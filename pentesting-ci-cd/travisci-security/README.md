# Seguridad de TravisCI

<details>

<summary><strong>춰Apoya a HackTricks y obt칠n beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **칰ltima versi칩n de PEASS o descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop).
* Obt칠n el [**merchandising oficial de PEASS y HackTricks**](https://peass.creator-spring.com).
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family).
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s칤gueme** en **Twitter** 游냕 [**@carlospolopm**](https://twitter.com/carlospolopm).

* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en GitHub.

</details>

## 쯈u칠 es TravisCI?

**Travis CI** es un servicio de **integraci칩n continua** alojado o en las instalaciones utilizado para construir y probar proyectos de software alojados en varias **plataformas de git diferentes**.

{% content-ref url="basic-travisci-information.md" %}
[basic-travisci-information.md](basic-travisci-information.md)
{% endcontent-ref %}

## Ataques

### Disparadores

Para lanzar un ataque, primero necesitas saber c칩mo activar una compilaci칩n. Por defecto, TravisCI **activar치 una compilaci칩n en los empujes y las solicitudes de extracci칩n**:

![](<../../.gitbook/assets/image (19) (1).png>)

#### Trabajos Cron

Si tienes acceso a la aplicaci칩n web, puedes **configurar trabajos cron para ejecutar la compilaci칩n**, esto podr칤a ser 칰til para la persistencia o para activar una compilaci칩n:

![](<../../.gitbook/assets/image (42).png>)

{% hint style="info" %}
Parece que no es posible configurar trabajos cron dentro del archivo `.travis.yml` seg칰n [esto](https://github.com/travis-ci/travis-ci/issues/9162).
{% endhint %}

### Solicitudes de extracci칩n de terceros

TravisCI, de forma predeterminada, deshabilita el intercambio de variables de entorno con las solicitudes de extracci칩n de terceros, pero alguien podr칤a habilitarlo y luego podr칤as crear solicitudes de extracci칩n al repositorio y extraer los secretos:

![](<../../.gitbook/assets/image (1) (1) (1) (1).png>)

### Extracci칩n de secretos

Como se explica en la p치gina de [**informaci칩n b치sica**](basic-travisci-information.md), hay 2 tipos de secretos. Los **secretos de variables de entorno** (que se enumeran en la p치gina web) y los **secretos cifrados personalizados**, que se almacenan dentro del archivo `.travis.yml` en formato base64 (ten en cuenta que ambos, almacenados cifrados, terminar치n como variables de entorno en las m치quinas finales).

* Para **enumerar los secretos** configurados como **variables de entorno**, ve a la **configuraci칩n** del **proyecto** y verifica la lista. Sin embargo, ten en cuenta que todas las variables de entorno del proyecto configuradas aqu칤 aparecer치n al activar una compilaci칩n.
* Para enumerar los **secretos cifrados personalizados**, lo mejor que puedes hacer es **verificar el archivo `.travis.yml`**.
* Para **enumerar los archivos cifrados**, puedes buscar archivos **`.enc`** en el repositorio, l칤neas similares a `openssl aes-256-cbc -K $encrypted_355e94ba1091_key -iv $encrypted_355e94ba1091_iv -in super_secret.txt.enc -out super_secret.txt -d` en el archivo de configuraci칩n, o **claves y vectores de inicializaci칩n cifrados** en las **variables de entorno**, como:

![](<../../.gitbook/assets/image (71).png>)

### POR HACER:

* Ejemplo de compilaci칩n con una shell inversa en Windows/Mac/Linux.
* Ejemplo de compilaci칩n que filtra el entorno codificado en base64 en los registros.

### TravisCI Enterprise

Si un atacante termina en un entorno que utiliza **TravisCI Enterprise** (m치s informaci칩n sobre qu칠 es esto en la [**informaci칩n b치sica**](basic-travisci-information.md#travisci-enterprise)), podr치 **activar compilaciones en el Worker**. Esto significa que un atacante podr치 moverse lateralmente a ese servidor desde el cual podr칤a ser capaz de:

* 쮼scapar al host?
* 쮺omprometer Kubernetes?
* 쮺omprometer otras m치quinas que se ejecutan en la misma red?
* 쮺omprometer nuevas credenciales de la nube?

## Referencias

* [https://docs.travis-ci.com/user/encrypting-files/](https://docs.travis-ci.com/user/encrypting-files/)
* [https://docs.travis-ci.com/user/best-practices-security](https://docs.travis-ci.com/user/best-practices-security)

<details>

<summary><strong>춰Apoya a HackTricks y obt칠n beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **칰ltima versi칩n de PEASS o descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop).
* Obt칠n el [**merchandising oficial de PEASS y HackTricks**](https://peass.creator-spring.com).
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family).
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s칤gueme** en **Twitter** 游냕 [**@carlospolopm**](https://twitter.com/carlospolopm).

* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en GitHub.

</details>
