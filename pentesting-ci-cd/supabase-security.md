# Supabaseå®‰å…¨

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

- å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
- è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
- æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
- **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Šå…³æ³¨æˆ‘ä»¬ ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
- é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## åŸºæœ¬ä¿¡æ¯

æ ¹æ®ä»–ä»¬çš„[**é¦–é¡µ**](https://supabase.com/)ï¼šSupabaseæ˜¯ä¸€ä¸ªå¼€æºçš„Firebaseæ›¿ä»£å“ã€‚ä½¿ç”¨Postgresæ•°æ®åº“ã€èº«ä»½éªŒè¯ã€å³æ—¶APIã€è¾¹ç¼˜å‡½æ•°ã€å®æ—¶è®¢é˜…ã€å­˜å‚¨å’Œå‘é‡åµŒå…¥å¼€å§‹æ‚¨çš„é¡¹ç›®ã€‚

### å­åŸŸ

åŸºæœ¬ä¸Šï¼Œå½“åˆ›å»ºä¸€ä¸ªé¡¹ç›®æ—¶ï¼Œç”¨æˆ·å°†æ”¶åˆ°ä¸€ä¸ªç±»ä¼¼äº**`jnanozjdybtpqgcwhdiz.supabase.co`**çš„supabase.coå­åŸŸã€‚

## **æ•°æ®åº“é…ç½®**

{% hint style="success" %}
**å¯ä»¥é€šè¿‡ç±»ä¼¼`https://supabase.com/dashboard/project/<project-id>/settings/database`çš„é“¾æ¥è®¿é—®è¿™äº›æ•°æ®**
{% endhint %}

è¿™ä¸ª**æ•°æ®åº“**å°†éƒ¨ç½²åœ¨æŸä¸ªAWSåŒºåŸŸï¼Œä¸ºäº†è¿æ¥åˆ°å®ƒï¼Œå¯ä»¥è¿æ¥åˆ°ï¼š`postgres://postgres.jnanozjdybtpqgcwhdiz:[YOUR-PASSWORD]@aws-0-us-west-1.pooler.supabase.com:5432/postgres`ï¼ˆè¿™æ˜¯åœ¨us-west-1åˆ›å»ºçš„ï¼‰ã€‚\
å¯†ç æ˜¯ç”¨æˆ·ä¹‹å‰è®¾ç½®çš„**å¯†ç **ã€‚

å› æ­¤ï¼Œç”±äºå­åŸŸæ˜¯å·²çŸ¥çš„ï¼Œå¹¶ä¸”ç”¨ä½œç”¨æˆ·åï¼ŒAWSåŒºåŸŸæœ‰é™ï¼Œå¯èƒ½å¯ä»¥å°è¯•**æš´åŠ›ç ´è§£å¯†ç **ã€‚

æ­¤éƒ¨åˆ†è¿˜åŒ…å«ä»¥ä¸‹é€‰é¡¹ï¼š

- é‡ç½®æ•°æ®åº“å¯†ç 
- é…ç½®è¿æ¥æ± 
- é…ç½®SSLï¼šæ‹’ç»æ˜æ–‡è¿æ¥ï¼ˆé»˜è®¤æƒ…å†µä¸‹å·²å¯ç”¨ï¼‰
- é…ç½®ç£ç›˜å¤§å°
- åº”ç”¨ç½‘ç»œé™åˆ¶å’Œå°ç¦

## APIé…ç½®

{% hint style="success" %}
**å¯ä»¥é€šè¿‡ç±»ä¼¼`https://supabase.com/dashboard/project/<project-id>/settings/api`çš„é“¾æ¥è®¿é—®è¿™äº›æ•°æ®**
{% endhint %}

è®¿é—®é¡¹ç›®ä¸­supabase APIçš„URLå°†ç±»ä¼¼äºï¼š`https://jnanozjdybtpqgcwhdiz.supabase.co`ã€‚

### åŒ¿åAPIå¯†é’¥

å®ƒè¿˜å°†ç”Ÿæˆä¸€ä¸ª**åŒ¿åAPIå¯†é’¥**ï¼ˆ`role: "anon"`ï¼‰ï¼Œå¦‚ï¼š`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTQ5OTI3MTksImV4cCI6MjAzMDU2ODcxOX0.sRN0iMGM5J741pXav7UxeChyqBE9_Z-T0tLA9Zehvqk`ï¼Œåº”ç”¨ç¨‹åºå°†éœ€è¦ä½¿ç”¨å®ƒæ¥è”ç³»åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­å…¬å¼€çš„APIå¯†é’¥ã€‚

å¯ä»¥åœ¨[**æ–‡æ¡£**](https://supabase.com/docs/reference/self-hosting-auth/returns-the-configuration-settings-for-the-gotrue-server)ä¸­æ‰¾åˆ°è”ç³»æ­¤APIçš„API RESTï¼Œä½†æœ€æœ‰è¶£çš„ç«¯ç‚¹å°†æ˜¯ï¼š
```
POST /auth/v1/signup HTTP/2
Host: id.io.net
Content-Length: 90
X-Client-Info: supabase-js-web/2.39.2
Sec-Ch-Ua: "Not-A.Brand";v="99", "Chromium";v="124"
Sec-Ch-Ua-Mobile: ?0
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTQ5OTI3MTksImV4cCI6MjAzMDU2ODcxOX0.sRN0iMGM5J741pXav7UxeChyqBE9_Z-T0tLA9Zehvqk
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.6367.60 Safari/537.36
Content-Type: application/json;charset=UTF-8
Apikey: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTQ5OTI3MTksImV4cCI6MjAzMDU2ODcxOX0.sRN0iMGM5J741pXav7UxeChyqBE9_Z-T0tLA9Zehvqk
Sec-Ch-Ua-Platform: "macOS"
Accept: */*
Origin: https://cloud.io.net
Sec-Fetch-Site: same-site
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://cloud.io.net/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Priority: u=1, i

{"email":"test@exmaple.com","password":"SomeCOmplexPwd239."}
```
</details>

<details>

<summary>ç™»å½• (/auth/v1/token?grant_type=password)</summary>
```
POST /auth/v1/token?grant_type=password HTTP/2
Host: hypzbtgspjkludjcnjxl.supabase.co
Content-Length: 80
X-Client-Info: supabase-js-web/2.39.2
Sec-Ch-Ua: "Not-A.Brand";v="99", "Chromium";v="124"
Sec-Ch-Ua-Mobile: ?0
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTQ5OTI3MTksImV4cCI6MjAzMDU2ODcxOX0.sRN0iMGM5J741pXav7UxeChyqBE9_Z-T0tLA9Zehvqk
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.6367.60 Safari/537.36
Content-Type: application/json;charset=UTF-8
Apikey: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTQ5OTI3MTksImV4cCI6MjAzMDU2ODcxOX0.sRN0iMGM5J741pXav7UxeChyqBE9_Z-T0tLA9Zehvqk
Sec-Ch-Ua-Platform: "macOS"
Accept: */*
Origin: https://cloud.io.net
Sec-Fetch-Site: same-site
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://cloud.io.net/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Priority: u=1, i

{"email":"test@exmaple.com","password":"SomeCOmplexPwd239."}
```
</details>

å› æ­¤ï¼Œæ¯å½“æ‚¨å‘ç°å®¢æˆ·æ­£åœ¨ä½¿ç”¨å…¶è¢«æˆäºˆçš„å­åŸŸåä¸ supabase ä¸€èµ·ä½¿ç”¨æ—¶ï¼ˆå…¬å¸çš„å­åŸŸåå¯èƒ½åœ¨å…¶ supabase å­åŸŸåä¸Šæœ‰ä¸€ä¸ª CNAMEï¼‰ï¼Œæ‚¨å¯ä»¥å°è¯•**ä½¿ç”¨ supabase API åœ¨å¹³å°ä¸Šåˆ›å»ºä¸€ä¸ªæ–°å¸æˆ·**ã€‚

### secret / service\_role api keys

è¿˜å°†ç”Ÿæˆä¸€ä¸ªå¸¦æœ‰**`role: "service_role"`**çš„ç§˜å¯† API å¯†é’¥ã€‚è¿™ä¸ª API å¯†é’¥åº”è¯¥ä¿å¯†ï¼Œå› ä¸ºå®ƒå°†èƒ½å¤Ÿç»•è¿‡**è¡Œçº§å®‰å…¨æ€§**ã€‚

API å¯†é’¥çœ‹èµ·æ¥åƒè¿™æ ·ï¼š`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTcxNDk5MjcxOSwiZXhwIjoyMDMwNTY4NzE5fQ.0a8fHGp3N_GiPq0y0dwfs06ywd-zhTwsm486Tha7354`

### JWT Secret

è¿˜å°†ç”Ÿæˆä¸€ä¸ª**JWT å¯†é’¥**ï¼Œä»¥ä¾¿åº”ç”¨ç¨‹åºå¯ä»¥**åˆ›å»ºå’Œç­¾ç½²è‡ªå®šä¹‰ JWT ä»¤ç‰Œ**ã€‚

## è®¤è¯

### æ³¨å†Œ

{% hint style="success" %}
**é»˜è®¤æƒ…å†µä¸‹**ï¼Œsupabase å°†å…è®¸é¡¹ç›®ä¸Šçš„**æ–°ç”¨æˆ·é€šè¿‡ä½¿ç”¨å…ˆå‰æåˆ°çš„ API ç«¯ç‚¹åˆ›å»ºå¸æˆ·**ã€‚
{% endhint %}

ç„¶è€Œï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº›æ–°å¸æˆ·**éœ€è¦éªŒè¯å…¶ç”µå­é‚®ä»¶åœ°å€**æ‰èƒ½ç™»å½•åˆ°å¸æˆ·ã€‚å¯ä»¥å¯ç”¨**"å…è®¸åŒ¿åç™»å½•"**ä»¥å…è®¸äººä»¬åœ¨ä¸éªŒè¯å…¶ç”µå­é‚®ä»¶åœ°å€çš„æƒ…å†µä¸‹ç™»å½•ã€‚è¿™å¯èƒ½ä¼šæˆäºˆå¯¹**æ„å¤–æ•°æ®**çš„è®¿é—®æƒé™ï¼ˆä»–ä»¬è·å¾—è§’è‰² `public` å’Œ `authenticated`ï¼‰ã€‚
è¿™æ˜¯ä¸€ä¸ªéå¸¸ç³Ÿç³•çš„ä¸»æ„ï¼Œå› ä¸º supabase æŒ‰æ´»è·ƒç”¨æˆ·æ”¶è´¹ï¼Œæ‰€ä»¥äººä»¬å¯ä»¥åˆ›å»ºç”¨æˆ·å¹¶ç™»å½•ï¼Œsupabase å°†ä¸ºè¿™äº›ç”¨æˆ·æ”¶è´¹ï¼š

<figure><img src="../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

### å¯†ç å’Œä¼šè¯

å¯ä»¥æŒ‡å®šæœ€å°å¯†ç é•¿åº¦ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼‰ï¼Œè¦æ±‚ï¼ˆé»˜è®¤æƒ…å†µä¸‹ä¸è¦æ±‚ï¼‰å¹¶ç¦æ­¢ä½¿ç”¨æ³„éœ²çš„å¯†ç ã€‚
å»ºè®®**æ”¹è¿›è¦æ±‚ï¼Œå› ä¸ºé»˜è®¤è¦æ±‚è¾ƒå¼±**ã€‚

* ç”¨æˆ·ä¼šè¯ï¼šå¯ä»¥é…ç½®ç”¨æˆ·ä¼šè¯çš„å·¥ä½œæ–¹å¼ï¼ˆè¶…æ—¶ï¼Œæ¯ä¸ªç”¨æˆ· 1 ä¸ªä¼šè¯...ï¼‰
* æœºå™¨äººå’Œæ»¥ç”¨ä¿æŠ¤ï¼šå¯ä»¥å¯ç”¨éªŒè¯ç ã€‚

### SMTP è®¾ç½®

å¯ä»¥è®¾ç½® SMTP ä»¥å‘é€ç”µå­é‚®ä»¶ã€‚

### é«˜çº§è®¾ç½®

* è®¾ç½®è®¿é—®ä»¤ç‰Œçš„è¿‡æœŸæ—¶é—´ï¼ˆé»˜è®¤ä¸º 3600ï¼‰
* è®¾ç½®ä»¥æ£€æµ‹å’Œæ’¤é”€æ½œåœ¨å—æŸçš„åˆ·æ–°ä»¤ç‰Œå’Œè¶…æ—¶
* MFAï¼šæŒ‡ç¤ºæ¯ä¸ªç”¨æˆ·å¯ä»¥åŒæ—¶æ³¨å†Œå¤šå°‘ä¸ª MFA å› ç´ ï¼ˆé»˜è®¤ä¸º 10ï¼‰
* æœ€å¤§ç›´æ¥æ•°æ®åº“è¿æ¥æ•°ï¼šç”¨äºèº«ä»½éªŒè¯çš„æœ€å¤§è¿æ¥æ•°ï¼ˆé»˜è®¤ä¸º 10ï¼‰
* æœ€å¤§è¯·æ±‚æŒç»­æ—¶é—´ï¼šå…è®¸èº«ä»½éªŒè¯è¯·æ±‚æŒç»­çš„æœ€é•¿æ—¶é—´ï¼ˆé»˜è®¤ä¸º 10sï¼‰

## å­˜å‚¨

{% hint style="success" %}
Supabase å…è®¸**å­˜å‚¨æ–‡ä»¶**å¹¶é€šè¿‡ URL ä½¿å…¶å¯è®¿é—®ï¼ˆå®ƒä½¿ç”¨ S3 å­˜å‚¨æ¡¶ï¼‰ã€‚
{% endhint %}

* è®¾ç½®ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶ï¼ˆé»˜è®¤ä¸º 50MBï¼‰
* S3 è¿æ¥ä½¿ç”¨ç±»ä¼¼ä»¥ä¸‹çš„ URLï¼š`https://jnanozjdybtpqgcwhdiz.supabase.co/storage/v1/s3`
* å¯ä»¥**è¯·æ±‚ S3 è®¿é—®å¯†é’¥**ï¼Œç”± `è®¿é—®å¯†é’¥ ID`ï¼ˆä¾‹å¦‚ `a37d96544d82ba90057e0e06131d0a7b`ï¼‰å’Œ `ç§˜å¯†è®¿é—®å¯†é’¥`ï¼ˆä¾‹å¦‚ `58420818223133077c2cec6712a4f909aec93b4daeedae205aa8e30d5a860628`ï¼‰ç»„æˆ

## è¾¹ç¼˜å‡½æ•°

ä¹Ÿå¯ä»¥åœ¨ supabase ä¸­**å­˜å‚¨ç§˜å¯†**ï¼Œè¿™äº›ç§˜å¯†å°†**å¯ç”±è¾¹ç¼˜å‡½æ•°è®¿é—®**ï¼ˆå¯ä»¥ä»ç½‘ç»œåˆ›å»ºå’Œåˆ é™¤ï¼Œä½†æ— æ³•ç›´æ¥è®¿é—®å…¶å€¼ï¼‰ã€‚
