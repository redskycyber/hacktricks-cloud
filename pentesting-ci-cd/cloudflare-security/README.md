# BezpieczeÅ„stwo Cloudflare

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

W koncie Cloudflare moÅ¼na skonfigurowaÄ‡ kilka **ogÃ³lnych ustawieÅ„ i usÅ‚ug**. Na tej stronie przeanalizujemy **ustawienia zwiÄ…zane z bezpieczeÅ„stwem w kaÅ¼dej sekcji:**

<figure><img src="../../.gitbook/assets/image (85) (1).png" alt=""><figcaption></figcaption></figure>

## Strony internetowe

Przejrzyj kaÅ¼dÄ… z nich:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

### Rejestracja domen

* [ ] W **`Transfer Domains`** sprawdÅº, czy nie moÅ¼na przenieÅ›Ä‡ Å¼adnej domeny.

Przejrzyj kaÅ¼dÄ… z nich:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

## Analiza

_Nie znalazÅ‚em niczego, co moÅ¼na by sprawdziÄ‡ pod kÄ…tem bezpieczeÅ„stwa konfiguracji._

## Strony

Na kaÅ¼dej stronie Cloudflare:

* [ ] SprawdÅº, czy nie ma **wraÅ¼liwych informacji** w **`Build log`**.
* [ ] SprawdÅº, czy nie ma **wraÅ¼liwych informacji** w repozytorium **Github** przypisanym do stron.
* [ ] SprawdÅº, czy nie ma moÅ¼liwoÅ›ci **kompromitacji repozytorium Github** za pomocÄ… **wstrzykniÄ™cia poleceÅ„ workflow** lub **kompromitacji pull_request_target**. WiÄ™cej informacji na stronie [**BezpieczeÅ„stwo Github**](../github-security/).
* [ ] SprawdÅº, czy nie ma **podatnych funkcji** w katalogu `/fuctions` (jeÅ›li istniejÄ…), sprawdÅº **przekierowania** w pliku `_redirects` (jeÅ›li istniejÄ…) i **bÅ‚Ä™dnie skonfigurowane nagÅ‚Ã³wki** w pliku `_headers` (jeÅ›li istniejÄ…).
* [ ] SprawdÅº, czy nie ma **podatnoÅ›ci** na **stronie internetowej** za pomocÄ… **blackbox** lub **whitebox**, jeÅ›li masz **dostÄ™p do kodu**
* [ ] W szczegÃ³Å‚ach kaÅ¼dej strony `/<page_id>/pages/view/blocklist/settings/functions`. SprawdÅº, czy nie ma **wraÅ¼liwych informacji** w **`Zmiennych Å›rodowiskowych`**.
* [ ] Na stronie szczegÃ³Å‚Ã³w sprawdÅº rÃ³wnieÅ¼ **polecenie budowania** i **katalog gÅ‚Ã³wny** w celu **potencjalnych wstrzykniÄ™Ä‡** w celu skompromitowania strony.

## **Pracownicy**

Na kaÅ¼dym pracowniku Cloudflare sprawdÅº:

* [ ] Wyzwalacze: Co powoduje uruchomienie pracownika? Czy uÅ¼ytkownik moÅ¼e przesÅ‚aÄ‡ dane, ktÃ³re bÄ™dÄ… uÅ¼ywane przez pracownika?
* [ ] W **`Ustawieniach`** sprawdÅº, czy sÄ… **`Zmienne`** zawierajÄ…ce **wraÅ¼liwe informacje**
* [ ] SprawdÅº kod pracownika i wyszukaj **podatnoÅ›ci** (szczegÃ³lnie w miejscach, gdzie uÅ¼ytkownik moÅ¼e zarzÄ…dzaÄ‡ danymi wejÅ›ciowymi)
* SprawdÅº SSRF zwracajÄ…cÄ… wskazanÄ… stronÄ™, ktÃ³rÄ… moÅ¼na kontrolowaÄ‡
* SprawdÅº XSS wykonujÄ…cy JS wewnÄ…trz obrazu svg

{% hint style="warning" %}
NaleÅ¼y zauwaÅ¼yÄ‡, Å¼e domyÅ›lnie **Pracownikowi przypisywany jest adres URL** taki jak `<worker-name>.<account>.workers.dev`. UÅ¼ytkownik moÅ¼e ustawiÄ‡ go jako **poddomenÄ™**, ale zawsze moÅ¼na do niego uzyskaÄ‡ dostÄ™p za pomocÄ… tego **oryginalnego adresu URL**, jeÅ›li go znasz.
{% endhint %}

## R2

TODO

## Stream

TODO

## Obrazy

TODO

## Centrum bezpieczeÅ„stwa

* [ ] JeÅ›li to moÅ¼liwe, uruchom **skanowanie** **`Security Insights`** i **`Infrastructure`**, poniewaÅ¼ wyÅ›wietlÄ… one interesujÄ…ce informacje zwiÄ…zane z bezpieczeÅ„stwem.
* [ ] SprawdÅº te informacje pod kÄ…tem nieprawidÅ‚owej konfiguracji bezpieczeÅ„stwa i interesujÄ…cych informacji

## Turnstile

TODO

## **Zero Trust**

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Przekierowania masowe

{% hint style="info" %}
W przeciwieÅ„stwie do [PrzekierowaÅ„ dynamicznych](https://developers.cloudflare.com/rules/url-forwarding/dynamic-redirects/), [**Przekierowania masowe**](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/) sÄ… w zasadzie statyczne - **nie obsÅ‚ugujÄ… Å¼adnych operacji zastÄ™powania ciÄ…gÃ³w znakÃ³w** ani wyraÅ¼eÅ„ regularnych. Jednak moÅ¼na skonfigurowaÄ‡ parametry przekierowania URL, ktÃ³re wpÅ‚ywajÄ… na ich zachowanie w czasie wykonywania i dopasowywanie do adresÃ³w URL.
{% endhint %}

* [ ] SprawdÅº, czy **wyraÅ¼enia** i **wymagania** dla przekierowaÅ„ majÄ… **sens**.
* [ ] SprawdÅº rÃ³wnieÅ¼, czy nie ma **ukrytych punktÃ³w koÅ„cowych** zawierajÄ…cych interesujÄ…ce informacje.

## Powiadomienia

* [ ] SprawdÅº **powiadomienia**. NastÄ™pujÄ…ce powiadomienia sÄ… zalecane pod kÄ…tem bezpieczeÅ„stwa:
* `Usage Based Billing`
* `HTTP DDoS Attack Alert`
* `Layer 3/4 DDoS Attack Alert`
* `Advanced HTTP DDoS Attack Alert`
* `Advanced Layer 3/4 DDoS Attack Alert`
* `Flow-based Monitoring: Volumetric Attack`
* `Route Leak Detection Alert`
* `Access mTLS Certificate Expiration Alert`
* `SSL for SaaS Custom Hostnames Alert`
* `Universal SSL Alert`
* `Script Monitor New Code Change Detection Alert`
* `Script Monitor New Domain Alert`
* `Script Monitor New Malicious Domain Alert`
* `Script Monitor New Malicious Script Alert`
* `Script Monitor New Malicious URL Alert`
* `Script Monitor New Scripts Alert`
* `Script Monitor New Script Exceeds Max URL Length Alert`
* `Advanced Security Events Alert`
* `Security Events Alert`
* [ ] SprawdÅº wszystkie **miejsca docelowe**, poniewaÅ¼ mogÄ… zawieraÄ‡ **wraÅ¼liwe informacje** (podstawowa autoryzacja HTTP) w adresach URL webhookÃ³w. Upewnij siÄ™ rÃ³wnieÅ¼, Å¼e adresy URL webhookÃ³w uÅ¼ywajÄ… **protokoÅ‚u HTTPS**
* [ ] Dodatkowo, moÅ¼na sprÃ³bowaÄ‡ **udawaÄ‡ powiadomienie Cloudflare** do strony trzeciej, byÄ‡ moÅ¼e moÅ¼na w jakiÅ› sposÃ³b **wstrzyknÄ…Ä‡ coÅ› niebezpiecznego**

## ZarzÄ…dzanie kontem

* [ ] MoÅ¼na zobaczyÄ‡ **ostatnie 4 cyfry karty kredytowej**, **termin waÅ¼noÅ›ci** i **adres rozliczeniowy** w **`Billing` -> `Payment info`**.
* [ ] MoÅ¼na zobaczyÄ‡ **typ planu** uÅ¼ywanego w koncie w **`Billing` -> `Subscriptions`**.
* [ ] W **`Members`** moÅ¼na zobaczyÄ‡ wszystkich czÅ‚onkÃ³w konta i ich **rolÄ™**. N
## Åšledztwo w sprawie ataku DDoS

[SprawdÅº tÄ™ czÄ™Å›Ä‡](cloudflare-domains.md#ochrona-przed-atakami-ddos-w-cloudflare).

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ **reklamÄ™ swojej firmy w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>
