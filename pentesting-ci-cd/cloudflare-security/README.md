# Sicurezza di Cloudflare

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Esperto Red Team AWS di HackTricks)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se desideri vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**La Famiglia PEASS**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repository di Github.

</details>

In un account Cloudflare ci sono alcune **impostazioni generali e servizi** che possono essere configurati. In questa pagina andremo a **analizzare le impostazioni relative alla sicurezza di ciascuna sezione:**

<figure><img src="../../.gitbook/assets/image (117).png" alt=""><figcaption></figcaption></figure>

## Siti Web

Rivedi ciascuno con:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

### Registrazione del Dominio

* [ ] In **`Trasferimento Domini`** controlla che non sia possibile trasferire alcun dominio.

Rivedi ciascuno con:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

## Analisi

_Non ho trovato nulla da controllare per una revisione della sicurezza della configurazione._

## Pagine

Su ciascuna pagina di Cloudflare:

* [ ] Controlla le **informazioni sensibili** nel **`Log di compilazione`**.
* [ ] Controlla le **informazioni sensibili** nel **repository Github** assegnato alle pagine.
* [ ] Controlla la compromissione potenziale del repository Github tramite **iniezione di comandi nel workflow** o compromissione di `pull_request_target`. Ulteriori informazioni nella [**pagina di sicurezza di Github**](../github-security/).
* [ ] Controlla le **funzioni vulnerabili** nella directory `/funzioni` (se presente), controlla i **reindirizzamenti** nel file `_redirects` (se presente) e **intestazioni mal configurate** nel file `_headers` (se presente).
* [ ] Controlla le **vulnerabilit√†** nella **pagina web** tramite **blackbox** o **whitebox** se puoi **accedere al codice**
* [ ] Nei dettagli di ciascuna pagina `/<page_id>/pages/view/blocklist/settings/functions`. Controlla le **informazioni sensibili** nelle **`Variabili d'ambiente`**.
* [ ] Nella pagina dei dettagli controlla anche il **comando di compilazione** e la **directory principale** per **iniezioni potenziali** per compromettere la pagina.

## **Workers**

Su ciascun worker di Cloudflare controlla:

* [ ] I trigger: Cosa fa scattare il worker? Un **utente pu√≤ inviare dati** che verranno **utilizzati** dal worker?
* [ ] Nelle **`Impostazioni`**, controlla le **`Variabili`** contenenti **informazioni sensibili**
* [ ] Controlla il **codice del worker** e cerca **vulnerabilit√†** (specialmente nei punti in cui l'utente pu√≤ gestire l'input)
* Controlla gli SSRF che restituiscono la pagina indicata che puoi controllare
* Controlla gli XSS che eseguono JS all'interno di un'immagine svg

{% hint style="warning" %}
Nota che per impostazione predefinita a un **Worker viene assegnato un URL** come `<nome-worker>.<account>.workers.dev`. L'utente pu√≤ impostarlo su un **sottodominio** ma puoi sempre accedervi con quell'**URL originale** se lo conosci.
{% endhint %}

## R2

DA FARE

## Stream

DA FARE

## Immagini

DA FARE

## Centro Sicurezza

* [ ] Se possibile, esegui una **scansione di** **`Security Insights`** e una scansione di **`Infrastruttura`**, poich√© evidenzieranno informazioni interessanti dal punto di vista della **sicurezza**.
* [ ] Controlla queste informazioni per eventuali errate configurazioni di sicurezza e informazioni interessanti

## Turnstile

DA FARE

## **Zero Trust**

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Reindirizzamenti di Massa

{% hint style="info" %}
A differenza dei [Reindirizzamenti Dinamici](https://developers.cloudflare.com/rules/url-forwarding/dynamic-redirects/), i [**Reindirizzamenti di Massa**](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/) sono essenzialmente statici ‚Äî non supportano operazioni di **sostituzione di stringhe** o espressioni regolari. Tuttavia, √® possibile configurare parametri di reindirizzamento URL che influenzano il comportamento di corrispondenza dell'URL e il loro comportamento in fase di esecuzione.
{% endhint %}

* [ ] Controlla che le **espressioni** e i **requisiti** per i reindirizzamenti abbiano **senso**.
* [ ] Controlla anche la presenza di **endpoint nascosti sensibili** che contengono informazioni interessanti.

## Notifiche

* [ ] Controlla le **notifiche**. Queste notifiche sono consigliate per la sicurezza:
* `Fatturazione basata sull'utilizzo`
* `Avviso attacco DDoS HTTP`
* `Avviso attacco DDoS Layer 3/4`
* `Avviso attacco DDoS HTTP avanzato`
* `Avviso attacco DDoS Layer 3/4 avanzato`
* `Monitoraggio basato sul flusso: Attacco volumetrico`
* `Avviso rilevamento perdita di route`
* `Avviso scadenza certificato mTLS Access`
* `Avviso hostname personalizzato SSL per SaaS`
* `Avviso SSL universale`
* `Avviso rilevamento nuovo codice monitoraggio script`
* `Avviso rilevamento nuovo dominio monitoraggio script`
* `Avviso rilevamento nuovo dominio dannoso monitoraggio script`
* `Avviso rilevamento nuovo script dannoso monitoraggio script`
* `Avviso rilevamento nuovo URL dannoso monitoraggio script`
* `Avviso rilevamento nuovi script monitoraggio script`
* `Avviso rilevamento nuovo script che supera la lunghezza URL massima monitoraggio script`
* `Avviso eventi sicurezza avanzati`
* `Avviso eventi sicurezza`
* [ ] Controlla tutte le **destinazioni**, poich√© potrebbero esserci **informazioni sensibili** (autenticazione http di base) negli URL dei webhook. Assicurati inoltre che gli URL dei webhook utilizzino **HTTPS**
* [ ] Come controllo aggiuntivo, potresti provare a **fingere una notifica di Cloudflare** a un terzo, forse puoi in qualche modo **iniettare qualcosa di pericoloso**

## Gestisci Account

* [ ] √à possibile vedere gli **ultimi 4 numeri della carta di credito**, la **scadenza** e l'**indirizzo di fatturazione** in **`Fatturazione` -> `Informazioni di pagamento`**.
* [ ] √à possibile vedere il **tipo di piano** utilizzato nell'account in **`Fatturazione` -> `Sottoscrizioni`**.
* [ ] In **`Membri`** √® possibile vedere tutti i membri dell'account e il loro **ruolo**. Nota che se il tipo di piano non √® Enterprise, esistono solo 2 ruoli: Amministratore e Super Amministratore. Ma se il **piano utilizzato √® Enterprise**, possono essere utilizzati [**pi√π ruoli**](https://developers.cloudflare.com/fundamentals/account-and-billing/account-setup/account-roles/) per seguire il principio del privilegio minimo.
* Pertanto, quando possibile √® **consigliabile** utilizzare il **piano Enterprise**.
* [ ] In Membri √® possibile verificare quali **membri** hanno attivato il **2FA**. **Ogni** utente dovrebbe averlo attivato.

{% hint style="info" %}
Nota che fortunatamente il ruolo **`Amministratore`** non concede autorizzazioni per gestire le appartenenze (**non pu√≤ aumentare i privilegi o invitare** nuovi membri)
{% endhint %}
## Indagine DDoS

[Controlla questa parte](cloudflare-domains.md#cloudflare-ddos-protection).

<details>

<summary><strong>Impara l'hacking AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Esperto Red Team AWS di HackTricks)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se desideri vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**La Famiglia PEASS**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR a** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
