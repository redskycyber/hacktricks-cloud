# Gh Actions - Inyecciones de Script

<details>

<summary><strong>隆Apoya a HackTricks y obt茅n beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **煤ltima versi贸n de PEASS o descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop).
* Obt茅n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm).

* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>

## Informaci贸n b谩sica

Ten en cuenta que hay ciertos [**contextos de github**](https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context) cuyos valores son **controlados** por el **usuario** que crea la PR. Si la acci贸n de github est谩 utilizando esos **datos para ejecutar cualquier cosa**, podr铆a llevar a una **ejecuci贸n de c贸digo arbitrario**. Estos contextos suelen terminar con `body`, `default_branch`, `email`, `head_ref`, `label`, `message`, `name`, `page_name`,`ref` y `title`. Por ejemplo (lista de este [**art铆culo**](https://medium.com/tinder/exploiting-github-actions-on-open-source-projects-5d93936d189f)):

* github.event.comment.body
* github.event.issue.body
* github.event.issue.title
* github.head\_ref
* github.pull\_request.\*
* github.\*.\*.authors.name
* github.\*.\*.authors.email

Ten en cuenta que hay **fuentes menos obvias** de entrada potencialmente no confiable, como los nombres de las ramas y las direcciones de correo electr贸nico, que pueden ser **bastante flexibles en cuanto a su contenido permitido**. Por ejemplo, `zzz";echo${IFS}"hello";#` ser铆a un nombre de rama v谩lido y podr铆a ser un posible vector de ataque para un repositorio objetivo.

### Ejemplo de un ataque de inyecci贸n de script <a href="#example-of-a-script-injection-attack" id="example-of-a-script-injection-attack"></a>

Un ataque de inyecci贸n de script puede ocurrir directamente dentro del script en l铆nea de un flujo de trabajo. En el siguiente ejemplo, una acci贸n utiliza una **expresi贸n para probar la validez del t铆tulo de una pull request**, pero tambi茅n agrega el riesgo de inyecci贸n de script:
```yaml
- name: Check PR title
run: |
title="${{ github.event.pull_request.title }}"
if [[ $title =~ ^octocat ]]; then
echo "PR title starts with 'octocat'"
exit 0
else
echo "PR title did not start with 'octocat'"
exit 1
fi
```
Antes de que se ejecute el script de shell, las expresiones dentro de `${{ }}` se **eval煤an** y luego se sustituyen por los valores resultantes, lo que puede hacerlo **vulnerable a la inyecci贸n de comandos de shell**.

Para inyectar comandos en este flujo de trabajo, el atacante podr铆a crear una solicitud de extracci贸n con un t铆tulo de **`a"; ls $GITHUB_WORKSPACE"`**

En este ejemplo, el car谩cter **`"`** se utiliza para interrumpir la declaraci贸n `title=`**`"${{ github.event.pull_request.title }}"`**, lo que permite que se ejecute el comando `ls` en el runner.

<details>

<summary><strong>隆Apoya a HackTricks y obt茅n beneficios!</strong></summary>

* Si quieres ver tu **empresa anunciada en HackTricks** o si quieres acceder a la **煤ltima versi贸n de PEASS o descargar HackTricks en PDF**, 隆consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>
