# GH Actions - Zatrucie pamici podrcznej

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w GitHub.

</details>


Aby uzyska dalsze szczeg贸y, sprawd藕 oryginalny post [https://scribesecurity.com/blog/github-cache-poisoning/](https://scribesecurity.com/blog/github-cache-poisoning/)


## Zatrucie pamici podrcznej

Akcja Git [**action/cache**](https://github.com/actions/cache) wprowadza mechanizm pamici podrcznej w procesie Continuous Integration (CI), obejmujcy dwie kluczowe fazy:

1. **Uruchomienie akcji**: Ta faza polega na wyszukiwaniu i pobieraniu danych z pamici podrcznej podczas uruchamiania CI. Wyszukiwanie wykorzystuje unikalny klucz pamici podrcznej, dajc dwa wyniki:
- **Trafienie w pami podrczn**: 呕dane dane s znalezione w pamici podrcznej i s natychmiast pobierane do u偶ycia.
- **Brak trafienia w pami podrczn**: Nie znaleziono pasujcych danych w pamici podrcznej, co powoduje pobranie wymaganych plik贸w i katalog贸w, podobnie jak w przypadku pierwszego 偶dania.

2. **Akcja po zakoczeniu przepywu pracy**: Ta faza jest powicona pamici podrcznej danych po zakoczeniu przepywu pracy CI. Konkretnie, jeli wystpi brak trafienia w pami podrczn podczas akcji uruchamiania, bie偶cy stan okrelonych katalog贸w jest przechowywany w pamici podrcznej za pomoc podanego klucza. Ten proces jest zautomatyzowany i nie wymaga wywoania explicite.

#### rodki bezpieczestwa: Izolacja pamici podrcznej i ograniczenia dostpu

Aby utrzyma bezpieczestwo i zapewni izolacj pamici podrcznej, wprowadza si ograniczenia dostpu, tworzc logiczne rozdzielenie midzy r贸偶nymi gaziami. Na przykad, pami podrczna utworzona dla gazi **Feature-A** (z baz w g贸wnej gazi) bdzie niedostpna dla 偶dania pull request dla gazi **Feature-B** (r贸wnie偶 z baz w g贸wnej gazi).

Akcja pamici podrcznej przestrzega okrelonej kolejnoci wyszukiwania:
- Najpierw szuka trafie w pamici podrcznej w tej samej gazi, w kt贸rej uruchamiany jest przepyw pracy.
- Jeli nie powiedzie si, rozszerza wyszukiwanie do gazi nadrzdnej i innych gazi nadrzdnych.

Wa偶ne jest, 偶e dostp do pamici podrcznej jest ograniczony do gazi, obejmujc wszystkie przepywy pracy i uruchomienia konkretnej gazi. Dodatkowo, GitHub narzuca polityk tylko do odczytu dla wpis贸w pamici podrcznej po ich utworzeniu, zabraniajc jakichkolwiek modyfikacji.

#### Implikacja w wiecie rzeczywistym: Atak na przepyw pracy o niskich uprawnieniach, prowadzcy do przepywu pracy o wysokich uprawnieniach

Ilustracyjny scenariusz CI pokazuje, jak atakujcy mo偶e wykorzysta zatrucie pamici podrcznej do eskalacji uprawnie z przepywu pracy o niskich uprawnieniach do przepywu pracy o wysokich uprawnieniach:

- Przepyw pracy **Unit-test**, odpowiedzialny za uruchamianie test贸w jednostkowych i narzdzi do pokrycia kodu, zakada u偶ycie narzdzia skompromitowanego lub podatnego. Ten przepyw pracy wykorzystuje akcj Git **action/cache**, dziki czemu pami podrczna jest dostpna dla dowolnego przepywu pracy.
- Przepyw pracy **Release**, odpowiedzialny za budowanie i wydawanie artefaktu aplikacji, optymalizuje swoje operacje poprzez pamici podrczne zale偶noci Golang.

W tym scenariuszu przepyw pracy jednostkowego testu wprowadza zoliwy wpis do pamici podrcznej, podmieniajc prawidow bibliotek logowania Golang (`go
