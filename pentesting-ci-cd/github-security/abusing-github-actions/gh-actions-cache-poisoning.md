# GH Actions - Trovanje ke코a

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>


Za dalje detalje pogledajte originalni post [https://scribesecurity.com/blog/github-cache-poisoning/](https://scribesecurity.com/blog/github-cache-poisoning/)


## Trovanje ke코a

Git akcija [**action/cache**](https://github.com/actions/cache) uvodi mehanizam ke코iranja u proces kontinuirane integracije (CI), obuhvataju캖i dve klju캜ne faze:

1. **Pokreni akciju**: Ova faza uklju캜uje pretragu i dobavljanje ke코iranih podataka tokom CI izvr코avanja. Pretraga koristi jedinstveni klju캜 ke코a, daju캖i dva rezultata:
- **Ke코 pogodak**: Tra쬰ni podaci se nalaze u ke코u i stoga se odmah dobavljaju za upotrebu.
- **Ke코 proma코aj**: Nema podudaranja podataka u ke코u, 코to dovodi do sve쬰g preuzimanja potrebnih datoteka i direktorijuma, sli캜no kao kod prvog zahteva.

2. **Post Workflow akcija**: Ova faza je posve캖ena ke코iranju podataka nakon CI workflow-a. Konkretno, ako se dogodi ke코 proma코aj tokom izvr코avanja akcije, trenutno stanje odre캠enih direktorijuma se ke코ira koriste캖i pru쬰ni klju캜. Ovaj proces je automatizovan i ne zahteva eksplicitno pozivanje.

#### Mere bezbednosti: Izolacija ke코a i ograni캜enja pristupa

Da bi se odr쬬la bezbednost i osigurala izolacija ke코a, primenjuju se ograni캜enja pristupa, stvaraju캖i logi캜ku separaciju izme캠u razli캜itih grana. Na primer, ke코 kreiran za granu **Feature-A** (sa bazom u glavnoj grani) ne캖e biti dostupan za pull zahtev za granu **Feature-B** (tako캠e baziranu na glavnoj grani).

Akcija ke코a se pridr쬬va odre캠enog redosleda pretrage:
- Prvo tra쬴 ke코 pogotke unutar iste grane kao i izvr코avanje workflow-a.
- Ako ne uspe, pro코iruje pretragu na nadre캠enu granu i druge uzvodne grane.

Va쬹o je napomenuti da je pristup ke코u ograni캜en na granu, prote쬰 se na sve workflow-e i izvr코avanja odre캠ene grane. Dodatno, GitHub primenjuje pravilo samo za 캜itanje za unose ke코a nakon 코to su kreirani, zabranjuju캖i bilo kakve izmene.

#### Implikacija u stvarnom svetu: Od napada sa niskim do napada sa visokim privilegijama u workflow-u

Ilustrativni CI scenario prikazuje kako napada캜 mo쬰 iskoristiti trovanje ke코a da bi eskalirao privilegije od workflow-a sa niskim privilegijama do onog sa visokim privilegijama:

- Workflow **Unit-test**, odgovoran za pokretanje jedini캜nih testova i alata za pokrivenost koda, pretpostavlja da koristi kompromitovan ili ranjiv alat. Ovaj workflow koristi Git akciju **action/cache**, 캜ime ke코 postaje dostupan svakom workflow-u.
- Workflow **Release**, zadu쬰n za izgradnju i objavljivanje aplikacionog artefakta, optimizuje svoje operacije ke코iranjem Golang zavisnosti.

U ovom scenariju, workflow za jedini캜no testiranje uvodi zlonamerni unos u ke코 zamenom legitimne Golang biblioteke za logovanje (`go
