# Github Bezbednost

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini da podrÅ¾ite HackTricks:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Å ta je Github

(Sa [ovde](https://kinsta.com/knowledgebase/what-is-github/)) Na visokom nivou, **Github je veb sajt i cloud-based servis koji pomaÅ¾e programerima da skladiÅ¡te i upravljaju svojim kodom, kao i da prate i kontroliÅ¡u promene na svom kodu**.

### Osnovne informacije

{% content-ref url="basic-github-information.md" %}
[basic-github-information.md](basic-github-information.md)
{% endcontent-ref %}

## Spoljni Recon

Github repozitorijumi mogu biti konfigurisani kao javni, privatni i interni.

* **Privatni** znaÄi da Ä‡e **samo** ljudi iz **organizacije** moÄ‡i da im pristupe
* **Interni** znaÄi da Ä‡e **samo** ljudi iz **preduzeÄ‡a** (preduzeÄ‡e moÅ¾e imati viÅ¡e organizacija) moÄ‡i da mu pristupe
* **Javni** znaÄi da Ä‡e mu moÄ‡i pristupiti **ceo internet**.

Ukoliko znate **korisnika, repozitorijum ili organizaciju koju Å¾elite da ciljate** moÅ¾ete koristiti **github dorks** da pronaÄ‘ete osetljive informacije ili traÅ¾ite **curenje osetljivih informacija na svakom repozitorijumu**.

### Github Dorks

Github omoguÄ‡ava **pretragu neÄega specificirajuÄ‡i korisnika, repozitorijum ili organizaciju kao opseg**. Stoga, sa listom stringova koji Ä‡e se pojaviti blizu osetljivih informacija, lako moÅ¾ete **traÅ¾iti potencijalne osetljive informacije na svom cilju**.

Alati (svaki alat sadrÅ¾i svoju listu dorkova):

* [https://github.com/obheda12/GitDorker](https://github.com/obheda12/GitDorker) ([Lista dorkova](https://github.com/obheda12/GitDorker/tree/master/Dorks))
* [https://github.com/techgaun/github-dorks](https://github.com/techgaun/github-dorks) ([Lista dorkova](https://github.com/techgaun/github-dorks/blob/master/github-dorks.txt))
* [https://github.com/hisxo/gitGraber](https://github.com/hisxo/gitGraber) ([Lista dorkova](https://github.com/hisxo/gitGraber/tree/master/wordlists))

### Github Curenja

Molim vas, imajte na umu da su github dorkovi takoÄ‘e namenjeni za pretragu curenja koristeÄ‡i opcije pretrage na github-u. Ova sekcija je posveÄ‡ena alatima koji Ä‡e **preuzeti svaki repozitorijum i traÅ¾iti osetljive informacije u njima** (Äak i proveravajuÄ‡i odreÄ‘enu dubinu commit-ova).

Alati (svaki alat sadrÅ¾i svoju listu regex-a):

* [https://github.com/zricethezav/gitleaks](https://github.com/zricethezav/gitleaks)
* [https://github.com/trufflesecurity/truffleHog](https://github.com/trufflesecurity/truffleHog)
* [https://github.com/eth0izzle/shhgit](https://github.com/eth0izzle/shhgit)
* [https://github.com/michenriksen/gitrob](https://github.com/michenriksen/gitrob)
* [https://github.com/anshumanbh/git-all-secrets](https://github.com/anshumanbh/git-all-secrets)
* [https://github.com/kootenpv/gittyleaks](https://github.com/kootenpv/gittyleaks)
* [https://github.com/awslabs/git-secrets](https://github.com/awslabs/git-secrets)

{% hint style="warning" %}
Kada traÅ¾ite curenja u repozitorijumu i pokrenete neÅ¡to poput `git log -p`, ne zaboravite da mogu postojati **druge grane sa drugim commit-ovima** koji sadrÅ¾e tajne!
{% endhint %}

### Spoljni Forkovi

MoguÄ‡e je **ugroziti repozitorijume zloupotrebom pull zahteva**. Da biste saznali da li je repozitorijum ranjiv, uglavnom treba da proÄitate Github Actions yaml konfiguracije. [**ViÅ¡e informacija o tome ispod**](./#execution-from-a-external-fork).

## JaÄanje Organizacije

### Privilegije ÄŒlanova

Postoje neke **podrazumevane privilegije** koje se mogu dodeliti **Älanovima** organizacije. Ove privilegije se mogu kontrolisati sa stranice `https://github.com/organizations/<org_name>/settings/member_privileges` ili preko [**Organizations API-ja**](https://docs.github.com/en/rest/orgs/orgs).

* **Osnovna ovlaÅ¡Ä‡enja**: ÄŒlanovi Ä‡e imati ovlaÅ¡Ä‡enja None/Read/write/Admin nad repozitorijumima organizacije. PreporuÄuje se **None** ili **Read**.
* **Forkovanje repozitorijuma**: Ako nije neophodno, bolje je **ne dozvoliti** Älanovima da forkiraju repozitorijume organizacije.
* **Kreiranje stranica**: Ako nije neophodno, bolje je **ne dozvoliti** Älanovima da objavljuju stranice iz repozitorijuma organizacije. Ako je potrebno, moÅ¾ete dozvoliti kreiranje javnih ili privatnih stranica.
* **Zahtevi za pristup integracijama**: Sa ovim omoguÄ‡enim, spoljni saradnici Ä‡e moÄ‡i da zatraÅ¾e pristup GitHub ili OAuth aplikacijama za pristup ovoj organizaciji i njenim resursima. ObiÄno je potrebno, ali ako nije, bolje je onemoguÄ‡iti.
* _Nisam mogao da pronaÄ‘em ove informacije u API odgovoru, podelite ako vi pronaÄ‘ete_
* **Promena vidljivosti repozitorijuma**: Ako je omoguÄ‡eno, **Älanovi** sa **admin** ovlaÅ¡Ä‡enjima za **repozitorijum** Ä‡e moÄ‡i da **promene njegovu vidljivost**. Ako je onemoguÄ‡eno, samo vlasnici organizacije mogu promeniti vidljivost repozitorijuma. Ako **ne Å¾elite** da ljudi Äine stvari **javno dostupnim**, pobrinite se
### Integracije

_Javite mi ako znate API endpoint za pristupanje ovim informacijama!_

* **Politika pristupa treÄ‡ih aplikacija**: PreporuÄuje se ograniÄiti pristup svakoj aplikaciji i dozvoliti samo one koje su potrebne (nakon pregleda).
* **Instalirane GitHub aplikacije**: PreporuÄuje se dozvoliti samo one koje su potrebne (nakon pregleda).

## Recon & Napadi zloupotrebom akreditiva

Za ovaj scenario pretpostavljamo da ste veÄ‡ dobili pristup GitHub nalogu.

### Sa korisniÄkim akreditivima

Ako veÄ‡ imate akreditive za korisnika unutar organizacije, moÅ¾ete se **samo prijaviti** i proveriti koje **uloge imate u preduzeÄ‡u i organizaciji**, ako ste obiÄan Älan, proverite koje **dozvole imaju obiÄni Älanovi**, u kojim **grupama** se nalazite, koje **dozvole imate** nad kojim **repozitorijumima**, i **kako su repozitorijumi zaÅ¡tiÄ‡eni**.

Imajte na umu da se moÅ¾e koristiti **2FA**, pa Ä‡ete moÄ‡i pristupiti ovim informacijama samo ako moÅ¾ete **proÄ‡i tu proveru**.

{% hint style="info" %}
Imajte na umu da ako **uspete da ukradete `user_session` kolaÄiÄ‡** (trenutno konfigurisan sa SameSite: Lax), moÅ¾ete **potpuno se predstavljati kao korisnik** bez potrebe za akreditivima ili 2FA.
{% endhint %}

Proverite odeljak ispod o [**zaobilaÅ¾enju zaÅ¡tite grana**](./#zaobilaÅ¾enje-zaÅ¡tite-grana) ako je korisno.

### Sa korisniÄkim SSH kljuÄem

Github omoguÄ‡ava **korisnicima** da postave **SSH kljuÄeve** koji Ä‡e se koristiti kao **metod autentifikacije za implementaciju koda** u njihovo ime (ne primenjuje se 2FA).

Sa ovim kljuÄem moÅ¾ete izvrÅ¡iti **promene u repozitorijumima gde korisnik ima privilegije**, meÄ‘utim ne moÅ¾ete ga koristiti za pristupanje GitHub API-ju radi nabrojavanja okruÅ¾enja. MeÄ‘utim, moÅ¾ete **nabrojati lokalne postavke** kako biste dobili informacije o repozitorijumima i korisniku kojima imate pristup:
```bash
# Go to the the repository folder
# Get repo config and current user name and email
git config --list
```
Ako korisnik konfiguriÅ¡e svoje korisniÄko ime kao svoje github korisniÄko ime, moÅ¾ete pristupiti **javnom kljuÄu koji je postavio** na svom nalogu na _https://github.com/\<github\_korisniÄko\_ime>.keys_, moÅ¾ete to proveriti da biste potvrdili da li pronaÄ‘eni privatni kljuÄ moÅ¾e da se koristi.

**SSH kljuÄevi** takoÄ‘e mogu biti postavljeni u repozitorijumima kao **deploy kljuÄevi**. Svako ko ima pristup ovom kljuÄu moÄ‡i Ä‡e da **pokrene projekte iz repozitorijuma**. ObiÄno, na serveru sa razliÄitim deploy kljuÄevima, lokalna datoteka **`~/.ssh/config`** Ä‡e vam pruÅ¾iti informacije o tome koji kljuÄ je povezan.

#### GPG KljuÄevi

Kao Å¡to je objaÅ¡njeno [**ovde**](broken-reference/), ponekad je potrebno potpisati komitove ili biste mogli biti otkriveni.

Lokalno proverite da li trenutni korisnik ima neki kljuÄ sa:
```shell
gpg --list-secret-keys --keyid-format=long
```
### Sa korisniÄkim tokenom

Za uvod o **KorisniÄkim tokenima proverite osnovne informacije**.

KorisniÄki token se moÅ¾e koristiti **umesto lozinke** za Git preko HTTPS-a, ili se moÅ¾e koristiti za **autentifikaciju na API-ju preko osnovne autentifikacije**. Zavisno od privilegija koje su mu dodeljene, moÅ¾ete izvrÅ¡iti razliÄite radnje.

KorisniÄki token izgleda ovako: `ghp_EfHnQFcFHX6fGIu5mpduvRiYR584kK0dX123`

### Sa Oauth aplikacijom

Za uvod o **Github Oauth aplikacijama proverite osnovne informacije**.

NapadaÄ moÅ¾e kreirati **zlonamernu Oauth aplikaciju** kako bi pristupio privilegovanim podacima/akcijama korisnika koji ih prihvataju, verovatno kao deo kampanje phishinga.

Ovo su [oblasti koje Oauth aplikacija moÅ¾e zahtevati](https://docs.github.com/en/developers/apps/building-oauth-apps/scopes-for-oauth-apps). Uvek treba proveriti zahtevane oblasti pre nego Å¡to ih prihvatite.

Osim toga, kao Å¡to je objaÅ¡njeno u osnovnim informacijama, **organizacije mogu dozvoliti/odbijati pristup aplikacijama treÄ‡ih strana** informacijama/repositorijumima/akcijama vezanim za organizaciju.

### Sa Github aplikacijom

Za uvod o **Github aplikacijama proverite osnovne informacije**.

NapadaÄ moÅ¾e kreirati **zlonamernu Github aplikaciju** kako bi pristupio privilegovanim podacima/akcijama korisnika koji ih prihvataju, verovatno kao deo kampanje phishinga.

Osim toga, kao Å¡to je objaÅ¡njeno u osnovnim informacijama, **organizacije mogu dozvoliti/odbijati pristup aplikacijama treÄ‡ih strana** informacijama/repositorijumima/akcijama vezanim za organizaciju.

## Kompromitacija i zloupotreba Github akcija

Postoji nekoliko tehnika za kompromitaciju i zloupotrebu Github akcija, proverite ih ovde:

{% content-ref url="abusing-github-actions/" %}
[abusing-github-actions](abusing-github-actions/)
{% endcontent-ref %}

## ZaobilaÅ¾enje zaÅ¡tite grane

* **Zahtevanje odreÄ‘enog broja odobrenja**: Ako ste kompromitovali nekoliko naloga, moÅ¾ete prihvatiti svoje PR-ove sa drugih naloga. Ako imate samo nalog sa kojeg ste kreirali PR, ne moÅ¾ete prihvatiti svoj sopstveni PR. MeÄ‘utim, ako imate pristup **Github Action** okruÅ¾enju unutar repozitorijuma, koristeÄ‡i **GITHUB\_TOKEN** moÅ¾da Ä‡ete moÄ‡i **odobriti svoj PR** i na taj naÄin dobiti 1 odobrenje.
* _Napomena za ovo i za ograniÄenje vlasnika koda je da korisnik obiÄno neÄ‡e moÄ‡i odobriti svoje sopstvene PR-ove, ali ako moÅ¾ete, moÅ¾ete ih zloupotrebiti da biste prihvatili svoje PR-ove._
* **Odbacivanje odobrenja kada se poÅ¡alju novi commit-ovi**: Ako ovo nije podeÅ¡eno, moÅ¾ete poslati legitimni kod, saÄekati da ga neko odobri, a zatim uneti zlonameran kod i spojiti ga na zaÅ¡tiÄ‡enu granu.
* **Zahtevanje odobrenja od vlasnika koda**: Ako je ovo aktivirano i vi ste vlasnik koda, moÅ¾ete napraviti **Github Action koji Ä‡e kreirati vaÅ¡ PR, a zatim ga sami odobriti**.
* Kada je **CODEOWNER fajl netaÄno konfigurisan**, Github ne prijavljuje greÅ¡ku, ali ga ne koristi. Dakle, ako je netaÄno konfigurisan, **zaÅ¡tita vlasnika koda se ne primenjuje**.
* **Dozvoljavanje odreÄ‘enim akterima da zaobiÄ‘u zahteve za pull request**: Ako ste jedan od tih aktera, moÅ¾ete zaobiÄ‡i zaÅ¡titu pull requesta.
* **UkljuÄivanje administratora**: Ako ovo nije podeÅ¡eno i vi ste administrator repozitorijuma, moÅ¾ete zaobiÄ‡i ovu zaÅ¡titu grane.
* **Hijacking PR-a**: MoÅ¾ete biti u moguÄ‡nosti da **izmenite PR nekog drugog** dodavanjem zlonamernog koda, odobrite rezultirajuÄ‡i PR sami i spojite sve.
* **Uklanjanje zaÅ¡tite grane**: Ako ste **administrator repozitorijuma, moÅ¾ete onemoguÄ‡iti zaÅ¡titu**, spojiti svoj PR i ponovo postaviti zaÅ¡titu.
* **ZaobilaÅ¾enje zaÅ¡tite push-ova**: Ako repozitorijum **samo odreÄ‘enim korisnicima dozvoljava** slanje push-ova (spajanje koda) na granama (zaÅ¡tita grane moÅ¾e Å¡tititi sve grane koristeÄ‡i wildcard `*`).
* Ako imate **pristup pisanju nad repozitorijumom, ali vam nije dozvoljeno slanje koda** zbog zaÅ¡tite grane, i dalje moÅ¾ete **kreirati novu granu** i unutar nje kreirati **Github Action koji se pokreÄ‡e kada se kod poÅ¡alje**. PoÅ¡to **zaÅ¡tita grane neÄ‡e Å¡tititi granu dok se ne kreira**, prvo slanje koda na granu Ä‡e **pokrenuti Github Action**.

## ZaobilaÅ¾enje zaÅ¡tite okruÅ¾enja

Za uvod o **Github okruÅ¾enjima proverite osnovne informacije**.

U sluÄaju da se na **svim granama moÅ¾e pristupiti okruÅ¾enju**, ono **nije zaÅ¡tiÄ‡eno** i lako moÅ¾ete pristupiti tajnama unutar okruÅ¾enja. Imajte na umu da moÅ¾ete naiÄ‡i na repozitorijume gde su **sve grane zaÅ¡tiÄ‡ene** (navoÄ‘enjem njihovih imena ili koriÅ¡Ä‡enjem `*`), u tom scenariju **pronaÄ‘ite granu na koju moÅ¾ete slati kod** i moÅ¾ete **izfiltrirati** tajne kreiranjem nove Github akcije (ili modifikacijom postojeÄ‡e).

Imajte na umu da moÅ¾ete naiÄ‡i na specifiÄan sluÄaj gde su **sve grane zaÅ¡tiÄ‡ene** (pomoÄ‡u wildcard `*`) i **navedeno je ko moÅ¾e slati kod na grane** (_to moÅ¾ete specificirati u zaÅ¡titi grane_) i **vaÅ¡em korisniku nije dozvoljeno**. Ipak, moÅ¾ete pokrenuti prilagoÄ‘enu Github akciju jer moÅ¾ete kreirati granu i koristiti okidaÄ za slanje koda na samu sebe. **ZaÅ¡tita grane dozvoljava slanje na novu granu, pa Ä‡e se Github akcija pokrenuti**.
```yaml
push: # Run it when a push is made to a branch
branches:
- current_branch_name #Use '**' to run when a push is made to any branch
```
Napomena da Ä‡e **nakon kreiranja** grane **zaÅ¡tita grane biti primenjena na novu granu** i neÄ‡ete moÄ‡i da je menjate, ali do tada Ä‡ete veÄ‡ izvukli tajne.

## Upornost

* GeneriÅ¡ite **korisniÄki token**
* Ukradite **github token-e** iz **tajni**
* **Brisanje** rezultata radnog toka i grana
* Dajte **viÅ¡e dozvola svim organizacijama**
* Kreirajte **webhook-ove** za izvlaÄenje informacija
* Pozovite **spoljne saradnike**
* **Uklonite webhook-ove** koje koristi **SIEM**
* Kreirajte/izmenite **Github Action** sa **zadnjim vratima**
* PronaÄ‘ite **ranjivu Github Action za ubrizgavanje komandi** putem izmene vrednosti **tajne**

### LaÅ¾ni commit-ovi - Zadnja vrata putem commit-a repozitorijuma

Na Github-u je moguÄ‡e **kreirati PR za repozitorijum iz forka**. ÄŒak i ako PR nije **prihvaÄ‡en**, id commit-a unutar originalnog repozitorijuma Ä‡e biti kreiran za verziju koda iz forka. Stoga, napadaÄ **moÅ¾e da se veÅ¾e za odreÄ‘eni commit iz navodno legitimnog repozitorijuma koji nije kreirao vlasnik repozitorijuma**.

Kao [**ovde**](https://github.com/actions/checkout/commit/c7d749a2d57b4b375d1ebcd17cfbfb60c676f18e):
```yaml
name: example
on: [push]
jobs:
commit:
runs-on: ubuntu-latest
steps:
- uses: actions/checkout@c7d749a2d57b4b375d1ebcd17cfbfb60c676f18e
- shell: bash
run: |
echo 'hello world!'
```
Za viÅ¡e informacija pogledajte [https://www.chainguard.dev/unchained/what-the-fork-imposter-commits-in-github-actions-and-ci-cd](https://www.chainguard.dev/unchained/what-the-fork-imposter-commits-in-github-actions-and-ci-cd)

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju oglaÅ¡enu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
