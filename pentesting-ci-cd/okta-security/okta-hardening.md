# Okta OjaÄavanje

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Pogledajte [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Direktorijum

### Ljudi

Iz perspektive napadaÄa, ovo je veoma interesantno jer Ä‡ete moÄ‡i da vidite **sve registrovane korisnike**, njihove **email** adrese, **grupe** kojima pripadaju, **profile** i Äak **ureÄ‘aje** (mobilne ureÄ‘aje zajedno sa njihovim operativnim sistemima).

Prilikom belog-boksa pregleda, proverite da li postoje nekoliko "**Pending user action**" i "**Password reset**".

### Grupe

Ovde moÅ¾ete pronaÄ‡i sve kreirane grupe u Okta. Interesantno je razumeti razliÄite grupe (skup **dozvola**) koje mogu biti dodeljene **korisnicima**.\
MoguÄ‡e je videti **ljude ukljuÄene u grupe** i **aplikacije dodeljene** svakoj grupi.

Naravno, svaka grupa sa imenom **admin** je interesantna, posebno grupa **Global Administrators**, proverite Älanove da biste saznali ko su najprivilegovaniji Älanovi.

Prilikom belog-boksa pregleda, **ne bi trebalo da postoji viÅ¡e od 5 globalnih administratora** (bolje ako ih ima samo 2 ili 3).

### UreÄ‘aji

PronaÄ‘ite ovde **listu svih ureÄ‘aja** svih korisnika. TakoÄ‘e moÅ¾ete videti da li se ureÄ‘aj **aktivno upravlja** ili ne.

### UreÄ‘ivaÄ profila

Ovde je moguÄ‡e posmatrati kako se kljuÄne informacije kao Å¡to su ime, prezime, email, korisniÄko ime... dele izmeÄ‘u Okta i drugih aplikacija. Ovo je interesantno jer ako korisnik moÅ¾e da **izmeni polje u Okta** (kao Å¡to je njegovo ime ili email) koje se zatim koristi od strane **spoljne aplikacije** da **identifikuje** korisnika, unutraÅ¡nji napadaÄ moÅ¾e pokuÅ¡ati da **preuzme druge naloge**.

Osim toga, u profilu **`User (default)`** iz Okta moÅ¾ete videti **koja polja** svaki **korisnik** ima i koja su polja **izmenjiva** od strane korisnika. Ako ne moÅ¾ete videti admin panel, jednostavno idite na **aÅ¾uriranje informacija o svom profilu** i videÄ‡ete koja polja moÅ¾ete aÅ¾urirati (imajte na umu da za aÅ¾uriranje email adrese morate je verifikovati).

### Integracije direktorijuma

Direktorijumi vam omoguÄ‡avaju da uvezete ljude iz postojeÄ‡ih izvora. Pretpostavljam da Ä‡ete ovde videti korisnike uvezene iz drugih direktorijuma.

Nisam to video, ali pretpostavljam da je ovo interesantno da se otkriju **drugi direktorijumi koje Okta koristi za uvoz korisnika**, tako da ako **kompromitujete taj direktorijum** moÅ¾ete postaviti vrednosti atributa u korisnicima kreiranim u Okta i **moÅ¾da kompromitovati Okta okruÅ¾enje**.

### Izvori profila

Izvor profila je **aplikacija koja deluje kao izvor istine** za atribute korisniÄkog profila. Korisnik moÅ¾e biti izvor samo jedne aplikacije ili direktorijuma u isto vreme.

Nisam to video, pa je svaka informacija o bezbednosti i hakovanju u vezi sa ovom opcijom dobrodoÅ¡la.

## PrilagoÄ‘avanja

### Brendovi

Proverite u kartici **Domains** ove sekcije email adrese koje se koriste za slanje emailova i prilagoÄ‘enu domenu unutar Okta kompanije (koju verovatno veÄ‡ znate).

Osim toga, u kartici **Setting**, ako ste admin, moÅ¾ete "**Koristiti prilagoÄ‘enu stranicu za odjavu**" i postaviti prilagoÄ‘eni URL.

### SMS

Ovde nema niÄeg interesantnog.

### KorisniÄki panel

Ovde moÅ¾ete pronaÄ‡i konfigurisane aplikacije, ali detalje o njima Ä‡emo videti kasnije u drugoj sekciji.

### Ostalo

Interesantno podeÅ¡avanje, ali niÅ¡ta posebno interesantno sa aspekta bezbednosti.

## Aplikacije

### Aplikacije

Ovde moÅ¾ete pronaÄ‡i sve **konfigurisane aplikacije** i njihove detalje: Ko ima pristup njima, kako je konfigurisano (SAML, OPenID), URL za prijavu, mapiranje izmeÄ‘u Okta i aplikacije...

U kartici **`Sign On`** takoÄ‘e postoji polje nazvano **`Password reveal`** koje bi omoguÄ‡ilo korisniku da **otkrije svoju lozinku** prilikom provere postavki aplikacije. Da biste proverili postavke aplikacije iz korisniÄkog panela, kliknite na 3 taÄke:

<figure><img src="../../.gitbook/assets/image (4) (7).png" alt=""><figcaption></figcaption></figure>

I moÅ¾ete videti joÅ¡ neke detalje o aplikaciji (kao Å¡to je funkcija otkrivanja lozinke, ako je omoguÄ‡ena):

<figure><img src="../../.gitbook/assets/image (1) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

## Upravljanje identitetom

### Sertifikati pristupa

Koristite Sertifikate pristupa da biste kreirali kampanje za pregled pristupa vaÅ¡ih korisnika resursima periodiÄno i automatski odobravali ili oduzimali pristup kada je to potrebno.

Nisam video da se koristi, ali pretpostavljam da je ovo korisna funkcionalnost sa aspekta odbrane.

## Bezbednost

### OpÅ¡te

* **Emailovi sa obaveÅ¡tenjima o bezbednosti**: Sve bi trebalo da bude omoguÄ‡eno.
* **Integracija CAPTCHA**: PreporuÄuje se postavljanje barem nevidljivog reCaptcha
* **Bezbednost organizacije**: Sve moÅ¾e biti omoguÄ‡eno i emailovi za aktivaciju ne bi trebalo da traju dugo (7 dana je u redu)
* **Prevencija enumeracije korisnika**: Obe opcije bi trebalo da budu omoguÄ‡ene
* Imajte na umu da prevencija enumeracije korisnika neÄ‡e imati efekta ako su dozvoljeni bilo koji od sledeÄ‡ih uslova (videti [Upravljanje korisnicima](https://help.okta.com/oie/en-us/Content/Topics/users-groups-profiles/usgp-main.htm) za viÅ¡e informacija):
* Registracija samousluge
* JIT tokovi sa email autentifikacijom
* **Okta ThreatInsight podeÅ¡avanja**: Prijavljivanje i sprovoÄ‘enje bezbednosti na osnovu nivoa pretnje

### HealthInsight

Ovde je moguÄ‡e pronaÄ‡i pravilno i **opasno** konfigurisana **podeÅ¡avanja**.

### Autentifikatori

Ovde moÅ¾ete pronaÄ‡i sve metode autentifikacije koje korisnik moÅ¾e koristiti: Lozinka, telefon, email
### Globalna politika sesije

Ovde moÅ¾ete pronaÄ‡i politike sesije dodeljene razliÄitim grupama. Na primer:

<figure><img src="../../.gitbook/assets/image (2) (1) (2).png" alt=""><figcaption></figcaption></figure>

PreporuÄuje se zahtevanje MFA, ograniÄavanje trajanja sesije na nekoliko sati, ne Äuvanje kolaÄiÄ‡a sesije preko ekstenzija pregledaÄa i ograniÄavanje lokacije i Identity Provider-a (ako je to moguÄ‡e). Na primer, ako svaki korisnik treba da se prijavi iz odreÄ‘ene zemlje, moÅ¾ete dozvoliti samo tu lokaciju.

### Identity Providers

Identity Providers (IdP-ovi) su usluge koje **upravljaju korisniÄkim nalozima**. Dodavanje IdP-ova u Okta omoguÄ‡ava vaÅ¡im krajnjim korisnicima da se **samoregistruju** sa vaÅ¡im prilagoÄ‘enim aplikacijama tako Å¡to Ä‡e se prvo autentifikovati putem druÅ¡tvenog naloga ili pametne kartice.

Na stranici Identity Providers, moÅ¾ete dodati druÅ¡tvene prijave (IdP-ove) i konfigurisati Okta kao pruÅ¾aoca usluga (SP) dodavanjem dolaznog SAML-a. Nakon Å¡to ste dodali IdP-ove, moÅ¾ete postaviti pravila usmeravanja koja Ä‡e korisnike usmeriti na IdP na osnovu konteksta, kao Å¡to su lokacija korisnika, ureÄ‘aj ili domen e-poÅ¡te.

**Ako je konfigurisan bilo koji pruÅ¾alac identiteta** sa glediÅ¡ta napadaÄa i branioca, proverite tu konfiguraciju i **da li je izvor zaista pouzdan**, jer napadaÄ koji kompromituje IdP moÅ¾e dobiti pristup Okta okruÅ¾enju.

### Delegirana autentifikacija

Delegirana autentifikacija omoguÄ‡ava korisnicima da se prijave na Okta unosom podataka za prijavu za **Active Directory (AD) ili LDAP** server njihove organizacije.

Ponovo proverite ovo, jer napadaÄ koji kompromituje AD organizacije moÅ¾e preÄ‡i na Okta zahvaljujuÄ‡i ovoj postavci.

### MreÅ¾a

MreÅ¾na zona je konfigurabilna granica koju moÅ¾ete koristiti da **dodelite ili ograniÄite pristup raÄunarima i ureÄ‘ajima** u vaÅ¡oj organizaciji na osnovu **IP adrese** koja zahteva pristup. MoÅ¾ete definisati mreÅ¾nu zonu tako Å¡to Ä‡ete navesti jednu ili viÅ¡e pojedinaÄnih IP adresa, opsege IP adresa ili geografske lokacije.

Nakon Å¡to definiÅ¡ete jednu ili viÅ¡e mreÅ¾nih zona, moÅ¾ete ih **koristiti u globalnim politikama sesije**, politikama autentifikacije, obaveÅ¡tenjima o VPN-u i pravilima usmeravanja.

Sa glediÅ¡ta napadaÄa, interesantno je znati koje su IP adrese dozvoljene (i proveriti da li su neke IP adrese **privilegovane** u odnosu na druge). Sa glediÅ¡ta napadaÄa, ako korisnici treba da pristupaju sa odreÄ‘ene IP adrese ili regiona, proverite da li se ova funkcija pravilno koristi.

### Integracije ureÄ‘aja

* **Upravljanje krajnjim taÄkama**: Upravljanje krajnjim taÄkama je uslov koji se moÅ¾e primeniti u politici autentifikacije kako bi se osiguralo da upravljani ureÄ‘aji imaju pristup aplikaciji.
* JoÅ¡ nisam video da se ovo koristi. TODO
* **ObaveÅ¡tenja o usluzi**: JoÅ¡ nisam video da se ovo koristi. TODO

### API

Na ovoj stranici moÅ¾ete kreirati Okta API tokene i videti one koji su **kreirani**, njihove **privilegije**, **vreme isteka** i **URL-ove porekla**. Imajte na umu da se API tokeni generiÅ¡u sa dozvolama korisnika koji je kreirao token i vaÅ¾e samo ako je **korisnik** koji ih je kreirao **aktivan**.

**Pouzdani izvori** omoguÄ‡avaju pristup veb lokacijama koje kontroliÅ¡ete i kojima verujete da pristupaju vaÅ¡oj Okta organizaciji putem Okta API-ja.

Ne bi trebalo da bude puno API tokena, jer ako ih ima previÅ¡e, napadaÄ moÅ¾e pokuÅ¡ati da im pristupi i koristi ih.

## Radni tok

### Automatizacija

Automatizacija vam omoguÄ‡ava da kreirate automatske akcije koje se izvrÅ¡avaju na osnovu skupa uslova okidaÄa koji se javljaju tokom Å¾ivotnog ciklusa krajnjih korisnika.

Na primer, uslov moÅ¾e biti "Neaktivnost korisnika u Okta" ili "Isticanje lozinke korisnika u Okta", a akcija moÅ¾e biti "Slanje e-poÅ¡te korisniku" ili "Promena stanja Å¾ivotnog ciklusa korisnika u Okta".

## IzveÅ¡taji

### IzveÅ¡taji

Preuzmite zapise. Oni se **Å¡alju** na **e-adresu** trenutnog naloga.

### Sistemski zapis

Ovde moÅ¾ete pronaÄ‡i **zapise o radnjama koje su korisnici izvrÅ¡ili** sa mnogo detalja, kao Å¡to su prijava u Okta ili u aplikacije putem Okta.

### PraÄ‡enje uvoza

Ovo moÅ¾e **uvoziti zapise iz drugih platformi** na koje se pristupa putem Okta.

### OgraniÄenja brzine

Proverite dostignuta ograniÄenja brzine API-ja.

## Postavke

### Nalog

Ovde moÅ¾ete pronaÄ‡i **opÅ¡te informacije** o Okta okruÅ¾enju, kao Å¡to su naziv kompanije, adresa, **e-adresa za naplatu**, **e-adresa za tehniÄku podrÅ¡ku**, kao i ko treba da prima Okta aÅ¾uriranja i kakva Okta aÅ¾uriranja.

### Preuzimanja

Ovde moÅ¾ete preuzeti Okta agente za sinhronizaciju Okta sa drugim tehnologijama.

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **oglaÅ¡avanje vaÅ¡e kompanije u HackTricks-u** ili **preuzmete HackTricks u PDF formatu**, proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
