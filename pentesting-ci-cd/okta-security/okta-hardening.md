# Okta JaÄanje

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**PorodiÄnu PEASS**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Direktorijum

### Ljudi

Iz perspektive napadaÄa, ovo je veoma interesantno jer Ä‡ete moÄ‡i da vidite **sve registrovane korisnike**, njihove **email** adrese, **grupe** kojima pripadaju, **profile** pa Äak i **ureÄ‘aje** (mobilne telefone zajedno sa njihovim OS-ovima).

Za pregled iz belog okvira proverite da li postoji viÅ¡e "**Nepotpunih korisniÄkih radnji**" i "**Resetovanja lozinke**".

### Grupe

Ovde moÅ¾ete pronaÄ‡i sve kreirane grupe u Okta. Interesantno je razumeti razliÄite grupe (skup **dozvola**) koje se mogu dodeliti **korisnicima**.\
MoguÄ‡e je videti **ljude ukljuÄene u grupe** i **aplikacije dodeljene** svakoj grupi.

Naravno, svaka grupa sa imenom **admin** je interesantna, posebno grupa **Globalni administratori**, proverite Älanove da biste saznali ko su najprivilegovaniji Älanovi.

Iz belog okvira, **ne bi trebalo da postoji viÅ¡e od 5 globalnih administratora** (bolje je ako postoji samo 2 ili 3).

### UreÄ‘aji

Ovde pronaÄ‘ite **listu svih ureÄ‘aja** svih korisnika. TakoÄ‘e moÅ¾ete videti da li se ureÄ‘aj **aktivno upravlja** ili ne.

### Editor profila

Ovde je moguÄ‡e posmatrati kako se kljuÄne informacije poput imena, prezimena, email adresa, korisniÄkih imena... dele izmeÄ‘u Okta i drugih aplikacija. Ovo je interesantno jer ako korisnik moÅ¾e **da izmeni u Okta polje** (kao Å¡to je njegovo ime ili email) koje se zatim koristi od strane **spoljne aplikacije** da **identifikuje** korisnika, unutraÅ¡nji napadaÄ bi mogao da pokuÅ¡a da **preuzme druge naloge**.

Osim toga, u profilu **`Korisnik (podrazumevano)`** iz Okta moÅ¾ete videti **koja polja** svaki **korisnik** ima i koja su polja **koja korisnici mogu da menjaju**. Ako ne moÅ¾ete videti admin panel, jednostavno idite na **aÅ¾uriranje informacija o svom profilu** i videÄ‡ete koja polja moÅ¾ete aÅ¾urirati (imajte na umu da za aÅ¾uriranje email adrese morate je verifikovati).

### Integracije direktorijuma

Direktorijumi vam omoguÄ‡avaju da uvezete ljude iz postojeÄ‡ih izvora. Pretpostavljam da Ä‡ete ovde videti korisnike uvezene iz drugih direktorijuma.

Nisam video, ali pretpostavljam da je interesantno saznati **druge direktorijume koje Okta koristi za uvoz korisnika** tako da ako **kompromitujete taj direktorijum** moÅ¾ete postaviti vrednosti atributa kod korisnika kreiranih u Okta i **moÅ¾da kompromitovati Okta okruÅ¾enje**.

### Izvori profila

Izvor profila je **aplikacija koja deluje kao izvor istine** za atribute korisniÄkog profila. Korisnik moÅ¾e biti povezan samo sa jednom aplikacijom ili direktorijumom u isto vreme.

Nisam video, pa je svaka informacija o bezbednosti i hakovanju u vezi sa ovom opcijom dobrodoÅ¡la.

## PrilagoÄ‘avanja

### Brendovi

Proverite u odeljku **Domenske** tabele ove sekcije email adrese koje se koriste za slanje emailova i prilagoÄ‘enu domenu unutar Okta kompanije (koju verovatno veÄ‡ znate).

Osim toga, u **PodeÅ¡avanju** tabu, ako ste admin, moÅ¾ete "**Koristiti prilagoÄ‘enu stranicu odjavljivanja**" i postaviti prilagoÄ‘eni URL.

### SMS

Nema niÄeg interesantnog ovde.

### KorisniÄki panel

Ovde moÅ¾ete pronaÄ‡i konfigurisane aplikacije, ali Ä‡emo detalje o njima videti kasnije u drugom odeljku.

### Ostalo

Interesantno podeÅ¡avanje, ali niÅ¡ta posebno interesantno sa aspekta bezbednosti.

## Aplikacije

### Aplikacije

Ovde moÅ¾ete pronaÄ‡i sve **konfigurisane aplikacije** i njihove detalje: Ko ima pristup njima, kako je konfigurisano (SAML, OPenID), URL za prijavljivanje, mapiranje izmeÄ‘u Okta i aplikacije...

U **`Prijavi se`** tabu postoji i polje nazvano **`Otkrij lozinku`** koje bi omoguÄ‡ilo korisniku da **otkrije svoju lozinku** prilikom provere postavki aplikacije. Da biste proverili postavke aplikacije iz korisniÄkog panela, kliknite na 3 taÄke:

<figure><img src="../../.gitbook/assets/image (283).png" alt=""><figcaption></figcaption></figure>

I moÅ¾ete videti joÅ¡ neke detalje o aplikaciji (kao Å¡to je funkcija otkrivanja lozinke, ako je omoguÄ‡ena):

<figure><img src="../../.gitbook/assets/image (220).png" alt=""><figcaption></figcaption></figure>

## Upravljanje identitetom

### Sertifikati pristupa

Koristite Sertifikate pristupa da biste kreirali kampanje za proveru pristupa vaÅ¡ih korisnika resursima periodiÄno i automatski odobravali ili oduzimali pristup kada je potrebno.

Nisam video da se koristi, ali pretpostavljam da je sa defanzivnog aspekta lepa funkcija.

## Bezbednost

### OpÅ¡te

* **Emailovi obaveÅ¡tenja o bezbednosti**: Sve bi trebalo da bude omoguÄ‡eno.
* **Integracija CAPTCHA-e**: PreporuÄuje se postavljanje bar nevidljive reCaptcha-e
* **Bezbednost organizacije**: Sve moÅ¾e biti omoguÄ‡eno i aktivacioni emailovi ne bi trebalo da traju dugo (7 dana je ok)
* **Prevencija numeracije korisnika**: Obe bi trebalo da budu omoguÄ‡ene
* Imajte na umu da Prevencija numeracije korisnika neÄ‡e imati efekta ako su dozvoljeni bilo koji od sledeÄ‡ih uslova (Pogledajte [Upravljanje korisnicima](https://help.okta.com/oie/en-us/Content/Topics/users-groups-profiles/usgp-main.htm) za viÅ¡e informacija):
* Registracija samoposluÅ¾ivanja
* JIT tokovi sa email autentifikacijom
* **Okta ThreatInsight podeÅ¡avanja**: Prijavite i sprovodite bezbednost na osnovu nivoa pretnje

### HealthInsight

Ovde je moguÄ‡e pronaÄ‡i ispravno i **opasno** konfigurisana **podeÅ¡avanja**.

### Autentifikatori

Ovde moÅ¾ete pronaÄ‡i sve metode autentifikacije koje korisnik moÅ¾e koristiti: Lozinka, telefon, email, kod, WebAuthn... Klikom na autentifikator lozinke moÅ¾ete videti **polisu lozinke**. Proverite da li je jaka.

U tabu **Upis** moÅ¾ete videti koje su obavezne, a koje opcione:

<figure><img src="../../.gitbook/assets/image (143).png" alt=""><figcaption></figcaption></figure>

PreporuÄljivo je onemoguÄ‡iti Telefon. NajjaÄi su verovatno kombinacija lozinke, emaila i WebAuthn-a.

### Politike autentifikacije

Svaka aplikacija ima politiku autentifikacije. Politika autentifikacije proverava da li korisnici koji pokuÅ¡avaju da se prijave na aplikaciju ispunjavaju odreÄ‘ene uslove i sprovodi zahteve za faktore zasnovane na tim uslovima.

Ovde moÅ¾ete pronaÄ‡i **uslove za pristup svakoj aplikaciji**. PreporuÄljivo je zahtevati bar lozinku i joÅ¡ jedan metod za svaku aplikaciju. Ali ako kao napadaÄ pronaÄ‘ete neÅ¡to slabije, moÅ¾da Ä‡ete moÄ‡i da ga napadnete.
### Global Session Policy

Ovde moÅ¾ete pronaÄ‡i politike sesije dodeljene razliÄitim grupama. Na primer:

<figure><img src="../../.gitbook/assets/image (245).png" alt=""><figcaption></figcaption></figure>

PreporuÄuje se zahtevati MFA, ograniÄiti vreme trajanja sesije na nekoliko sati, ne Äuvati kolaÄiÄ‡e sesije preko proÅ¡irenja pregledaÄa i ograniÄiti lokaciju i Identity Provider (ako je to moguÄ‡e). Na primer, ako svaki korisnik treba da se prijavi iz odreÄ‘ene zemlje, moÅ¾ete dozvoliti samo tu lokaciju.

### Identity Providers

Identity Providers (IdP) su usluge koje **upravljaju korisniÄkim nalozima**. Dodavanje IdP u Okta omoguÄ‡ava vaÅ¡im krajnjim korisnicima da se **samoregistruju** sa vaÅ¡im prilagoÄ‘enim aplikacijama prvo se autentifikovanjem putem druÅ¡tvenog naloga ili pametne kartice.

Na stranici Identity Providers, moÅ¾ete dodati druÅ¡tvene prijave (IdP) i konfigurisati Okta kao pruÅ¾aoca usluga (SP) dodavanjem dolaznog SAML-a. Nakon Å¡to dodate IdP, moÅ¾ete postaviti pravila usmeravanja da usmerite korisnike ka IdP na osnovu konteksta, kao Å¡to su lokacija korisnika, ureÄ‘aj ili domen e-poÅ¡te.

**Ako je konfigurisan bilo koji pruÅ¾alac identiteta** sa taÄke glediÅ¡ta napadaÄa i branioca, proverite tu konfiguraciju i **da li je izvor zaista pouzdan** jer napadaÄ koji ga kompromituje moÅ¾e dobiti pristup Okta okruÅ¾enju.

### Delegirana autentikacija

Delegirana autentikacija omoguÄ‡ava korisnicima da se prijave na Okta unoÅ¡enjem podataka za svoj organizacioni **Active Directory (AD) ili LDAP** server.

Ponovo proverite ovo, jer napadaÄ koji kompromituje organizacioni AD moÅ¾e biti u moguÄ‡nosti da preÄ‘e na Okta zahvaljujuÄ‡i ovoj postavci.

### MreÅ¾a

MreÅ¾na zona je konfigurabilna granica koju moÅ¾ete koristiti da **omoguÄ‡ite ili ograniÄite pristup raÄunarima i ureÄ‘ajima** u vaÅ¡oj organizaciji na osnovu **IP adrese** koja zahteva pristup. MoÅ¾ete definisati mreÅ¾nu zonu navoÄ‘enjem jedne ili viÅ¡e pojedinaÄnih IP adresa, opsega IP adresa ili geografskih lokacija.

Nakon Å¡to definiÅ¡ete jednu ili viÅ¡e mreÅ¾nih zona, moÅ¾ete ih **koristiti u globalnim politikama sesije**, **autentikacionim politikama**, obaveÅ¡tenjima o VPN-u i **pravilima usmeravanja**.

Sa glediÅ¡ta napadaÄa, vaÅ¾no je znati koje IP adrese su dozvoljene (i proveriti da li su neke **IP adrese privilegovane** u odnosu na druge). Sa glediÅ¡ta napadaÄa, ako korisnici treba da pristupaju sa odreÄ‘ene IP adrese ili regiona, proverite da li se ova funkcija koristi na odgovarajuÄ‡i naÄin.

### Integracije ureÄ‘aja

* **Upravljanje krajnjim taÄkama**: Upravljanje krajnjim taÄkama je uslov koji se moÅ¾e primeniti u autentikacionoj politici kako bi se osiguralo da upravljani ureÄ‘aji imaju pristup aplikaciji.
* JoÅ¡ uvek nisam video da je ovo koriÅ¡Ä‡eno. TODO
* **ObaveÅ¡tenja o uslugama**: JoÅ¡ uvek nisam video da je ovo koriÅ¡Ä‡eno. TODO

### API

MoÅ¾ete kreirati Okta API token-e na ovoj stranici i videti one koji su **kreirani**, njihove **privilegije**, **vreme isteka** i **URL-ove porekla**. Imajte na umu da su API tokeni generisani sa dozvolama korisnika koji je kreirao token i vaÅ¾e samo ako je **korisnik** koji ih je kreirao **aktivan**.

**Pouzdani izvori** omoguÄ‡avaju pristup veb lokacijama koje kontroliÅ¡ete i kojima verujete da pristupaju vaÅ¡em Okta okruÅ¾enju putem Okta API-ja.

Ne bi trebalo da bude puno API tokena, jer ako ih ima previÅ¡e, napadaÄ bi mogao pokuÅ¡ati da im pristupi i koristi ih.

## Radni tok

### Automatizacija

Automatizacija vam omoguÄ‡ava da kreirate automatizovane akcije koje se pokreÄ‡u na osnovu skupa uslova okidaÄa koji se deÅ¡avaju tokom Å¾ivotnog ciklusa krajnjih korisnika.

Na primer, uslov moÅ¾e biti "Neaktivnost korisnika u Okta" ili "Isticanje lozinke korisnika u Okta", a akcija moÅ¾e biti "Slanje e-poÅ¡te korisniku" ili "Promena stanja Å¾ivotnog ciklusa korisnika u Okta".

## IzveÅ¡taji

### IzveÅ¡taji

Preuzmite logove. Oni se **Å¡alju** na **e-adresu** trenutnog naloga.

### Sistemski log

Ovde moÅ¾ete pronaÄ‡i **logove akcija koje su izvrÅ¡ili korisnici** sa mnogo detalja poput prijave u Okta ili u aplikacije putem Okta.

### PraÄ‡enje uvoza

Ovo moÅ¾e **uvoziti logove sa drugih platformi** pristupljenih putem Okta.

### OgraniÄenja brzine

Proverite ograniÄenja brzine API-ja dostignuta.

## Postavke

### Nalog

Ovde moÅ¾ete pronaÄ‡i **opÅ¡te informacije** o Okta okruÅ¾enju, kao Å¡to su naziv kompanije, adresa, **e-adresa za fakturisanje**, **tehniÄka kontakt e-adresa** i takoÄ‘e ko bi trebalo da prima aÅ¾uriranja Okta i kakva vrsta aÅ¾uriranja Okta.

### Preuzimanja

Ovde moÅ¾ete preuzeti Okta agente za sinhronizaciju Okta sa drugim tehnologijama.
