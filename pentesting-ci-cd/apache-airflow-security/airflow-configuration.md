# Airflow é…ç½®

<details>

<summary><strong>ä»é›¶åˆ°è‹±é›„å­¦ä¹  AWS é»‘å®¢æŠ€æœ¯</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS çº¢é˜Ÿä¸“å®¶)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨ **HackTricks** ä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½ HackTricks çš„ PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å– [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* å‘ç° [**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„ [**NFTs é›†åˆ**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## é…ç½®æ–‡ä»¶

**Apache Airflow** åœ¨æ‰€æœ‰ airflow æœºå™¨ä¸Šç”Ÿæˆä¸€ä¸ªåä¸º **`airflow.cfg`** çš„**é…ç½®æ–‡ä»¶**ï¼Œä½äº airflow ç”¨æˆ·çš„ä¸»ç›®å½•ä¸­ã€‚æ­¤é…ç½®æ–‡ä»¶åŒ…å«é…ç½®ä¿¡æ¯ï¼Œ**å¯èƒ½åŒ…å«æœ‰è¶£å’Œæ•æ„Ÿçš„ä¿¡æ¯ã€‚**

**è®¿é—®æ­¤æ–‡ä»¶æœ‰ä¸¤ç§æ–¹å¼ï¼šé€šè¿‡æ”»ç ´æŸäº› airflow æœºå™¨ï¼Œæˆ–è®¿é—® web æ§åˆ¶å°ã€‚**

è¯·æ³¨æ„ï¼Œ**é…ç½®æ–‡ä»¶ä¸­çš„å€¼** **å¯èƒ½ä¸æ˜¯æ­£åœ¨ä½¿ç”¨çš„å€¼**ï¼Œå› ä¸ºæ‚¨å¯ä»¥é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆå¦‚ `AIRFLOW__WEBSERVER__EXPOSE_CONFIG: 'true'`ï¼‰æ¥è¦†ç›–å®ƒä»¬ã€‚

å¦‚æœæ‚¨å¯ä»¥è®¿é—® **web æœåŠ¡å™¨ä¸­çš„é…ç½®æ–‡ä»¶**ï¼Œæ‚¨å¯ä»¥åœ¨æ˜¾ç¤ºé…ç½®çš„åŒä¸€é¡µé¢æ£€æŸ¥**å®é™…è¿è¡Œé…ç½®**ã€‚\
å¦‚æœæ‚¨**å¯ä»¥è®¿é—® airflow ç¯å¢ƒä¸­çš„æŸå°æœºå™¨**ï¼Œè¯·æ£€æŸ¥**ç¯å¢ƒ**ã€‚

é˜…è¯»é…ç½®æ–‡ä»¶æ—¶è¦æ£€æŸ¥çš„ä¸€äº›æœ‰è¶£çš„å€¼ï¼š

### \[api]

* **`access_control_allow_headers`**: æŒ‡ç¤º **CORS** çš„**å…è®¸** **å¤´éƒ¨**
* **`access_control_allow_methods`**: æŒ‡ç¤º **CORS** çš„**å…è®¸æ–¹æ³•**
* **`access_control_allow_origins`**: æŒ‡ç¤º **CORS** çš„**å…è®¸æ¥æº**
* **`auth_backend`**: [**æ ¹æ®æ–‡æ¡£**](https://airflow.apache.org/docs/apache-airflow/stable/security/api.html) å¯ä»¥é…ç½®å‡ ä¸ªé€‰é¡¹æ¥é…ç½®è°å¯ä»¥è®¿é—® APIï¼š
* `airflow.api.auth.backend.deny_all`: **é»˜è®¤æƒ…å†µä¸‹æ²¡æœ‰äºº**å¯ä»¥è®¿é—® API
* `airflow.api.auth.backend.default`: **æ¯ä¸ªäººéƒ½å¯ä»¥**åœ¨æ²¡æœ‰è®¤è¯çš„æƒ…å†µä¸‹è®¿é—®å®ƒ
* `airflow.api.auth.backend.kerberos_auth`: é…ç½® **kerberos è®¤è¯**
* `airflow.api.auth.backend.basic_auth`: ç”¨äº**åŸºæœ¬è®¤è¯**
* `airflow.composer.api.backend.composer_auth`: ä½¿ç”¨ composer è®¤è¯ (GCP)ï¼ˆæ¥è‡ª[**è¿™é‡Œ**](https://cloud.google.com/composer/docs/access-airflow-api)ï¼‰ã€‚
* `composer_auth_user_registration_role`: æŒ‡ç¤º **composer ç”¨æˆ·**åœ¨ **airflow** ä¸­å°†è·å¾—çš„**è§’è‰²**ï¼ˆé»˜è®¤ä¸º **Op**ï¼‰ã€‚
* æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ python **åˆ›å»ºæ‚¨è‡ªå·±çš„è®¤è¯**æ–¹æ³•ã€‚
* **`google_key_path`:** GCP æœåŠ¡è´¦æˆ·å¯†é’¥çš„**è·¯å¾„**

### **\[atlas]**

* **`password`**: Atlas å¯†ç 
* **`username`**: Atlas ç”¨æˆ·å

### \[celery]

* **`flower_basic_auth`** : å‡­æ® (_user1:password1,user2:password2_)
* **`result_backend`**: å¯èƒ½åŒ…å«**å‡­æ®**çš„ Postgres urlã€‚
* **`ssl_cacert`**: cacert çš„è·¯å¾„
* **`ssl_cert`**: è¯ä¹¦çš„è·¯å¾„
* **`ssl_key`**: å¯†é’¥çš„è·¯å¾„

### \[core]

* **`dag_discovery_safe_mode`**: é»˜è®¤å¯ç”¨ã€‚åœ¨å‘ç° DAG æ—¶ï¼Œå¿½ç•¥ä»»ä½•ä¸åŒ…å«å­—ç¬¦ä¸² `DAG` å’Œ `airflow` çš„æ–‡ä»¶ã€‚
* **`fernet_key`**: å­˜å‚¨åŠ å¯†å˜é‡çš„å¯†é’¥ï¼ˆå¯¹ç§°ï¼‰
* **`hide_sensitive_var_conn_fields`**: é»˜è®¤å¯ç”¨ï¼Œéšè—è¿æ¥çš„æ•æ„Ÿä¿¡æ¯ã€‚
* **`security`**: ä½¿ç”¨å“ªä¸ªå®‰å…¨æ¨¡å—ï¼ˆä¾‹å¦‚ kerberosï¼‰

### \[dask]

* **`tls_ca`**: ca çš„è·¯å¾„
* **`tls_cert`**: è¯ä¹¦çš„è·¯å¾„
* **`tls_key`**: tls å¯†é’¥çš„è·¯å¾„

### \[kerberos]

* **`ccache`**: ccache æ–‡ä»¶çš„è·¯å¾„
* **`forwardable`**: é»˜è®¤å¯ç”¨

### \[logging]

* **`google_key_path`**: GCP JSON å‡­æ®çš„è·¯å¾„ã€‚

### \[secrets]

* **`backend`**: å¯ç”¨çš„ç§˜å¯†åç«¯çš„å®Œæ•´ç±»å
* **`backend_kwargs`**: backend_kwargs å‚æ•°è¢«åŠ è½½åˆ°å­—å…¸ä¸­å¹¶ä¼ é€’ç»™ç§˜å¯†åç«¯ç±»çš„ **init**ã€‚

### \[smtp]

* **`smtp_password`**: SMTP å¯†ç 
* **`smtp_user`**: SMTP ç”¨æˆ·

### \[webserver]

* **`cookie_samesite`**: é»˜è®¤æ˜¯ **Lax**ï¼Œæ‰€ä»¥å®ƒå·²ç»æ˜¯å¯èƒ½çš„æœ€å¼±å€¼
* **`cookie_secure`**: åœ¨ä¼šè¯ cookie ä¸Šè®¾ç½®**å®‰å…¨æ ‡å¿—**
* **`expose_config`**: é»˜è®¤ä¸º Falseï¼Œå¦‚æœä¸º trueï¼Œå¯ä»¥ä» web **æ§åˆ¶å°**ä¸­**è¯»å–** **é…ç½®**
* **`expose_stacktrace`**: é»˜è®¤ä¸º Trueï¼Œå®ƒå°†æ˜¾ç¤º **python å›æº¯**ï¼ˆå¯¹æ”»å‡»è€…å¯èƒ½æœ‰ç”¨ï¼‰
* **`secret_key`**: è¿™æ˜¯ **flask ç”¨æ¥ç­¾ç½² cookie çš„å¯†é’¥**ï¼ˆå¦‚æœæ‚¨æœ‰è¿™ä¸ªï¼Œæ‚¨å¯ä»¥**å†’å…… Airflow ä¸­çš„ä»»ä½•ç”¨æˆ·**ï¼‰
* **`web_server_ssl_cert`**: **SSL** **è¯ä¹¦**çš„**è·¯å¾„**
* **`web_server_ssl_key`**: **SSL** **å¯†é’¥**çš„**è·¯å¾„**
* **`x_frame_enabled`**: é»˜è®¤ä¸º **True**ï¼Œæ‰€ä»¥é»˜è®¤æƒ…å†µä¸‹ä¸å¯èƒ½è¿›è¡Œç‚¹å‡»åŠ«æŒ

### Web è®¤è¯

é»˜è®¤æƒ…å†µä¸‹ï¼Œ**web è®¤è¯**åœ¨æ–‡ä»¶ **`webserver_config.py`** ä¸­æŒ‡å®šï¼Œå¹¶é…ç½®ä¸º
```bash
AUTH_TYPE = AUTH_DB
```
è¿™æ„å‘³ç€**èº«ä»½éªŒè¯æ˜¯é’ˆå¯¹æ•°æ®åº“è¿›è¡Œæ£€æŸ¥çš„**ã€‚ç„¶è€Œï¼Œè¿˜æœ‰å…¶ä»–å¯èƒ½çš„é…ç½®ï¼Œä¾‹å¦‚
```bash
AUTH_TYPE = AUTH_OAUTH
```
ä¿ç•™**ç¬¬ä¸‰æ–¹æœåŠ¡è®¤è¯**ã€‚

ä½†æ˜¯ï¼Œä¹Ÿæœ‰ä¸€ä¸ªé€‰é¡¹å¯ä»¥**å…è®¸åŒ¿åç”¨æˆ·è®¿é—®**ï¼Œå°†ä»¥ä¸‹å‚æ•°è®¾ç½®ä¸º**æ‰€éœ€è§’è‰²**ï¼š
```bash
AUTH_ROLE_PUBLIC = 'Admin'
```
<details>

<summary><strong>ä»é›¶åˆ°è‹±é›„å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œé€šè¿‡</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨**HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDFç‰ˆæœ¬**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**telegramç¾¤ç»„**](https://t.me/peass)æˆ–åœ¨**Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
