# Konfiguracija Airflow-a

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** me na **Twitter-u** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Konfiguracioni fajl

**Apache Airflow** generiÅ¡e **konfiguracioni fajl** na svim airflow maÅ¡inama koji se naziva **`airflow.cfg`** u home direktorijumu korisnika airflow-a. Ovaj konfiguracioni fajl sadrÅ¾i informacije o konfiguraciji i **moÅ¾e sadrÅ¾ati zanimljive i osetljive informacije**.

**Postoje dva naÄina pristupa ovom fajlu: kompromitovanjem neke airflow maÅ¡ine ili pristupom web konzoli.**

Imajte na umu da **vrednosti unutar konfiguracionog fajla** **moÅ¾da nisu one koje se koriste**, jer ih moÅ¾ete prebrisati postavljanjem env promenljivih kao Å¡to je `AIRFLOW__WEBSERVER__EXPOSE_CONFIG: 'true'`.

Ako imate pristup **konfiguracionom fajlu na web serveru**, moÅ¾ete proveriti **stvarnu konfiguraciju koja se izvrÅ¡ava** na istoj stranici na kojoj se prikazuje konfiguracija.\
Ako imate **pristup nekoj maÅ¡ini unutar airflow okruÅ¾enja**, proverite **okruÅ¾enje**.

Neke zanimljive vrednosti za proveru prilikom Äitanja konfiguracionog fajla:

### \[api]

* **`access_control_allow_headers`**: Ovo oznaÄava **dozvoljene zaglavlja** za **CORS**
* **`access_control_allow_methods`**: Ovo oznaÄava **dozvoljene metode** za **CORS**
* **`access_control_allow_origins`**: Ovo oznaÄava **dozvoljene origin-e** za **CORS**
* **`auth_backend`**: [**Prema dokumentaciji**](https://airflow.apache.org/docs/apache-airflow/stable/security/api.html) nekoliko opcija moÅ¾e biti postavljeno da konfiguriÅ¡e ko moÅ¾e pristupiti API-ju:
* `airflow.api.auth.backend.deny_all`: **Podrazumevano niko** ne moÅ¾e pristupiti API-ju
* `airflow.api.auth.backend.default`: **Svi mogu** pristupiti bez autentifikacije
* `airflow.api.auth.backend.kerberos_auth`: Za konfigurisanje **kerberos autentifikacije**
* `airflow.api.auth.backend.basic_auth`: Za **osnovnu autentifikaciju**
* `airflow.composer.api.backend.composer_auth`: Koristi autentifikaciju kompozitora (GCP) (od [**ovde**](https://cloud.google.com/composer/docs/access-airflow-api)).
* `composer_auth_user_registration_role`: Ovo oznaÄava **ulogu** koju Ä‡e **korisnik kompozitora** dobiti unutar **airflow-a** (**Op** podrazumevano).
* TakoÄ‘e moÅ¾ete **kreirati sopstveni autentifikacioni** metod sa python-om.
* **`google_key_path`:** Putanja do **GCP servisnog naloga kljuÄa**

### **\[atlas]**

* **`password`**: Atlas lozinka
* **`username`**: Atlas korisniÄko ime

### \[celery]

* **`flower_basic_auth`** : Kredencijali (_user1:password1,user2:password2_)
* **`result_backend`**: Postgres url koji moÅ¾e sadrÅ¾ati **kredencijale**.
* **`ssl_cacert`**: Putanja do cacert-a
* **`ssl_cert`**: Putanja do cert-a
* **`ssl_key`**: Putanja do kljuÄa

### \[core]

* **`dag_discovery_safe_mode`**: Podrazumevano je omoguÄ‡eno. Pri otkrivanju DAG-ova, ignorisati sve fajlove koji ne sadrÅ¾e stringove `DAG` i `airflow`.
* **`fernet_key`**: KljuÄ za Äuvanje enkriptovanih promenljivih (simetriÄno)
* **`hide_sensitive_var_conn_fields`**: Podrazumevano je omoguÄ‡eno, sakriva osetljive informacije o konekcijama.
* **`security`**: Koju sigurnosnu modul koristiti (na primer kerberos)

### \[dask]

* **`tls_ca`**: Putanja do ca
* **`tls_cert`**: Deo do cert-a
* **`tls_key`**: Deo do tls kljuÄa

### \[kerberos]

* **`ccache`**: Putanja do ccache fajla
* **`forwardable`**: Podrazumevano je omoguÄ‡eno

### \[logging]

* **`google_key_path`**: Putanja do GCP JSON kredencijala.

### \[secrets]

* **`backend`**: Puno ime klase tajnih backend-a za omoguÄ‡avanje
* **`backend_kwargs`**: Parametar backend\_kwargs se uÄitava u reÄnik i prosleÄ‘uje **init** metodi klase tajnih backend-a.

### \[smtp]

* **`smtp_password`**: SMTP lozinka
* **`smtp_user`**: SMTP korisnik

### \[webserver]

* **`cookie_samesite`**: Podrazumevano je **Lax**, tako da je veÄ‡ najslabija moguÄ‡a vrednost
* **`cookie_secure`**: Postavi **secure flag** na sesijski kolaÄiÄ‡
* **`expose_config`**: Podrazumevano je False, ako je true, **konfiguracija** moÅ¾e biti **proÄitana** sa web **konzole**
* **`expose_stacktrace`**: Podrazumevano je True, prikazaÄ‡e **python tracebacks** (potencijalno korisno za napadaÄa)
* **`secret_key`**: Ovo je **kljuÄ koji flask koristi za potpisivanje kolaÄiÄ‡a** (ako ga imate, moÅ¾ete **preuzeti identitet bilo kog korisnika u Airflow-u**)
* **`web_server_ssl_cert`**: **Putanja** do **SSL** **cert-a**
* **`web_server_ssl_key`**: **Putanja** do **SSL** **kljuÄa**
* **`x_frame_enabled`**: Podrazumevano je **True**, tako da podrazumevano nije moguÄ‡e clickjacking

### Web autentifikacija

Podrazumevano je da je **web autentifikacija** navedena u fajlu **`webserver_config.py`** i konfigurisana je kao
```bash
AUTH_TYPE = AUTH_DB
```
Å to znaÄi da se **autentifikacija proverava protiv baze podataka**. MeÄ‘utim, moguÄ‡e su i druge konfiguracije kao Å¡to su
```bash
AUTH_TYPE = AUTH_OAUTH
```
Da biste **autentifikaciju prepustili uslugama treÄ‡ih strana**.

MeÄ‘utim, takoÄ‘e postoji opcija da **omoguÄ‡ite pristup anonimnim korisnicima**, postavljajuÄ‡i sledeÄ‡i parametar na **Å¾eljenu ulogu**:
```bash
AUTH_ROLE_PUBLIC = 'Admin'
```
<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** me na **Twitter-u** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
