# Airflow YapÄ±landÄ±rmasÄ±

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman olmak iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile Ã¶ÄŸrenin!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklam vermek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family)
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)'Ä± **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

## YapÄ±landÄ±rma DosyasÄ±

**Apache Airflow**, airflow makinelerinin ev dizininde **`airflow.cfg`** adÄ±nda bir **yapÄ±landÄ±rma dosyasÄ±** oluÅŸturur. Bu yapÄ±landÄ±rma dosyasÄ±, yapÄ±landÄ±rma bilgilerini iÃ§erir ve **ilginÃ§ ve hassas bilgiler iÃ§erebilir**.

Bu dosyaya **eriÅŸmenin iki yolu vardÄ±r: Bir airflow makinesini ele geÃ§irerek veya web konsoluna eriÅŸerek**.

Dikkat edin ki **yapÄ±landÄ±rma dosyasÄ±ndaki deÄŸerler**, `AIRFLOW__WEBSERVER__EXPOSE_CONFIG: 'true'` gibi ortam deÄŸiÅŸkenlerini ayarlayarak Ã¼zerine yazabileceÄŸiniz deÄŸerler olmayabilir.

EÄŸer **web sunucusundaki yapÄ±landÄ±rma dosyasÄ±na eriÅŸiminiz varsa**, yapÄ±landÄ±rmanÄ±n gÃ¶rÃ¼ntÃ¼lendiÄŸi aynÄ± sayfada **gerÃ§ek Ã§alÄ±ÅŸan yapÄ±landÄ±rmayÄ±** kontrol edebilirsiniz.\
EÄŸer **airflow ortamÄ±ndaki bazÄ± makinelerde eriÅŸiminiz varsa**, **ortamÄ±** kontrol edin.

YapÄ±landÄ±rma dosyasÄ±nÄ± okurken kontrol etmek iÃ§in bazÄ± ilginÃ§ deÄŸerler:

### \[api]

* **`access_control_allow_headers`**: Bu, **CORS** iÃ§in **izin verilen baÅŸlÄ±klarÄ±** gÃ¶sterir.
* **`access_control_allow_methods`**: Bu, **CORS** iÃ§in **izin verilen yÃ¶ntemleri** gÃ¶sterir.
* **`access_control_allow_origins`**: Bu, **CORS** iÃ§in **izin verilen kaynaklarÄ±** gÃ¶sterir.
* **`auth_backend`**: [**Belgelere gÃ¶re**](https://airflow.apache.org/docs/apache-airflow/stable/security/api.html), API'ye kimin eriÅŸebileceÄŸini yapÄ±landÄ±rmak iÃ§in birkaÃ§ seÃ§enek mevcuttur:
* `airflow.api.auth.backend.deny_all`: **VarsayÄ±lan olarak kimse** API'ye eriÅŸemez
* `airflow.api.auth.backend.default`: Kimse kimlik doÄŸrulamasÄ± olmadan eriÅŸebilir
* `airflow.api.auth.backend.kerberos_auth`: **Kerberos kimlik doÄŸrulamasÄ±nÄ±** yapÄ±landÄ±rmak iÃ§in
* `airflow.api.auth.backend.basic_auth`: **Temel kimlik doÄŸrulamasÄ±** iÃ§in
* `airflow.composer.api.backend.composer_auth`: Bestecinin kimlik doÄŸrulamasÄ±nÄ± kullanÄ±r (GCP) (buradan [**buradan**](https://cloud.google.com/composer/docs/access-airflow-api)).
* `composer_auth_user_registration_role`: Bu, **besteci kullanÄ±cÄ±sÄ±nÄ±n airflow iÃ§indeki rolÃ¼nÃ¼** belirtir (**Op** varsayÄ±lan olarak).
* Kendi kimlik doÄŸrulama yÃ¶nteminizi python ile oluÅŸturabilirsiniz.
* **`google_key_path`:** GCP hizmet hesabÄ± anahtarÄ±nÄ±n yolu

### **\[atlas]**

* **`password`**: Atlas ÅŸifresi
* **`username`**: Atlas kullanÄ±cÄ± adÄ±

### \[celery]

* **`flower_basic_auth`** : Kimlik bilgileri (_user1:password1,user2:password2_)
* **`result_backend`**: Kimlik bilgilerini iÃ§erebilecek Postgres url'i.
* **`ssl_cacert`**: cacert'in yolu
* **`ssl_cert`**: sertifikanÄ±n yolu
* **`ssl_key`**: anahtarÄ±n yolu

### \[core]

* **`dag_discovery_safe_mode`**: VarsayÄ±lan olarak etkinleÅŸtirilmiÅŸtir. DAG'larÄ± keÅŸfederken, `DAG` ve `airflow` dizelerini iÃ§ermeyen dosyalarÄ± yok sayar.
* **`fernet_key`**: Åifreli deÄŸiÅŸkenleri depolamak iÃ§in anahtar (simetrik)
* **`hide_sensitive_var_conn_fields`**: VarsayÄ±lan olarak etkinleÅŸtirilmiÅŸtir, baÄŸlantÄ±larÄ±n hassas bilgilerini gizler.
* **`security`**: Hangi gÃ¼venlik modÃ¼lÃ¼nÃ¼n kullanÄ±lacaÄŸÄ± (Ã¶rneÄŸin kerberos)

### \[dask]

* **`tls_ca`**: ca'nÄ±n yolu
* **`tls_cert`**: sertifikanÄ±n yolu
* **`tls_key`**: tls anahtarÄ±nÄ±n yolu

### \[kerberos]

* **`ccache`**: ccache dosyasÄ±nÄ±n yolu
* **`forwardable`**: VarsayÄ±lan olarak etkinleÅŸtirilmiÅŸtir

### \[logging]

* **`google_key_path`**: GCP JSON kimlik bilgilerinin yolu

### \[secrets]

* **`backend`**: EtkinleÅŸtirilecek gizli backend'in tam sÄ±nÄ±f adÄ±
* **`backend_kwargs`**: backend_kwargs parametresi bir sÃ¶zlÃ¼ÄŸe yÃ¼klenir ve gizli backend sÄ±nÄ±fÄ±nÄ±n **init**'ine iletilir.

### \[smtp]

* **`smtp_password`**: SMTP ÅŸifresi
* **`smtp_user`**: SMTP kullanÄ±cÄ±sÄ±

### \[webserver]

* **`cookie_samesite`**: VarsayÄ±lan olarak **Lax** olduÄŸundan, zaten en zayÄ±f deÄŸerdir
* **`cookie_secure`**: Oturum Ã§erezi Ã¼zerinde **gÃ¼venli bayrak** ayarla
* **`expose_config`**: VarsayÄ±lan olarak False'dur, true ise **yapÄ±landÄ±rma** web **konsolundan okunabilir**
* **`expose_stacktrace`**: VarsayÄ±lan olarak True'dur, **python iz sÃ¼rÃ¼mlerini** gÃ¶sterir (saldÄ±rgan iÃ§in potansiyel olarak faydalÄ± olabilir)
* **`secret_key`**: Bu, Ã§erezleri imzalamak iÃ§in flask tarafÄ±ndan kullanÄ±lan **anahtar**tÄ±r (bunu elde ederseniz Airflow'da herhangi bir kullanÄ±cÄ±yÄ± taklit edebilirsiniz)
* **`web_server_ssl_cert`**: **SSL** **sertifikasÄ±nÄ±n** **yolu**
* **`web_server_ssl_key`**: **SSL** **AnahtarÄ±nÄ±n** **yolu**
* **`x_frame_enabled`**: VarsayÄ±lan olarak **True** olduÄŸundan, varsayÄ±lan olarak clickjacking mÃ¼mkÃ¼n deÄŸildir

### Web Kimlik DoÄŸrulama

VarsayÄ±lan olarak **web kimlik doÄŸrulamasÄ±**, **`webserver_config.py`** dosyasÄ±nda belirtilir ve yapÄ±landÄ±rÄ±lÄ±r.
```bash
AUTH_TYPE = AUTH_DB
```
Bu, **kimlik doÄŸrulamanÄ±n veritabanÄ±na karÅŸÄ± kontrol edildiÄŸi** anlamÄ±na gelir. Bununla birlikte, baÅŸka yapÄ±landÄ±rmalar da mÃ¼mkÃ¼ndÃ¼r, Ã¶rneÄŸin
```bash
AUTH_TYPE = AUTH_OAUTH
```
**ÃœÃ§Ã¼ncÃ¼ taraf hizmetlerine kimlik doÄŸrulamayÄ± bÄ±rakmak** iÃ§in.

Ancak, **anonim kullanÄ±cÄ±lara eriÅŸim izni** vermek iÃ§in aÅŸaÄŸÄ±daki parametreyi **istenen role** ayarlamak da mÃ¼mkÃ¼ndÃ¼r:
```bash
AUTH_ROLE_PUBLIC = 'Admin'
```
<details>

<summary><strong>AWS hackleme becerilerini sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenmek iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARINA**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)'Ä± **takip edin**.
* **Hacking hilelerinizi paylaÅŸarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>
