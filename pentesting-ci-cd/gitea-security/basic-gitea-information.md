# Informaci贸n B谩sica de Gitea

<details>

<summary><strong>Aprende hacking en AWS de cero a h茅roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** revisa los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Estructura B谩sica

La estructura b谩sica del entorno de Gitea es agrupar repositorios por **organizaci贸n(es),** cada una de ellas puede contener **varios repositorios** y **varios equipos.** Sin embargo, ten en cuenta que, al igual que en github, los usuarios pueden tener repositorios fuera de la organizaci贸n.

Adem谩s, un **usuario** puede ser **miembro** de **diferentes organizaciones**. Dentro de la organizaci贸n, el usuario puede tener **diferentes permisos sobre cada repositorio**.

Un usuario tambi茅n puede ser **parte de diferentes equipos** con diferentes permisos sobre diferentes repositorios.

Y finalmente, **los repositorios pueden tener mecanismos de protecci贸n especiales**.

## Permisos

### Organizaciones

Cuando se **crea una organizaci贸n** se **crea** un equipo llamado **Owners** y el usuario se coloca dentro de 茅l. Este equipo otorgar谩 **acceso de administrador** sobre la **organizaci贸n**, esos **permisos** y el **nombre** del equipo **no se pueden modificar**.

Los **administradores de la organizaci贸n** (propietarios) pueden seleccionar la **visibilidad** de la organizaci贸n:

* P煤blica
* Limitada (solo usuarios registrados)
* Privada (solo miembros)

Los **administradores de la organizaci贸n** tambi茅n pueden indicar si los **administradores del repositorio** pueden **agregar y/o eliminar acceso** para los equipos. Tambi茅n pueden indicar el n煤mero m谩ximo de repositorios.

Al crear un nuevo equipo, se seleccionan varios ajustes importantes:

* Se indica los **repositorios de la org a los que los miembros del equipo podr谩n acceder**: repositorios espec铆ficos (repositorios donde se a帽ade el equipo) o todos.
* Tambi茅n se indica **si los miembros pueden crear nuevos repositorios** (el creador obtendr谩 acceso de administrador a 茅l)
* Los **permisos** que los **miembros** del repositorio **tendr谩n**:
* Acceso de **Administrador**
* Acceso **Espec铆fico**:

![](<../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1).png>)

### Equipos y Usuarios

En un repositorio, el **administrador de la org** y los **administradores del repositorio** (si la org lo permite) pueden **gestionar los roles** otorgados a colaboradores (otros usuarios) y equipos. Hay **3** posibles **roles**:

* Administrador
* Escritura
* Lectura

## Autenticaci贸n en Gitea

### Acceso Web

Usando **nombre de usuario + contrase帽a** y potencialmente (y recomendado) un 2FA.

### **Claves SSH**

Puedes configurar tu cuenta con una o varias claves p煤blicas permitiendo que la **clave privada relacionada realice acciones en tu nombre.** [http://localhost:3000/user/settings/keys](http://localhost:3000/user/settings/keys)

#### **Claves GPG**

**No puedes suplantar al usuario con estas claves** pero si no las usas podr铆a ser posible que te **descubran por enviar commits sin una firma**.

### **Tokens de Acceso Personal**

Puedes generar un token de acceso personal para **dar acceso a una aplicaci贸n a tu cuenta**. Un token de acceso personal otorga acceso completo sobre tu cuenta: [http://localhost:3000/user/settings/applications](http://localhost:3000/user/settings/applications)

### Aplicaciones Oauth

Al igual que los tokens de acceso personal, las **aplicaciones Oauth** tendr谩n **acceso completo** sobre tu cuenta y los lugares a los que tu cuenta tiene acceso porque, como se indica en la [documentaci贸n](https://docs.gitea.io/en-us/oauth2-provider/#scopes), los 谩mbitos a煤n no son compatibles:

![](<../../.gitbook/assets/image (60).png>)

### Claves de Despliegue

Las claves de despliegue pueden tener acceso de solo lectura o escritura al repositorio, por lo que podr铆an ser interesantes para comprometer repositorios espec铆ficos.

## Protecciones de Ramas

Las protecciones de ramas est谩n dise帽adas para **no dar control completo de un repositorio** a los usuarios. El objetivo es **poner varios m茅todos de protecci贸n antes de poder escribir c贸digo dentro de alguna rama**.

Las **protecciones de ramas de un repositorio** se pueden encontrar en _https://localhost:3000/\<orgname>/\<reponame>/settings/branches_

{% hint style="info" %}
**No es posible establecer una protecci贸n de rama a nivel de organizaci贸n**. Por lo tanto, todas deben ser declaradas en cada repositorio.
{% endhint %}

Se pueden aplicar diferentes protecciones a una rama (como a master):

* **Desactivar Push**: Nadie puede hacer push a esta rama
* **Activar Push**: Cualquiera con acceso puede hacer push, pero no forzar push.
* **Lista Blanca de Push Restringido**: Solo usuarios/equipos seleccionados pueden hacer push a esta rama (pero no forzar push)
* **Activar Lista Blanca de Merge**: Solo usuarios/equipos en la lista blanca pueden fusionar PRs.
* **Activar Verificaciones de Estado**: Requerir que las verificaciones de estado pasen antes de fusionar.
* **Requerir aprobaciones**: Indicar el n煤mero de aprobaciones requeridas antes de que un PR pueda ser fusionado.
* **Restringir aprobaciones a lista blanca**: Indicar usuarios/equipos que pueden aprobar PRs.
* **Bloquear fusi贸n en revisiones rechazadas**: Si se solicitan cambios, no se puede fusionar (incluso si las otras verificaciones pasan)
* **Bloquear fusi贸n en solicitudes de revisi贸n oficiales**: Si hay solicitudes de revisi贸n oficiales no se puede fusionar
* **Descartar aprobaciones obsoletas**: Cuando hay nuevos commits, las aprobaciones antiguas ser谩n descartadas.
* **Requerir Commits Firmados**: Los commits deben estar firmados.
* **Bloquear fusi贸n si la solicitud de extracci贸n est谩 desactualizada**
* **Patrones de Archivos Protegidos/Desprotegidos**: Indicar patrones de archivos para proteger/desproteger contra cambios

{% hint style="info" %}
Como puedes ver, incluso si lograste obtener algunas credenciales de un usuario, **los repositorios pueden estar protegidos evitando que puedas hacer push de c贸digo a master** por ejemplo para comprometer la pipeline de CI/CD.
{% endhint %}

<details>

<summary><strong>Aprende hacking en AWS de cero a h茅roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** revisa los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
