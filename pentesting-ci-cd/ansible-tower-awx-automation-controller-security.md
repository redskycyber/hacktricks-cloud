# Bezbednost Ansible Tower / AWX / Automation kontrolera

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** me na **Twitter-u** 游냕 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Osnovne informacije

**Ansible Tower** ili njegova open source verzija [**AWX**](https://github.com/ansible/awx) je tako캠e poznata kao **Ansible-ov korisni캜ki interfejs, kontrolna tabla i REST API**. Sa **kontrolom pristupa zasnovanom na ulogama**, planiranjem poslova i grafi캜kim upravljanjem inventarom, mo쬰te upravljati svojom Ansible infrastrukturom putem modernog korisni캜kog interfejsa. REST API i komandna linija Tower-a omogu캖avaju jednostavnu integraciju u postoje캖e alate i radne tokove.

**Automation Controller je novija** verzija Ansible Tower-a sa vi코e mogu캖nosti.

### Razlike

Prema [**ovome**](https://blog.devops.dev/ansible-tower-vs-awx-under-the-hood-65cfec78db00), glavne razlike izme캠u Ansible Tower-a i AWS-a su podr코ka koju dobijaju i Ansible Tower ima dodatne funkcionalnosti kao 코to su kontrola pristupa zasnovana na ulogama, podr코ka za prilago캠ene API-je i korisni캜ki definisani radni tokovi.

### Tehni캜ki skup

* **Veb interfejs**: Ovo je grafi캜ki interfejs gde korisnici mogu upravljati inventarima, akreditivima, 코ablonima i poslovima. Dizajniran je da bude intuitivan i pru쬬 vizualizacije koje poma쬿 u razumevanju stanja i rezultata va코ih automatizovanih poslova.
* **REST API**: Sve 코to mo쬰te uraditi u veb interfejsu, mo쬰te uraditi i putem REST API-ja. To zna캜i da mo쬰te integrisati AWX/Tower sa drugim sistemima ili skriptovati akcije koje obi캜no izvr코avate u interfejsu.
* **Baza podataka**: AWX/Tower koristi bazu podataka (obi캜no PostgreSQL) za skladi코tenje konfiguracije, rezultata poslova i ostalih neophodnih operativnih podataka.
* **RabbitMQ**: Ovo je sistem za razmenu poruka koji koristi AWX/Tower za komunikaciju izme캠u razli캜itih komponenti, posebno izme캠u veb servisa i izvr코ilaca zadataka.
* **Redis**: Redis slu쬴 kao ke코 i pozadina za red zadataka.

### Logi캜ke komponente

* **Inventari**: Inventar je **kolekcija 캜vorova (ili 캜vorova)** protiv kojih se mogu **pokrenuti poslovi** (Ansible playbook-ovi). AWX/Tower vam omogu캖ava da defini코ete i grupi코ete inventare, a tako캠e podr쬬va dinami캜ke inventare koji mogu **dobavljati liste 캜vorova iz drugih sistema** kao 코to su AWS, Azure, itd.
* **Projekti**: Projekat je su코tinski **kolekcija Ansible playbook-ova** izvorno iz **sistema za kontrolu verzija** (kao 코to je Git) kako bi se povukli najnoviji playbook-ovi kada je to potrebno.
* **마bloni**: 마bloni poslova defini코u **kako 캖e se odre캠eni playbook pokrenuti**, navode캖i **inventar**, **akreditive** i druge **parametre** za posao.
* **Akreditivi**: AWX/Tower pru쬬 siguran na캜in za **upravljanje i 캜uvanje tajni, kao 코to su SSH klju캜evi, lozinke i API tokeni**. Ovi akreditivi mogu biti povezani sa 코ablonima poslova kako bi playbook-ovi imali neophodan pristup prilikom izvr코avanja.
* **Task Engine**: Ovde se de코ava magija. Task engine je izgra캠en na Ansible-u i odgovoran je za **pokretanje playbook-ova**. Poslovi se 코alju task engine-u, koji zatim pokre캖e Ansible playbook-ove protiv odre캠enog inventara koriste캖i navedene akreditive.
* **Planeri i povratni pozivi**: Ovo su napredne funkcionalnosti u AWX/Tower-u koje omogu캖avaju **planiranje poslova** za pokretanje u odre캠eno vreme ili pokretanje spolja코njim doga캠ajima.
* **Obave코tenja**: AWX/Tower mo쬰 slati obave코tenja na osnovu uspeha ili neuspeha poslova. Podr쬬va razli캜ite na캜ine obave코tavanja kao 코to su e-po코ta, Slack poruke, webhooks, itd.
* **Ansible playbook-ovi**: Ansible playbook-ovi su alati za konfiguraciju, implementaciju i orkestraciju. Oni opisuju 쬰ljeno stanje sistema na automatizovan, ponovljiv na캜in. Napisani u YAML-u, playbook-ovi koriste Ansible-ov deklarativni jezik automatizacije za opisivanje konfiguracija, zadataka i koraka koji treba da se izvr코e.

### Tok izvr코avanja posla

1. **Interakcija korisnika**: Korisnik mo쬰 da interaguje sa AWX/Tower-om putem **veb interfejsa** ili **REST API-ja**. Oni omogu캖avaju pristup svim funkcionalnostima koje nudi AWX/Tower.
2. **Pokretanje posla**:
* Korisnik, putem veb interfejsa ili API-ja, pokre캖e posao na osnovu **코ablona posla**.
* 마blon posla uklju캜uje reference na **inventar**, **projekat** (koji sadr쬴 playbook) i **akreditive**.
* Prilikom pokretanja posla, zahtev se 코alje AWX/Tower backend-u da bi se posao stavio u red za izvr코avanje.
3. **Stavljanje posla u red**:
* **RabbitMQ** upravlja razmenom poruka izme캠u veb komponente i izvr코ilaca zadataka. Kada se posao pokrene, poruka se 코alje task engine-u koriste캖i RabbitMQ.
* **Redis** slu쬴 kao pozadina za red zadataka, upravljaju캖i poslovima koji 캜ekaju izvr코avanje.
4. **Izvr코avanje posla**:
* **Task Engine** preuzima posao iz reda. On dobavlja neophodne informacije iz **baze podataka** o povezanom playbook-u, inventaru i akreditivima posla.
* Koriste캖i dobijeni Ansible playbook iz povezanog **projekta**, Task Engine pokre캖e playbook protiv odre캠enih 캜vorova **inventara** koriste캖i pru쬰ne **akreditive**.
* Dok playbook radi, njegov izlaz izvr코avanja (logovi, 캜injenice, itd.) se bele쬰 i 캜uvaju u **bazi podataka**.
5. **Rezultati posla**:
* Kada playbook zavr코i sa izvr코avanjem, rezultati (uspeh, neuspeh, logovi) se 캜uvaju u **bazi podataka**.
* Korisnici mogu zatim pregledati rezultate putem veb interfejsa ili ih pretra쬴vati putem REST API-ja.
* Na osnovu rezultata posla, mogu se slati **obave코tenja** koja informi코u kor
```bash
git clone -b x.y.z https://github.com/ansible/awx.git # Get in x.y.z the latest release version

cd awx

# Build
make docker-compose-build

# Run
make docker-compose

# Or to create a more complex env
MAIN_NODE_TYPE=control EXECUTION_NODE_COUNT=2 COMPOSE_TAG=devel make docker-compose

# Clean and build the UI
docker exec tools_awx_1 make clean-ui ui-devel

# Once migrations are completed and the UI is built, you can begin using AWX. The UI can be reached in your browser at https://localhost:8043/#/home, and the API can be found at https://localhost:8043/api/v2.

# Create an admin user
docker exec -ti tools_awx_1 awx-manage createsuperuser

# Load demo data
docker exec tools_awx_1 awx-manage create_preload_data
```
{% endcode %}

## RBAC

### Podr쬬ne uloge

Najprivilegovanija uloga se naziva **Sistemski administrator**. Svi sa ovom ulogom mogu **izmeniti bilo 코ta**.

Iz perspektive **bele kutije bezbednosti**, trebali biste imati ulogu **Sistemskog revizora**, koja omogu캖ava **pregled svih podataka sistema**, ali ne mo쬰 vr코iti nikakve promene. Druga opcija bila bi uloga **Revizora organizacije**, ali bilo bi bolje dobiti prvu.

<details>

<summary>Pro코irite ovo da biste dobili detaljan opis dostupnih uloga</summary>

1. **Sistemski administrator**:
* Ovo je superkorisni캜ka uloga sa dozvolama za pristup i izmenu svih resursa u sistemu.
* Mogu upravljati svim organizacijama, timovima, projektima, inventarima, 코ablonima poslova, itd.
2. **Sistemski revizor**:
* Korisnici sa ovom ulogom mogu pregledati sve podatke sistema, ali ne mogu vr코iti nikakve promene.
* Ova uloga je dizajnirana za uskla캠enost i nadzor.
3. **Uloge organizacije**:
* **Admin**: Potpuna kontrola nad resursima organizacije.
* **Revizor**: Samo pregled pristupa resursima organizacije.
* **캛lan**: Osnovno 캜lanstvo u organizaciji bez posebnih dozvola.
* **Izvr코i**: Mo쬰 pokretati 코ablone poslova unutar organizacije.
* **Pro캜itaj**: Mo쬰 pregledati resurse organizacije.
4. **Uloge projekta**:
* **Admin**: Mo쬰 upravljati i izmeniti projekat.
* **Koristi**: Mo쬰 koristiti projekat u 코ablonu posla.
* **A쬿riraj**: Mo쬰 a쬿rirati projekat koriste캖i SCM (izvor kontrola).
5. **Uloge inventara**:
* **Admin**: Mo쬰 upravljati i izmeniti inventar.
* **Ad Hoc**: Mo쬰 pokretati ad hoc komande na inventaru.
* **A쬿riraj**: Mo쬰 a쬿rirati izvor inventara.
* **Koristi**: Mo쬰 koristiti inventar u 코ablonu posla.
* **Pro캜itaj**: Samo pregled pristupa.
6. **Uloge 코ablona posla**:
* **Admin**: Mo쬰 upravljati i izmeniti 코ablon posla.
* **Izvr코i**: Mo쬰 pokrenuti posao.
* **Pro캜itaj**: Samo pregled pristupa.
7. **Uloge akreditacija**:
* **Admin**: Mo쬰 upravljati i izmeniti akreditacije.
* **Koristi**: Mo쬰 koristiti akreditacije u 코ablonima poslova ili drugim relevantnim resursima.
* **Pro캜itaj**: Samo pregled pristupa.
8. **Uloge tima**:
* **캛lan**: Deo tima, ali bez posebnih dozvola.
* **Admin**: Mo쬰 upravljati 캜lanovima tima i povezanim resursima.
9. **Uloge radnog toka**:
* **Admin**: Mo쬰 upravljati i izmeniti radni tok.
* **Izvr코i**: Mo쬰 pokrenuti radni tok.
* **Pro캜itaj**: Samo pregled pristupa.

</details>

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite videti **ogla코avanje va코e kompanije na HackTricks-u** ili **preuzeti HackTricks u PDF formatu** proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili me **pratite** na **Twitter-u** 游냕 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
