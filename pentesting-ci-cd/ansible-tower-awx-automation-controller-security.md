# Ansible Tower / AWX / Otomasyon Denetleyici GÃ¼venliÄŸi

<details>

<summary><strong>A'dan Z'ye AWS hackleme becerilerini Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)'Ä± **takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶ndererek.

</details>

## Temel Bilgiler

**Ansible Tower** veya aÃ§Ä±k kaynak versiyonu [**AWX**](https://github.com/ansible/awx) aynÄ± zamanda **Ansible'Ä±n kullanÄ±cÄ± arayÃ¼zÃ¼, gÃ¶sterge tablosu ve REST API'si** olarak bilinir. **Rol tabanlÄ± eriÅŸim kontrolÃ¼**, iÅŸ zamanlamasÄ± ve grafiksel envanter yÃ¶netimi ile Ansible altyapÄ±nÄ±zÄ± modern bir kullanÄ±cÄ± arayÃ¼zÃ¼nden yÃ¶netebilirsiniz. Tower'Ä±n REST API'si ve komut satÄ±rÄ± arayÃ¼zÃ¼, mevcut araÃ§lar ve iÅŸ akÄ±ÅŸlarÄ±na entegre etmeyi kolaylaÅŸtÄ±rÄ±r.

**Otomasyon Denetleyicisi**, daha fazla yeteneÄŸe sahip yeni bir Ansible Tower sÃ¼rÃ¼mÃ¼dÃ¼r.

### Farklar

[**Bu**](https://blog.devops.dev/ansible-tower-vs-awx-under-the-hood-65cfec78db00) kaynaÄŸa gÃ¶re, Ansible Tower ve AWX arasÄ±ndaki temel farklar, alÄ±nan destek ve Ansible Tower'Ä±n rol tabanlÄ± eriÅŸim kontrolÃ¼, Ã¶zel API'larÄ± destekleme ve kullanÄ±cÄ± tanÄ±mlÄ± iÅŸ akÄ±ÅŸlarÄ± gibi ek Ã¶zelliklere sahip olmasÄ±dÄ±r.

### Teknoloji YÄ±ÄŸÄ±nÄ±

* **Web ArayÃ¼zÃ¼**: KullanÄ±cÄ±larÄ±n envanterleri, kimlik bilgilerini, ÅŸablonlarÄ± ve iÅŸleri yÃ¶netebileceÄŸi grafik arayÃ¼zÃ¼dÃ¼r. KullanÄ±cÄ±larÄ±n otomasyon iÅŸlerinin durumunu ve sonuÃ§larÄ±nÄ± anlamalarÄ±na yardÄ±mcÄ± olmak iÃ§in gÃ¶rselleÅŸtirmeler sunar.
* **REST API**: Web arayÃ¼zÃ¼nde yapabileceÄŸiniz her ÅŸeyi REST API Ã¼zerinden de yapabilirsiniz. Bu, AWX/Tower'Ä± diÄŸer sistemlerle entegre etmenizi veya genellikle arayÃ¼zde gerÃ§ekleÅŸtireceÄŸiniz iÅŸlemleri betikleÅŸtirmenizi saÄŸlar.
* **VeritabanÄ±**: AWX/Tower, yapÄ±landÄ±rmasÄ±nÄ±, iÅŸ sonuÃ§larÄ±nÄ± ve diÄŸer gerekli iÅŸletme verilerini depolamak iÃ§in bir veritabanÄ± (genellikle PostgreSQL) kullanÄ±r.
* **RabbitMQ**: Bu, AWX/Tower'Ä±n farklÄ± bileÅŸenler arasÄ±nda iletiÅŸim kurmak iÃ§in kullandÄ±ÄŸÄ± mesajlaÅŸma sistemidir, Ã¶zellikle web hizmeti ile gÃ¶rev Ã§alÄ±ÅŸtÄ±rÄ±cÄ±lar arasÄ±nda.
* **Redis**: Redis, bir Ã¶nbellek ve gÃ¶rev kuyruÄŸu iÃ§in bir arka uÃ§ olarak hizmet verir.

### MantÄ±ksal BileÅŸenler

* **Envanterler**: Bir envanter, **iÅŸlerin** (Ansible oynatma kitaplarÄ±) **Ã§alÄ±ÅŸtÄ±rÄ±labileceÄŸi ana bilgisayarlarÄ±n (veya dÃ¼ÄŸÃ¼mlerin) bir koleksiyonudur**. AWX/Tower, envanterlerinizi tanÄ±mlamanÄ±za ve gruplandÄ±rmanÄ±za olanak tanÄ±r ve ayrÄ±ca AWS, Azure vb. gibi diÄŸer sistemlerden ana bilgisayar listelerini **alabilen dinamik envanterleri** destekler.
* **Projeler**: Bir proje, ihtiyaÃ§ duyulduÄŸunda en son oynatma kitaplarÄ±nÄ± Ã§ekmek iÃ§in bir **sÃ¼rÃ¼m kontrol sistemi**nden (Git gibi) alÄ±nan Ansible oynatma kitaplarÄ±nÄ±n bir **koleksiyonu**dur.
* **Åablonlar**: Ä°ÅŸ ÅŸablonlarÄ±, belirli bir oynatma kitabÄ±nÄ±n **nasÄ±l Ã§alÄ±ÅŸtÄ±rÄ±lacaÄŸÄ±nÄ±** belirler, iÅŸ iÃ§in gerekli **envanteri**, **kimlik bilgilerini** ve diÄŸer **parametreleri** belirtir.
* **Kimlik Bilgileri**: AWX/Tower, SSH anahtarlarÄ±, ÅŸifreler ve API belirteÃ§leri gibi **sÄ±rlarÄ± yÃ¶netmek ve depolamak iÃ§in gÃ¼venli bir yol** saÄŸlar. Bu kimlik bilgileri, oynatma kitaplarÄ± Ã§alÄ±ÅŸtÄ±ÄŸÄ±nda gerekli eriÅŸime sahip olmasÄ± iÃ§in iÅŸ ÅŸablonlarÄ±yla iliÅŸkilendirilebilir.
* **GÃ¶rev Motoru**: Burada sihir gerÃ§ekleÅŸir. GÃ¶rev motoru, Ansible Ã¼zerine inÅŸa edilmiÅŸtir ve **oynatma kitaplarÄ±nÄ± Ã§alÄ±ÅŸtÄ±rmaktan sorumludur**. Ä°ÅŸler, belirtilen envanteri kullanarak belirtilen kimlik bilgilerini kullanarak Ansible oynatma kitaplarÄ±nÄ± Ã§alÄ±ÅŸtÄ±rmak Ã¼zere gÃ¶rev motoruna gÃ¶nderilir.
* **ZamanlayÄ±cÄ±lar ve Geri Ã‡aÄŸrÄ±lar**: Bunlar, **belirli zamanlarda Ã§alÄ±ÅŸtÄ±rÄ±lacak iÅŸleri zamanlamak** veya dÄ±ÅŸ etkinlikler tarafÄ±ndan tetiklenmesini saÄŸlamak iÃ§in AWX/Tower'da bulunan geliÅŸmiÅŸ Ã¶zelliklerdir.
* **Bildirimler**: AWX/Tower, iÅŸlerin baÅŸarÄ±sÄ± veya baÅŸarÄ±sÄ±zlÄ±ÄŸÄ±na baÄŸlÄ± olarak bildirimler gÃ¶nderebilir. E-postalar, Slack mesajlarÄ±, web kancalarÄ± vb. gibi Ã§eÅŸitli bildirim yÃ¶ntemlerini destekler.
* **Ansible Oynatma KitaplarÄ±**: Ansible oynatma kitaplarÄ±, yapÄ±landÄ±rma, daÄŸÄ±tÄ±m ve orkestrasyon araÃ§larÄ±dÄ±r. Otomatik, tekrarlanabilir bir ÅŸekilde sistemlerin istenen durumunu tanÄ±mlarlar. YAML'de yazÄ±lan oynatma kitaplarÄ±, yapÄ±landÄ±rmalarÄ±, gÃ¶revleri ve adÄ±mlarÄ± aÃ§Ä±klamak iÃ§in Ansible'Ä±n deklaratif otomasyon dilini kullanÄ±r.

### Ä°ÅŸ YÃ¼rÃ¼tme AkÄ±ÅŸÄ±

1. **KullanÄ±cÄ± EtkileÅŸimi**: Bir kullanÄ±cÄ±, AWX/Tower'a **Web ArayÃ¼zÃ¼** veya **REST API** aracÄ±lÄ±ÄŸÄ±yla etkileÅŸimde bulunabilir. Bu, AWX/Tower tarafÄ±ndan sunulan tÃ¼m iÅŸlevlere Ã¶n uÃ§ eriÅŸimi saÄŸlar.
2. **Ä°ÅŸ BaÅŸlatma**:
* KullanÄ±cÄ±, Web ArayÃ¼zÃ¼ veya API aracÄ±lÄ±ÄŸÄ±yla, bir **Ä°ÅŸ Åablonu**na dayalÄ± olarak bir iÅŸ baÅŸlatÄ±r.
* Ä°ÅŸ Åablonu, **Envanter**, **Proje** (oynatma kitabÄ±nÄ± iÃ§eren) ve **Kimlik Bilgileri**ne referanslar iÃ§erir.
* Ä°ÅŸ baÅŸlatÄ±ldÄ±ÄŸÄ±nda, iÅŸi yÃ¼rÃ¼tmek iÃ§in bir istek, iÅŸi sÄ±raya almak Ã¼zere AWX/Tower arka uÃ§una gÃ¶nderilir.
3. **Ä°ÅŸ SÄ±ralama**:
* **RabbitMQ**, web bileÅŸeni ile gÃ¶rev Ã§alÄ±ÅŸtÄ±rÄ±cÄ±lar arasÄ±ndaki iletiÅŸimi yÃ¶netir. Bir iÅŸ baÅŸlatÄ±ldÄ±ÄŸÄ±nda, bir mesaj, RabbitMQ kullanÄ±larak gÃ¶rev motoruna iletilir.
* **Redis**, sÄ±raya alÄ±nan iÅŸleri yÃ¶neterek gÃ¶rev kuyruÄŸu iÃ§in bir arka uÃ§ gÃ¶revi gÃ¶rÃ¼r.
4. **Ä°ÅŸ YÃ¼rÃ¼tme**:
* **GÃ¶rev Motoru**, sÄ±raya alÄ±nan iÅŸi alÄ±r. Ä°ÅŸin iliÅŸkili oynatma kitabÄ±, envanter ve kimlik bilgileri hakkÄ±ndaki gerekli bilgileri **VeritabanÄ±**'ndan alÄ±r.
* Ä°liÅŸkili **Projeden** alÄ±nan Ansible oynatma kitabÄ±nÄ± kullanarak GÃ¶rev Motoru, belirtilen **Envanter** dÃ¼ÄŸÃ¼mleri karÅŸÄ±sÄ±nda oynatma kitabÄ±nÄ± Ã§alÄ±ÅŸtÄ±rÄ±r ve saÄŸlanan **Kimlik Bilgileri**ni kullanÄ±r.
* Oynatma kitabÄ± Ã§alÄ±ÅŸtÄ±kÃ§a, yÃ¼rÃ¼tme Ã§Ä±ktÄ±sÄ± (loglar, gerÃ§ekler vb.) yakalanÄ±r ve **VeritabanÄ±**'nda depolanÄ±r.
5. **Ä°ÅŸ SonuÃ§larÄ±**:
* Oynatma kitabÄ± Ã§alÄ±ÅŸmayÄ± bitirdiÄŸinde, sonuÃ§lar (baÅŸarÄ±, baÅŸarÄ±sÄ±zlÄ±k, loglar) **VeritabanÄ±**'na kaydedilir.
* KullanÄ±cÄ±lar daha sonra sonuÃ§larÄ± Web ArayÃ¼zÃ¼ Ã¼zerinden gÃ¶rÃ¼ntÃ¼leyebilir veya REST API aracÄ±lÄ±ÄŸÄ±yla sorgulayabilir.
* Ä°ÅŸ sonuÃ§larÄ±na baÄŸlÄ± olarak, iÅŸle ilgili durumu kullanÄ±cÄ±larÄ± veya harici sistemleri bilgilendirmek iÃ§in **Bildirimler** gÃ¶nderilebilir. Bildirimler, e-postalar, Slack mesajlarÄ±, web kancalarÄ± vb. olabilir.
6. **Harici Sistemler Entegrasyonu**:
* **Envanterler**, AWS, Azure, VMware ve daha fazlasÄ± gibi kaynaklardan ana bilgisayarlarÄ± iÃ§e Ã§ekebilen dÄ±ÅŸ sistemlerden dinamik olarak alÄ±nabilir.
* **Projeler** (oynatma kitaplarÄ±), sÃ¼rÃ¼m kontrol sistemlerinden alÄ±nabilir, iÅŸ yÃ¼rÃ¼tme sÄ±rasÄ±nda gÃ¼ncel oynatma kitaplarÄ±nÄ±n kullanÄ±lmasÄ±nÄ± saÄŸlar.
* **ZamanlayÄ±cÄ±lar ve Geri Ã‡aÄŸrÄ±lar**, diÄŸer sistemler veya araÃ§larla entegre olmak iÃ§in kullanÄ±labilir, AWX/Tower'Ä±n dÄ±ÅŸ tetikleyicilere tepki vermesini veya belirlenmiÅŸ zamanlarda iÅŸleri Ã§alÄ±ÅŸtÄ±rmasÄ±nÄ± saÄŸlar.

### Test iÃ§in AWX laboratuvarÄ± oluÅŸturma

[**Belgeleri takip ederek**](https://github.com/ansible/awx/blob/devel/tools/docker-compose/README.md), AWX'Ä± Ã§alÄ±ÅŸtÄ±rmak iÃ§in docker-compose kullanmak mÃ¼mkÃ¼ndÃ¼r:

{% code overflow="wrap" %}
```bash
git clone -b x.y.z https://github.com/ansible/awx.git # Get in x.y.z the latest release version

cd awx

# Build
make docker-compose-build

# Run
make docker-compose

# Or to create a more complex env
MAIN_NODE_TYPE=control EXECUTION_NODE_COUNT=2 COMPOSE_TAG=devel make docker-compose

# Clean and build the UI
docker exec tools_awx_1 make clean-ui ui-devel

# Once migrations are completed and the UI is built, you can begin using AWX. The UI can be reached in your browser at https://localhost:8043/#/home, and the API can be found at https://localhost:8043/api/v2.

# Create an admin user
docker exec -ti tools_awx_1 awx-manage createsuperuser

# Load demo data
docker exec tools_awx_1 awx-manage create_preload_data
```
{% endcode %}

## RBAC

### Desteklenen roller

En ayrÄ±calÄ±klÄ± rol **Sistem YÃ¶neticisi** olarak adlandÄ±rÄ±lÄ±r. Bu role sahip olan herkes **herhangi bir ÅŸeyi deÄŸiÅŸtirebilir**.

**Beyaz kutu gÃ¼venliÄŸi** incelemesinden, **Sistem DenetÃ§isi rolÃ¼ne** ihtiyacÄ±nÄ±z olacaktÄ±r, bu rol **tÃ¼m sistem verilerini gÃ¶rÃ¼ntÃ¼lemeyi** saÄŸlar ancak herhangi bir deÄŸiÅŸiklik yapamaz. BaÅŸka bir seÃ§enek **Organizasyon DenetÃ§isi rolÃ¼** almak olabilir, ancak diÄŸerini almak daha iyi olacaktÄ±r.

<details>

<summary>DetaylÄ± rol aÃ§Ä±klamalarÄ±nÄ± almak iÃ§in burayÄ± geniÅŸletin</summary>

1. **Sistem YÃ¶neticisi**:
* Bu, sistemdeki herhangi bir kaynaÄŸa eriÅŸim ve deÄŸiÅŸiklik izinlerine sahip sÃ¼per kullanÄ±cÄ± rolÃ¼dÃ¼r.
* TÃ¼m organizasyonlarÄ±, ekipleri, projeleri, envanterleri, iÅŸ ÅŸablonlarÄ±nÄ± yÃ¶netebilirler, vb.
2. **Sistem DenetÃ§isi**:
* Bu role sahip kullanÄ±cÄ±lar tÃ¼m sistem verilerini gÃ¶rebilir ancak herhangi bir deÄŸiÅŸiklik yapamazlar.
* Bu rol uyumluluk ve denetim iÃ§in tasarlanmÄ±ÅŸtÄ±r.
3. **Organizasyon Roller**:
* **YÃ¶netici**: Organizasyonun kaynaklarÄ± Ã¼zerinde tam kontrol.
* **DenetÃ§i**: Organizasyonun kaynaklarÄ±na yalnÄ±zca gÃ¶rÃ¼ntÃ¼leme eriÅŸimi.
* **Ãœye**: Belirli izinleri olmadan bir organizasyonda temel Ã¼yelik.
* **YÃ¼rÃ¼t**: Organizasyon iÃ§inde iÅŸ ÅŸablonlarÄ±nÄ± Ã§alÄ±ÅŸtÄ±rabilir.
* **Oku**: Organizasyonun kaynaklarÄ±nÄ± gÃ¶rÃ¼ntÃ¼leyebilir.
4. **Proje Roller**:
* **YÃ¶netici**: Projeyi yÃ¶netebilir ve deÄŸiÅŸtirebilir.
* **Kullan**: Projeyi bir iÅŸ ÅŸablonunda kullanabilir.
* **GÃ¼ncelle**: KaynaÄŸÄ± SCM (kaynak kontrolÃ¼) kullanarak gÃ¼ncelleme yapabilir.
5. **Envanter Roller**:
* **YÃ¶netici**: Envanteri yÃ¶netebilir ve deÄŸiÅŸtirebilir.
* **Ad Hoc**: Envanter Ã¼zerinde ad hoc komutlar Ã§alÄ±ÅŸtÄ±rabilir.
* **GÃ¼ncelle**: Envanter kaynaÄŸÄ±nÄ± gÃ¼ncelleme yapabilir.
* **Kullan**: Envanteri bir iÅŸ ÅŸablonunda kullanabilir.
* **Oku**: YalnÄ±zca gÃ¶rÃ¼ntÃ¼leme eriÅŸimi.
6. **Ä°ÅŸ Åablonu Roller**:
* **YÃ¶netici**: Ä°ÅŸ ÅŸablonunu yÃ¶netebilir ve deÄŸiÅŸtirebilir.
* **YÃ¼rÃ¼t**: Ä°ÅŸi Ã§alÄ±ÅŸtÄ±rabilir.
* **Oku**: YalnÄ±zca gÃ¶rÃ¼ntÃ¼leme eriÅŸimi.
7. **Kimlik Bilgisi Roller**:
* **YÃ¶netici**: Kimlik bilgilerini yÃ¶netebilir ve deÄŸiÅŸtirebilir.
* **Kullan**: Kimlik bilgilerini iÅŸ ÅŸablonlarÄ±nda veya diÄŸer ilgili kaynaklarda kullanabilir.
* **Oku**: YalnÄ±zca gÃ¶rÃ¼ntÃ¼leme eriÅŸimi.
8. **Ekip Roller**:
* **Ãœye**: Ekip Ã¼yesi ancak belirli izinleri yok.
* **YÃ¶netici**: Ekip Ã¼yelerini ve iliÅŸkili kaynaklarÄ± yÃ¶netebilir.
9. **Ä°ÅŸ AkÄ±ÅŸÄ± Roller**:
* **YÃ¶netici**: Ä°ÅŸ akÄ±ÅŸÄ±nÄ± yÃ¶netebilir ve deÄŸiÅŸtirebilir.
* **YÃ¼rÃ¼t**: Ä°ÅŸ akÄ±ÅŸÄ±nÄ± Ã§alÄ±ÅŸtÄ±rabilir.
* **Oku**: YalnÄ±zca gÃ¶rÃ¼ntÃ¼leme eriÅŸimi.

</details>
