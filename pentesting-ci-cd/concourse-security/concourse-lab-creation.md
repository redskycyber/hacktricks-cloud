# Concourse Lab ä½œæˆ

<details>

<summary><strong>AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricksã«ã‚ãªãŸã®ä¼šç¤¾ã‚’åºƒå‘Šã—ãŸã„**ã€ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã«**å‚åŠ ã™ã‚‹**ã‹ã€[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã€ã¾ãŸã¯**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹**ã€‚
* [**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’**å…±æœ‰ã™ã‚‹**ã€‚

</details>

## ãƒ†ã‚¹ãƒˆç’°å¢ƒ

### Concourseã®å®Ÿè¡Œ

#### Docker-Composeã‚’ä½¿ç”¨

ã“ã®docker-composeãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€concourseã§ã„ãã¤ã‹ã®ãƒ†ã‚¹ãƒˆã‚’è¡Œã†ãŸã‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ç°¡ç´ åŒ–ã—ã¾ã™ï¼š
```bash
wget https://raw.githubusercontent.com/starkandwayne/concourse-tutorial/master/docker-compose.yml
docker-compose up -d
```
ä»¥ä¸‹ã¯ã€ãƒãƒƒã‚­ãƒ³ã‚°æŠ€è¡“ã«é–¢ã™ã‚‹ãƒãƒƒã‚­ãƒ³ã‚°ã®æœ¬ã®å†…å®¹ã§ã™ã€‚é–¢é€£ã™ã‚‹è‹±èªã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æ—¥æœ¬èªã«ç¿»è¨³ã—ã€ã¾ã£ãŸãåŒã˜ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãŠã‚ˆã³htmlæ§‹æ–‡ã‚’ä¿æŒã—ã¦ç¿»è¨³ã‚’è¿”ã—ã¦ãã ã•ã„ã€‚ã‚³ãƒ¼ãƒ‰ã€ãƒãƒƒã‚­ãƒ³ã‚°æŠ€è¡“åã€ãƒãƒƒã‚­ãƒ³ã‚°ç”¨èªã€ã‚¯ãƒ©ã‚¦ãƒ‰/SaaSãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åï¼ˆWorkspaceã€awsã€gcpãªã©ï¼‰ã€'leak'ã¨ã„ã†å˜èªã€ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã€ãŠã‚ˆã³ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚¿ã‚°ãªã©ã®ã‚‚ã®ã¯ç¿»è¨³ã—ãªã„ã§ãã ã•ã„ã€‚ã¾ãŸã€ç¿»è¨³ã¨ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³æ§‹æ–‡ä»¥å¤–ã®ä½™åˆ†ãªã‚‚ã®ã¯ä½•ã‚‚è¿½åŠ ã—ãªã„ã§ãã ã•ã„ã€‚

```
ã‚ãªãŸã®OSç”¨ã®ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ `fly` ã¯ã€ã‚¦ã‚§ãƒ–ä¸Šã® `127.0.0.1:8080` ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚

#### Kubernetesã‚’ä½¿ç”¨ã™ã‚‹ï¼ˆæ¨å¥¨ï¼‰

**Kubernetes**ï¼ˆä¾‹ãˆã° **minikube**ï¼‰ã§helm-chartã‚’ä½¿ç”¨ã—ã¦ç°¡å˜ã«concourseã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã¾ã™: [**concourse-chart**](https://github.com/concourse/concourse-chart)ã€‚
```
```bash
brew install helm
helm repo add concourse https://concourse-charts.storage.googleapis.com/
helm install concourse-release concourse/concourse
# concourse-release will be the prefix name for the concourse elements in k8s
# After the installation you will find the indications to connect to it in the console

# If you need to delete it
helm delete concourse-release
```
ç”Ÿæˆã—ãŸconcourseç’°å¢ƒã®å¾Œã€ç§˜å¯†ã‚’ç”Ÿæˆã—ã€concourse webã§å®Ÿè¡Œä¸­ã®SAãŒK8sã®ç§˜å¯†ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’ä¸ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š
```yaml
echo 'apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
name: read-secrets
rules:
- apiGroups: [""]
resources: ["secrets"]
verbs: ["get"]

---

apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
name: read-secrets-concourse
roleRef:
apiGroup: rbac.authorization.k8s.io
kind: ClusterRole
name: read-secrets
subjects:
- kind: ServiceAccount
name: concourse-release-web
namespace: default

---

apiVersion: v1
kind: Secret
metadata:
name: super
namespace: concourse-release-main
type: Opaque
data:
secret: MWYyZDFlMmU2N2Rm

' | kubectl apply -f -
```
### ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®ä½œæˆ

ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¯ã€é †åºä»˜ã‘ã‚‰ã‚ŒãŸ[ã‚¹ãƒ†ãƒƒãƒ—](https://concourse-ci.org/steps.html)ã®ãƒªã‚¹ãƒˆã‚’å«ã‚€[ã‚¸ãƒ§ãƒ–](https://concourse-ci.org/jobs.html)ã®ãƒªã‚¹ãƒˆã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—

ã„ãã¤ã‹ã®ç•°ãªã‚‹ã‚¿ã‚¤ãƒ—ã®ã‚¹ãƒ†ãƒƒãƒ—ãŒä½¿ç”¨ã§ãã¾ã™ï¼š

* **`task` ã‚¹ãƒ†ãƒƒãƒ—**](https://concourse-ci.org/task-step.html) ã¯ [**ã‚¿ã‚¹ã‚¯**](https://concourse-ci.org/tasks.html)ã‚’å®Ÿè¡Œã—ã¾ã™
* [`get` ã‚¹ãƒ†ãƒƒãƒ—](https://concourse-ci.org/get-step.html) ã¯ [ãƒªã‚½ãƒ¼ã‚¹](https://concourse-ci.org/resources.html)ã‚’å–å¾—ã—ã¾ã™
* [`put` ã‚¹ãƒ†ãƒƒãƒ—](https://concourse-ci.org/put-step.html) ã¯ [ãƒªã‚½ãƒ¼ã‚¹](https://concourse-ci.org/resources.html)ã‚’æ›´æ–°ã—ã¾ã™
* [`set_pipeline` ã‚¹ãƒ†ãƒƒãƒ—](https://concourse-ci.org/set-pipeline-step.html) ã¯ [ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³](https://concourse-ci.org/pipelines.html)ã‚’è¨­å®šã—ã¾ã™
* [`load_var` ã‚¹ãƒ†ãƒƒãƒ—](https://concourse-ci.org/load-var-step.html) ã¯å€¤ã‚’ [ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°](https://concourse-ci.org/vars.html#local-vars)ã«ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™
* [`in_parallel` ã‚¹ãƒ†ãƒƒãƒ—](https://concourse-ci.org/in-parallel-step.html) ã¯ã‚¹ãƒ†ãƒƒãƒ—ã‚’ä¸¦è¡Œã—ã¦å®Ÿè¡Œã—ã¾ã™
* [`do` ã‚¹ãƒ†ãƒƒãƒ—](https://concourse-ci.org/do-step.html) ã¯ã‚¹ãƒ†ãƒƒãƒ—ã‚’é †åºç«‹ã¦ã¦å®Ÿè¡Œã—ã¾ã™
* [`across` ã‚¹ãƒ†ãƒƒãƒ—ä¿®é£¾å­](https://concourse-ci.org/across-step.html#schema.across) ã¯ã‚¹ãƒ†ãƒƒãƒ—ã‚’è¤‡æ•°å›å®Ÿè¡Œã—ã¾ã™ã€‚å¤‰æ•°å€¤ã®å„çµ„ã¿åˆã‚ã›ã«ã¤ã„ã¦ä¸€åº¦ãšã¤
* [`try` ã‚¹ãƒ†ãƒƒãƒ—](https://concourse-ci.org/try-step.html) ã¯ã‚¹ãƒ†ãƒƒãƒ—ã®å®Ÿè¡Œã‚’è©¦ã¿ã€ã‚¹ãƒ†ãƒƒãƒ—ãŒå¤±æ•—ã—ã¦ã‚‚æˆåŠŸã—ã¾ã™

[ã‚¸ãƒ§ãƒ–ãƒ—ãƒ©ãƒ³](https://concourse-ci.org/jobs.html#schema.job.plan)å†…ã®å„[ã‚¹ãƒ†ãƒƒãƒ—](https://concourse-ci.org/steps.html)ã¯**ç‹¬è‡ªã®ã‚³ãƒ³ãƒ†ãƒŠ**ã§å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ä½•ã§ã‚‚å®Ÿè¡Œã§ãã¾ã™ _(ä¾‹ï¼šãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã€ã“ã®bashã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã€ã“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ãªã©)_ã€‚ã—ãŸãŒã£ã¦ã€5ã¤ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’æŒã¤ã‚¸ãƒ§ãƒ–ãŒã‚ã‚‹å ´åˆã€Concourseã¯å„ã‚¹ãƒ†ãƒƒãƒ—ã”ã¨ã«5ã¤ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆã—ã¾ã™ã€‚

ã—ãŸãŒã£ã¦ã€å„ã‚¹ãƒ†ãƒƒãƒ—ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã¹ãã‚³ãƒ³ãƒ†ãƒŠã®ã‚¿ã‚¤ãƒ—ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

### ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®ä¾‹
```yaml
jobs:
- name: simple
plan:
- task: simple-task
privileged: true
config:
# Tells Concourse which type of worker this task should run on
platform: linux
image_resource:
type: registry-image
source:
repository: busybox # images are pulled from docker hub by default
run:
path: sh
args:
- -cx
- |
sleep 1000
echo "$SUPER_SECRET"
params:
SUPER_SECRET: ((super.secret))
```

```bash
fly -t tutorial set-pipeline -p pipe-name -c hello-world.yml
# pipelines are paused when first created
fly -t tutorial unpause-pipeline -p pipe-name
# trigger the job and watch it run to completion
fly -t tutorial trigger-job --job pipe-name/simple --watch
# From another console
fly -t tutorial intercept --job pipe-name/simple
```
ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®æµã‚Œã‚’ç¢ºèªã™ã‚‹ã«ã¯ã€**127.0.0.1:8080** ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚

### Bashã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨å‡ºåŠ›/å…¥åŠ›ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

ã‚ã‚‹ã‚¿ã‚¹ã‚¯ã®çµæœã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«**ä¿å­˜ã—**ã€ãã‚Œã‚’å‡ºåŠ›ã¨ã—ã¦æŒ‡å®šã—ãŸå¾Œã€æ¬¡ã®ã‚¿ã‚¹ã‚¯ã®å…¥åŠ›ã‚’å‰ã®ã‚¿ã‚¹ã‚¯ã®å‡ºåŠ›ã¨ã—ã¦æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ConcourseãŒè¡Œã†ã“ã¨ã¯ã€**å‰ã®ã‚¿ã‚¹ã‚¯ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã«ãƒã‚¦ãƒ³ãƒˆã—ã€å‰ã®ã‚¿ã‚¹ã‚¯ã«ã‚ˆã£ã¦ä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§ã™**ã€‚

### ãƒˆãƒªã‚¬ãƒ¼

ã‚¸ãƒ§ãƒ–ã‚’æ‰‹å‹•ã§æ¯å›ãƒˆãƒªã‚¬ãƒ¼ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚æ¬¡ã®ã‚ˆã†ãªå ´åˆã«è‡ªå‹•çš„ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼š

* ä¸€å®šæ™‚é–“ãŒçµŒéã—ãŸå ´åˆï¼š[Time resource](https://github.com/concourse/time-resource/)
* ãƒ¡ã‚¤ãƒ³ãƒ–ãƒ©ãƒ³ãƒã«æ–°ã—ã„ã‚³ãƒŸãƒƒãƒˆãŒã‚ã£ãŸå ´åˆï¼š[Git resource](https://github.com/concourse/git-resource)
* æ–°ã—ã„PRãŒã‚ã£ãŸå ´åˆï¼š[Github-PR resource](https://github.com/telia-oss/github-pr-resource)
* ã‚¢ãƒ—ãƒªã®æœ€æ–°ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ•ã‚§ãƒƒãƒã¾ãŸã¯ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹å ´åˆï¼š[Registry-image resource](https://github.com/concourse/registry-image-resource/)

masterã¸ã®æ–°ã—ã„ã‚³ãƒŸãƒƒãƒˆã«ãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œã‚‹YAMLãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®ä¾‹ã‚’[https://concourse-ci.org/tutorial-resources.html](https://concourse-ci.org/tutorial-resources.html)ã§ç¢ºèªã—ã¦ãã ã•ã„ã€‚

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)ã§<strong>AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶</strong></a><strong>ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•ï¼š

* **HackTricksã«ã‚ãªãŸã®ä¼šç¤¾ã‚’åºƒå‘Šã—ãŸã„**ã€ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼ã®PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã™ã‚‹ã€ç§ãŸã¡ã®ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã‚„[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ ã™ã‚‹**ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)ã§**ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹**ã€‚
* [**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’**å…±æœ‰ã™ã‚‹**ã€‚

</details>
