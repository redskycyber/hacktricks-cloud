# Podstawowe informacje o Jenkinsie

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Dostp

### Nazwa u偶ytkownika + Haso

Najczstszy spos贸b logowania do Jenkinsa to za pomoc nazwy u偶ytkownika i hasa.

### Cookie

Jeli **ukradziono uprawnione cookie**, mo偶na je wykorzysta do uzyskania dostpu do sesji u偶ytkownika. Cookie zwykle nazywane jest `JSESSIONID.*`. (U偶ytkownik mo偶e zakoczy wszystkie swoje sesje, ale musiaby najpierw dowiedzie si, 偶e cookie zostao skradzione).

### SSO/Wtyczki

Jenkins mo偶na skonfigurowa za pomoc wtyczek, aby by **dostpny za porednictwem zewntrznego SSO**.

### Tokeny

**U偶ytkownicy mog generowa tokeny**, aby umo偶liwi aplikacjom udawanie ich za pomoc interfejsu CLI lub REST API.

### Klucze SSH

Ten komponent dostarcza wbudowany serwer SSH dla Jenkinsa. Jest to alternatywny interfejs dla [Jenkins CLI](https://www.jenkins.io/doc/book/managing/cli/), a polecenia mo偶na wywoywa w ten spos贸b za pomoc dowolnego klienta SSH. (Z dokumentacji (https://plugins.jenkins.io/sshd/))

## Autoryzacja

W `/configureSecurity` mo偶na **skonfigurowa metod autoryzacji Jenkinsa**. Istnieje kilka opcji:

* **Ka偶dy mo偶e wszystko**: Nawet anonimowy dostp mo偶e zarzdza serwerem.
* **Tryb dziedzictwa**: To samo co w Jenkinsie <1.164. Jeli masz rol **"admin"**, otrzymasz **pen kontrol** nad systemem, a w przeciwnym razie (w tym u偶ytkownicy **anonimowi**) otrzymasz dostp tylko do odczytu.
* **Zalogowani u偶ytkownicy mog wszystko**: W tym trybie ka偶dy **zalogowany u偶ytkownik ma pen kontrol** nad Jenkins. Jedynym u偶ytkownikiem, kt贸ry nie ma penej kontroli, jest u偶ytkownik **anonimowy**, kt贸ry ma tylko dostp do odczytu.
* **Matrix-based security**: Mo偶na skonfigurowa, **kto mo偶e co robi** w tabeli. Ka偶da **kolumna** reprezentuje **uprawnienie**. Ka偶dy **wiersz** reprezentuje **u偶ytkownika lub grup/rol**. Obejmuje to specjalnego u偶ytkownika '**anonymous**', kt贸ry reprezentuje **nieuwierzytelnionych u偶ytkownik贸w**, oraz '**authenticated**', kt贸ry reprezentuje **wszystkich uwierzytelnionych u偶ytkownik贸w**.

![](<../../.gitbook/assets/image (40).png>)

* **Project-based Matrix Authorization Strategy:** Ten tryb jest **rozszerzeniem** dla "**Matrix-based security**", kt贸re pozwala na zdefiniowanie dodatkowej macierzy ACL dla ka偶dego projektu osobno.
* **Role-Based Strategy:** Umo偶liwia definiowanie autoryzacji za pomoc **strategii opartej na rolach**. Zarzdzaj rolami w `/role-strategy`.

## **Realm zabezpiecze**

W `/configureSecurity` mo偶na **skonfigurowa realm zabezpiecze**. Domylnie Jenkins zawiera obsug kilku r贸偶nych realm贸w zabezpiecze:

* **Delegowanie do kontenera serwlet贸w**: Do **delegowania uwierzytelniania do kontenera serwlet贸w uruchamiajcego kontroler Jenkinsa**, takiego jak [Jetty](https://www.eclipse.org/jetty/).
* **Wasna baza danych u偶ytkownik贸w Jenkinsa:** U偶yj **wbudowanej w Jenkinsa bazy danych u偶ytkownik贸w** do uwierzytelniania zamiast delegowania do zewntrznego systemu. Jest to domylnie wczone.
* **LDAP**: Deleguj cae uwierzytelnianie do skonfigurowanego serwera LDAP, obejmujcego zar贸wno u偶ytkownik贸w, jak i grupy.
* **Baza danych u偶ytkownik贸w/grup Unix**: Deleguje uwierzytelnianie do baz danych u偶ytkownik贸w na poziomie systemu operacyjnego Unix na kontrolerze Jenkinsa. Ten tryb umo偶liwia r贸wnie偶 ponowne wykorzystanie grup Unix do autoryzacji.

Wtyczki mog dostarcza dodatkowe realm zabezpiecze, kt贸re mog by przydatne do wczenia Jenkinsa do istniejcych system贸w to偶samoci, takich jak:

* [Active Directory](https://plugins.jenkins.io/active-directory)
* [GitHub Authentication](https://plugins.jenkins.io/github-oauth)
* [Atlassian Crowd 2](https://plugins.jenkins.io/crowd2)

## Wzy, Agenci i Wykonawcy Jenkinsa

Definicje z [dokumentacji](https://www.jenkins.io/doc/book/managing/nodes/):

**Wzy** to **maszyny**, na kt贸rych uruchamiane s **agenty budowy**. Jenkins monitoruje ka偶dy podczony wze pod ktem miejsca na dysku, wolnego miejsca tymczasowego, wolnej przestrzeni wymiany, czasu/zgodnoci zegara i czasu odpowiedzi. Wze jest wyczany, jeli kt贸re z tych wartoci wykracza poza skonfigurowany pr贸g.

**Agenci** **zarzdzaj** wykonaniem zada w imieniu kontrolera Jenkinsa, **korzystajc z wykonawc贸w**. Agent mo偶e korzysta z dowolnego systemu operacyjnego obsugujcego Jav. Narzdzia wymagane do budowy i test贸w s instalowane na w藕le, na kt贸rym dziaa agent; mog by **instalowane bezporednio lub w kontenerze** (Docker lub Kubernetes). Ka偶dy **agent jest efektywnie procesem z wasnym PID** na maszynie hosta.

Wykonawca to **slot do wykonywania zada**; efektywnie jest to **wtek w agencie**. Liczba wykonawc贸w na w藕le okrela liczb **r贸wnoczesnych zada**, kt贸re mo偶na wykona na tym w藕le w jednym czasie. Innymi sowy, to okrela **liczb r贸wnoczesnych etap贸w Pipeline**, kt贸re mo偶na wykona na tym w藕le w jednym czasie.

## Tajemnice Jenkinsa

### Szyfrowanie tajemnic i powiadcze

Definicja z [dokumentacji](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials):
Jenkins u偶ywa **AES do szyfrowania i ochrony tajemnic**, powiadcze i ich odpowiednich kluczy szyfrowania. Te klucze szyfrowania s przechowywane w `$JENKINS_HOME/secrets/` wraz z kluczem g贸wnym u偶ywanym do ochrony tych kluczy. Ten katalog powinien by skonfigurowany tak, aby tylko u偶ytkownik systemu operacyjnego, na kt贸rym dziaa kontroler Jenkinsa, mia dostp do odczytu i zapisu do tego katalogu (tj. warto `chmod` r贸wna `0700` lub odpowiednie atrybuty pliku). **Klucz g贸wny** (czasami nazywany "kluczem szyfrowania kluc
### Dostp do powiadcze

Powiadczenia mog by **ograniczone do globalnych dostawc贸w** (`/credentials/`), kt贸re mog by dostpne dla dowolnie skonfigurowanego projektu, lub mog by ograniczone do **konkretnych projekt贸w** (`/job/<nazwa-projektu>/configure`) i w zwizku z tym dostpne tylko z tego konkretnego projektu.

Zgodnie z [**dokumentacj**](https://www.jenkins.io/blog/2019/02/21/credentials-masking/): Powiadczenia, kt贸re s w zakresie, s udostpniane w potoku bez ogranicze. Aby **zapobiec przypadkowemu ujawnieniu w dzienniku budowy**, powiadczenia s **zamazywane** w zwykym wyjciu, wic wywoanie `env` (Linux) lub `set` (Windows), lub programy drukujce swoje rodowisko lub parametry **nie ujawni ich w dzienniku budowy** dla u偶ytkownik贸w, kt贸rzy nie maj w przeciwnym razie dostpu do powiadcze.

**Dlatego te偶, aby wydoby powiadczenia, atakujcy musi np. zakodowa je w base64.**

## Odwoania

* [https://www.jenkins.io/doc/book/security/managing-security/](https://www.jenkins.io/doc/book/security/managing-security/)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)
* [https://www.jenkins.io/doc/developer/security/secrets/](https://www.jenkins.io/doc/developer/security/secrets/)
* [https://www.jenkins.io/blog/2019/02/21/credentials-masking/](https://www.jenkins.io/blog/2019/02/21/credentials-masking/)
* [https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery)
* [https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi trikami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
