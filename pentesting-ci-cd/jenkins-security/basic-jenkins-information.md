# JenkinsåŸºæœ¬ä¿¡æ¯

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[NFTs](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Šå…³æ³¨æˆ‘ä»¬ ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## è®¿é—®

### ç”¨æˆ·å + å¯†ç 

åœ¨Jenkinsä¸­ç™»å½•æœ€å¸¸è§çš„æ–¹å¼æ˜¯ä½¿ç”¨ç”¨æˆ·åæˆ–å¯†ç ã€‚

### Cookie

å¦‚æœ**æˆæƒçš„Cookieè¢«çªƒå–**ï¼Œå®ƒå¯ä»¥ç”¨äºè®¿é—®ç”¨æˆ·çš„ä¼šè¯ã€‚Cookieé€šå¸¸è¢«ç§°ä¸º`JSESSIONID.*`ã€‚ï¼ˆç”¨æˆ·å¯ä»¥ç»ˆæ­¢æ‰€æœ‰ä¼šè¯ï¼Œä½†é¦–å…ˆéœ€è¦æ‰¾å‡ºCookieè¢«ç›—ï¼‰ã€‚

### SSO/æ’ä»¶

å¯ä»¥ä½¿ç”¨æ’ä»¶é…ç½®Jenkinsä»¥é€šè¿‡ç¬¬ä¸‰æ–¹SSOè¿›è¡Œè®¿é—®ã€‚

### ä»¤ç‰Œ

**ç”¨æˆ·å¯ä»¥ç”Ÿæˆä»¤ç‰Œ**ï¼Œä»¥ä¾¿åº”ç”¨ç¨‹åºé€šè¿‡CLIæˆ–REST APIæ¨¡æ‹Ÿä»–ä»¬è¿›è¡Œè®¿é—®ã€‚

### SSHå¯†é’¥

æ­¤ç»„ä»¶ä¸ºJenkinsæä¾›äº†ä¸€ä¸ªå†…ç½®çš„SSHæœåŠ¡å™¨ã€‚è¿™æ˜¯[Jenkins CLI](https://www.jenkins.io/doc/book/managing/cli/)çš„æ›¿ä»£ç•Œé¢ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•SSHå®¢æˆ·ç«¯ä»¥è¿™ç§æ–¹å¼è°ƒç”¨å‘½ä»¤ã€‚ï¼ˆæ¥è‡ª[æ–‡æ¡£](https://plugins.jenkins.io/sshd/))

## æˆæƒ

åœ¨`/configureSecurity`ä¸­ï¼Œå¯ä»¥**é…ç½®Jenkinsçš„æˆæƒæ–¹æ³•**ã€‚æœ‰å‡ ä¸ªé€‰é¡¹ï¼š

* **ä»»ä½•äººéƒ½å¯ä»¥åšä»»ä½•äº‹æƒ…**ï¼šå³ä½¿åŒ¿åè®¿é—®ä¹Ÿå¯ä»¥ç®¡ç†æœåŠ¡å™¨
* **ä¼ ç»Ÿæ¨¡å¼**ï¼šä¸Jenkins <1.164ç›¸åŒã€‚å¦‚æœæ‚¨æ‹¥æœ‰**"admin"è§’è‰²**ï¼Œåˆ™å°†è¢«æˆäºˆå¯¹ç³»ç»Ÿçš„**å®Œå…¨æ§åˆ¶**ï¼Œå¦åˆ™ï¼ˆåŒ…æ‹¬**åŒ¿å**ç”¨æˆ·ï¼‰å°†åªæœ‰**è¯»å–æƒé™**ã€‚
* **å·²ç™»å½•ç”¨æˆ·å¯ä»¥åšä»»ä½•äº‹æƒ…**ï¼šåœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œæ¯ä¸ª**å·²ç™»å½•ç”¨æˆ·éƒ½å¯ä»¥å®Œå…¨æ§åˆ¶**Jenkinsã€‚å”¯ä¸€æ²¡æœ‰å®Œå…¨æ§åˆ¶çš„ç”¨æˆ·æ˜¯**åŒ¿åç”¨æˆ·**ï¼Œä»–ä»¬åªæœ‰**è¯»å–æƒé™**ã€‚
* **åŸºäºçŸ©é˜µçš„å®‰å…¨æ€§**ï¼šæ‚¨å¯ä»¥åœ¨è¡¨ä¸­é…ç½®**è°å¯ä»¥åšä»€ä¹ˆ**ã€‚æ¯ä¸ª**åˆ—**ä»£è¡¨ä¸€ä¸ª**æƒé™**ã€‚æ¯ä¸ª**è¡Œ**ä»£è¡¨ä¸€ä¸ª**ç”¨æˆ·æˆ–ç»„/è§’è‰²**ã€‚è¿™åŒ…æ‹¬ä¸€ä¸ªç‰¹æ®Šç”¨æˆ·'**åŒ¿å**'ï¼Œä»£è¡¨**æœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·**ï¼Œä»¥åŠ'**å·²éªŒè¯**'ï¼Œä»£è¡¨**æ‰€æœ‰å·²éªŒè¯çš„ç”¨æˆ·**ã€‚

![](<../../.gitbook/assets/image (149).png>)

* **åŸºäºé¡¹ç›®çš„çŸ©é˜µæˆæƒç­–ç•¥**ï¼šè¿™ç§æ¨¡å¼æ˜¯å¯¹â€œ**åŸºäºçŸ©é˜µçš„å®‰å…¨æ€§**â€çš„æ‰©å±•ï¼Œå…è®¸ä¸ºæ¯ä¸ªé¡¹ç›®å•ç‹¬å®šä¹‰é™„åŠ çš„ACLçŸ©é˜µã€‚
* **åŸºäºè§’è‰²çš„ç­–ç•¥**ï¼šå¯ç”¨ä½¿ç”¨**åŸºäºè§’è‰²çš„ç­–ç•¥**å®šä¹‰æˆæƒã€‚åœ¨`/role-strategy`ä¸­ç®¡ç†è§’è‰²ã€‚

## **å®‰å…¨é¢†åŸŸ**

åœ¨`/configureSecurity`ä¸­ï¼Œå¯ä»¥**é…ç½®å®‰å…¨é¢†åŸŸ**ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒJenkinsåŒ…æ‹¬å¯¹å‡ ç§ä¸åŒå®‰å…¨é¢†åŸŸçš„æ”¯æŒï¼š

* **å§”æ‰˜ç»™Servletå®¹å™¨**ï¼šç”¨äº**å§”æ‰˜èº«ä»½éªŒè¯ç»™è¿è¡ŒJenkinsæ§åˆ¶å™¨çš„Servletå®¹å™¨**ï¼Œä¾‹å¦‚[Jetty](https://www.eclipse.org/jetty/)ã€‚
* **Jenkinsè‡ªå·±çš„ç”¨æˆ·æ•°æ®åº“**ï¼šä½¿ç”¨**Jenkinså†…ç½®çš„ç”¨æˆ·æ•°æ®å­˜å‚¨**è¿›è¡Œèº«ä»½éªŒè¯ï¼Œè€Œä¸æ˜¯å§”æ‰˜ç»™å¤–éƒ¨ç³»ç»Ÿã€‚é»˜è®¤æƒ…å†µä¸‹å¯ç”¨æ­¤åŠŸèƒ½ã€‚
* **LDAP**ï¼šå°†æ‰€æœ‰èº«ä»½éªŒè¯å§”æ‰˜ç»™é…ç½®çš„LDAPæœåŠ¡å™¨ï¼ŒåŒ…æ‹¬ç”¨æˆ·å’Œç»„ã€‚
* **Unixç”¨æˆ·/ç»„æ•°æ®åº“**ï¼šå°†èº«ä»½éªŒè¯å§”æ‰˜ç»™Jenkinsæ§åˆ¶å™¨ä¸Šè¿è¡Œçš„åº•å±‚Unixæ“ä½œç³»ç»Ÿçº§ç”¨æˆ·æ•°æ®åº“ã€‚æ­¤æ¨¡å¼è¿˜å…è®¸é‡ç”¨Unixç»„è¿›è¡Œæˆæƒã€‚

æ’ä»¶å¯ä»¥æä¾›é¢å¤–çš„å®‰å…¨é¢†åŸŸï¼Œè¿™å¯èƒ½å¯¹å°†Jenkinsæ•´åˆåˆ°ç°æœ‰èº«ä»½ç³»ç»Ÿä¸­å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚ï¼š

* [Active Directory](https://plugins.jenkins.io/active-directory)
* [GitHubèº«ä»½éªŒè¯](https://plugins.jenkins.io/github-oauth)
* [Atlassian Crowd 2](https://plugins.jenkins.io/crowd2)

## JenkinsèŠ‚ç‚¹ã€ä»£ç†å’Œæ‰§è¡Œå™¨

æ¥è‡ª[æ–‡æ¡£](https://www.jenkins.io/doc/book/managing/nodes/)çš„å®šä¹‰ï¼š

**èŠ‚ç‚¹**æ˜¯æ„å»º**ä»£ç†è¿è¡Œ**çš„**æœºå™¨**ã€‚Jenkinsç›‘è§†æ¯ä¸ªé™„åŠ èŠ‚ç‚¹çš„ç£ç›˜ç©ºé—´ã€ä¸´æ—¶ç©ºé—´ã€äº¤æ¢ç©ºé—´ã€æ—¶é’Ÿæ—¶é—´/åŒæ­¥å’Œå“åº”æ—¶é—´ã€‚å¦‚æœè¿™äº›å€¼ä¸­çš„ä»»ä½•ä¸€ä¸ªè¶…å‡ºäº†é…ç½®çš„é˜ˆå€¼ï¼ŒèŠ‚ç‚¹å°†è¢«ä¸‹çº¿ã€‚

**ä»£ç†**ä»£è¡¨Jenkinsæ§åˆ¶å™¨**ç®¡ç†**ä»»åŠ¡æ‰§è¡Œï¼Œ**ä½¿ç”¨æ‰§è¡Œå™¨**ã€‚ä»£ç†å¯ä»¥ä½¿ç”¨æ”¯æŒJavaçš„ä»»ä½•æ“ä½œç³»ç»Ÿã€‚æ„å»ºå’Œæµ‹è¯•æ‰€éœ€çš„å·¥å…·å®‰è£…åœ¨ä»£ç†è¿è¡Œçš„èŠ‚ç‚¹ä¸Šï¼›å®ƒä»¬å¯ä»¥**ç›´æ¥å®‰è£…æˆ–åœ¨å®¹å™¨ä¸­**ï¼ˆDockeræˆ–Kubernetesï¼‰å®‰è£…ã€‚æ¯ä¸ª**ä»£ç†å®é™…ä¸Šæ˜¯ä¸»æœºä¸Šå…·æœ‰è‡ªå·±PIDçš„è¿›ç¨‹**ã€‚

**æ‰§è¡Œå™¨**æ˜¯**ä»»åŠ¡æ‰§è¡Œçš„æ’æ§½**ï¼›å®é™…ä¸Šï¼Œå®ƒæ˜¯ä»£ç†ä¸­çš„**ä¸€ä¸ªçº¿ç¨‹**ã€‚èŠ‚ç‚¹ä¸Šçš„æ‰§è¡Œå™¨æ•°é‡å®šä¹‰äº†è¯¥èŠ‚ç‚¹å¯ä»¥åŒæ—¶æ‰§è¡Œçš„**å¹¶å‘ä»»åŠ¡**æ•°é‡ã€‚æ¢å¥è¯è¯´ï¼Œè¿™ç¡®å®šäº†è¯¥èŠ‚ç‚¹å¯ä»¥åŒæ—¶æ‰§è¡Œçš„**å¹¶å‘Pipeline `é˜¶æ®µ`**çš„æ•°é‡ã€‚

## Jenkinsç§˜å¯†

### åŠ å¯†ç§˜å¯†å’Œå‡­æ®

æ¥è‡ª[æ–‡æ¡£](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials)çš„å®šä¹‰ï¼šJenkinsä½¿ç”¨**AESåŠ å¯†å’Œä¿æŠ¤ç§˜å¯†**ã€å‡­æ®åŠå…¶ç›¸åº”çš„åŠ å¯†å¯†é’¥ã€‚è¿™äº›åŠ å¯†å¯†é’¥å­˜å‚¨åœ¨`$JENKINS_HOME/secrets/`ä¸­ï¼Œä¸ç”¨äºä¿æŠ¤è¿™äº›å¯†é’¥çš„ä¸»å¯†é’¥ä¸€èµ·ã€‚æ­¤ç›®å½•åº”é…ç½®ä¸ºåªæœ‰Jenkinsæ§åˆ¶å™¨æ­£åœ¨è¿è¡Œçš„æ“ä½œç³»ç»Ÿç”¨æˆ·å¯¹æ­¤ç›®å½•å…·æœ‰è¯»å–å’Œå†™å…¥è®¿é—®æƒé™ï¼ˆå³ï¼Œ`chmod`å€¼ä¸º`0700`æˆ–ä½¿ç”¨é€‚å½“çš„æ–‡ä»¶å±æ€§ï¼‰ã€‚ä¸»å¯†é’¥ï¼ˆæœ‰æ—¶åœ¨åŠ å¯†æœ¯è¯­ä¸­ç§°ä¸ºâ€œå¯†é’¥åŠ å¯†å¯†é’¥â€ï¼‰**æœªåŠ å¯†åœ°å­˜å‚¨åœ¨**Jenkinsæ§åˆ¶å™¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„**`$JENKINS_HOME/secrets/master.key`**ä¸­ï¼Œè¿™ä¸ä¼šé˜²æ­¢ç›´æ¥è®¿é—®è¯¥æ–‡ä»¶çš„æ”»å‡»è€…ã€‚å¤§å¤šæ•°ç”¨æˆ·å’Œå¼€å‘äººå‘˜å°†é—´æ¥ä½¿ç”¨è¿™äº›åŠ å¯†å¯†é’¥ï¼Œé€šè¿‡[Secret](https://javadoc.jenkins.io/byShortName/Secret) APIåŠ å¯†é€šç”¨ç§˜å¯†æ•°æ®æˆ–é€šè¿‡å‡­æ®APIã€‚å¯¹äºå¯¹åŠ å¯†æ„Ÿå…´è¶£çš„äººï¼ŒJenkinsä½¿ç”¨AESåœ¨å¯†ç å—é“¾æ¥ï¼ˆCBCï¼‰æ¨¡å¼ä¸‹ä½¿ç”¨PKCS#5å¡«å……å’ŒéšæœºIVå¯¹[åŠ å¯†æœºå¯†å¯†é’¥](https://javadoc.jenkins.io/byShortName/CryptoConfidentialKey)çš„å®ä¾‹è¿›è¡ŒåŠ å¯†ï¼Œè¿™äº›å®ä¾‹å­˜å‚¨åœ¨`$JENKINS_HOME/secrets/`ä¸­ï¼Œæ–‡ä»¶åå¯¹åº”äºå®ƒä»¬çš„`CryptoConfidentialKey` idã€‚å¸¸è§çš„å¯†é’¥idåŒ…æ‹¬ï¼š

* `hudson.util.Secret`ï¼šç”¨äºé€šç”¨ç§˜å¯†ï¼›
* `com.cloudbees.plugins.credentials.SecretBytes.KEY`ï¼šç”¨äºæŸäº›å‡­æ®ç±»å‹ï¼›
* `jenkins.model.Jenkins.crumbSalt`ï¼šç”±[CSRFä¿æŠ¤æœºåˆ¶](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery)ä½¿ç”¨ï¼›
### å‡­è¯è®¿é—®

å‡­è¯å¯ä»¥è¢«**é™å®šä¸ºå…¨å±€æä¾›è€…** (`/credentials/`)ï¼Œå¯ä»¥è¢«ä»»ä½•é…ç½®çš„é¡¹ç›®è®¿é—®ï¼Œæˆ–è€…å¯ä»¥è¢«**é™å®šä¸ºç‰¹å®šé¡¹ç›®** (`/job/<project-name>/configure`)ï¼Œå› æ­¤åªèƒ½ä»ç‰¹å®šé¡¹ç›®è®¿é—®ã€‚

æ ¹æ®[**æ–‡æ¡£**](https://www.jenkins.io/blog/2019/02/21/credentials-masking/)ï¼šåœ¨èŒƒå›´å†…çš„å‡­è¯å¯ä»¥åœ¨ç®¡é“ä¸­æ— é™åˆ¶åœ°ä½¿ç”¨ã€‚ä¸ºäº†**é˜²æ­¢åœ¨æ„å»ºæ—¥å¿—ä¸­æ„å¤–æš´éœ²**ï¼Œå‡­è¯ä¼šä»å¸¸è§„è¾“å‡ºä¸­**æ©ç **ï¼Œå› æ­¤åœ¨ Linux ä¸­è°ƒç”¨ `env` æˆ–åœ¨ Windows ä¸­è°ƒç”¨ `set`ï¼Œæˆ–è€…æ‰“å°å…¶ç¯å¢ƒæˆ–å‚æ•°çš„ç¨‹åº**ä¸ä¼šåœ¨æ„å»ºæ—¥å¿—ä¸­æ˜¾ç¤º**ï¼Œè¿™æ ·å°±ä¸ä¼šè®©å…¶ä»–æ²¡æœ‰å‡­è¯è®¿é—®æƒé™çš„ç”¨æˆ·çœ‹åˆ°ã€‚

**è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸ºäº†çªƒå–å‡­è¯ï¼Œæ”»å‡»è€…éœ€è¦å¯¹å…¶è¿›è¡Œ base64 ç¼–ç ã€‚**

## å‚è€ƒèµ„æ–™

* [https://www.jenkins.io/doc/book/security/managing-security/](https://www.jenkins.io/doc/book/security/managing-security/)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)
* [https://www.jenkins.io/doc/developer/security/secrets/](https://www.jenkins.io/doc/developer/security/secrets/)
* [https://www.jenkins.io/blog/2019/02/21/credentials-masking/](https://www.jenkins.io/blog/2019/02/21/credentials-masking/)
* [https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery)
* [https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹  AWS é»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨ HackTricks ä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½ PDF ç‰ˆæœ¬çš„ HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTs**](https://opensea.io/collection/the-peass-family)ç³»åˆ—
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
