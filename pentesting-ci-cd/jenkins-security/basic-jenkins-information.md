# åŸºæœ¬çš„Jenkinsä¿¡æ¯

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºè‹±é›„</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## è®¿é—®

### ç”¨æˆ·å + å¯†ç 

ç™»å½•Jenkinsæœ€å¸¸è§çš„æ–¹å¼æ˜¯ä½¿ç”¨ç”¨æˆ·åæˆ–å¯†ç 

### Cookie

å¦‚æœ**æˆæƒçš„cookieè¢«ç›—**ï¼Œå®ƒå¯ä»¥è¢«ç”¨æ¥è®¿é—®ç”¨æˆ·çš„ä¼šè¯ã€‚Cookieé€šå¸¸è¢«ç§°ä¸º`JSESSIONID.*`ã€‚ï¼ˆç”¨æˆ·å¯ä»¥ç»ˆæ­¢ä»–çš„æ‰€æœ‰ä¼šè¯ï¼Œä½†ä»–éœ€è¦é¦–å…ˆå‘ç°cookieè¢«ç›—äº†ï¼‰ã€‚

### SSO/æ’ä»¶

Jenkinså¯ä»¥ä½¿ç”¨æ’ä»¶é…ç½®ï¼Œé€šè¿‡ç¬¬ä¸‰æ–¹SSO**è®¿é—®**ã€‚

### ä»¤ç‰Œ

**ç”¨æˆ·å¯ä»¥ç”Ÿæˆä»¤ç‰Œ**ï¼Œä»¥ä¾¿é€šè¿‡CLIæˆ–REST APIæˆæƒåº”ç”¨ç¨‹åºä»£è¡¨ä»–ä»¬è®¿é—®ã€‚

### SSHå¯†é’¥

æ­¤ç»„ä»¶ä¸ºJenkinsæä¾›äº†å†…ç½®çš„SSHæœåŠ¡å™¨ã€‚å®ƒæ˜¯[Jenkins CLI](https://www.jenkins.io/doc/book/managing/cli/)çš„å¦ä¸€ç§æ¥å£ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•SSHå®¢æˆ·ç«¯ä»¥è¿™ç§æ–¹å¼è°ƒç”¨å‘½ä»¤ã€‚ï¼ˆæ¥è‡ª[æ–‡æ¡£](https://plugins.jenkins.io/sshd/)ï¼‰

## æˆæƒ

åœ¨`/configureSecurity`ä¸­ï¼Œå¯ä»¥**é…ç½®Jenkinsçš„æˆæƒæ–¹æ³•**ã€‚æœ‰å‡ ä¸ªé€‰é¡¹ï¼š

* **ä»»ä½•äººéƒ½å¯ä»¥åšä»»ä½•äº‹**ï¼šå³ä½¿æ˜¯åŒ¿åè®¿é—®ä¹Ÿå¯ä»¥ç®¡ç†æœåŠ¡å™¨
* **ä¼ ç»Ÿæ¨¡å¼**ï¼šä¸Jenkins <1.164ç›¸åŒã€‚å¦‚æœæ‚¨æ‹¥æœ‰**"admin"è§’è‰²**ï¼Œæ‚¨å°†è¢«æˆäºˆ**å®Œå…¨æ§åˆ¶**ç³»ç»Ÿçš„æƒé™ï¼Œ**å¦åˆ™**ï¼ˆåŒ…æ‹¬**åŒ¿å**ç”¨æˆ·ï¼‰æ‚¨å°†æ‹¥æœ‰**è¯»å–**æƒé™ã€‚
* **ç™»å½•ç”¨æˆ·å¯ä»¥åšä»»ä½•äº‹**ï¼šåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ¯ä¸ª**ç™»å½•ç”¨æˆ·éƒ½è·å¾—å¯¹Jenkinsçš„å®Œå…¨æ§åˆ¶**ã€‚å”¯ä¸€æ²¡æœ‰å®Œå…¨æ§åˆ¶æƒçš„ç”¨æˆ·æ˜¯**åŒ¿åç”¨æˆ·**ï¼Œä»–ä»¬åªæœ‰**è¯»å–æƒé™**ã€‚
* **åŸºäºçŸ©é˜µçš„å®‰å…¨æ€§**ï¼šæ‚¨å¯ä»¥åœ¨è¡¨æ ¼ä¸­é…ç½®**è°å¯ä»¥åšä»€ä¹ˆ**ã€‚æ¯ä¸ª**åˆ—**ä»£è¡¨ä¸€ä¸ª**æƒé™**ã€‚æ¯ä¸ª**è¡Œ** **ä»£è¡¨** ä¸€ä¸ª**ç”¨æˆ·æˆ–ä¸€ä¸ªç»„/è§’è‰²**ã€‚è¿™åŒ…æ‹¬ä¸€ä¸ªç‰¹æ®Šç”¨æˆ·'**åŒ¿å**'ï¼Œä»£è¡¨**æœªç»è®¤è¯çš„ç”¨æˆ·**ï¼Œä»¥åŠ'**è®¤è¯**'ï¼Œä»£è¡¨**æ‰€æœ‰ç»è¿‡è®¤è¯çš„ç”¨æˆ·**ã€‚

![](<../../.gitbook/assets/image (40).png>)

* **åŸºäºé¡¹ç›®çš„çŸ©é˜µæˆæƒç­–ç•¥**ï¼šè¿™ç§æ¨¡å¼æ˜¯"**åŸºäºçŸ©é˜µçš„å®‰å…¨æ€§**"çš„**æ‰©å±•**ï¼Œå…è®¸ä¸ºæ¯ä¸ªé¡¹ç›®å•ç‹¬å®šä¹‰é¢å¤–çš„ACLçŸ©é˜µã€‚
* **åŸºäºè§’è‰²çš„ç­–ç•¥**ï¼šä½¿ç”¨**åŸºäºè§’è‰²çš„ç­–ç•¥**å®šä¹‰æˆæƒã€‚åœ¨`/role-strategy`ç®¡ç†è§’è‰²ã€‚

## **å®‰å…¨é¢†åŸŸ**

åœ¨`/configureSecurity`ä¸­ï¼Œå¯ä»¥**é…ç½®å®‰å…¨é¢†åŸŸ**ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒJenkinsæ”¯æŒå‡ ç§ä¸åŒçš„å®‰å…¨é¢†åŸŸï¼š

* **å§”æ‰˜ç»™servletå®¹å™¨**ï¼šç”¨äº**å§”æ‰˜è¿è¡ŒJenkinsæ§åˆ¶å™¨çš„servletå®¹å™¨è¿›è¡Œè®¤è¯**ï¼Œä¾‹å¦‚[Jetty](https://www.eclipse.org/jetty/)ã€‚
* **Jenkinsè‡ªå·±çš„ç”¨æˆ·æ•°æ®åº“**ï¼šä½¿ç”¨**Jenkinsè‡ªå·±çš„å†…ç½®ç”¨æˆ·æ•°æ®å­˜å‚¨**è¿›è¡Œè®¤è¯ï¼Œè€Œä¸æ˜¯å§”æ‰˜ç»™å¤–éƒ¨ç³»ç»Ÿã€‚è¿™æ˜¯é»˜è®¤å¯ç”¨çš„ã€‚
* **LDAP**ï¼šå°†æ‰€æœ‰è®¤è¯å§”æ‰˜ç»™é…ç½®çš„LDAPæœåŠ¡å™¨ï¼ŒåŒ…æ‹¬ç”¨æˆ·å’Œç»„ã€‚
* **Unixç”¨æˆ·/ç»„æ•°æ®åº“**ï¼š **å°†è®¤è¯å§”æ‰˜ç»™Jenkinsæ§åˆ¶å™¨ä¸Šçš„åº•å±‚Unix**æ“ä½œç³»ç»Ÿçº§ç”¨æˆ·æ•°æ®åº“ã€‚è¿™ç§æ¨¡å¼è¿˜å…è®¸é‡ç”¨Unixç»„è¿›è¡Œæˆæƒã€‚

æ’ä»¶å¯ä»¥æä¾›é¢å¤–çš„å®‰å…¨é¢†åŸŸï¼Œè¿™å¯èƒ½æœ‰åŠ©äºå°†Jenkinsæ•´åˆåˆ°ç°æœ‰çš„èº«ä»½ç³»ç»Ÿä¸­ï¼Œä¾‹å¦‚ï¼š

* [Active Directory](https://plugins.jenkins.io/active-directory)
* [GitHub Authentication](https://plugins.jenkins.io/github-oauth)
* [Atlassian Crowd 2](https://plugins.jenkins.io/crowd2)

## JenkinsèŠ‚ç‚¹ã€ä»£ç†å’Œæ‰§è¡Œå™¨

æ¥è‡ª[æ–‡æ¡£](https://www.jenkins.io/doc/book/managing/nodes/)çš„å®šä¹‰ï¼š

**èŠ‚ç‚¹**æ˜¯æ„å»º**ä»£ç†è¿è¡Œ**çš„**æœºå™¨**ã€‚Jenkinsç›‘æ§æ¯ä¸ªè¿æ¥çš„èŠ‚ç‚¹çš„ç£ç›˜ç©ºé—´ã€ä¸´æ—¶ç©ºé—´ã€äº¤æ¢ç©ºé—´ã€æ—¶é’Ÿæ—¶é—´/åŒæ­¥å’Œå“åº”æ—¶é—´ã€‚å¦‚æœè¿™äº›å€¼ä¸­çš„ä»»ä½•ä¸€ä¸ªè¶…å‡ºé…ç½®çš„é˜ˆå€¼ï¼ŒèŠ‚ç‚¹å°†è¢«è„±æœºã€‚

**ä»£ç†** **ç®¡ç†** ä»£è¡¨Jenkinsæ§åˆ¶å™¨**æ‰§è¡Œä»»åŠ¡** **ä½¿ç”¨æ‰§è¡Œå™¨**ã€‚ä»£ç†å¯ä»¥ä½¿ç”¨æ”¯æŒJavaçš„ä»»ä½•æ“ä½œç³»ç»Ÿã€‚æ„å»ºå’Œæµ‹è¯•æ‰€éœ€çš„å·¥å…·å®‰è£…åœ¨ä»£ç†è¿è¡Œçš„èŠ‚ç‚¹ä¸Šï¼›å®ƒä»¬å¯ä»¥**ç›´æ¥å®‰è£…æˆ–åœ¨å®¹å™¨ä¸­å®‰è£…**ï¼ˆDockeræˆ–Kubernetesï¼‰ã€‚æ¯ä¸ª**ä»£ç†å®é™…ä¸Šæ˜¯å®¿ä¸»æœºä¸Šæ‹¥æœ‰è‡ªå·±PIDçš„è¿›ç¨‹**ã€‚

**æ‰§è¡Œå™¨**æ˜¯æ‰§è¡Œä»»åŠ¡çš„**æ§½**ï¼›å®é™…ä¸Šï¼Œå®ƒæ˜¯**ä»£ç†ä¸­çš„çº¿ç¨‹**ã€‚èŠ‚ç‚¹ä¸Šçš„**æ‰§è¡Œå™¨æ•°é‡**å®šä¹‰äº†å¯ä»¥åŒæ—¶åœ¨è¯¥èŠ‚ç‚¹ä¸Šæ‰§è¡Œçš„**å¹¶å‘ä»»åŠ¡æ•°é‡**ã€‚æ¢å¥è¯è¯´ï¼Œè¿™å†³å®šäº†å¯ä»¥åŒæ—¶åœ¨è¯¥èŠ‚ç‚¹ä¸Šæ‰§è¡Œçš„**å¹¶å‘Pipeline `stages`çš„æ•°é‡**ã€‚

## Jenkinsç§˜å¯†

### ç§˜å¯†å’Œå‡­è¯çš„åŠ å¯†

æ¥è‡ª[æ–‡æ¡£](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials)çš„å®šä¹‰ï¼š
Jenkinsä½¿ç”¨**AESåŠ å¯†å’Œä¿æŠ¤ç§˜å¯†**ã€å‡­è¯åŠå…¶å„è‡ªçš„åŠ å¯†å¯†é’¥ã€‚è¿™äº›åŠ å¯†å¯†é’¥å­˜å‚¨åœ¨`$JENKINS_HOME/secrets/`ä¸­ï¼Œè¿åŒç”¨äºä¿æŠ¤è¿™äº›å¯†é’¥çš„ä¸»å¯†é’¥ã€‚åº”é…ç½®æ­¤ç›®å½•ï¼Œä»¥ä¾¿åªæœ‰è¿è¡ŒJenkinsæ§åˆ¶å™¨çš„æ“ä½œç³»ç»Ÿç”¨æˆ·æ‰èƒ½å¯¹æ­¤ç›®å½•å…·æœ‰è¯»å†™æƒé™ï¼ˆå³ï¼Œ`chmod`å€¼ä¸º`0700`æˆ–ä½¿ç”¨é€‚å½“çš„æ–‡ä»¶å±æ€§ï¼‰ã€‚**ä¸»å¯†é’¥**ï¼ˆæœ‰æ—¶åœ¨åŠ å¯†æœ¯è¯­ä¸­ç§°ä¸º"å¯†é’¥åŠ å¯†å¯†é’¥"ï¼‰**æœªåŠ å¯†**åœ°å­˜å‚¨åœ¨Jenkinsæ§åˆ¶å™¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„**`$JENKINS_HOME/secrets/master.key`**ä¸­ï¼Œè¿™å¹¶ä¸èƒ½é˜²æ­¢ç›´æ¥è®¿é—®è¯¥æ–‡ä»¶çš„æ”»å‡»è€…ã€‚å¤§å¤šæ•°ç”¨æˆ·å’Œå¼€å‘äººå‘˜å°†é€šè¿‡[Secret](https://javadoc.jenkins.io/byShortName/Secret) APIï¼ˆç”¨äºåŠ å¯†é€šç”¨ç§˜å¯†æ•°æ®ï¼‰æˆ–é€šè¿‡å‡­è¯APIé—´æ¥ä½¿ç”¨è¿™äº›åŠ å¯†å¯†é’¥ã€‚å¯¹äºå¯¹åŠ å¯†æ„Ÿå…´è¶£çš„äººï¼ŒJenkinsä½¿ç”¨AESåœ¨å¯†ç å—é“¾æ¥ï¼ˆCBCï¼‰æ¨¡å¼ä¸‹ï¼Œå¸¦æœ‰PKCS#5å¡«å……å’ŒéšæœºIVæ¥åŠ å¯†[CryptoConfidentialKey](https://javadoc.jenkins.io/byShortName/CryptoConfidentialKey)çš„å®ä¾‹ï¼Œè¿™äº›å®ä¾‹å­˜å‚¨åœ¨`$JENKINS_HOME/secrets/`ä¸­ï¼Œæ–‡ä»¶åå¯¹åº”äºå®ƒä»¬çš„`CryptoConfidentialKey` idã€‚å¸¸è§çš„å¯†é’¥idåŒ…æ‹¬ï¼š

* `hudson.util.Secret`ï¼šç”¨äºé€šç”¨ç§˜å¯†ï¼›
* `com.cloudbees.plugins.credentials.SecretBytes.KEY`ï¼šç”¨äºæŸäº›å‡­è¯ç±»å‹ï¼›
* `jenkins.model.Jenkins.crumbSalt`ï¼šç”±[CSRFä¿æŠ¤æœºåˆ¶](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery)ä½¿ç”¨ï¼›ç­‰

### å‡­è¯è®¿é—®

å‡­è¯å¯ä»¥**é™å®šä¸ºå…¨å±€æä¾›è€…**ï¼ˆ`/credentials/`ï¼‰ï¼Œä»»ä½•é…ç½®çš„é¡¹ç›®éƒ½å¯ä»¥è®¿é—®ï¼Œæˆ–è€…å¯ä»¥é™å®šä¸º**ç‰¹å®šé¡¹ç›®**ï¼ˆ`/job/<project-name>/configure`ï¼‰ï¼Œå› æ­¤åªèƒ½ä»ç‰¹å®šé¡¹ç›®è®¿é—®ã€‚

æ ¹æ®[**æ–‡æ¡£**](https://www.jenkins.io/blog/2019/02/21/credentials-masking/)ï¼šåœ¨èŒƒå›´å†…çš„å‡­è¯å¯ä¾›æµæ°´çº¿æ— é™åˆ¶åœ°ä½¿ç”¨ã€‚ä¸ºäº†**é˜²æ­¢åœ¨æ„å»ºæ—¥å¿—ä¸­æ„å¤–æš´éœ²**ï¼Œå‡­è¯ä¼šä»å¸¸è§„è¾“å‡ºä¸­**æ©ç›–**ï¼Œå› æ­¤è°ƒç”¨`env`ï¼ˆLinuxï¼‰æˆ–`set`ï¼ˆWindowsï¼‰ï¼Œæˆ–æ‰“å°å…¶ç¯å¢ƒæˆ–å‚æ•°çš„ç¨‹åº**ä¸ä¼šåœ¨æ„å»ºæ—¥å¿—ä¸­å‘å¦åˆ™æ— æ³•è®¿é—®å‡­è¯çš„ç”¨æˆ·æ˜¾ç¤ºå®ƒä»¬**ã€‚

**è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ”»å‡»è€…éœ€è¦ä¾‹å¦‚å°†å‡­è¯base64ç¼–ç æ‰èƒ½çªƒå–å®ƒä»¬çš„åŸå› ã€‚**

## å‚è€ƒèµ„æ–™

* [https://www.jenkins.io/doc/book/security/managing-security/](https://www.jenkins.io/doc/book/security/managing-security/)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)
* [https://www.jenkins.io/doc/developer/security/secrets/](https://www.jenkins.io/doc/developer/security/secrets/)
* [https://www.jenkins.io/blog/2019/02/21/credentials-masking/](https://www.jenkins.io/blog/2019/02/21/credentials-masking/)
* [https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery)
* [https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºè‹±é›„</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
