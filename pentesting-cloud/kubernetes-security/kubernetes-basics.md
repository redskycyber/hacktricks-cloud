# Î’Î±ÏƒÎ¹ÎºÎ¬ Ï„Î¿Ï… Kubernetes

## Î’Î±ÏƒÎ¹ÎºÎ¬ Ï„Î¿Ï… Kubernetes

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº Ï„Î¿Ï… AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ HackTricks:

* Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**Ï„Î·Î½ ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Îµ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>

**ÎŸ Î±ÏÏ‡Î¹ÎºÏŒÏ‚ ÏƒÏ…Î³Î³ÏÎ±Ï†Î­Î±Ï‚ Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÏƒÎµÎ»Î¯Î´Î±Ï‚ ÎµÎ¯Î½Î±Î¹** [**Jorge**](https://www.linkedin.com/in/jorge-belmonte-a924b616b/) **(Î´Î¹Î±Î²Î¬ÏƒÏ„Îµ Ï„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ® Ï„Î¿Ï… Î±Î½Î¬ÏÏ„Î·ÏƒÎ·** [**ÎµÎ´Ï**](https://sickrov.github.io)**)**

## Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ® & Î’Î±ÏƒÎ¹ÎºÎ¬

### Î¤Î¹ ÎºÎ¬Î½ÎµÎ¹ Ï„Î¿ Kubernetes;

* Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· ÎµÎ½ÏŒÏ‚ Î® Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÏ‰Î½ containers ÏƒÎµ Î­Î½Î±Î½ ÎºÎ¹Î½Î·Ï„Î®ÏÎ± container.
* ÎŸ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒÏ‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ Î±Ï€Î¿ÏƒÏ„Î¿Î»Î® Ï„Ï‰Î½ containers Î¼Îµ Î±Ï€Î¿Î´Î¿Ï„Î¹ÎºÏŒ Ï„ÏÏŒÏ€Î¿.
* Î”Î¹Î±Ï„Î·ÏÎµÎ¯ Ï„Î± containers ÎµÎ½ÎµÏÎ³Î¬.
* Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Î¼ÎµÏ„Î±Î¾Ï Ï„Ï‰Î½ containers.
* Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ Î±Î½Î±Ï€Ï„ÏÎ¾ÎµÏ‰Î½.
* Î”Î¹Î±Ï‡ÎµÎ¹ÏÎ¯Î¶ÎµÏ„Î±Î¹ ÏŒÎ³ÎºÎ¿Ï…Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½.

### Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ®

![](https://sickrov.github.io/media/Screenshot-68.jpg)

* **ÎšÏŒÎ¼Î²Î¿Ï‚ (Node)**: Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒ ÏƒÏÏƒÏ„Î·Î¼Î± Î¼Îµ pod Î® pods.
* **Pod**: Î ÎµÏÎ¹Ï„ÏÎ»Î¹Î³Î¼Î± Î³ÏÏÏ‰ Î±Ï€ÏŒ Î­Î½Î± container Î® Ï€Î¿Î»Î»Î±Ï€Î»Î¬ containers. ÎˆÎ½Î± pod Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î¼ÏŒÎ½Î¿ Î¼Î¯Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î® (ÏƒÏ…Î½Î®Î¸Ï‰Ï‚, Î­Î½Î± pod ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Î¼ÏŒÎ½Î¿ 1 container). Î¤Î¿ pod ÎµÎ¯Î½Î±Î¹ Î¿ Ï„ÏÏŒÏ€Î¿Ï‚ Î¼Îµ Ï„Î¿Î½ Î¿Ï€Î¿Î¯Î¿ Ï„Î¿ Kubernetes Î±Ï†Î±Î¹ÏÎµÎ¯ Ï„Î·Î½ Ï„ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯Î± container Ï€Î¿Ï… ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹.
* **Î¥Ï€Î·ÏÎµÏƒÎ¯Î± (Service)**: ÎšÎ¬Î¸Îµ pod Î­Ï‡ÎµÎ¹ 1 ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® **Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP** Î±Ï€ÏŒ Ï„Î·Î½ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® Ï€ÎµÏÎ¹Î¿Ï‡Î® Ï„Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï…. Î©ÏƒÏ„ÏŒÏƒÎ¿, Î¼Ï€Î¿ÏÎµÎ¯ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± ÎµÎºÏ„Î¯Î¸ÎµÏ„Î±Î¹ Î¼Î­ÏƒÏ‰ Î¼Î¹Î±Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚. Î— **Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Î­Ï‡ÎµÎ¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP** ÎºÎ±Î¹ Î¿ ÏƒÏ„ÏŒÏ‡Î¿Ï‚ Ï„Î·Ï‚ ÎµÎ¯Î½Î±Î¹ Î½Î± Î´Î¹Î±Ï„Î·ÏÎµÎ¯ Ï„Î·Î½ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Î¼ÎµÏ„Î±Î¾Ï Ï„Ï‰Î½ pods, Î­Ï„ÏƒÎ¹ ÏÏƒÏ„Îµ ÎµÎ¬Î½ Î­Î½Î± Ï€ÎµÎ¸Î±Î¯Î½ÎµÎ¹, Ï„Î¿ **Î½Î­Î¿ Î±Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î±Î¸Î­Î½** (Î¼Îµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ® ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® IP) **Î¸Î± ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼Î¿** ÎºÎ±Î¹ Î¸Î± ÎµÎºÏ„Î¯Î¸ÎµÏ„Î±Î¹ ÏƒÏ„Î·Î½ **Î¯Î´Î¹Î± IP Ï„Î·Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚**. ÎœÏ€Î¿ÏÎµÎ¯ Î½Î± ÏÏ…Î¸Î¼Î¹ÏƒÏ„ÎµÎ¯ Ï‰Ï‚ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® Î® ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ®. Î— Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÎµÏ€Î¯ÏƒÎ·Ï‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Ï‰Ï‚ **ÎµÎ¾Î¹ÏƒÎ¿ÏÏÎ¿Ï€Î·Ï„Î®Ï‚ Ï†Î¿ÏÏ„Î¯Î¿Ï… ÏŒÏ„Î±Î½ 2 pods ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î±** ÏƒÏ„Î·Î½ Î¯Î´Î¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯Î±.\
ÎŒÏ„Î±Î½ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ Î¼Î¹Î± **Ï…Ï€Î·ÏÎµÏƒÎ¯Î±** Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î± ÏƒÎ·Î¼ÎµÎ¯Î± Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÎºÎ¬Î¸Îµ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚ ÎµÎºÏ„ÎµÎ»ÏÎ½Ï„Î±Ï‚ `kubectl get endpoints`
* **Kubelet**: ÎšÏÏÎ¹Î¿Ï‚ Ï€ÏÎ¬ÎºÏ„Î¿ÏÎ±Ï‚ ÎºÏŒÎ¼Î²Î¿Ï…. ÎŸ ÏƒÏ…ÏƒÏ„Î±Ï„Î¹ÎºÏŒÏ‚ Ï€Î¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Î¼ÎµÏ„Î±Î¾Ï Ï„Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï… ÎºÎ±Î¹ Ï„Î¿Ï… kubectl, ÎºÎ±Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Î¼ÏŒÎ½Î¿ pods (Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… API server). Î¤Î¿ kubelet Î´ÎµÎ½ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¯Î¶ÎµÏ„Î±Î¹ containers Ï€Î¿Ï… Î´ÎµÎ½ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎ±Î½ Î±Ï€ÏŒ Ï„Î¿ Kubernetes.
* **Kube-proxy**: Î•Î¯Î½Î±Î¹ Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Ï€Î¿Ï… Î±Î½Î±Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î¹Ï‚ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯ÎµÏ‚ (Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚) Î¼ÎµÏ„Î±Î¾Ï Ï„Î¿Ï… apiserver ÎºÎ±Î¹ Ï„Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï…. Î’Î±ÏƒÎ¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ IPtables Î³Î¹Î± Ï„Î¿Ï…Ï‚ ÎºÏŒÎ¼Î²Î¿Ï…Ï‚. ÎŸÎ¹ Ï€Î¹Î¿ Î­Î¼Ï€ÎµÎ¹ÏÎ¿Î¹ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÎ³ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎ¿Ï…Î½ Î¬Î»Î»Î¿Ï…Ï‚ kube-proxy Î±Ï€ÏŒ Î¬Î»Î»Î¿Ï…Ï‚ Ï€ÏÎ¿Î¼Î·Î¸ÎµÏ…Ï„Î­Ï‚.
* **Sidecar container**: Î¤Î± sidecar containers ÎµÎ¯Î½Î±Î¹ Ï„Î± containers Ï€Î¿Ï… Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ Î¼Î±Î¶Î¯ Î¼Îµ Ï„Î¿ ÎºÏÏÎ¹Î¿ container ÏƒÏ„Î¿ pod. Î‘Ï…Ï„ÏŒ Ï„Î¿ Ï€ÏÏŒÏ„Ï…Ï€Î¿ sidecar ÎµÏ€ÎµÎºÏ„ÎµÎ¯Î½Îµ
### Î¥Ï€Î¿Î´Î¿Î¼Î® PKI - Î‘ÏÏ‡Î® Î Î¹ÏƒÏ„Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ Î Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÏÎ½ CA:

![](https://sickrov.github.io/media/Screenshot-66.jpg)

* Î— CA ÎµÎ¯Î½Î±Î¹ Î· Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„Î· ÏÎ¯Î¶Î± Î³Î¹Î± ÏŒÎ»Î± Ï„Î± Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÎ¬ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ cluster.
* Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± Î½Î± ÎµÏ€Î¹ÎºÏ…ÏÏÎ½Î¿Î½Ï„Î±Î¹ Î¼ÎµÏ„Î±Î¾Ï Ï„Î¿Ï…Ï‚.
* ÎŒÎ»Î± Ï„Î± Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÎ¬ Ï„Î¿Ï… cluster Ï…Ï€Î¿Î³ÏÎ¬Ï†Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î·Î½ CA.
* Î¤Î¿ ETCd Î­Ï‡ÎµÎ¹ Ï„Î¿ Î´Î¹ÎºÏŒ Ï„Î¿Ï… Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÏŒ.
* Î¤ÏÏ€Î¿Î¹:
* Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÏŒ apiserver.
* Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÏŒ kubelet.
* Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÏŒ scheduler.

## Î’Î±ÏƒÎ¹ÎºÎ­Ï‚ Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚

### Minikube

Î¤Î¿ **Minikube** Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î³Î¹Î± Î½Î± Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ **Î³ÏÎ®Î³Î¿ÏÎµÏ‚ Î´Î¿ÎºÎ¹Î¼Î­Ï‚** ÏƒÏ„Î¿ Kubernetes Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± Î±Î½Î±Ï€Ï„ÏÎ¾ÎµÏ„Îµ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½ Kubernetes. Î˜Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Ï„Î¹Ï‚ Î´Î¹ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ master ÎºÎ±Î¹ node ÏƒÎµ Î­Î½Î± Î¼Î·Ï‡Î¬Î½Î·Î¼Î±. Î¤Î¿ Minikube Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î¿ virtualbox Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Ï„Î¿Î½ ÎºÏŒÎ¼Î²Î¿. Î”ÎµÎ¯Ï„Îµ [**ÎµÎ´Ï Ï€ÏÏ‚ Î½Î± Ï„Î¿ ÎµÎ³ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÏ„Îµ**](https://minikube.sigs.k8s.io/docs/start/).
```
$ minikube start
ğŸ˜„  minikube v1.19.0 on Ubuntu 20.04
âœ¨  Automatically selected the virtualbox driver. Other choices: none, ssh
ğŸ’¿  Downloading VM boot image ...
> minikube-v1.19.0.iso.sha256: 65 B / 65 B [-------------] 100.00% ? p/s 0s
> minikube-v1.19.0.iso: 244.49 MiB / 244.49 MiB  100.00% 1.78 MiB p/s 2m17.
ğŸ‘  Starting control plane node minikube in cluster minikube
ğŸ’¾  Downloading Kubernetes v1.20.2 preload ...
> preloaded-images-k8s-v10-v1...: 491.71 MiB / 491.71 MiB  100.00% 2.59 MiB
ğŸ”¥  Creating virtualbox VM (CPUs=2, Memory=3900MB, Disk=20000MB) ...
ğŸ³  Preparing Kubernetes v1.20.2 on Docker 20.10.4 ...
â–ª Generating certificates and keys ...
â–ª Booting up control plane ...
â–ª Configuring RBAC rules ...
ğŸ”  Verifying Kubernetes components...
â–ª Using image gcr.io/k8s-minikube/storage-provisioner:v5
ğŸŒŸ  Enabled addons: storage-provisioner, default-storageclass
ğŸ„  Done! kubectl is now configured to use "minikube" cluster and "default" namespace by defaul

$ minikube status
host: Running
kubelet: Running
apiserver: Running
kubeconfig: Configured

---- ONCE YOU HAVE A K8 SERVICE RUNNING WITH AN EXTERNAL SERVICE -----
$ minikube service mongo-express-service
(This will open your browser to access the service exposed port)

$ minikube delete
ğŸ”¥  Deleting "minikube" in virtualbox ...
ğŸ’€  Removed all traces of the "minikube" cluster
```
### Î’Î±ÏƒÎ¹ÎºÎ¬ Ï„Î¿Ï… Kubectl

Î¤Î¿ **`Kubectl`** ÎµÎ¯Î½Î±Î¹ Ï„Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ Î³ÏÎ±Î¼Î¼Î®Ï‚ ÎµÎ½Ï„Î¿Î»ÏÎ½ Î³Î¹Î± Ï„Î± ÎºÎ±Ï„Î±Î½ÎµÎ¼Î·Î¼Î­Î½Î± ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î± Kubernetes. Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½ÎµÎ¯ Î¼Îµ Ï„Î¿Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® Api Ï„Î·Ï‚ ÎºÏÏÎ¹Î±Ï‚ Î´Î¹ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚ Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ ÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ ÏƒÏ„Î¿ Kubernetes Î® Î½Î± Î¶Î·Ï„Î®ÏƒÎµÎ¹ Î´ÎµÎ´Î¿Î¼Î­Î½Î±.
```bash
kubectl version #Get client and server version
kubectl get pod
kubectl get services
kubectl get deployment
kubectl get replicaset
kubectl get secret
kubectl get all
kubectl get ingress
kubectl get endpoints

#kubectl create deployment <deployment-name> --image=<docker image>
kubectl create deployment nginx-deployment --image=nginx
#Access the configuration of the deployment and modify it
#kubectl edit deployment <deployment-name>
kubectl edit deployment nginx-deployment
#Get the logs of the pod for debbugging (the output of the docker container running)
#kubectl logs <replicaset-id/pod-id>
kubectl logs nginx-deployment-84cd76b964
#kubectl describe pod <pod-id>
kubectl describe pod mongo-depl-5fd6b7d4b4-kkt9q
#kubectl exec -it <pod-id> -- bash
kubectl exec -it mongo-depl-5fd6b7d4b4-kkt9q -- bash
#kubectl describe service <service-name>
kubectl describe service mongodb-service
#kubectl delete deployment <deployment-name>
kubectl delete deployment mongo-depl
#Deploy from config file
kubectl apply -f deployment.yml
```
### Î Î¯Î½Î±ÎºÎ±Ï‚ ÎµÎ»Î­Î³Ï‡Î¿Ï… Minikube

ÎŸ Ï€Î¯Î½Î±ÎºÎ±Ï‚ ÎµÎ»Î­Î³Ï‡Î¿Ï… ÏƒÎ±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± Î²Î»Î­Ï€ÎµÏ„Îµ ÎµÏ…ÎºÎ¿Î»ÏŒÏ„ÎµÏÎ± Ï„Î¹ ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ ÏƒÏ„Î¿ Minikube, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î¿ URL Î³Î¹Î± Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î±Ï…Ï„ÏŒ ÏƒÏ„Î¿:
```
minikube dashboard --url


ğŸ”Œ  Enabling dashboard ...
â–ª Using image kubernetesui/dashboard:v2.3.1
â–ª Using image kubernetesui/metrics-scraper:v1.0.7
ğŸ¤”  Verifying dashboard health ...
ğŸš€  Launching proxy ...
ğŸ¤”  Verifying proxy health ...
http://127.0.0.1:50034/api/v1/namespaces/kubernetes-dashboard/services/http:kubernetes-dashboard:/proxy/
```
### Î Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± Î±ÏÏ‡ÎµÎ¯Ï‰Î½ ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ YAML

ÎšÎ¬Î¸Îµ Î±ÏÏ‡ÎµÎ¯Î¿ ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ Î­Ï‡ÎµÎ¹ 3 Î¼Î­ÏÎ·: **metadata**, **specification** (Ï„Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎºÎºÎ¹Î½Î·Î¸ÎµÎ¯), **status** (ÎµÏ€Î¹Î¸Ï…Î¼Î·Ï„Î® ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·).\
ÎœÎ­ÏƒÎ± ÏƒÏ„Î·Î½ Ï€ÏÎ¿Î´Î¹Î±Î³ÏÎ±Ï†Î® Ï„Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï… ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ Ï„Î·Ï‚ Î±Î½Î±Ï€Ï„Ï…Î¾Î¹Î±ÎºÎ®Ï‚ Î´Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ·Ï‚ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î¿ Ï€ÏÏŒÏ„Ï…Ï€Î¿ Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÏ„ÎµÎ¯ Î¼Îµ Î¼Î¹Î± Î½Î­Î± Î´Î¿Î¼Î® ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ Ï€Î¿Ï… ÎºÎ±Î¸Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î·Î½ ÎµÎ¹ÎºÏŒÎ½Î± Ï€Î¿Ï… Î¸Î± ÎµÎºÏ„ÎµÎ»ÎµÏƒÏ„ÎµÎ¯:

**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î±Î½Î±Ï€Ï„Ï…Î¾Î¹Î±ÎºÎ®Ï‚ Î´Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ·Ï‚ + Î¥Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚ Ï€Î¿Ï… Î´Î·Î»ÏÎ½Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ Î¯Î´Î¹Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ (Î±Ï€ÏŒ** [**ÎµÎ´Ï**](https://gitlab.com/nanuchi/youtube-tutorial-series/-/blob/master/demo-kubernetes-components/mongo.yaml)**)**

ÎšÎ±Î¸ÏÏ‚ Î¼Î¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ ÏƒÏ‡ÎµÏ„Î¯Î¶ÎµÏ„Î±Î¹ Î¼Îµ Î¼Î¹Î± Î±Î½Î¬Ï€Ï„Ï…Î¾Î·, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Î´Î·Î»Ï‰Î¸Î¿ÏÎ½ ÎºÎ±Î¹ Î¿Î¹ Î´ÏÎ¿ ÏƒÏ„Î¿ Î¯Î´Î¹Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ (Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Ï€Î¿Ï… Î´Î·Î»ÏÎ½ÎµÏ„Î±Î¹ ÏƒÎµ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ ÏÏÎ¸Î¼Î¹ÏƒÎ· ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼Î· Î¼ÏŒÎ½Î¿ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ¬):
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
name: mongodb-deployment
labels:
app: mongodb
spec:
replicas: 1
selector:
matchLabels:
app: mongodb
template:
metadata:
labels:
app: mongodb
spec:
containers:
- name: mongodb
image: mongo
ports:
- containerPort: 27017
env:
- name: MONGO_INITDB_ROOT_USERNAME
valueFrom:
secretKeyRef:
name: mongodb-secret
key: mongo-root-username
- name: MONGO_INITDB_ROOT_PASSWORD
valueFrom:
secretKeyRef:
name: mongodb-secret
key: mongo-root-password
---
apiVersion: v1
kind: Service
metadata:
name: mongodb-service
spec:
selector:
app: mongodb
ports:
- protocol: TCP
port: 27017
targetPort: 27017
```
**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ®Ï‚ Î´Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ·Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚**

Î‘Ï…Ï„Î® Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Î¸Î± ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼Î· ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ¬ (ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬ `nodePort` ÎºÎ±Î¹ `type: LoadBalancer`):
```yaml
---
apiVersion: v1
kind: Service
metadata:
name: mongo-express-service
spec:
selector:
app: mongo-express
type: LoadBalancer
ports:
- protocol: TCP
port: 8081
targetPort: 8081
nodePort: 30000
```
{% hint style="info" %}
Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï‡ÏÎ®ÏƒÎ¹Î¼Î¿ Î³Î¹Î± Î´Î¿ÎºÎ¹Î¼Î­Ï‚, Î±Î»Î»Î¬ Î³Î¹Î± Ï€Î±ÏÎ±Î³Ï‰Î³Î® Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î­Ï‡ÎµÏ„Îµ Î¼ÏŒÎ½Î¿ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ ÎºÎ±Î¹ Î­Î½Î± Ingress Î³Î¹Î± Î½Î± ÎµÎºÎ¸Î­ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®.
{% endhint %}

**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î±ÏÏ‡ÎµÎ¯Î¿Ï… ÏÏÎ¸Î¼Î¹ÏƒÎ·Ï‚ Ingress**

Î‘Ï…Ï„ÏŒ Î¸Î± ÎµÎºÎ¸Î­ÏƒÎµÎ¹ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÏƒÏ„Î¿ `http://dashboard.com`.
```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
name: dashboard-ingress
namespace: kubernetes-dashboard
spec:
rules:
- host: dashboard.com
http:
paths:
- backend:
serviceName: kubernetes-dashboard
servicePort: 80
```
**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î±ÏÏ‡ÎµÎ¯Î¿Ï… ÏÏÎ¸Î¼Î¹ÏƒÎ·Ï‚ Î¼Ï…ÏƒÏ„Î¹ÎºÏÎ½**

Î Î±ÏÎ±Ï„Î·ÏÎ®ÏƒÏ„Îµ Ï€ÏÏ‚ Î¿Î¹ ÎºÏ‰Î´Î¹ÎºÎ¿Î¯ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ ÏƒÎµ B64 (Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î±ÏƒÏ†Î±Î»Î­Ï‚!)
```yaml
apiVersion: v1
kind: Secret
metadata:
name: mongodb-secret
type: Opaque
data:
mongo-root-username: dXNlcm5hbWU=
mongo-root-password: cGFzc3dvcmQ=
```
**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Ï„Î¿Ï… ConfigMap**

ÎˆÎ½Î± **ConfigMap** ÎµÎ¯Î½Î±Î¹ Î· Î´Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ· Ï€Î¿Ï… Î´Î¯Î½ÎµÏ„Î±Î¹ ÏƒÏ„Î± pods ÏÏƒÏ„Îµ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶Î¿Ï…Î½ Ï€ÏÏ‚ Î½Î± ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎ¿Ï…Î½ ÎºÎ±Î¹ Î½Î± Î­Ï‡Î¿Ï…Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î¬Î»Î»ÎµÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚. Î£Îµ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·, ÎºÎ¬Î¸Îµ pod Î¸Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± `mongodb-service` ÎµÎ¯Î½Î±Î¹ Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÎµÎ½ÏŒÏ‚ pod Î¼Îµ Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î®ÏƒÎµÎ¹ (Î±Ï…Ï„ÏŒ Ï„Î¿ pod Î¸Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Î­Î½Î± mongodb):
```yaml
apiVersion: v1
kind: ConfigMap
metadata:
name: mongodb-configmap
data:
database_url: mongodb-service
```
Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î± **deployment config**, Î±Ï…Ï„Î® Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÏ„ÎµÎ¯ Î¼Îµ Ï„Î¿Î½ ÎµÎ¾Î®Ï‚ Ï„ÏÏŒÏ€Î¿, ÏÏƒÏ„Îµ Î½Î± Ï†Î¿ÏÏ„ÏÎ½ÎµÏ„Î±Î¹ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½ Ï„Î¿Ï… pod:
```yaml
[...]
spec:
[...]
template:
[...]
spec:
containers:
- name: mongo-express
image: mongo-express
ports:
- containerPort: 8081
env:
- name: ME_CONFIG_MONGODB_SERVER
valueFrom:
configMapKeyRef:
name: mongodb-configmap
key: database_url
[...]
```
**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ÏÏÎ¸Î¼Î¹ÏƒÎ·Ï‚ ÏŒÎ³ÎºÎ¿Ï…**

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î´Î¹Î¬Ï†Î¿ÏÎ± Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± Î±ÏÏ‡ÎµÎ¯Ï‰Î½ ÏÏÎ¸Î¼Î¹ÏƒÎ·Ï‚ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·Ï‚ ÏƒÎµ Î¼Î¿ÏÏ†Î® yaml ÏƒÏ„Î¿ [https://gitlab.com/nanuchi/youtube-tutorial-series/-/tree/master/kubernetes-volumes](https://gitlab.com/nanuchi/youtube-tutorial-series/-/tree/master/kubernetes-volumes).\
**Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î¿Î¹ ÏŒÎ³ÎºÎ¿Î¹ Î´ÎµÎ½ Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Î¹ Î¼Î­ÏƒÎ± ÏƒÏ„Î± namespaces**

### Namespaces

Î¤Î¿ Kubernetes Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ **Ï€Î¿Î»Î»Î±Ï€Î»Î¬ ÎµÎ¹ÎºÎ¿Î½Î¹ÎºÎ¬ clusters** Ï€Î¿Ï… Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ Î¯Î´Î¹Î¿ Ï†Ï…ÏƒÎ¹ÎºÏŒ cluster. Î‘Ï…Ï„Î¬ Ï„Î± ÎµÎ¹ÎºÎ¿Î½Î¹ÎºÎ¬ clusters Î¿Î½Î¿Î¼Î¬Î¶Î¿Î½Ï„Î±Î¹ **namespaces**. Î‘Ï…Ï„Î¬ Ï€ÏÎ¿Î¿ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î³Î¹Î± Ï‡ÏÎ®ÏƒÎ· ÏƒÎµ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î± Î¼Îµ Ï€Î¿Î»Î»Î¿ÏÏ‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±ÏƒÎºÎ¿ÏÏ€Î¹ÏƒÎ¼Î­Î½Î¿Î¹ ÏƒÎµ Ï€Î¿Î»Î»Î­Ï‚ Î¿Î¼Î¬Î´ÎµÏ‚ Î® Î­ÏÎ³Î±. Î“Î¹Î± clusters Î¼Îµ Î»Î¯Î³Î¿Ï…Ï‚ Î­Ï‰Ï‚ Î´ÎµÎºÎ¬Î´ÎµÏ‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚, Î´ÎµÎ½ Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î® Î½Î± ÏƒÎºÎµÏ†Ï„ÎµÎ¯Ï„Îµ Î³Î¹Î± Ï„Î± namespaces ÎºÎ±Î¸ÏŒÎ»Î¿Ï…. Î˜Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î¼ÏŒÎ½Î¿ Î½Î± Î±ÏÏ‡Î¯ÏƒÎµÏ„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Îµ Ï„Î± namespaces Î³Î¹Î± Î½Î± Î­Ï‡ÎµÏ„Îµ ÎºÎ±Î»ÏÏ„ÎµÏÎ¿ Î­Î»ÎµÎ³Ï‡Î¿ ÎºÎ±Î¹ Î¿ÏÎ³Î¬Î½Ï‰ÏƒÎ· ÎºÎ¬Î¸Îµ Î¼Î­ÏÎ¿Ï…Ï‚ Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ Î±Î½Î±Ï€Ï„Ï…Ï‡Î¸ÎµÎ¯ ÏƒÏ„Î¿ Kubernetes.

Î¤Î± namespaces Ï€Î±ÏÎ­Ï‡Î¿Ï…Î½ Î­Î½Î± Ï€ÎµÎ´Î¯Î¿ Î¿ÏÎ±Ï„ÏŒÏ„Î·Ï„Î±Ï‚ Î³Î¹Î± Ï„Î± Î¿Î½ÏŒÎ¼Î±Ï„Î±. Î¤Î± Î¿Î½ÏŒÎ¼Î±Ï„Î± Ï„Ï‰Î½ Ï€ÏŒÏÏ‰Î½ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î¿Î½Î±Î´Î¹ÎºÎ¬ ÎµÎ½Ï„ÏŒÏ‚ ÎµÎ½ÏŒÏ‚ namespace, Î±Î»Î»Î¬ ÏŒÏ‡Î¹ Î±Î½Î¬Î¼ÎµÏƒÎ± ÏƒÎµ Î´Î¹Î¬Ï†Î¿ÏÎ± namespaces. Î¤Î± namespaces Î´ÎµÎ½ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÎ¯Î½Î±Î¹ ÎµÎ¼Ï†Ï‰Î»ÎµÏ…Î¼Î­Î½Î± Î¼Î­ÏƒÎ± ÏƒÎµ Î¬Î»Î»Î± ÎºÎ±Î¹ **ÎºÎ¬Î¸Îµ** Ï€ÏŒÏÎ¿Ï‚ Ï„Î¿Ï… Kubernetes Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ Î¼ÏŒÎ½Î¿ **ÏƒÎµ Î­Î½Î±** **namespace**.

Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ 4 namespaces Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î® Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Îµ Ï„Î¿ minikube:
```
kubectl get namespace
NAME              STATUS   AGE
default           Active   1d
kube-node-lease   Active   1d
kube-public       Active   1d
kube-system       Active   1d
```
* **kube-system**: Î”ÎµÎ½ Ï€ÏÎ¿Î¿ÏÎ¯Î¶ÎµÏ„Î±Î¹ Î³Î¹Î± Ï‡ÏÎ®ÏƒÎ· Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ ÎºÎ±Î¹ Î´ÎµÎ½ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿ Î±Î³Î³Î¯Î¾ÎµÏ„Îµ. Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Ï„Î¹Ï‚ Î´Î¹ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ Ï„Î¿Ï… master ÎºÎ±Î¹ Ï„Î¿Ï… kubectl.
* **kube-public**: Î”Î·Î¼ÏŒÏƒÎ¹Î± Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±. Î ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î­Î½Î± configmap Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î³Î¹Î± Ï„Î¿ cluster.
* **kube-node-lease**: ÎšÎ±Î¸Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î· Î´Î¹Î±Î¸ÎµÏƒÎ¹Î¼ÏŒÏ„Î·Ï„Î± ÎµÎ½ÏŒÏ‚ ÎºÏŒÎ¼Î²Î¿Ï….
* **default**: Î¤Î¿ namespace Ï€Î¿Ï… Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Î³Î¹Î± Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï€ÏŒÏÏ‰Î½.
```bash
#Create namespace
kubectl create namespace my-namespace
```
{% hint style="info" %}
Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î¿Î¹ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ¿Î¹ Ï€ÏŒÏÎ¿Î¹ Ï„Î¿Ï… Kubernetes (Ï€.Ï‡. pods, services, replication controllers ÎºÎ±Î¹ Î¬Î»Î»Î¿Î¹) Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Î¹ ÏƒÎµ Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î± namespaces. Î©ÏƒÏ„ÏŒÏƒÎ¿, Î¬Î»Î»Î¿Î¹ Ï€ÏŒÏÎ¿Î¹ ÏŒÏ€Ï‰Ï‚ Î¿Î¹ Ï€ÏŒÏÎ¿Î¹ Ï„Ï‰Î½ namespaces ÎºÎ±Î¹ Î¿Î¹ Ï‡Î±Î¼Î·Î»Î¿Ï ÎµÏ€Î¹Ï€Î­Î´Î¿Ï… Ï€ÏŒÏÎ¿Î¹, ÏŒÏ€Ï‰Ï‚ Î¿Î¹ ÎºÏŒÎ¼Î²Î¿Î¹ ÎºÎ±Î¹ Î¿Î¹ persistenVolumes, Î´ÎµÎ½ Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Î¹ ÏƒÎµ Î­Î½Î± namespace. Î“Î¹Î± Î½Î± Î´ÎµÎ¯Ï„Îµ Ï€Î¿Î¹Î¿Î¹ Ï€ÏŒÏÎ¿Î¹ Ï„Î¿Ï… Kubernetes ÎµÎ¯Î½Î±Î¹ ÎºÎ±Î¹ Ï€Î¿Î¹Î¿Î¹ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÎµ Î­Î½Î± namespace:
```bash
kubectl api-resources --namespaced=true #In a namespace
kubectl api-resources --namespaced=false #Not in a namespace
```
{% endhint %}

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏƒÎµÏ„Îµ Ï„Î¿ namespace Î³Î¹Î± ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÎµÏ€ÏŒÎ¼ÎµÎ½ÎµÏ‚ ÎµÎ½Ï„Î¿Î»Î­Ï‚ kubectl ÏƒÎµ Î±Ï…Ï„ÏŒ Ï„Î¿ Ï€Î»Î±Î¯ÏƒÎ¹Î¿.
```bash
kubectl config set-context --current --namespace=<insert-namespace-name-here>
```
### Helm

Î¤Î¿ Helm ÎµÎ¯Î½Î±Î¹ Î¿ **Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Ï€Î±ÎºÎ­Ï„Ï‰Î½** Î³Î¹Î± Ï„Î¿ Kubernetes. Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ ÏƒÏ…ÏƒÎºÎµÏ…Î±ÏƒÎ¯Î± Ï„Ï‰Î½ Î±ÏÏ‡ÎµÎ¯Ï‰Î½ YAML ÎºÎ±Î¹ Ï„Î· Î´Î¹Î±Î½Î¿Î¼Î® Ï„Î¿Ï…Ï‚ ÏƒÎµ Î´Î·Î¼ÏŒÏƒÎ¹Î¿Ï…Ï‚ ÎºÎ±Î¹ Î¹Î´Î¹Ï‰Ï„Î¹ÎºÎ¿ÏÏ‚ Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î¿Ï…Ï‚. Î‘Ï…Ï„Î¬ Ï„Î± Ï€Î±ÎºÎ­Ï„Î± Î¿Î½Î¿Î¼Î¬Î¶Î¿Î½Ï„Î±Î¹ **Helm Charts**.
```
helm search <keyword>
```
Î¤Î¿ Helm ÎµÎ¯Î½Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î­Î½Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½ Ï€Î¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î±ÏÏ‡ÎµÎ¯Ï‰Î½ ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ Î¼Îµ Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î­Ï‚:

## ÎœÏ…ÏƒÏ„Î¹ÎºÎ¬ Ï„Î¿Ï… Kubernetes

ÎˆÎ½Î± **ÎœÏ…ÏƒÏ„Î¹ÎºÏŒ** ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€Î¿Ï… **Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±** ÏŒÏ€Ï‰Ï‚ Î­Î½Î±Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚, Î­Î½Î± Ï„Î¿ÎºÎ­Î½ Î® Î­Î½Î± ÎºÎ»ÎµÎ¹Î´Î¯. Î¤Î­Ï„Î¿Î¹ÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î½ Î±Î»Î»Î¹ÏÏ‚ Î½Î± Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·Î¸Î¿ÏÎ½ ÏƒÎµ Î¼Î¹Î± Ï€ÏÎ¿Î´Î¹Î±Î³ÏÎ±Ï†Î® Pod Î® ÏƒÎµ Î¼Î¹Î± ÎµÎ¹ÎºÏŒÎ½Î±. ÎŸÎ¹ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎ¿Ï…Î½ ÎœÏ…ÏƒÏ„Î¹ÎºÎ¬ ÎºÎ±Î¹ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ ÎµÏ€Î¯ÏƒÎ·Ï‚ ÎœÏ…ÏƒÏ„Î¹ÎºÎ¬. Î¤Î¿ ÏŒÎ½Î¿Î¼Î± ÎµÎ½ÏŒÏ‚ Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… ÎœÏ…ÏƒÏ„Î¹ÎºÎ¿Ï Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Î­Î³ÎºÏ…ÏÎ¿ **DNS Ï…Ï€Î¿Ï„Î¿Î¼Î­Î±Ï‚**. Î”Î¹Î±Î²Î¬ÏƒÏ„Îµ ÎµÎ´Ï [Ï„Î·Î½ ÎµÏ€Î¯ÏƒÎ·Î¼Î· Ï„ÎµÎºÎ¼Î·ÏÎ¯Ï‰ÏƒÎ·](https://kubernetes.io/docs/concepts/configuration/secret/).

Î¤Î± ÎœÏ…ÏƒÏ„Î¹ÎºÎ¬ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¬Î³Î¼Î±Ï„Î± ÏŒÏ€Ï‰Ï‚:

* ÎšÎ»ÎµÎ¹Î´Î¹Î¬ API, SSH.
* Î¤Î¿ÎºÎ­Î½ OAuth.
* Î”Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±, ÎšÏ‰Î´Î¹ÎºÎ¿Î¯ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ (ÎºÎ±Î½Î¿Î½Î¹ÎºÏŒ ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Î® b64 + ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ¬Ï†Î·ÏƒÎ·).
* Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î® ÏƒÏ‡ÏŒÎ»Î¹Î±.
* ÎšÏÎ´Î¹ÎºÎ±Ï‚ ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚ Î²Î¬ÏƒÎ·Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½, ÏƒÏ…Î¼Î²Î¿Î»Î¿ÏƒÎµÎ¹ÏÎ­Ï‚... .

Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î´Î¹Î¬Ï†Î¿ÏÎ¿Î¹ Ï„ÏÏ€Î¿Î¹ Î¼Ï…ÏƒÏ„Î¹ÎºÏÎ½ ÏƒÏ„Î¿ Kubernetes

| Î•Î½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½Î¿Ï‚ Î¤ÏÏ€Î¿Ï‚                    | Î§ÏÎ®ÏƒÎ·                                      |
| ----------------------------------- | ----------------------------------------- |
| **Opaque**                          | **Î±Ï…Î¸Î±Î¯ÏÎµÏ„Î± Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€ÏŒ Ï„Î¿Î½ Ï‡ÏÎ®ÏƒÏ„Î· (Î ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®)** |
| kubernetes.io/service-account-token | Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î¿ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Ï Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚                     |
| kubernetes.io/dockercfg             | ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ \~/.dockercfg             |
| kubernetes.io/dockerconfigjson      | ÏƒÎµÎ¹ÏÎ¹Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ \~/.docker/config.json    |
| kubernetes.io/basic-auth            | Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± Î³Î¹Î± Î²Î±ÏƒÎ¹ÎºÎ® Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¯Î·ÏƒÎ·      |
| kubernetes.io/ssh-auth              | Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± Î³Î¹Î± Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¯Î·ÏƒÎ· SSH        |
| kubernetes.io/tls                   | Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î³Î¹Î± Î­Î½Î±Î½ Ï€ÎµÎ»Î¬Ï„Î· Î® Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® TLS           |
| bootstrap.kubernetes.io/token       | Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎµÎºÎºÎ¯Î½Î·ÏƒÎ·Ï‚ Ï„Î¿Ï… token                      |

{% hint style="info" %}
**ÎŸ Ï„ÏÏ€Î¿Ï‚ Opaque ÎµÎ¯Î½Î±Î¹ Î¿ Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï‚, Ï„Î¿ ÎºÎ»Î±ÏƒÎ¹ÎºÏŒ Î¶ÎµÏ…Î³Î¬ÏÎ¹ ÎºÎ»ÎµÎ¹Î´Î¹Î¿Ï-Ï„Î¹Î¼Î®Ï‚ Ï€Î¿Ï… ÎºÎ±Î¸Î¿ÏÎ¯Î¶ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚.**
{% endhint %}

**Î ÏÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¿ÏÎ½ Ï„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬:**

![](https://sickrov.github.io/media/Screenshot-164.jpg)

Î¤Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Î±ÏÏ‡ÎµÎ¯Î¿ ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ ÎºÎ±Î¸Î¿ÏÎ¯Î¶ÎµÎ¹ Î­Î½Î± **Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ** Î¼Îµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± `mysecret` Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ 2 Î¶ÎµÏ…Î³Î¬ÏÎ¹Î± ÎºÎ»ÎµÎ¹Î´Î¹Î¿Ï-Ï„Î¹Î¼Î®Ï‚ `username: YWRtaW4=` ÎºÎ±Î¹ `password: MWYyZDFlMmU2N2Rm`. ÎŸÏÎ¯Î¶ÎµÎ¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î­Î½Î± **pod** Î¼Îµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± `secretpod` Ï€Î¿Ï… Î¸Î± Î­Ï‡ÎµÎ¹ Ï„Î¿ `username` ÎºÎ±Î¹ Ï„Î¿ `password` Ï€Î¿Ï… ÎºÎ±Î¸Î¿ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ `mysecret` Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼Î± ÏƒÏ„Î¹Ï‚ **Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î­Ï‚ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î¿Ï‚** `SECRET_USERNAME` ÎºÎ±Î¹ `SECRET_PASSWOR`. Î•Ï€Î¯ÏƒÎ·Ï‚, Î¸Î± **Ï€ÏÎ¿ÏƒÎ±ÏÏ„Î®ÏƒÎµÎ¹** Ï„Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ `username` Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ `mysecret` ÏƒÏ„Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î® `/etc/foo/my-group/my-username` Î¼Îµ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± `0640`.

{% code title="secretpod.yaml" %}
```yaml
apiVersion: v1
kind: Secret
metadata:
name: mysecret
type: Opaque
data:
username: YWRtaW4=
password: MWYyZDFlMmU2N2Rm
---
apiVersion: v1
kind: Pod
metadata:
name: secretpod
spec:
containers:
- name: secretpod
image: nginx
env:
- name: SECRET_USERNAME
valueFrom:
secretKeyRef:
name: mysecret
key: username
- name: SECRET_PASSWORD
valueFrom:
secretKeyRef:
name: mysecret
key: password
volumeMounts:
- name: foo
mountPath: "/etc/foo"
restartPolicy: Never
volumes:
- name: foo
secret:
secretName: mysecret
items:
- key: username
path: my-group/my-username
mode: 0640
```
{% endcode %}
```bash
kubectl apply -f <secretpod.yaml>
kubectl get pods #Wait until the pod secretpod is running
kubectl exec -it  secretpod -- bash
env | grep SECRET && cat /etc/foo/my-group/my-username && echo
```
### ÎœÏ…ÏƒÏ„Î¹ÎºÎ¬ ÏƒÏ„Î¿ etcd <a href="#discover-secrets-in-etcd" id="discover-secrets-in-etcd"></a>

**etcd** ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÏƒÏ…Î½ÎµÏ€Î­Ï‚ ÎºÎ±Î¹ Ï…ÏˆÎ·Î»Î®Ï‚ Î´Î¹Î±Î¸ÎµÏƒÎ¹Î¼ÏŒÏ„Î·Ï„Î±Ï‚ **key-value store** Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Ï‰Ï‚ Î±Ï€Î¿Î¸Î®ÎºÎ· Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚ Ï„Î¿Ï… Kubernetes Î³Î¹Î± ÏŒÎ»Î± Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï„Î¿Ï… cluster. Î‘Ï‚ Î±Ï€Î¿ÎºÏ„Î®ÏƒÎ¿Ï…Î¼Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬ Ï€Î¿Ï… Î±Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ etcd:
```bash
cat /etc/kubernetes/manifests/kube-apiserver.yaml | grep etcd
```
Î˜Î± Î´ÎµÎ¯Ï„Îµ ÏŒÏ„Î¹ Ï„Î± Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÎ¬, Ï„Î± ÎºÎ»ÎµÎ¹Î´Î¹Î¬ ÎºÎ±Î¹ Î¿Î¹ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ URL Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î±ÏÏ‡ÎµÎ¯Ï‰Î½. ÎœÏŒÎ»Î¹Ï‚ Ï„Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ, Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ etcd.
```bash
#ETCDCTL_API=3 etcdctl --cert <path to client.crt> --key <path to client.ket> --cacert <path to CA.cert> endpoint=[<ip:port>] health

ETCDCTL_API=3 etcdctl --cert /etc/kubernetes/pki/apiserver-etcd-client.crt --key /etc/kubernetes/pki/apiserver-etcd-client.key --cacert /etc/kubernetes/pki/etcd/etcd/ca.cert endpoint=[127.0.0.1:1234] health
```
ÎœÏŒÎ»Î¹Ï‚ ÎµÏ€Î¹Ï„ÏÏ‡ÎµÏ„Îµ Î½Î± ÎµÎ³ÎºÎ±Î¸Î¹Î´ÏÏÏƒÎµÏ„Îµ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±, Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬:
```bash
#ETCDCTL_API=3 etcdctl --cert <path to client.crt> --key <path to client.ket> --cacert <path to CA.cert> endpoint=[<ip:port>] get <path/to/secret>

ETCDCTL_API=3 etcdctl --cert /etc/kubernetes/pki/apiserver-etcd-client.crt --key /etc/kubernetes/pki/apiserver-etcd-client.key --cacert /etc/kubernetes/pki/etcd/etcd/ca.cert endpoint=[127.0.0.1:1234] get /registry/secrets/default/secret_02
```
**Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ¬Ï†Î·ÏƒÎ·Ï‚ ÏƒÏ„Î¿ ETCD**

Î‘Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®, ÏŒÎ»Î± Ï„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Î½Ï„Î±Î¹ ÏƒÎµ Î±Ï€Î»ÏŒ ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ etcd ÎµÎºÏ„ÏŒÏ‚ Î±Î½ ÎµÏ†Î±ÏÎ¼ÏŒÏƒÎµÏ„Îµ Î­Î½Î± ÎµÏ€Î¯Ï€ÎµÎ´Î¿ ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ¬Ï†Î·ÏƒÎ·Ï‚. Î¤Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î²Î±ÏƒÎ¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ [https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/](https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/)

{% code title="encryption.yaml" %}
```yaml
apiVersion: apiserver.config.k8s.io/v1
kind: EncryptionConfiguration
resources:
- resources:
- secrets
providers:
- aescbc:
keys:
- name: key1
secret: cjjPMcWpTPKhAdieVtd+KhG4NN+N6e3NmBPMXJvbfrY= #Any random key
- identity: {}
```
{% endcode %}

ÎœÎµÏ„Î¬ Î±Ï€ÏŒ Î±Ï…Ï„ÏŒ, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¿ÏÎ¯ÏƒÎµÏ„Îµ Ï„Î· ÏƒÎ·Î¼Î±Î¯Î± `--encryption-provider-config` ÏƒÏ„Î¿Î½ `kube-apiserver` Î³Î¹Î± Î½Î± Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÏƒÏ„Î·Î½ Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î± Ï„Î¿Ï… Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¼Î­Î½Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï… ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ `/etc/kubernetes/manifest/kube-apiserver.yaml` ÎºÎ±Î¹ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÏ„Îµ Ï„Î¹Ï‚ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Î³ÏÎ±Î¼Î¼Î­Ï‚:
```yaml
containers:
- command:
- kube-apiserver
- --encriyption-provider-config=/etc/kubernetes/etcd/<configFile.yaml>
```
ÎšÎ±Ï„Î­Î²Î±ÏƒÎµ Ï€ÏÎ¿Ï‚ Ï„Î± ÎºÎ¬Ï„Ï‰ ÏƒÏ„Î¿ volumeMounts:
```yaml
- mountPath: /etc/kubernetes/etcd
name: etcd
readOnly: true
```
ÎšÎ±Ï„Î­Î²ÎµÏ„Îµ ÏƒÏ„Î¿Î½ ÎºÎ±Ï„Î¬Î»Î¿Î³Î¿ volumeMounts ÎºÎ±Î¹ Î²ÏÎµÎ¯Ï„Îµ Ï„Î¿ hostPath:
```yaml
- hostPath:
path: /etc/kubernetes/etcd
type: DirectoryOrCreate
name: etcd
```
**Î•Ï€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ· Ï„Î·Ï‚ ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ¬Ï†Î·ÏƒÎ·Ï‚ Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½**

Î¤Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î¿ÏÎ½Ï„Î±Î¹ ÎºÎ±Ï„Î¬ Ï„Î·Î½ ÎµÎ³Î³ÏÎ±Ï†Î® Ï„Î¿Ï…Ï‚ ÏƒÏ„Î¿ etcd. ÎœÎµÏ„Î¬ Ï„Î·Î½ ÎµÏ€Î±Î½ÎµÎºÎºÎ¯Î½Î·ÏƒÎ· Ï„Î¿Ï… `kube-apiserver`, Î¿Ï€Î¿Î¹Î¿Î´Î®Ï€Î¿Ï„Îµ Î½Î­Î¿ Î® ÎµÎ½Î·Î¼ÎµÏÏ‰Î¼Î­Î½Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†ÎµÎ¯Ï„Î±Î¹ ÎºÎ±Ï„Î¬ Ï„Î·Î½ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ® Ï„Î¿Ï…. Î“Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Î±Ï…Ï„ÏŒ, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î± Î³ÏÎ±Î¼Î¼Î®Ï‚ ÎµÎ½Ï„Î¿Î»ÏÎ½ `etcdctl` Î³Î¹Î± Î½Î± Î±Î½Î±ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï„Î¿Ï… Î¼Ï…ÏƒÏ„Î¹ÎºÎ¿Ï ÏƒÎ±Ï‚.

1. Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÏ„Îµ Î­Î½Î± Î½Î­Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ Î¼Îµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± `secret1` ÏƒÏ„Î¿ namespace `default`:

```
kubectl create secret generic secret1 -n default --from-literal=mykey=mydata
```
2. Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ etcdctl ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® ÎµÎ½Ï„Î¿Î»ÏÎ½, Î´Î¹Î±Î²Î¬ÏƒÏ„Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ Î±Ï€ÏŒ Ï„Î¿ etcd:

`ETCDCTL_API=3 etcdctl get /registry/secrets/default/secret1 [...] | hexdump -C`

ÏŒÏ€Î¿Ï… `[...]` Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¿Î¹ ÎµÏ€Î¹Ï€Î»Î­Î¿Î½ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Î¹ Î³Î¹Î± Ï„Î· ÏƒÏÎ½Î´ÎµÏƒÎ· Î¼Îµ Ï„Î¿Î½ ÎµÎ¾Ï…Ï€Î·ÏÎµÏ„Î·Ï„Î® etcd.
3. Î•Ï€Î±Î»Î·Î¸ÎµÏÏƒÏ„Îµ ÏŒÏ„Î¹ Ï„Î¿ Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Î¼Î­Î½Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÎ¸ÎµÎ¼Î± `k8s:enc:aescbc:v1:`, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Ï…Ï€Î¿Î´Î·Î»ÏÎ½ÎµÎ¹ ÏŒÏ„Î¹ Î¿ Ï€Î¬ÏÎ¿Ï‡Î¿Ï‚ `aescbc` Î­Ï‡ÎµÎ¹ ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î®ÏƒÎµÎ¹ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±.
4. Î•Ï€Î±Î»Î·Î¸ÎµÏÏƒÏ„Îµ ÏŒÏ„Î¹ Ï„Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ Î±Ï€Î¿ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†ÎµÎ¯Ï„Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬ ÏŒÏ„Î±Î½ Î±Î½Î±ÎºÏ„Î¬Ï„Î±Î¹ Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… API:

```
kubectl describe secret secret1 -n default
```

Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹ Î¼Îµ `mykey: bXlkYXRh`, Ï„Î¿ mydata ÎµÎ¯Î½Î±Î¹ ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿, ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î¿ [Î±Ï€Î¿ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· ÎµÎ½ÏŒÏ‚ Î¼Ï…ÏƒÏ„Î¹ÎºÎ¿Ï](https://kubernetes.io/docs/concepts/configuration/secret#decoding-a-secret) Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï€Î»Î®ÏÏ‰Ï‚ Ï„Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ.

**ÎšÎ±Î¸ÏÏ‚ Ï„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬ ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î¿ÏÎ½Ï„Î±Î¹ ÎºÎ±Ï„Î¬ Ï„Î·Î½ ÎµÎ³Î³ÏÎ±Ï†Î®, Î· ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ· ÎµÎ½ÏŒÏ‚ Î¼Ï…ÏƒÏ„Î¹ÎºÎ¿Ï Î¸Î± ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î®ÏƒÎµÎ¹ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Î±Ï…Ï„ÏŒ:**
```
kubectl get secrets --all-namespaces -o json | kubectl replace -f -
```
**Î¤ÎµÎ»Î¹ÎºÎ­Ï‚ ÏƒÏ…Î¼Î²Î¿Ï…Î»Î­Ï‚:**

* Î ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÏ„Îµ Î½Î± Î¼Î·Î½ ÎºÏÎ±Ï„Î¬Ï„Îµ Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬ ÏƒÏ„Î¿ FS, Î±Î»Î»Î¬ Î½Î± Ï„Î± Î±Î½Ï„Î»ÎµÎ¯Ï„Îµ Î±Ï€ÏŒ Î¬Î»Î»Î± Î¼Î­ÏÎ·.
* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î¿ [https://www.vaultproject.io/](https://www.vaultproject.io) Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ· Ï€ÏÎ¿ÏƒÏ„Î±ÏƒÎ¯Î± ÏƒÏ„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬ ÏƒÎ±Ï‚.
* [https://kubernetes.io/docs/concepts/configuration/secret/#risks](https://kubernetes.io/docs/concepts/configuration/secret/#risks)
* [https://docs.cyberark.com/Product-Doc/OnlineHelp/AAM-DAP/11.2/en/Content/Integrations/Kubernetes\_deployApplicationsConjur-k8s-Secrets.htm](https://docs.cyberark.com/Product-Doc/OnlineHelp/AAM-DAP/11.2/en/Content/Integrations/Kubernetes\_deployApplicationsConjur-k8s-Secrets.htm)

## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

{% embed url="https://sickrov.github.io/" %}

{% embed url="https://www.youtube.com/watch?v=X48VuDVv0do" %}

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ hacking Ï„Î¿Ï… AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ HackTricks:

* Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Îµ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± hacking tricks ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>
