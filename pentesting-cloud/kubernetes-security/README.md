# Pentesting Kubernetes

<details>

<summary><strong>Apoie o HackTricks e obtenha benefÃ­cios!</strong></summary>

* Se vocÃª quiser ver sua **empresa anunciada no HackTricks** ou se quiser acessar a **versÃ£o mais recente do PEASS ou baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Obtenha o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** ğŸ’¬ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo Telegram**](https://t.me/peass) ou **siga-me** no **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe seus truques de hacking enviando PRs para os repositÃ³rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) no GitHub.

</details>

## Conceitos bÃ¡sicos do Kubernetes

Se vocÃª nÃ£o sabe nada sobre o Kubernetes, este Ã© um **bom comeÃ§o**. Leia para aprender sobre a **arquitetura, componentes e aÃ§Ãµes bÃ¡sicas** no Kubernetes:

{% content-ref url="kubernetes-basics.md" %}
[kubernetes-basics.md](kubernetes-basics.md)
{% endcontent-ref %}

### LaboratÃ³rios para praticar e aprender

* [https://securekubernetes.com/](https://securekubernetes.com)
* [https://madhuakula.com/kubernetes-goat/index.html](https://madhuakula.com/kubernetes-goat/index.html)

## ReforÃ§ando a seguranÃ§a do Kubernetes / Ferramentas automÃ¡ticas

{% content-ref url="kubernetes-hardening/" %}
[kubernetes-hardening](kubernetes-hardening/)
{% endcontent-ref %}

## Pentest Manual do Kubernetes

### A partir do exterior

Existem vÃ¡rios **serviÃ§os do Kubernetes que vocÃª pode encontrar expostos** na Internet (ou em redes internas). Se vocÃª os encontrar, saberÃ¡ que hÃ¡ um ambiente Kubernetes lÃ¡.

Dependendo da configuraÃ§Ã£o e de seus privilÃ©gios, vocÃª pode abusar desse ambiente, para obter mais informaÃ§Ãµes:

{% content-ref url="pentesting-kubernetes-services.md" %}
[pentesting-kubernetes-services.md](pentesting-kubernetes-services.md)
{% endcontent-ref %}

### EnumeraÃ§Ã£o dentro de um Pod

Se vocÃª conseguir **comprometer um Pod**, leia a pÃ¡gina a seguir para aprender como enumerar e tentar **elevar privilÃ©gios/escapar**:

{% content-ref url="attacking-kubernetes-from-inside-a-pod.md" %}
[attacking-kubernetes-from-inside-a-pod.md](attacking-kubernetes-from-inside-a-pod.md)
{% endcontent-ref %}

### Enumerando o Kubernetes com Credenciais

VocÃª pode ter conseguido comprometer **credenciais de usuÃ¡rio, um token de usuÃ¡rio ou algum token de conta de serviÃ§o**. VocÃª pode usÃ¡-lo para se comunicar com o serviÃ§o de API do Kubernetes e tentar **enumerÃ¡-lo para aprender mais** sobre ele:

{% content-ref url="kubernetes-enumeration.md" %}
[kubernetes-enumeration.md](kubernetes-enumeration.md)
{% endcontent-ref %}

Outro detalhe importante sobre a enumeraÃ§Ã£o e abuso de permissÃµes do Kubernetes Ã© o **Controle de Acesso Baseado em FunÃ§Ã£o (RBAC) do Kubernetes**. Se vocÃª deseja abusar das permissÃµes, primeiro deve ler sobre isso aqui:

{% content-ref url="kubernetes-role-based-access-control-rbac.md" %}
[kubernetes-role-based-access-control-rbac.md](kubernetes-role-based-access-control-rbac.md)
{% endcontent-ref %}

#### Sabendo sobre o RBAC e tendo enumerado o ambiente, agora vocÃª pode tentar abusar das permissÃµes com:

{% content-ref url="abusing-roles-clusterroles-in-kubernetes/" %}
[abusing-roles-clusterroles-in-kubernetes](abusing-roles-clusterroles-in-kubernetes/)
{% endcontent-ref %}

### Privesc para um Namespace diferente

Se vocÃª comprometeu um namespace, pode potencialmente escapar para outros namespaces com permissÃµes/recursos mais interessantes:

{% content-ref url="kubernetes-namespace-escalation.md" %}
[kubernetes-namespace-escalation.md](kubernetes-namespace-escalation.md)
{% endcontent-ref %}

### Do Kubernetes para a Nuvem

Se vocÃª comprometeu uma conta ou um pod do K8s, pode ser capaz de se mover para outras nuvens. Isso ocorre porque em nuvens como AWS ou GCP Ã© possÃ­vel **dar permissÃµes de um SA do K8s sobre a nuvem**.

{% content-ref url="kubernetes-pivoting-to-clouds.md" %}
[kubernetes-pivoting-to-clouds.md](kubernetes-pivoting-to-clouds.md)
{% endcontent-ref %}

<details>

<summary><strong>Apoie o HackTricks e obtenha benefÃ­cios!</strong></summary>

* Se vocÃª quiser ver sua **empresa anunciada no HackTricks** ou se quiser acessar a **versÃ£o mais recente do PEASS ou baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Obtenha o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** ğŸ’¬ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo Telegram**](https://t.me/peass) ou **siga-me** no **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe seus truques de hacking enviando PRs para os repositÃ³rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) no GitHub.

</details>
