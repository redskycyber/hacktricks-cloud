# äº‘æ¸—é€æµ‹è¯•æ–¹æ³•è®º

<details>

<summary><strong>ä»é›¶åˆ°è‹±é›„å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œå‚åŠ </strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWSçº¢é˜Ÿä¸“å®¶)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨å¸Œæœ›åœ¨**HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä»¥PDFæ ¼å¼ä¸‹è½½HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨**Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricksäº‘**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

<figure><img src="../.gitbook/assets/CLOUD-logo-letters.svg" alt=""><figcaption></figcaption></figure>

## åŸºæœ¬æ–¹æ³•è®º

æ¯ä¸ªäº‘éƒ½æœ‰å…¶ç‰¹æ®Šæ€§ï¼Œä½†æ€»ä½“ä¸Šæœ‰ä¸€äº›**æ¸—é€æµ‹è¯•è€…åœ¨æµ‹è¯•äº‘ç¯å¢ƒæ—¶åº”è¯¥æ£€æŸ¥çš„å¸¸è§äº‹é¡¹**ï¼š

* **åŸºå‡†æ£€æŸ¥**
* è¿™å°†å¸®åŠ©æ‚¨**äº†è§£ç¯å¢ƒçš„è§„æ¨¡**å’Œ**ä½¿ç”¨çš„æœåŠ¡**
* å®ƒè¿˜å°†å…è®¸æ‚¨æ‰¾åˆ°ä¸€äº›**å¿«é€Ÿçš„é…ç½®é”™è¯¯**ï¼Œå› ä¸ºæ‚¨å¯ä»¥ä½¿ç”¨**è‡ªåŠ¨åŒ–å·¥å…·**æ‰§è¡Œå¤§å¤šæ•°æµ‹è¯•
* **æœåŠ¡æšä¸¾**
* å¦‚æœæ‚¨æ­£ç¡®æ‰§è¡Œäº†åŸºå‡†æµ‹è¯•ï¼Œè¿™é‡Œå¯èƒ½ä¸ä¼šå‘ç°æ›´å¤šçš„é…ç½®é”™è¯¯ï¼Œä½†æ‚¨å¯èƒ½ä¼šå‘ç°åŸºå‡†æµ‹è¯•ä¸­æœªæŸ¥æ‰¾çš„ä¸€äº›é”™è¯¯ã€‚
* è¿™å°†ä½¿æ‚¨äº†è§£äº‘ç¯å¢ƒä¸­**ç¡®åˆ‡ä½¿ç”¨çš„å†…å®¹**
* è¿™å°†åœ¨ä¸‹ä¸€æ­¥ä¸­å¤§æœ‰å¸®åŠ©
* **æ£€æŸ¥æš´éœ²çš„èµ„äº§**
* è¿™å¯ä»¥åœ¨ä¸Šä¸€èŠ‚æœŸé—´å®Œæˆï¼Œæ‚¨éœ€è¦**æ‰¾å‡ºæ‰€æœ‰å¯èƒ½ä»¥æŸç§æ–¹å¼æš´éœ²åœ¨äº’è”ç½‘ä¸Šçš„å†…å®¹**ä»¥åŠå¦‚ä½•è®¿é—®å®ƒä»¬ã€‚
* è¿™é‡Œæˆ‘æŒ‡çš„æ˜¯**æ‰‹åŠ¨æš´éœ²çš„åŸºç¡€è®¾æ–½**ï¼Œå¦‚å¸¦æœ‰ç½‘é¡µçš„å®ä¾‹æˆ–å…¶ä»–æš´éœ²çš„ç«¯å£ï¼Œä»¥åŠå¯ä»¥é…ç½®ä¸ºæš´éœ²çš„å…¶ä»–**äº‘æ‰˜ç®¡æœåŠ¡**ï¼ˆå¦‚æ•°æ®åº“æˆ–å­˜å‚¨æ¡¶ï¼‰
* ç„¶åæ‚¨åº”è¯¥æ£€æŸ¥**è¯¥èµ„æºæ˜¯å¦å¯ä»¥æš´éœ²**ï¼ˆæœºå¯†ä¿¡æ¯ï¼Ÿæ¼æ´ï¼Ÿæš´éœ²æœåŠ¡ä¸­çš„é…ç½®é”™è¯¯ï¼Ÿï¼‰
* **æ£€æŸ¥æƒé™**
* è¿™é‡Œæ‚¨åº”è¯¥**æ‰¾å‡ºäº‘ä¸­æ¯ä¸ªè§’è‰²/ç”¨æˆ·çš„æ‰€æœ‰æƒé™**ä»¥åŠå®ƒä»¬çš„ä½¿ç”¨æ–¹å¼
* å¤ªå¤š**é«˜æƒé™**ï¼ˆæ§åˆ¶ä¸€åˆ‡ï¼‰è´¦æˆ·ï¼Ÿæœªä½¿ç”¨çš„ç”Ÿæˆçš„å¯†é’¥ï¼Ÿ... å¤§å¤šæ•°æ£€æŸ¥åº”è¯¥å·²ç»åœ¨åŸºå‡†æµ‹è¯•ä¸­å®Œæˆ
* å¦‚æœå®¢æˆ·ç«¯æ­£åœ¨ä½¿ç”¨OpenIDæˆ–SAMLæˆ–å…¶ä»–**è”åˆèº«ä»½è®¤è¯**ï¼Œæ‚¨å¯èƒ½éœ€è¦å‘ä»–ä»¬è¿›ä¸€æ­¥è¯¢é—®æœ‰å…³**æ¯ä¸ªè§’è‰²åˆ†é…æ–¹å¼**çš„**ä¿¡æ¯**ï¼ˆç®¡ç†å‘˜è§’è‰²åˆ†é…ç»™1ä¸ªç”¨æˆ·æˆ–100ä¸ªç”¨æˆ·æ˜¯ä¸åŒçš„ï¼‰
* **å‘ç°**å“ªäº›ç”¨æˆ·å…·æœ‰**ç®¡ç†å‘˜**æƒé™"\*:\*"æ˜¯**ä¸å¤Ÿçš„**ã€‚è¿˜æœ‰å¾ˆå¤š**å…¶ä»–æƒé™**ï¼Œæ ¹æ®ä½¿ç”¨çš„æœåŠ¡ï¼Œå¯èƒ½éå¸¸**æ•æ„Ÿ**ã€‚
* æ­¤å¤–ï¼Œè¿˜æœ‰**æ½œåœ¨çš„æƒé™æå‡**æ–¹æ³•å¯ä»¥é€šè¿‡æ»¥ç”¨æƒé™æ¥è¿½è¸ªã€‚æ‰€æœ‰è¿™äº›äº‹æƒ…éƒ½åº”è¯¥è€ƒè™‘åœ¨å†…ï¼Œå¹¶ä¸”åº”è¯¥æŠ¥å‘Š**å°½å¯èƒ½å¤šçš„æƒé™æå‡è·¯å¾„**ã€‚
* **æ£€æŸ¥é›†æˆ**
* é«˜åº¦å¯èƒ½**äº‘ç¯å¢ƒå†…éƒ¨ä½¿ç”¨äº†ä¸å…¶ä»–äº‘æˆ–SaaSçš„é›†æˆ**ã€‚
* å¯¹äºæ‚¨æ­£åœ¨å®¡è®¡çš„äº‘ä¸å…¶ä»–å¹³å°çš„**é›†æˆ**ï¼Œæ‚¨åº”è¯¥é€šçŸ¥**è°æœ‰æƒé™ï¼ˆæ»¥ç”¨ï¼‰ä½¿ç”¨è¯¥é›†æˆ**ï¼Œå¹¶ä¸”æ‚¨åº”è¯¥è¯¢é—®æ‰§è¡Œçš„æ“ä½œæœ‰å¤š**æ•æ„Ÿ**ã€‚\
ä¾‹å¦‚ï¼Œè°å¯ä»¥åœ¨AWSä»ä¸­è·å–æ•°æ®çš„å­˜å‚¨æ¡¶ä¸­å†™å…¥ï¼ˆè¯¢é—®GCPå¤„ç†è¯¥æ•°æ®çš„æ“ä½œæœ‰å¤šæ•æ„Ÿï¼‰ã€‚
* å¯¹äºä»å¤–éƒ¨å¹³å°åˆ°æ‚¨æ­£åœ¨å®¡è®¡çš„äº‘å†…éƒ¨çš„**é›†æˆ**ï¼Œæ‚¨åº”è¯¥è¯¢é—®**è°æœ‰å¤–éƒ¨æƒé™ï¼ˆæ»¥ç”¨ï¼‰ä½¿ç”¨è¯¥é›†æˆ**ï¼Œå¹¶æ£€æŸ¥æ•°æ®çš„ä½¿ç”¨æ–¹å¼ã€‚\
ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªæœåŠ¡æ­£åœ¨ä½¿ç”¨æ‰˜ç®¡åœ¨GCRä¸­çš„Dockeré•œåƒï¼Œæ‚¨åº”è¯¥è¯¢é—®è°æœ‰æƒé™ä¿®æ”¹å®ƒï¼Œä»¥åŠè¯¥é•œåƒåœ¨AWSäº‘å†…æ‰§è¡Œæ—¶å°†è·å–å“ªäº›æ•æ„Ÿä¿¡æ¯å’Œè®¿é—®æƒé™ã€‚

## å¤šäº‘å·¥å…·

æœ‰å‡ ç§å·¥å…·å¯ä»¥ç”¨æ¥æµ‹è¯•ä¸åŒçš„äº‘ç¯å¢ƒã€‚å®‰è£…æ­¥éª¤å’Œé“¾æ¥å°†åœ¨æœ¬èŠ‚ä¸­æŒ‡å‡ºã€‚

### [PurplePanda](https://github.com/carlospolop/purplepanda)

ä¸€ä¸ªå·¥å…·ï¼Œç”¨äº**è¯†åˆ«äº‘ä¸­å’Œè·¨äº‘/SaaSçš„é”™è¯¯é…ç½®å’Œæƒé™æå‡è·¯å¾„ã€‚**

{% tabs %}
{% tab title="å®‰è£…" %}
```bash
# You need to install and run neo4j also
git clone https://github.com/carlospolop/PurplePanda
cd PurplePanda
python3 -m venv .
source bin/activate
python3 -m pip install -r requirements.txt
export PURPLEPANDA_NEO4J_URL="bolt://neo4j@localhost:7687"
export PURPLEPANDA_PWD="neo4j_pwd_4_purplepanda"
python3 main.py -h # Get help
```
{% endtab %}

{% tab title="GCP" %}
```bash
export GOOGLE_DISCOVERY=$(echo 'google:
- file_path: ""

- file_path: ""
service_account_id: "some-sa-email@sidentifier.iam.gserviceaccount.com"' | base64)

python3 main.py -a -p google #Get basic info of the account to check it's correctly configured
python3 main.py -e -p google #Enumerate the env
```
{% endtab %}
{% endtabs %}

### [Prowler](https://github.com/prowler-cloud/prowler)

å®ƒæ”¯æŒ **AWS, GCP & Azure**ã€‚æŸ¥çœ‹å¦‚ä½•é…ç½®æ¯ä¸ªæä¾›å•†ï¼Œè¯·è®¿é—® [https://docs.prowler.cloud/en/latest/#aws](https://docs.prowler.cloud/en/latest/#aws)
```bash
# Install
pip install prowler
prowler -v

# Run
prowler <provider>
# Example
prowler aws --profile custom-profile [-M csv json json-asff html]

# Get info about checks & services
prowler <provider> --list-checks
prowler <provider> --list-services
```
### [CloudSploit](https://github.com/aquasecurity/cloudsploit)

AWS, Azure, Github, Google, Oracle, Alibaba

{% tabs %}
{% tab title="å®‰è£…" %}
```bash
# Install
git clone https://github.com/aquasecurity/cloudsploit.git
cd cloudsploit
npm install
./index.js -h
## Docker instructions in github
```
{% endtab %}

{% tab title="GCP" %}
```bash
## You need to have creds for a service account and set them in config.js file
./index.js --cloud google --config </abs/path/to/config.js>
```
{% endtab %}
{% endtabs %}

### [ScoutSuite](https://github.com/nccgroup/ScoutSuite)

AWSã€Azureã€GCPã€é˜¿é‡Œå·´å·´äº‘ã€Oracle Cloud Infrastructure

{% tabs %}
{% tab title="å®‰è£…" %}
```bash
mkdir scout; cd scout
virtualenv -p python3 venv
source venv/bin/activate
pip install scoutsuite
scout --help
## Using Docker: https://github.com/nccgroup/ScoutSuite/wiki/Docker-Image
```
{% endtab %}

{% tab title="GCP" %}
```bash
scout gcp --report-dir /tmp/gcp --user-account --all-projects
## use "--service-account KEY_FILE" instead of "--user-account" to use a service account

SCOUT_FOLDER_REPORT="/tmp"
for pid in $(gcloud projects list --format="value(projectId)"); do
echo "================================================"
echo "Checking $pid"
mkdir "$SCOUT_FOLDER_REPORT/$pid"
scout gcp --report-dir "$SCOUT_FOLDER_REPORT/$pid" --no-browser --user-account --project-id "$pid"
done
```
{% endtab %}
{% endtabs %}

### [Steampipe](https://github.com/turbot)

{% tabs %}
{% tab title="å®‰è£…" %}
ä¸‹è½½å¹¶å®‰è£… Steampipe ([https://steampipe.io/downloads](https://steampipe.io/downloads))ã€‚æˆ–è€…ä½¿ç”¨ Brewï¼š
```
brew tap turbot/tap
brew install steampipe
```
{% endtab %}

{% tab title="GCP" %}
```bash
# Install gcp plugin
steampipe plugin install gcp

# Use https://github.com/turbot/steampipe-mod-gcp-compliance.git
git clone https://github.com/turbot/steampipe-mod-gcp-compliance.git
cd steampipe-mod-gcp-compliance
# To run all the checks from the dashboard
steampipe dashboard
# To run all the checks from rhe cli
steampipe check all
```
<details>

<summary>æ£€æŸ¥æ‰€æœ‰é¡¹ç›®</summary>

ä¸ºäº†æ£€æŸ¥æ‰€æœ‰é¡¹ç›®ï¼Œæ‚¨éœ€è¦ç”Ÿæˆ `gcp.spc` æ–‡ä»¶å¹¶æŒ‡æ˜æ‰€æœ‰è¦æµ‹è¯•çš„é¡¹ç›®ã€‚æ‚¨å¯ä»¥æŒ‰ç…§ä»¥ä¸‹è„šæœ¬çš„æŒ‡ç¤ºæ“ä½œ
```bash
FILEPATH="/tmp/gcp.spc"
rm -rf "$FILEPATH" 2>/dev/null

# Generate a json like object for each project
for pid in $(gcloud projects list --format="value(projectId)"); do
echo "connection \"gcp_$(echo -n $pid | tr "-" "_" )\" {
plugin  = \"gcp\"
project = \"$pid\"
}" >> "$FILEPATH"
done

# Generate the aggragator to call
echo 'connection "gcp_all" {
plugin      = "gcp"
type        = "aggregator"
connections = ["gcp_*"]
}' >> "$FILEPATH"

echo "Copy $FILEPATH in ~/.steampipe/config/gcp.spc if it was correctly generated"
```
</details>

è¦æ£€æŸ¥**å…¶ä»– GCP æ´å¯Ÿ**ï¼ˆå¯¹æšä¸¾æœåŠ¡æœ‰ç”¨ï¼‰ï¼Œè¯·ä½¿ç”¨ï¼š[https://github.com/turbot/steampipe-mod-gcp-insights](https://github.com/turbot/steampipe-mod-gcp-insights)

è¦æ£€æŸ¥ Terraform GCP ä»£ç ï¼š[https://github.com/turbot/steampipe-mod-terraform-gcp-compliance](https://github.com/turbot/steampipe-mod-terraform-gcp-compliance)

æ›´å¤š Steampipe çš„ GCP æ’ä»¶ï¼š[https://github.com/turbot?q=gcp](https://github.com/turbot?q=gcp)
{% endtab %}

{% tab title="AWS" %}
```bash
# Install aws plugin
steampipe plugin install aws

# Modify the spec indicating in "profile" the profile name to use
nano ~/.steampipe/config/aws.spc

# Get some info on how the AWS account is being used
git clone https://github.com/turbot/steampipe-mod-aws-insights.git
cd steampipe-mod-aws-insights
steampipe dashboard

# Get the services exposed to the internet
git clone https://github.com/turbot/steampipe-mod-aws-perimeter.git
cd steampipe-mod-aws-perimeter
steampipe dashboard

# Run the benchmarks
git clone https://github.com/turbot/steampipe-mod-aws-compliance
cd steampipe-mod-aws-compliance
steampipe dashboard # To see results in browser
steampipe check all --export=/tmp/output4.json
```
æ£€æŸ¥Terraform AWSä»£ç ï¼š[https://github.com/turbot/steampipe-mod-terraform-aws-compliance](https://github.com/turbot/steampipe-mod-terraform-aws-compliance)

æ›´å¤šSteampipeçš„AWSæ’ä»¶ï¼š[https://github.com/orgs/turbot/repositories?q=aws](https://github.com/orgs/turbot/repositories?q=aws)
{% endtab %}
{% endtabs %}

### [~~cs-suite~~](https://github.com/SecurityFTW/cs-suite)

AWSã€GCPã€Azureã€DigitalOceanã€‚\
å®ƒéœ€è¦python2.7å¹¶ä¸”çœ‹èµ·æ¥æ²¡æœ‰ç»´æŠ¤ã€‚

### Nessus

Nessusæœ‰ä¸€ä¸ª_**å®¡è®¡äº‘åŸºç¡€è®¾æ–½**_æ‰«ææ”¯æŒï¼šAWSã€Azureã€Office 365ã€Rackspaceã€Salesforceã€‚åœ¨**Azure**ä¸­éœ€è¦ä¸€äº›é¢å¤–é…ç½®æ¥è·å–**å®¢æˆ·ç«¯ID**ã€‚

### [**cloudlist**](https://github.com/projectdiscovery/cloudlist)

Cloudlistæ˜¯ä¸€ä¸ª**å¤šäº‘å·¥å…·ï¼Œç”¨äºä»äº‘æä¾›å•†è·å–èµ„äº§**ï¼ˆä¸»æœºåï¼ŒIPåœ°å€ï¼‰ã€‚

{% tabs %}
{% tab title="Cloudlist" %}
```bash
cd /tmp
wget https://github.com/projectdiscovery/cloudlist/releases/latest/download/cloudlist_1.0.1_macOS_arm64.zip
unzip cloudlist_1.0.1_macOS_arm64.zip
chmod +x cloudlist
sudo mv cloudlist /usr/local/bin
```
{% endtab %}

{% tab title="ç¬¬äºŒä¸ªæ ‡ç­¾" %}
```bash
## For GCP it requires service account JSON credentials
cloudlist -config </path/to/config>
```
{% endtab %}
{% endtabs %}

### [**cartography**](https://github.com/lyft/cartography)

Cartography æ˜¯ä¸€ä¸ª Python å·¥å…·ï¼Œå®ƒæ•´åˆäº†åŸºç¡€è®¾æ–½èµ„äº§åŠå…¶ä¹‹é—´çš„å…³ç³»ï¼Œé€šè¿‡ Neo4j æ•°æ®åº“æä¾›ç›´è§‚çš„å›¾å½¢è§†å›¾ã€‚

{% tabs %}
{% tab title="å®‰è£…" %}
```bash
# Installation
docker image pull ghcr.io/lyft/cartography
docker run --platform linux/amd64 ghcr.io/lyft/cartography cartography --help
## Install a Neo4j DB version 3.5.*
```
{% endtab %}

{% tab title="GCP" %}
```bash
docker run --platform linux/amd64 \
--volume "$HOME/.config/gcloud/application_default_credentials.json:/application_default_credentials.json" \
-e GOOGLE_APPLICATION_CREDENTIALS="/application_default_credentials.json" \
-e NEO4j_PASSWORD="s3cr3t" \
ghcr.io/lyft/cartography  \
--neo4j-uri bolt://host.docker.internal:7687 \
--neo4j-password-env-var NEO4j_PASSWORD \
--neo4j-user neo4j


# It only checks for a few services inside GCP (https://lyft.github.io/cartography/modules/gcp/index.html)
## Cloud Resource Manager
## Compute
## DNS
## Storage
## Google Kubernetes Engine
### If you can run starbase or purplepanda you will get more info
```
{% endtab %}
{% endtabs %}

### [**starbase**](https://github.com/JupiterOne/starbase)

Starbase ä»åŒ…æ‹¬äº‘åŸºç¡€è®¾æ–½ã€SaaSåº”ç”¨ç¨‹åºã€å®‰å…¨æ§åˆ¶ç­‰åœ¨å†…çš„æœåŠ¡å’Œç³»ç»Ÿä¸­æ”¶é›†èµ„äº§å’Œå…³ç³»ï¼Œå¹¶é€šè¿‡Neo4jæ•°æ®åº“æ”¯æŒï¼Œå‘ˆç°ä¸ºç›´è§‚çš„å›¾å½¢è§†å›¾ã€‚

{% tabs %}
{% tab title="å®‰è£…" %}
```bash
# You are going to need Node version 14, so install nvm following https://tecadmin.net/install-nvm-macos-with-homebrew/
npm install --global yarn
nvm install 14
git clone https://github.com/JupiterOne/starbase.git
cd starbase
nvm use 14
yarn install
yarn starbase --help
# Configure manually config.yaml depending on the env to analyze
yarn starbase setup
yarn starbase run

# Docker
git clone https://github.com/JupiterOne/starbase.git
cd starbase
cp config.yaml.example config.yaml
# Configure manually config.yaml depending on the env to analyze
docker build --no-cache -t starbase:latest .
docker-compose run starbase setup
docker-compose run starbase run
```
{% endtab %}

{% tab title="GCP" %}
```yaml
## Config for GCP
### Check out: https://github.com/JupiterOne/graph-google-cloud/blob/main/docs/development.md
### It requires service account credentials

integrations:
-
name: graph-google-cloud
instanceId: testInstanceId
directory: ./.integrations/graph-google-cloud
gitRemoteUrl: https://github.com/JupiterOne/graph-google-cloud.git
config:
SERVICE_ACCOUNT_KEY_FILE: '{Check https://github.com/JupiterOne/graph-google-cloud/blob/main/docs/development.md#service_account_key_file-string}'
PROJECT_ID: ""
FOLDER_ID: ""
ORGANIZATION_ID: ""
CONFIGURE_ORGANIZATION_PROJECTS: false

storage:
engine: neo4j
config:
username: neo4j
password: s3cr3t
uri: bolt://localhost:7687
#Consider using host.docker.internal if from docker
```
{% endtab %}
{% endtabs %}

### [**SkyArk**](https://github.com/cyberark/SkyArk)

åœ¨æ‰«æçš„AWSæˆ–Azureç¯å¢ƒä¸­å‘ç°æœ€å…·ç‰¹æƒçš„ç”¨æˆ·ï¼ŒåŒ…æ‹¬AWS Shadow Adminsã€‚å®ƒä½¿ç”¨powershellã€‚
```powershell
Import-Module .\SkyArk.ps1 -force
Start-AzureStealth

# in the Cloud Console
IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/cyberark/SkyArk/master/AzureStealth/AzureStealth.ps1')
Scan-AzureAdmins
```
### [Cloud Brute](https://github.com/0xsha/CloudBrute)

ä¸€æ¬¾ç”¨äºåœ¨é¡¶çº§äº‘æä¾›å•†ï¼ˆAmazonã€Googleã€Microsoftã€DigitalOceanã€Alibabaã€Vultrã€Linodeï¼‰ä¸Šæ‰¾åˆ°å…¬å¸ï¼ˆç›®æ ‡ï¼‰åŸºç¡€è®¾æ–½ã€æ–‡ä»¶å’Œåº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚

### [CloudFox](https://github.com/BishopFox/cloudfox)

* CloudFox æ˜¯ä¸€æ¬¾ç”¨äºåœ¨äº‘åŸºç¡€è®¾æ–½ä¸­æ‰¾åˆ°å¯åˆ©ç”¨æ”»å‡»è·¯å¾„çš„å·¥å…·ï¼ˆç›®å‰ä»…æ”¯æŒ AWS å’Œ Azureï¼ŒGCP å³å°†æ¨å‡ºï¼‰ã€‚
* å®ƒæ˜¯ä¸€ä¸ªæšä¸¾å·¥å…·ï¼Œæ—¨åœ¨è¡¥å……æ‰‹åŠ¨pentestingã€‚
* å®ƒä¸ä¼šåœ¨äº‘ç¯å¢ƒå†…åˆ›å»ºæˆ–ä¿®æ”¹ä»»ä½•æ•°æ®ã€‚

### æ›´å¤šäº‘å®‰å…¨å·¥å…·åˆ—è¡¨

* [https://github.com/RyanJarv/awesome-cloud-sec](https://github.com/RyanJarv/awesome-cloud-sec)

## Google

### GCP

{% content-ref url="gcp-security/" %}
[gcp-security](gcp-security/)
{% endcontent-ref %}

### Workspace

{% content-ref url="workspace-security.md" %}
[workspace-security.md](workspace-security.md)
{% endcontent-ref %}

## AWS

{% content-ref url="aws-security/" %}
[aws-security](aws-security/)
{% endcontent-ref %}

## Azure

åœ¨æ­¤è®¿é—®é—¨æˆ·ï¼š[http://portal.azure.com/](http://portal.azure.com)\
å¼€å§‹æµ‹è¯•å‰ï¼Œæ‚¨åº”è¯¥æ‹¥æœ‰å…·æœ‰**è®¢é˜…é˜…è¯»è€…æƒé™**å’Œ**AzureADå…¨å±€é˜…è¯»è€…è§’è‰²**çš„ç”¨æˆ·è®¿é—®æƒé™ã€‚å¦‚æœåœ¨è¿™ç§æƒ…å†µä¸‹æ‚¨**æ— æ³•è®¿é—®å­˜å‚¨è´¦æˆ·çš„å†…å®¹**ï¼Œæ‚¨å¯ä»¥é€šè¿‡**å­˜å‚¨è´¦æˆ·è´¡çŒ®è€…è§’è‰²**æ¥è§£å†³ã€‚

å»ºè®®åœ¨**linux**å’Œ**windows**è™šæ‹Ÿæœºä¸Š**å®‰è£… azure-cli**ï¼ˆä»¥ä¾¿èƒ½å¤Ÿè¿è¡Œpowershellå’Œpythonè„šæœ¬ï¼‰ï¼š[https://docs.microsoft.com/en-us/cli/azure/install-azure-cli?view=azure-cli-latest](https://docs.microsoft.com/en-us/cli/azure/install-azure-cli?view=azure-cli-latest)\
ç„¶åï¼Œè¿è¡Œ `az login` è¿›è¡Œç™»å½•ã€‚æ³¨æ„**è´¦æˆ·ä¿¡æ¯**å’Œ**ä»¤ç‰Œ**å°†è¢«**ä¿å­˜**åœ¨ _\<HOME>/.azure_ï¼ˆåœ¨Windowså’ŒLinuxä¸­ï¼‰ã€‚

è¯·è®°ä½ï¼Œå¦‚æœæ­£åœ¨ä½¿ç”¨çš„æ˜¯**å®‰å…¨ä¸­å¿ƒæ ‡å‡†å®šä»·å±‚**è€Œä¸æ˜¯**å…è´¹**å±‚ï¼Œæ‚¨å¯ä»¥ä»azureé—¨æˆ·**ç”Ÿæˆ**ä¸€ä¸ª**CISåˆè§„æ€§æ‰«ææŠ¥å‘Š**ã€‚è½¬åˆ° _ç­–ç•¥ä¸åˆè§„-> ç›‘ç®¡åˆè§„_ï¼ˆæˆ–å°è¯•è®¿é—® [https://portal.azure.com/#blade/Microsoft\_Azure\_Security/SecurityMenuBlade/22](https://portal.azure.com/#blade/Microsoft\_Azure\_Security/SecurityMenuBlade/22)ï¼‰ã€‚\
\_\_å¦‚æœå…¬å¸æ²¡æœ‰ä¸ºæ ‡å‡†è´¦æˆ·ä»˜è´¹ï¼Œæ‚¨å¯èƒ½éœ€è¦æ‰‹åŠ¨å®¡æŸ¥**CIS Microsoft Azure Foundations Benchmark**ï¼ˆæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å·¥å…·è·å¾—ä¸€äº›å¸®åŠ©ï¼‰ã€‚ä»[**è¿™é‡Œ**](https://www.newnettechnologies.com/cis-benchmark.html?keyword=\&gclid=Cj0KCQjwyPbzBRDsARIsAFh15JYSireQtX57C6XF8cfZU3JVjswtaLFJndC3Hv45YraKpLVDgLqEY6IaAhsZEALw\_wcB#microsoft-azure)ä¸‹è½½ã€‚

### è¿è¡Œæ‰«æå™¨

è¿è¡Œæ‰«æå™¨ä»¥å¯»æ‰¾**æ¼æ´**å¹¶**æ¯”è¾ƒ**å®æ–½çš„å®‰å…¨æªæ–½ä¸**CIS**ã€‚
```bash
pip install scout
scout azure --cli --report-dir <output_dir>

#Fix azureaudit.py before launching cs.py
#Adding "j_res = {}" on line 1074
python cs.py -env azure

#Azucar is an Azure security scanner for PowerShell (https://github.com/nccgroup/azucar)
#Run it from its folder
.\Azucar.ps1 -AuthMode Interactive -ForceAuth -ExportTo EXCEL

#Azure-CIS-Scanner,CIS scanner for Azure (https://github.com/kbroughton/azure_cis_scanner)
pip3 install azure-cis-scanner #Install
azscan #Run, login before with `az login`
```
### æ”»å‡»å›¾

[**Stormspotter**](https://github.com/Azure/Stormspotter) åˆ›å»º Azure è®¢é˜…èµ„æºçš„â€œæ”»å‡»å›¾â€ã€‚å®ƒä½¿çº¢é˜Ÿå’Œæ¸—é€æµ‹è¯•äººå‘˜èƒ½å¤Ÿå¯è§†åŒ–ç§Ÿæˆ·å†…çš„æ”»å‡»é¢å’Œæ¢çº½æœºä¼šï¼Œå¹¶æå¤§åœ°åŠ å¼ºäº†é˜²å¾¡è€…å¿«é€Ÿå®šä½å’Œä¼˜å…ˆå¤„ç†äº‹ä»¶å“åº”å·¥ä½œçš„èƒ½åŠ›ã€‚

### æ›´å¤šæ£€æŸ¥

* æ£€æŸ¥æ˜¯å¦æœ‰**å¤§é‡çš„å…¨å±€ç®¡ç†å‘˜**ï¼ˆæ¨è2-4ä¸ªï¼‰ã€‚è®¿é—®ï¼š[https://portal.azure.com/#blade/Microsoft\_AAD\_IAM/ActiveDirectoryMenuBlade/Overview](https://portal.azure.com/#blade/Microsoft\_AAD\_IAM/ActiveDirectoryMenuBlade/Overview)
* å…¨å±€ç®¡ç†å‘˜åº”è¯¥å¯ç”¨ MFAã€‚è½¬åˆ°ç”¨æˆ·å¹¶ç‚¹å‡»å¤šå› ç´ è®¤è¯æŒ‰é’®ã€‚
* ä¸“ç”¨ç®¡ç†å‘˜è´¦æˆ·ä¸åº”è¯¥æœ‰é‚®ç®±ï¼ˆé™¤éä»–ä»¬æœ‰ Office 365ï¼‰ã€‚
* å¦‚æœä¸éœ€è¦ï¼Œæœ¬åœ° AD ä¸åº”ä¸ Azure AD åŒæ­¥([https://portal.azure.com/#blade/Microsoft\_AAD\_IAM/ActiveDirectoryMenuBlade/AzureADConnect](https://portal.azure.com/#blade/Microsoft\_AAD\_IAM/ActiveDirectoryMenuBlade/AzureADConnect))ã€‚å¦‚æœåŒæ­¥ï¼Œåº”è¯¥å¯ç”¨å¯†ç å“ˆå¸ŒåŒæ­¥ä»¥ç¡®ä¿å¯é æ€§ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯ç¦ç”¨çš„ï¼š
* **å…¨å±€ç®¡ç†å‘˜**ä¸åº”ä»æœ¬åœ° AD åŒæ­¥ã€‚æ£€æŸ¥å…¨å±€ç®¡ç†å‘˜çš„ç”µå­é‚®ä»¶æ˜¯å¦ä½¿ç”¨åŸŸå **onmicrosoft.com**ã€‚å¦‚æœä¸æ˜¯ï¼Œæ£€æŸ¥ç”¨æˆ·çš„æ¥æºï¼Œæ¥æºåº”è¯¥æ˜¯ Azure Active Directoryï¼Œå¦‚æœæ¥è‡ª Windows Server ADï¼Œåˆ™æŠ¥å‘Šå®ƒã€‚
* æ¨èä½¿ç”¨**æ ‡å‡†å±‚**è€Œä¸æ˜¯å…è´¹å±‚ï¼ˆåœ¨ _å®šä»·ä¸è®¾ç½®_ ä¸­æŸ¥çœ‹æ­£åœ¨ä½¿ç”¨çš„å±‚æˆ–åœ¨ [https://portal.azure.com/#blade/Microsoft\_Azure\_Security/SecurityMenuBlade/24](https://portal.azure.com/#blade/Microsoft\_Azure\_Security/SecurityMenuBlade/24)ï¼‰
*   **å®šæœŸ SQL æœåŠ¡å™¨æ‰«æ**ï¼š

_é€‰æ‹© SQL æœåŠ¡å™¨_ --> _ç¡®ä¿â€œé«˜çº§æ•°æ®å®‰å…¨â€è®¾ç½®ä¸ºâ€œå¼€â€_ --> _åœ¨â€œæ¼æ´è¯„ä¼°è®¾ç½®â€ä¸‹ï¼Œå°†â€œå®šæœŸé‡å¤æ‰«æâ€è®¾ç½®ä¸ºâ€œå¼€â€ï¼Œå¹¶é…ç½®ä¸€ä¸ªå­˜å‚¨è´¦æˆ·ç”¨äºå­˜å‚¨æ¼æ´è¯„ä¼°æ‰«æç»“æœ_ --> _ç‚¹å‡»ä¿å­˜_
* **ç¼ºä¹åº”ç”¨æœåŠ¡é™åˆ¶**ï¼šåœ¨ Azure ä¸­æŸ¥æ‰¾â€œåº”ç”¨æœåŠ¡â€([https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Web%2Fsites](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Web%2Fsites))ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ä»»ä½•æœåŠ¡æ­£åœ¨ä½¿ç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ£€æŸ¥æ¯ä¸ªåº”ç”¨çš„â€œè®¿é—®é™åˆ¶â€ï¼Œå¦‚æœæ²¡æœ‰è§„åˆ™ï¼ŒæŠ¥å‘Šå®ƒã€‚åº”æ ¹æ®éœ€è¦é™åˆ¶å¯¹åº”ç”¨æœåŠ¡çš„è®¿é—®ã€‚

### Office365

ä½ éœ€è¦**å…¨å±€ç®¡ç†å‘˜**æˆ–è‡³å°‘**å…¨å±€ç®¡ç†å‘˜é˜…è¯»è€…**ï¼ˆä½†è¯·æ³¨æ„å…¨å±€ç®¡ç†å‘˜é˜…è¯»è€…æœ‰ä¸€äº›é™åˆ¶ï¼‰ã€‚ç„¶è€Œï¼Œè¿™äº›é™åˆ¶å‡ºç°åœ¨ä¸€äº› PS æ¨¡å—ä¸­ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡**é€šè¿‡ç½‘ç»œåº”ç”¨ç¨‹åº**è®¿é—®åŠŸèƒ½æ¥ç»•è¿‡ã€‚

## å…¶ä»–äº‘æ¸—é€æµ‹è¯•æŒ‡å—

* [**https://hackingthe.cloud**](https://hackingthe.cloud)

<details>

<summary><strong>ä»é›¶åˆ°è‹±é›„å­¦ä¹  AWS é»‘å®¢æ”»å‡»ï¼Œä½¿ç”¨</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS çº¢é˜Ÿä¸“å®¶)</strong></a><strong>ï¼</strong></summary>

å…¶ä»–æ”¯æŒ HackTricks çš„æ–¹å¼ï¼š

* å¦‚æœä½ æƒ³åœ¨ **HackTricks** ä¸­çœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½ HackTricks çš„ PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTs**](https://opensea.io/collection/the-peass-family)ç³»åˆ—
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚

</details>
