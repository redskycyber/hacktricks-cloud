# AWS - Kinesis Data Firehose æšä¸¾

<details>

<summary><strong>æ”¯æŒ HackTricks å¹¶è·å¾—ç¦åˆ©ï¼</strong></summary>

* å¦‚æœæ‚¨æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Šï¼Œæˆ–è€…å¦‚æœæ‚¨æƒ³è®¿é—® PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDFï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹ PEASS å’Œ HackTricks å•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFT**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) **å’Œ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## Kinesis Data Firehose

Amazon Kinesis Data Firehose æ˜¯ä¸€ä¸ª**å…¨ç®¡ç†çš„æœåŠ¡ï¼Œç”¨äºå°†å®æ—¶**[**æµæ•°æ®**](http://www.amazonaws.cn/streaming-data/) **ä¼ é€åˆ°ç›®æ ‡**ï¼Œä¾‹å¦‚ Amazon Simple Storage Service (Amazon S3)ã€Amazon Redshiftã€Amazon OpenSearch Serviceã€Splunk å’Œä»»ä½•è‡ªå®šä¹‰çš„ HTTP ç»ˆç«¯ç‚¹ã€‚\
ä½¿ç”¨ Kinesis Data Firehoseï¼Œæ‚¨æ— éœ€ç¼–å†™åº”ç”¨ç¨‹åºæˆ–ç®¡ç†èµ„æºã€‚æ‚¨åªéœ€**é…ç½®æ•°æ®ç”Ÿæˆå™¨**å°†æ•°æ®å‘é€åˆ° Kinesis Data Firehoseï¼Œå®ƒå°†**è‡ªåŠ¨å°†æ•°æ®ä¼ é€åˆ°æŒ‡å®šçš„ç›®æ ‡**ã€‚æ‚¨è¿˜å¯ä»¥é…ç½® Kinesis Data Firehose **åœ¨ä¼ é€æ•°æ®ä¹‹å‰å¯¹å…¶è¿›è¡Œè½¬æ¢**ã€‚

### æšä¸¾
```bash
# Get delivery streams
aws firehose list-delivery-streams

#Â Get stream info
aws firehose describe-delivery-stream --delivery-stream-name <name>
## Get roles
aws firehose describe-delivery-stream --delivery-stream-name <name> | grep -i RoleARN
```
## åæ¸—é€/é˜²å¾¡ç»•è¿‡

å¦‚æœFirehoseç”¨äºå‘é€æ—¥å¿—æˆ–é˜²å¾¡æ´å¯Ÿï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™äº›åŠŸèƒ½æ¥é˜»æ­¢å…¶æ­£å¸¸å·¥ä½œã€‚

### firehose:DeleteDeliveryStream
```
aws firehose delete-delivery-stream --delivery-stream-name <value> --allow-force-delete
```
### firehose:UpdateDestination

#### Description

The `firehose:UpdateDestination` action allows you to update the specified delivery stream destination. This action can be used to modify the destination configuration, such as the S3 bucket or the data transformation settings.

#### Required Permissions

To perform the `firehose:UpdateDestination` action, the user must have the following permissions:

- `firehose:UpdateDestination` on the specified delivery stream.

#### Usage

```bash
aws firehose update-destination \
    --delivery-stream-name <delivery-stream-name> \
    --current-delivery-stream-version-id <current-delivery-stream-version-id> \
    --destination-id <destination-id> \
    --s3-destination-configuration <s3-destination-configuration> \
    --extended-s3-destination-configuration <extended-s3-destination-configuration> \
    --redshift-destination-configuration <redshift-destination-configuration> \
    --elasticsearch-destination-configuration <elasticsearch-destination-configuration> \
    --splunk-destination-configuration <splunk-destination-configuration> \
    --http-destination-configuration <http-destination-configuration> \
    --open-xray-destination-configuration <open-xray-destination-configuration> \
    --processing-configuration <processing-configuration> \
    --cloudwatch-logging-options <cloudwatch-logging-options> \
    --vpc-configuration <vpc-configuration> \
    --http-endpoint-configuration <http-endpoint-configuration> \
    --request-headers <request-headers> \
    --response-headers <response-headers> \
    --request-configuration <request-configuration> \
    --kinesis-streams-destination-configuration <kinesis-streams-destination-configuration> \
    --extended-kinesis-streams-destination-configuration <extended-kinesis-streams-destination-configuration> \
    --elasticsearch-buffering-hints <elasticsearch-buffering-hints> \
    --elasticsearch-retry-options <elasticsearch-retry-options> \
    --s3-buffering-hints <s3-buffering-hints> \
    --s3-retry-options <s3-retry-options> \
    --splunk-retry-options <splunk-retry-options> \
    --http-retry-options <http-retry-options> \
    --buffering-hints <buffering-hints> \
    --retry-options <retry-options> \
    --s3-backup-mode <s3-backup-mode> \
    --s3-backup-configuration <s3-backup-configuration> \
    --data-format-conversion-configuration <data-format-conversion-configuration> \
    --schema-configuration <schema-configuration> \
    --deserializer <deserializer> \
    --serializer <serializer> \
    --input-format-configuration <input-format-configuration> \
    --output-format-configuration <output-format-configuration> \
    --encryption-configuration <encryption-configuration> \
    --cloudwatch-encryption-configuration <cloudwatch-encryption-configuration> \
    --processing-configuration <processing-configuration> \
    --cloudwatch-logging-options <cloudwatch-logging-options> \
    --vpc-configuration <vpc-configuration> \
    --http-endpoint-configuration <http-endpoint-configuration> \
    --request-headers <request-headers> \
    --response-headers <response-headers> \
    --request-configuration <request-configuration> \
    --kinesis-streams-destination-configuration <kinesis-streams-destination-configuration> \
    --extended-kinesis-streams-destination-configuration <extended-kinesis-streams-destination-configuration> \
    --elasticsearch-buffering-hints <elasticsearch-buffering-hints> \
    --elasticsearch-retry-options <elasticsearch-retry-options> \
    --s3-buffering-hints <s3-buffering-hints> \
    --s3-retry-options <s3-retry-options> \
    --splunk-retry-options <splunk-retry-options> \
    --http-retry-options <http-retry-options> \
    --buffering-hints <buffering-hints> \
    --retry-options <retry-options> \
    --s3-backup-mode <s3-backup-mode> \
    --s3-backup-configuration <s3-backup-configuration> \
    --data-format-conversion-configuration <data-format-conversion-configuration> \
    --schema-configuration <schema-configuration> \
    --deserializer <deserializer> \
    --serializer <serializer> \
    --input-format-configuration <input-format-configuration> \
    --output-format-configuration <output-format-configuration> \
    --encryption-configuration <encryption-configuration> \
    --cloudwatch-encryption-configuration <cloudwatch-encryption-configuration>
```

#### Example

The following command updates the destination configuration for the specified delivery stream:

```bash
aws firehose update-destination \
    --delivery-stream-name my-delivery-stream \
    --current-delivery-stream-version-id 1 \
    --destination-id my-destination \
    --s3-destination-configuration '{"RoleARN": "arn:aws:iam::123456789012:role/firehose-role","BucketARN": "arn:aws:s3:::my-bucket","Prefix": "my-prefix/"}'
```

#### References

- [AWS Documentation: UpdateDestination](https://docs.aws.amazon.com/firehose/latest/APIReference/API_UpdateDestination.html)
```
aws firehose update-destination --delivery-stream-name <value> --current-delivery-stream-version-id <value> --destination-id <value>
```
### firehose:PutRecord | firehose:PutRecordBatch

#### æè¿°

`firehose:PutRecord`å’Œ`firehose:PutRecordBatch`æ˜¯ç”¨äºå°†æ•°æ®è®°å½•å‘é€åˆ°Amazon Kinesis Data Firehoseçš„AWS Identity and Access Management (IAM)æƒé™ã€‚

#### æ½œåœ¨é£é™©

æ”»å‡»è€…å¯èƒ½ä¼šæ»¥ç”¨è¿™äº›æƒé™æ¥å‘é€æ¶æ„æ•°æ®è®°å½•ï¼Œå¯¼è‡´æ•°æ®æ³„éœ²æˆ–æœåŠ¡ä¸­æ–­ã€‚

#### å»ºè®®

ä¸ºäº†å‡è½»æ½œåœ¨é£é™©ï¼Œå»ºè®®é‡‡å–ä»¥ä¸‹æªæ–½ï¼š

- é™åˆ¶å¯¹è¿™äº›æƒé™çš„è®¿é—®ï¼Œä»…æˆäºˆå¿…è¦çš„ç”¨æˆ·æˆ–è§’è‰²ã€‚
- å®šæœŸå®¡æŸ¥å’Œç›‘æ§ä¸è¿™äº›æƒé™ç›¸å…³çš„æ´»åŠ¨ï¼Œä»¥ä¾¿åŠæ—¶æ£€æµ‹å’Œåº”å¯¹ä»»ä½•å¼‚å¸¸è¡Œä¸ºã€‚
- å®æ–½æ•°æ®éªŒè¯å’Œè¿‡æ»¤æœºåˆ¶ï¼Œä»¥é˜²æ­¢æ¶æ„æ•°æ®è®°å½•çš„ä¼ è¾“ã€‚
- é…ç½®é€‚å½“çš„æ—¥å¿—è®°å½•å’Œç›‘æ§ï¼Œä»¥ä¾¿åŠæ—¶å‘ç°å’Œè°ƒæŸ¥ä»»ä½•æ½œåœ¨çš„å®‰å…¨äº‹ä»¶ã€‚

#### ç¤ºä¾‹

ä»¥ä¸‹æ˜¯ä½¿ç”¨AWS CLIå‘é€æ•°æ®è®°å½•çš„ç¤ºä¾‹ï¼š

```bash
aws firehose put-record --delivery-stream-name my-delivery-stream --record '{"Data":"SGVsbG8gd29ybGQ="}'
```

ä»¥ä¸‹æ˜¯ä½¿ç”¨AWS CLIæ‰¹é‡å‘é€æ•°æ®è®°å½•çš„ç¤ºä¾‹ï¼š

```bash
aws firehose put-record-batch --delivery-stream-name my-delivery-stream --records '[{"Data":"SGVsbG8gd29ybGQ="},{"Data":"VGhpcyBpcyBhIG5lZWQgdG8gdGV4dA=="}]'
```

#### å‚è€ƒ

- [Amazon Kinesis Data Firehose API Reference](https://docs.aws.amazon.com/firehose/latest/APIReference/API_Operations.html)
```
aws firehose put-record --delivery-stream-name my-stream --record '{"Data":"SGVsbG8gd29ybGQ="}'

aws firehose put-record-batch --delivery-stream-name my-stream --records file://records.json
```
## å‚è€ƒèµ„æ–™

* [https://docs.amazonaws.cn/en\_us/firehose/latest/dev/what-is-this-service.html](https://docs.amazonaws.cn/en\_us/firehose/latest/dev/what-is-this-service.html)

<details>

<summary><strong>æ”¯æŒ HackTricks å¹¶è·å¾—ç¦åˆ©ï¼</strong></summary>

* å¦‚æœæ‚¨æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Šï¼Œæˆ–è€…å¦‚æœæ‚¨æƒ³è®¿é—® PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ PDF ç‰ˆçš„ HackTricksï¼Œè¯·æŸ¥çœ‹ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ï¼
* è·å– [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family) é›†åˆ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) **å’Œ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
