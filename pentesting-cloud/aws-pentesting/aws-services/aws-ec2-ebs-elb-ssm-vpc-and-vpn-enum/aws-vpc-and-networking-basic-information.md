# AWS - VPC λ° λ„¤νΈμ›ν‚Ή κΈ°λ³Έ μ •λ³΄

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>λ¥Ό ν†µν•΄ AWS ν•΄ν‚Ήμ„ μ²μλ¶€ν„° μ „λ¬Έκ°€κΉμ§€ λ°°μ›λ³΄μ„Έμ”<strong>!</strong></summary>

HackTricksλ¥Ό μ§€μ›ν•λ” λ‹¤λ¥Έ λ°©λ²•:

* **νμ‚¬λ¥Ό HackTricksμ—μ„ κ΄‘κ³ ν•κ±°λ‚ HackTricksλ¥Ό PDFλ΅ λ‹¤μ΄λ΅λ“**ν•λ ¤λ©΄ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)λ¥Ό ν™•μΈν•μ„Έμ”!
* [**κ³µμ‹ PEASS & HackTricks μ¤μ›¨κ·Έ**](https://peass.creator-spring.com)λ¥Ό μ–»μΌμ„Έμ”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)λ¥Ό λ°κ²¬ν•μ„Έμ”. λ…μ μ μΈ [**NFT**](https://opensea.io/collection/the-peass-family) μ»¬λ ‰μ…μ…λ‹λ‹¤.
* π’¬ [**Discord κ·Έλ£Ή**](https://discord.gg/hRep4RUj7f) λλ” [**ν…”λ κ·Έλ¨ κ·Έλ£Ή**](https://t.me/peass)μ— **μ°Έμ—¬**ν•κ±°λ‚ **Twitter** π¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)λ¥Ό **ν”λ΅μ°**ν•μ„Έμ”.
* **HackTricks**μ™€ **HackTricks Cloud** github μ €μ¥μ†μ— PRμ„ μ μ¶ν•μ—¬ **ν•΄ν‚Ή νΈλ¦­μ„ κ³µμ **ν•μ„Έμ”.

</details>

## AWS λ„¤νΈμ›ν‚Ή μ”μ•½

**VPC**μ—λ” 10.0.0.0/16κ³Ό κ°™μ€ **λ„¤νΈμ›ν¬ CIDR** (λΌμ°ν… ν…μ΄λΈ” λ° λ„¤νΈμ›ν¬ ACLκ³Ό ν•¨κ»)κ°€ ν¬ν•¨λ©λ‹λ‹¤.

μ΄ VPC λ„¤νΈμ›ν¬λ” **μ„λΈλ„¤νΈμ›ν¬**λ΅ λ‚λ‰μ–΄μ§€λ―€λ΅ **μ„λΈλ„¤νΈμ›ν¬**λ” **VPC**, **λΌμ°ν… ν…μ΄λΈ”** λ° **λ„¤νΈμ›ν¬ ACL**κ³Ό μ§μ ‘ **κ΄€λ ¨**μ΄ μμµλ‹λ‹¤.

κ·Έλ° λ‹¤μ EC2 μΈμ¤ν„΄μ¤μ™€ κ°™μ€ μ„λΉ„μ¤μ— μ—°κ²°λ **λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤**λ” **λ³΄μ• κ·Έλ£Ή**κ³Ό ν•¨κ» **μ„λΈλ„¤νΈμ›ν¬**μ— **μ—°κ²°**λ©λ‹λ‹¤.

λ”°λΌμ„ **λ³΄μ• κ·Έλ£Ή**μ€ **λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤κ°€ μ‚¬μ©ν•λ” λ…Έμ¶λ ν¬νΈλ¥Ό μ ν•**ν•λ©°, **μ„λΈλ„¤νΈμ›ν¬μ™€λ” λ…λ¦½μ μΌλ΅** μ‘λ™ν•©λ‹λ‹¤. κ·Έλ¦¬κ³  **λ„¤νΈμ›ν¬ ACL**μ€ **μ „μ²΄ λ„¤νΈμ›ν¬μ— λ…Έμ¶λ ν¬νΈλ¥Ό μ ν•**ν•©λ‹λ‹¤.

λν•, **μΈν„°λ„·μ— μ•΅μ„Έμ¤**ν•κΈ° μ„ν•΄ ν™•μΈν•΄μ•Ό ν•  λ‡ κ°€μ§€ ν¥λ―Έλ΅μ΄ κµ¬μ„±μ΄ μμµλ‹λ‹¤:

* **μ„λΈλ„¤νΈμ›ν¬**λ” **κ³µκ° IPv4 μ£Όμ†λ¥Ό μλ™μΌλ΅ ν• λ‹Ή**ν•  μ μμµλ‹λ‹¤.
* **IPv4 μ£Όμ†λ¥Ό μλ™μΌλ΅ ν• λ‹Ήν•λ” λ„¤νΈμ›ν¬**μ—μ„ μƒμ„±λ **μΈμ¤ν„΄μ¤λ” ν•λ‚λ¥Ό μ–»μ„ μ μμµλ‹λ‹¤.**
* **μΈν„°λ„· κ²μ΄νΈμ›¨μ΄**λ¥Ό **VPCμ— μ—°κ²°**ν•΄μ•Ό ν•©λ‹λ‹¤.
* **Egress-only μΈν„°λ„· κ²μ΄νΈμ›¨μ΄**λ¥Ό μ‚¬μ©ν•  μλ„ μμµλ‹λ‹¤.
* **κ°μΈ μ„λΈλ„·**μ— **NAT κ²μ΄νΈμ›¨μ΄**λ¥Ό λ‘ μ μμΌλ―€λ΅ ν•΄λ‹Ή κ°μΈ μ„λΈλ„·μ—μ„ μ™Έλ¶€ μ„λΉ„μ¤μ— μ—°κ²°ν•  μ μμ§€λ§ μ™Έλ¶€μ—μ„λ” ν•΄λ‹Ή μ„λΉ„μ¤μ— μ—°κ²°ν•  μ μ—†μµλ‹λ‹¤.
* NAT κ²μ΄νΈμ›¨μ΄λ” **κ³µκ°**(μΈν„°λ„· μ•΅μ„Έμ¤) λλ” **κ°μΈ**(λ‹¤λ¥Έ VPCμ— μ•΅μ„Έμ¤)μΌ μ μμµλ‹λ‹¤.

![](<../../../../.gitbook/assets/image (73).png>)

## VPC

Amazon **Virtual Private Cloud** (Amazon VPC)λ¥Ό μ‚¬μ©ν•λ©΄ μ •μν• κ°€μƒ λ„¤νΈμ›ν¬λ΅ AWS λ¦¬μ†μ¤λ¥Ό μ‹μ‘ν•  μ μμµλ‹λ‹¤. μ΄ κ°€μƒ λ„¤νΈμ›ν¬μ—λ” μ—¬λ¬ μ„λΈλ„·, μΈν„°λ„· κ²μ΄νΈμ›¨μ΄(μΈν„°λ„· μ•΅μ„Έμ¤), ACL, λ³΄μ• κ·Έλ£Ή, IP λ“±μ΄ ν¬ν•¨λ©λ‹λ‹¤.

### μ„λΈλ„·

μ„λΈλ„·μ€ **μ μ‚¬ν• λ¦¬μ†μ¤μ λ…Όλ¦¬μ  κ·Έλ£Ήν™”**λ¥Ό κ°•ν™”ν•λ” λ° λ„μ›€μ΄ λ©λ‹λ‹¤. **μΈν”„λΌ μ „μ²΄μ—μ„ κ΄€λ¦¬μ μ©μ΄μ„±μ„ μ μ§€**ν•λ” λ°λ„ λ„μ›€μ΄ λ©λ‹λ‹¤.

* μ ν¨ν• CIDRμ€ /16 λ„·λ§μ¤ν¬μ—μ„ /28 λ„·λ§μ¤ν¬κΉμ§€μ…λ‹λ‹¤.
* μ„λΈλ„·μ€ λ™μ‹μ— λ‹¤λ¥Έ κ°€μ© μμ—­μ— μμ„ μ μ—†μµλ‹λ‹¤.
* **AWSλ” κ° μ„λΈλ„·μ μ²μ μ„Έ κ°μ νΈμ¤νΈ IP μ£Όμ†λ¥Ό λ‚΄λ¶€ AWS μ‚¬μ©μ„ μ„ν•΄ μμ•½**ν•©λ‹λ‹¤: μ²« λ²μ§Έ νΈμ¤νΈ μ£Όμ†λ” VPC λΌμ°ν„°μ©μΌλ΅ μ‚¬μ©λ©λ‹λ‹¤. λ‘ λ²μ§Έ μ£Όμ†λ” AWS DNSλ¥Ό μ„ν•΄ μμ•½λλ©°, μ„Έ λ²μ§Έ μ£Όμ†λ” λ―Έλ μ‚¬μ©μ„ μ„ν•΄ μμ•½λ©λ‹λ‹¤.
* **μΈν„°λ„·μ— μ§μ ‘ μ•΅μ„Έμ¤ν•  μ μλ” μ„λΈλ„·**μ„ **κ³µκ° μ„λΈλ„·**μ΄λΌκ³  ν•κ³ , κ·Έλ ‡μ§€ μ•μ€ μ„λΈλ„·μ„ **κ°μΈ μ„λΈλ„·**μ΄λΌκ³  ν•©λ‹λ‹¤.

<figure><img src="https://lh5.googleusercontent.com/N_WTrTrDAHwN61FMKJvLSHVua2EM0IazHH1fSTg8JQfTChm-dLN9mn7wkjz2MlpD-uOUqtWdMZpqKOp4VxaHy5-5X66GD1K8y1UGc27r-GbHdFty9ImpXdcjEsC7u4vjxKme_B_HwDOUnG6camxENYECTw=s2048" alt=""><figcaption></figcaption></figure>

<figure><img src="https://lh3.googleusercontent.com/MmjfVzGmV4jM7tO8lVoTKONoeqbq6E40DGeKUoo4kN-lmMDKnEiGNB-gGVx3EvjK9UV844im225CA8aAjomHf1Modt3MramHrHZdEGbeSZncWhVuT9R8f7tQZ2pXjdSJxeNfErmJ-0mmcUaV6dcU0TAd2A=s2048" alt=""><figcaption></figcaption></figure>

### λΌμ°ν… ν…μ΄λΈ”

λΌμ°ν… ν…μ΄λΈ”μ€ VPC λ‚΄μ μ„λΈλ„·μ— λ€ν• νΈλν”½ λΌμ°ν…μ„ κ²°μ •ν•©λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ μ–΄λ–¤ λ„¤νΈμ›ν¬ νΈλν”½μ΄ μΈν„°λ„·μΌλ΅ μ „λ‹¬λκ±°λ‚ VPN μ—°κ²°λ΅ μ „λ‹¬λλ”μ§€ κ²°μ •ν•  μ μμµλ‹λ‹¤. μΌλ°μ μΌλ΅ λ‹¤μμ— μ•΅μ„Έμ¤ν•  μ μμµλ‹λ‹¤:

* λ΅μ»¬ VPC
* NAT
* μΈν„°λ„· κ²μ΄νΈμ›¨μ΄ / Egress-only μΈν„°λ„· κ²μ΄νΈμ›¨μ΄ (VPCκ°€ μΈν„°λ„·μ— μ•΅μ„Έμ¤ν•λ ¤λ©΄ ν•„μ”ν•¨).
* μ„λΈλ„·μ„ κ³µκ°ν•λ ¤λ©΄ VPCμ— **μΈν„°λ„· κ²μ΄νΈμ›¨μ΄λ¥Ό μƒμ„±**ν•κ³  **μ—°κ²°**ν•΄μ•Ό ν•©λ‹λ‹¤.
* VPC μ—”λ“ν¬μΈνΈ (κ°μΈ λ„¤νΈμ›ν¬μ—μ„ S3μ— μ•΅μ„Έμ¤ν•κΈ° μ„ν•΄)

λ‹¤μ μ΄λ―Έμ§€μ—μ„ κΈ°λ³Έ κ³µκ° λ„¤νΈμ›ν¬μ™€ κ°μΈ λ„¤νΈμ›ν¬μ μ°¨μ΄λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤:

<figure><img src="https://lh3.googleusercontent.com/q4ASpcLAYqijdNMLhMLl8EoowDtTMU5I_7YCVfk7-5hxDyeQOik9ImHnD2SYy32XUA2qXjEbXTAxA1lP--znJASdhYOdBveDcrD42f9XBKZ3EmjJCazN3YPLC6oS0xtRMmfORuwCszmMt-KrAkH07_izwg=s2048" alt=""><figcaption></figcaption></figure>

<figure><img src="https://lh5.googleusercontent.com/30psylXAI0gRN6_LK-reP00aGIlMma64E1qafCVPunn6nS-y5jAO6Y2JiempKcf6-LFi7ScicYcOh7BbHEya2VWtksnFX_8SPXQf97tKkg2tNZzrArWbiDCCn2m2LP1QUq6MZ_KayH3yir7t8zpO7CEQOw=s2048" alt=""><figcaption></figcaption></figure>

### ACLs

**λ„¤νΈμ›ν¬ μ•΅μ„Έμ¤ μ μ–΄ λ©λ΅ (ACL)**: λ„¤νΈμ›ν¬ ACLμ€ μ„λΈλ„·μΌλ΅μ λ“¤μ–΄μ¤κ³  λ‚κ°€λ” λ„¤νΈ
### λ³΄μ• κ·Έλ£Ή

λ³΄μ• κ·Έλ£Ήμ€ VPC λ‚΄μ μΈμ¤ν„΄μ¤λ΅μ λ“¤μ–΄μ¤κ³  λ‚κ°€λ” λ„¤νΈμ›ν¬ νΈλν”½μ„ μ μ–΄ν•λ” κ°€μƒ λ°©ν™”λ²½μ…λ‹λ‹¤. μΌλ°μ μΌλ΅ 1κ°μ λ³΄μ• κ·Έλ£Ήμ€ Mκ°μ μΈμ¤ν„΄μ¤μ™€ κ΄€λ ¨λ©λ‹λ‹¤ (λ³΄ν†µ 1:1 κ΄€κ³„).\
μΌλ°μ μΌλ΅ μ΄λ” μΈμ¤ν„΄μ¤μ—μ„ μ„ν—ν• ν¬νΈλ¥Ό μ—΄κΈ° μ„ν•΄ μ‚¬μ©λ©λ‹λ‹¤. μλ¥Ό λ“¤μ–΄, ν¬νΈ 22μ™€ κ°™μ€ ν¬νΈλ¥Ό μ—΄ μ μμµλ‹λ‹¤:

<figure><img src="https://lh5.googleusercontent.com/LliB7eb3cYfkEyOpyw1-eYgWsn2kq1yF6uRn5VYndvOuTvDlURimYx9UvuK8F2impTLmx50mid4MdTXE-Ljt2i_rxaIfnKUdji_hFjCdU9tdoW-axng9-W4tSL71gbbjrPQ7IYY5lAdH_G3UoMRMGGGOxQ=s2048" alt=""><figcaption></figcaption></figure>

### νƒ„λ ¥μ  IP μ£Όμ†

νƒ„λ ¥μ  IP μ£Όμ†λ” λ™μ  ν΄λΌμ°λ“ μ»΄ν“¨ν…μ„ μ„ν•΄ μ„¤κ³„λ μ •μ  IPv4 μ£Όμ†μ…λ‹λ‹¤. νƒ„λ ¥μ  IP μ£Όμ†λ” AWS κ³„μ •μ— ν• λ‹Ήλλ©°, ν•΄μ ν•  λ•κΉμ§€ μ‚¬μ©ν•  μ μμµλ‹λ‹¤. νƒ„λ ¥μ  IP μ£Όμ†λ¥Ό μ‚¬μ©ν•λ©΄ μΈμ¤ν„΄μ¤λ‚ μ†ν”„νΈμ›¨μ–΄μ μ¥μ• λ¥Ό λΉ λ¥΄κ² λ‹¤λ¥Έ μΈμ¤ν„΄μ¤λ΅ λ§¤ν•‘ν•μ—¬ λ¬Έμ λ¥Ό μ¨κΈΈ μ μμµλ‹λ‹¤.

### μ„λΈλ„· κ°„ μ—°κ²°

κΈ°λ³Έμ μΌλ΅ λ¨λ“  μ„λΈλ„·μ€ κ³µμ© IP μ£Όμ†μ μλ™ ν• λ‹Ήμ΄ κΊΌμ Έ μμ§€λ§, μΌ¤ μ μμµλ‹λ‹¤.

λΌμ°ν… ν…μ΄λΈ” λ‚΄μ λ΅μ»¬ κ²½λ΅λ” VPC μ„λΈλ„· κ°„μ ν†µμ‹ μ„ κ°€λ¥ν•κ² ν•©λ‹λ‹¤.

λ‹¤λ¥Έ μ„λΈλ„·κ³Ό μ—°κ²°λ μ„λΈλ„·μ„ μ—°κ²°ν•λ” κ²½μ°, ν•΄λ‹Ή μ„λΈλ„·μ— μ§μ ‘ μ—°κ²°ν•΄μ•Ό ν•©λ‹λ‹¤. μ΄λ” μΈν„°λ„· κ²μ΄νΈμ›¨μ΄μ—λ„ μ μ©λ©λ‹λ‹¤. μΈν„°λ„·μ— μ ‘κ·Όν•λ ¤λ©΄ μ„λΈλ„· μ—°κ²°μ„ ν†µν•΄ κ°€λ” κ²ƒμ΄ μ•„λ‹λΌ μ„λΈλ„·μ— μΈν„°λ„· κ²μ΄νΈμ›¨μ΄λ¥Ό ν• λ‹Ήν•΄μ•Ό ν•©λ‹λ‹¤.

### VPC ν”Όμ–΄λ§

VPC ν”Όμ–΄λ§μ„ μ‚¬μ©ν•λ©΄ λ‘ κ° μ΄μƒμ VPCλ¥Ό ν•λ‚μ λ„¤νΈμ›ν¬λ΅ μ—°κ²°ν•  μ μμµλ‹λ‹¤. IPV4 λλ” IPV6λ¥Ό μ‚¬μ©ν•μ—¬ μ—°κ²°ν•©λ‹λ‹¤.

ν”Όμ–΄λ§ μ—°κ²°μ΄ μ„¤μ •λλ©΄ ν• VPCμ λ¦¬μ†μ¤κ°€ λ‹¤λ¥Έ VPCμ λ¦¬μ†μ¤μ— μ•΅μ„Έμ¤ν•  μ μμµλ‹λ‹¤. VPC κ°„μ μ—°κ²°μ€ κΈ°μ΅΄μ AWS λ„¤νΈμ›ν¬ μΈν”„λΌλ¥Ό ν†µν•΄ κµ¬ν„λλ―€λ΅ κ°€μ©μ„±μ΄ λ†’κ³  λ€μ—­ν­ λ³‘λ© ν„μƒμ΄ μ—†μµλ‹λ‹¤. ν”Όμ–΄λ§ μ—°κ²°μ€ λ§μΉ κ°™μ€ λ„¤νΈμ›ν¬μ μΌλ¶€μΈ κ²ƒμ²λΌ μ‘λ™ν•λ―€λ΅ μ‚¬μ©ν•  μ μλ” CIDR λΈ”λ΅ λ²”μ„μ— μ ν•μ΄ μμµλ‹λ‹¤.\
VPCμ CIDR λ²”μ„κ°€ κ²ΉμΉκ±°λ‚ μ¤‘λ³µλλ” κ²½μ° VPCλ¥Ό ν”Όμ–΄λ§ν•  μ μ—†μµλ‹λ‹¤.\
κ° AWS VPCλ” ν•΄λ‹Ή ν”Όμ–΄μ™€λ§ ν†µμ‹ ν•  μ μμµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄, VPC 1κ³Ό VPC 2 μ‚¬μ΄μ— ν”Όμ–΄λ§ μ—°κ²°μ΄ μκ³ , VPC 2μ™€ VPC 3 μ‚¬μ΄μ—λ„ μ—°κ²°μ΄ μλ‹¤λ©΄, VPC 1κ³Ό VPC 2λ” μ„λ΅ μ§μ ‘ ν†µμ‹ ν•  μ μκ³ , VPC 2μ™€ VPC 3λ„ ν†µμ‹ ν•  μ μμ§€λ§, VPC 1κ³Ό VPC 3μ€ ν†µμ‹ ν•  μ μ—†μµλ‹λ‹¤. **ν•λ‚μ VPCλ¥Ό ν†µν•΄ λ‹¤λ¥Έ VPCμ— μ ‘κ·Όν•  μ μ—†μµλ‹λ‹¤.**

### **VPC ν”λ΅μ° λ΅κ·Έ**

VPC λ‚΄μ—μ„λ” μλ°± κ° λλ” μμ² κ°μ λ¦¬μ†μ¤κ°€ λ¨λ‘ λ‹¤λ¥Έ μ„λΈλ„· (κ³µμ© λ° μ‚¬μ„¤) λ° VPC ν”Όμ–΄λ§ μ—°κ²°μ„ ν†µν•΄ ν†µμ‹ ν•  μ μμµλ‹λ‹¤. **VPC ν”λ΅μ° λ΅κ·Έλ¥Ό μ‚¬μ©ν•λ©΄ VPC λ‚΄μ λ¦¬μ†μ¤μ λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤ κ°„μ— νλ¥΄λ” IP νΈλν”½ μ •λ³΄λ¥Ό μΊ΅μ²ν•  μ μμµλ‹λ‹¤**.

S3 μ•΅μ„Έμ¤ λ΅κ·Έ λ° CloudFront μ•΅μ„Έμ¤ λ΅κ·Έμ™€ λ‹¬λ¦¬, VPC ν”λ΅μ° λ΅κ·Έλ΅ μƒμ„±λ λ΅κ·Έ λ°μ΄ν„°λ” S3μ— μ €μ¥λμ§€ μ•μµλ‹λ‹¤. λ€μ‹ , μΊ΅μ²λ λ΅κ·Έ λ°μ΄ν„°λ” CloudWatch λ΅κ·Έλ΅ μ „μ†΅λ©λ‹λ‹¤.

μ ν• μ‚¬ν•­:

* VPC ν”Όμ–΄λ§ μ—°κ²°μ„ μ‹¤ν–‰ μ¤‘μΈ κ²½μ°, λ™μΌν• κ³„μ • λ‚΄μ ν”Όμ–΄ VPCμ ν”λ΅μ° λ΅κ·Έλ§ λ³Ό μ μμµλ‹λ‹¤.
* EC2-Classic ν™κ²½μ—μ„ μ—¬μ „ν λ¦¬μ†μ¤λ¥Ό μ‹¤ν–‰ μ¤‘μΈ κ²½μ°, μΈν„°νμ΄μ¤μ—μ„ μ •λ³΄λ¥Ό κ²€μƒ‰ν•  μ μ—†μµλ‹λ‹¤.
* VPC ν”λ΅μ° λ΅κ·Έκ°€ μƒμ„±λ ν›„μ—λ” λ³€κ²½ν•  μ μ—†μµλ‹λ‹¤. VPC ν”λ΅μ° λ΅κ·Έ κµ¬μ„±μ„ λ³€κ²½ν•λ ¤λ©΄ μ‚­μ ν• λ‹¤μ μƒλ΅μ΄ λ΅κ·Έλ¥Ό λ‹¤μ‹ μƒμ„±ν•΄μ•Ό ν•©λ‹λ‹¤.
* λ‹¤μ νΈλν”½μ€ λ΅κ·Έλ΅ λ¨λ‹ν„°λ§λμ§€ μ•κ³  μΊ΅μ²λμ§€ μ•μµλ‹λ‹¤. VPC λ‚΄μ DHCP νΈλν”½, Amazon DNS μ„λ²„λ΅ ν–¥ν•λ” μΈμ¤ν„΄μ¤ νΈλν”½.
* VPC κΈ°λ³Έ λΌμ°ν„°μ IP μ£Όμ†λ΅ ν–¥ν•λ” νΈλν”½ λ° λ‹¤μ μ£Όμ†λ΅λ¶€ν„°μ νΈλν”½μ— λ€ν• λ΅κ·Έ. μΈμ¤ν„΄μ¤ λ©”νƒ€λ°μ΄ν„° μμ§‘μ— μ‚¬μ©λλ” 169.254.169.254 λ° Amazon Time Sync Serviceμ— μ‚¬μ©λλ” 169.254.169.123.
* Windows μΈμ¤ν„΄μ¤μ Amazon Windows ν™μ„±ν™” λΌμ΄μ„ μ¤μ™€ κ΄€λ ¨λ νΈλν”½
* λ„¤νΈμ›ν¬ λ΅λ“ λ°Έλ°μ„ μΈν„°νμ΄μ¤μ™€ μ—”λ“ν¬μΈνΈ λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤ κ°„μ νΈλν”½

CloudWatch λ΅κ·Έ κ·Έλ£Ήμ— λ°μ΄ν„°λ¥Ό κ²μ‹ν•λ” κ° λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤λ” λ³„λ„μ λ΅κ·Έ μ¤νΈλ¦Όμ„ μ‚¬μ©ν•©λ‹λ‹¤. μ΄λ¬ν• μ¤νΈλ¦Ό κ°κ°μ—λ” λ΅κ·Έ ν•­λ©μ λ‚΄μ©μ„ λ³΄μ—¬μ£Όλ” ν”λ΅μ° λ΅κ·Έ μ΄λ²¤νΈ λ°μ΄ν„°κ°€ ν¬ν•¨λ©λ‹λ‹¤. μ΄λ¬ν• λ΅κ·Έλ” μ•½ 10~15λ¶„ λ™μ•μ μλ„μ°μ—μ„ λ°μ΄ν„°λ¥Ό μΊ΅μ²ν•©λ‹λ‹¤.

## VPN

### κΈ°λ³Έ AWS VPN κµ¬μ„± μ”μ†

1. **κ³ κ° κ²μ΄νΈμ›¨μ΄**:
* κ³ κ° κ²μ΄νΈμ›¨μ΄λ” VPN μ—°κ²°μ κ³ κ° μΈ΅μ„ λ‚νƒ€λ‚΄κΈ° μ„ν•΄ AWSμ—μ„ μƒμ„±ν•λ” λ¦¬μ†μ¤μ…λ‹λ‹¤.
* μ‚¬μ‹¤μƒ μ‚¬μ΄νΈ κ°„ VPN μ—°κ²°μ κ³ κ° μΈ΅μ— μλ” λ¬Όλ¦¬μ  μ¥μΉ λλ” μ†ν”„νΈμ›¨μ–΄ μ‘μ© ν”„λ΅κ·Έλ¨μ…λ‹λ‹¤.
* λΌμ°ν… μ •λ³΄μ™€ λ„¤νΈμ›ν¬ μ¥μΉ (λΌμ°ν„° λλ” λ°©ν™”λ²½κ³Ό κ°™μ€)μ κ³µμ© IP μ£Όμ†λ¥Ό AWSμ— μ κ³µν•μ—¬ κ³ κ° κ²μ΄νΈμ›¨μ΄λ¥Ό μƒμ„±ν•©λ‹λ‹¤.
* VPN μ—°κ²° μ„¤μ •μ„ μ„ν• μ°Έμ΅°μ  μ—­ν• μ„ ν•λ©° μ¶”κ°€ λΉ„μ©μ΄ λ°μƒν•μ§€ μ•μµλ‹λ‹¤.
2. **κ°€μƒ ν”„λΌμ΄λΉ— κ²μ΄νΈμ›¨μ΄**:
* κ°€μƒ ν”„λΌμ΄λΉ— κ²μ΄νΈμ›¨μ΄ (VPG)λ” μ‚¬μ΄νΈ κ°„ VPN μ—°κ²°μ Amazon μΈ΅ VPN μ§‘μ¤‘κΈ°μ…λ‹λ‹¤.
* VPCμ— μ—°κ²°λμ–΄ VPN μ—°κ²°μ λ€μƒμΌλ΅ μ‚¬μ©λ©λ‹λ‹¤.
* VPGλ” VPN μ—°κ²°μ AWS μΈ΅ μ—”λ“ν¬μΈνΈμ…λ‹λ‹¤.
* VPCμ™€ μ¨ν”„λ λ―Έμ¤ λ„¤νΈμ›ν¬ κ°„μ μ•μ „ν• ν†µμ‹ μ„ μ²λ¦¬ν•©λ‹λ‹¤.
3. **μ‚¬μ΄νΈ κ°„ VPN μ—°κ²°**:
* μ‚¬μ΄νΈ κ°„ VPN μ—°κ²°μ€ μ•μ „ν• IPsec VPN ν„°λ„μ„ ν†µν•΄ μ¨ν”„λ λ―Έμ¤ λ„¤νΈμ›ν¬μ™€ VPCλ¥Ό μ—°κ²°ν•©λ‹λ‹¤.
* μ΄ μ ν•μ μ—°κ²°μ—λ” κ³ κ° κ²μ΄νΈμ›¨μ΄μ™€ κ°€μƒ ν”„λΌμ΄λΉ— κ²μ΄νΈμ›¨μ΄κ°€ ν•„μ”ν•©λ‹λ‹¤.
* λ°μ΄ν„° μ„Όν„° λλ” λ„¤νΈμ›ν¬μ™€ AWS ν™κ²½ κ°„μ μ•μ •μ μ΄κ³  μΌκ΄€λ ν†µμ‹ μ— μ‚¬μ©λ©λ‹λ‹¤.
* μΌλ°μ μΌλ΅ μ •
#### μ ν• μ‚¬ν•­

* κ°€μƒ μ‚¬μ„¤ κ²μ΄νΈμ›¨μ΄μ—μ„ VPN μ—°κ²°μ—λ” IPv6 νΈλν”½μ„ μ§€μ›ν•μ§€ μ•μµλ‹λ‹¤.
* AWS VPN μ—°κ²°μ€ Path MTU κ²€μƒ‰μ„ μ§€μ›ν•μ§€ μ•μµλ‹λ‹¤.

λν• Site-to-Site VPNμ„ μ‚¬μ©ν•  λ• λ‹¤μ μ‚¬ν•­μ„ κ³ λ ¤ν•μ‹­μ‹μ¤.

* VPCλ¥Ό κ³µν†µ μ¨ν”„λ λ―Έμ¤ λ„¤νΈμ›ν¬μ— μ—°κ²°ν•  λ•, λ„¤νΈμ›ν¬μ— μ¤‘μ²©λμ§€ μ•λ” CIDR λΈ”λ΅μ„ μ‚¬μ©ν•λ” κ²ƒμ΄ μΆ‹μµλ‹λ‹¤.

### ν΄λΌμ΄μ–ΈνΈ VPN <a href="#what-is-components" id="what-is-components"></a>

**μμ‹ μ κΈ°κΈ°μ—μ„ VPCλ΅ μ—°κ²°**

#### κ°λ…

* **ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈ:** ν΄λΌμ΄μ–ΈνΈ VPN μ„Έμ…μ„ ν™μ„±ν™”ν•κ³  κ΄€λ¦¬ν•κΈ° μ„ν•΄ μƒμ„±ν•κ³  κµ¬μ„±ν•λ” λ¦¬μ†μ¤μ…λ‹λ‹¤. λ¨λ“  ν΄λΌμ΄μ–ΈνΈ VPN μ„Έμ…μ΄ μΆ…λ£λλ” λ¦¬μ†μ¤μ…λ‹λ‹¤.
* **λ€μƒ λ„¤νΈμ›ν¬:** λ€μƒ λ„¤νΈμ›ν¬λ” ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈμ™€ μ—°κ΄€λ λ„¤νΈμ›ν¬μ…λ‹λ‹¤. **VPCμ μ„λΈλ„·μ€ λ€μƒ λ„¤νΈμ›ν¬μ…λ‹λ‹¤**. μ„λΈλ„·μ„ ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈμ™€ μ—°κ΄€μ‹ν‚¤λ©΄ VPN μ„Έμ…μ„ μ„¤μ •ν•  μ μμµλ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈμ— μ—¬λ¬ μ„λΈλ„·μ„ μ—°κ΄€μ‹μΌ κ³ κ°€μ©μ„±μ„ ν™•λ³΄ν•  μ μμµλ‹λ‹¤. λ¨λ“  μ„λΈλ„·μ€ λ™μΌν• VPCμ— μ†ν•΄μ•Ό ν•©λ‹λ‹¤. κ° μ„λΈλ„·μ€ λ‹¤λ¥Έ κ°€μ© μμ—­μ— μ†ν•΄μ•Ό ν•©λ‹λ‹¤.
* **κ²½λ΅**: κ° ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈμ—λ” μ‚¬μ© κ°€λ¥ν• λ€μƒ λ„¤νΈμ›ν¬ κ²½λ΅λ¥Ό μ„¤λ…ν•λ” κ²½λ΅ ν…μ΄λΈ”μ΄ μμµλ‹λ‹¤. κ²½λ΅ ν…μ΄λΈ”μ κ° κ²½λ΅λ” νΉμ • λ¦¬μ†μ¤ λλ” λ„¤νΈμ›ν¬λ΅μ νΈλν”½ κ²½λ΅λ¥Ό μ§€μ •ν•©λ‹λ‹¤.
* **μΈκ°€ κ·μΉ™:** μΈκ°€ κ·μΉ™μ€ **λ„¤νΈμ›ν¬μ— μ•΅μ„Έμ¤ν•  μ μλ” μ‚¬μ©μλ¥Ό μ ν•**ν•©λ‹λ‹¤. μ§€μ •λ λ„¤νΈμ›ν¬μ— λ€ν•΄ μ•΅μ„Έμ¤λ¥Ό ν—μ©ν•λ” Active Directory λλ” μ‹ μ› μ κ³µμ(IdP) κ·Έλ£Ήμ„ κµ¬μ„±ν•©λ‹λ‹¤. μ΄ κ·Έλ£Ήμ— μ†ν• μ‚¬μ©μλ§ μ§€μ •λ λ„¤νΈμ›ν¬μ— μ•΅μ„Έμ¤ν•  μ μμµλ‹λ‹¤. **κΈ°λ³Έμ μΌλ΅ μΈκ°€ κ·μΉ™μ΄ μ—†μΌλ―€λ΅** λ¦¬μ†μ¤μ™€ λ„¤νΈμ›ν¬μ— μ•΅μ„Έμ¤ν•λ ¤λ©΄ μΈκ°€ κ·μΉ™μ„ κµ¬μ„±ν•΄μ•Ό ν•©λ‹λ‹¤.
* **ν΄λΌμ΄μ–ΈνΈ:** VPN μ„Έμ…μ„ μ„¤μ •ν•κΈ° μ„ν•΄ ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈμ— μ—°κ²°ν•λ” μµμΆ… μ‚¬μ©μμ…λ‹λ‹¤. μ‚¬μ©μλ” OpenVPN ν΄λΌμ΄μ–ΈνΈλ¥Ό λ‹¤μ΄λ΅λ“ν•κ³  μƒμ„±ν• ν΄λΌμ΄μ–ΈνΈ VPN κµ¬μ„± νμΌμ„ μ‚¬μ©ν•μ—¬ VPN μ„Έμ…μ„ μ„¤μ •ν•΄μ•Ό ν•©λ‹λ‹¤.
* **ν΄λΌμ΄μ–ΈνΈ CIDR λ²”μ„:** ν΄λΌμ΄μ–ΈνΈ IP μ£Όμ†λ¥Ό ν• λ‹Ήν•κΈ° μ„ν• IP μ£Όμ† λ²”μ„μ…λ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈμ— λ€ν• κ° μ—°κ²°μ€ ν΄λΌμ΄μ–ΈνΈ CIDR λ²”μ„μ—μ„ κ³ μ ν• IP μ£Όμ†κ°€ ν• λ‹Ήλ©λ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈ CIDR λ²”μ„λ¥Ό μ„ νƒν•©λ‹λ‹¤. μλ¥Ό λ“¤μ–΄, `10.2.0.0/16`μ…λ‹λ‹¤.
* **ν΄λΌμ΄μ–ΈνΈ VPN ν¬νΈ:** AWS ν΄λΌμ΄μ–ΈνΈ VPNμ€ TCPμ™€ UDP λ¨λ‘μ— λ€ν•΄ ν¬νΈ 443κ³Ό 1194λ¥Ό μ§€μ›ν•©λ‹λ‹¤. κΈ°λ³Έκ°’μ€ ν¬νΈ 443μ…λ‹λ‹¤.
* **ν΄λΌμ΄μ–ΈνΈ VPN λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤:** μ„λΈλ„·μ„ ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈμ™€ μ—°κ΄€μ‹ν‚¬ λ•, ν•΄λ‹Ή μ„λΈλ„·μ— ν΄λΌμ΄μ–ΈνΈ VPN λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤κ°€ μƒμ„±λ©λ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈμ—μ„ VPCλ΅ μ „μ†΅λλ” νΈλν”½μ€ ν΄λΌμ΄μ–ΈνΈ VPN λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤λ¥Ό ν†µν•΄ μ „μ†΅λ©λ‹λ‹¤. κ·Έλ° λ‹¤μ ν΄λΌμ΄μ–ΈνΈ CIDR λ²”μ„μ μ†μ¤ IP μ£Όμ†κ°€ ν΄λΌμ΄μ–ΈνΈ VPN λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤ IP μ£Όμ†λ΅ λ³€ν™λ©λ‹λ‹¤.
* **μ—°κ²° λ΅κΉ…:** ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈμ— λ€ν• μ—°κ²° λ΅κΉ…μ„ ν™μ„±ν™”ν•μ—¬ μ—°κ²° μ΄λ²¤νΈλ¥Ό κΈ°λ΅ν•  μ μμµλ‹λ‹¤. μ΄ μ •λ³΄λ¥Ό μ‚¬μ©ν•μ—¬ ν¬λ μ‹μ„ μ‹¤ν–‰ν•κ±°λ‚ ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈμ μ‚¬μ© λ°©μ‹μ„ λ¶„μ„ν•κ±°λ‚ μ—°κ²° λ¬Έμ λ¥Ό λ””λ²„κ·Έν•  μ μμµλ‹λ‹¤.
* **μ…€ν”„ μ„λΉ„μ¤ ν¬ν„Έ:** ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈμ— λ€ν• μ…€ν”„ μ„λΉ„μ¤ ν¬ν„Έμ„ ν™μ„±ν™”ν•  μ μμµλ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈλ” μκ²© μ¦λ…μ„ μ‚¬μ©ν•μ—¬ μ›Ή κΈ°λ° ν¬ν„Έμ— λ΅κ·ΈμΈν•κ³  ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈ κµ¬μ„± νμΌμ μµμ‹  λ²„μ „ λλ” AWSμ—μ„ μ κ³µν•λ” μµμ‹  ν΄λΌμ΄μ–ΈνΈλ¥Ό λ‹¤μ΄λ΅λ“ν•  μ μμµλ‹λ‹¤.

#### μ ν• μ‚¬ν•­

* **ν΄λΌμ΄μ–ΈνΈ CIDR λ²”μ„λ” μ—°κ΄€λ μ„λΈλ„·μ΄ μ„μΉν• VPCμ λ΅μ»¬ CIDRκ³Ό μ¤‘μ²©λ  μ μ—†μµλ‹λ‹¤**. λν• ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈμ κ²½λ΅ ν…μ΄λΈ”μ— μλ™μΌλ΅ μ¶”κ°€λ κ²½λ΅μ™€λ„ μ¤‘μ²©λ  μ μ—†μµλ‹λ‹¤.
* ν΄λΌμ΄μ–ΈνΈ CIDR λ²”μ„λ” **μµμ† /22μ λΈ”λ΅ ν¬κΈ°λ¥Ό κ°€μ Έμ•Ό ν•λ©°, /12λ³΄λ‹¤ ν¬μ§€ μ•μ•„μ•Ό ν•©λ‹λ‹¤**.
* ν΄λΌμ΄μ–ΈνΈ CIDR λ²”μ„μ **μΌλ¶€ μ£Όμ†**λ” ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈμ κ°€μ©μ„± λ¨λΈμ„ μ§€μ›ν•κΈ° μ„ν•΄ μ‚¬μ©λλ©°, ν΄λΌμ΄μ–ΈνΈμ—κ² ν• λ‹Ήν•  μ μ—†μµλ‹λ‹¤. λ”°λΌμ„ ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈμ—μ„ μ§€μ›ν•  μµλ€ λ™μ‹ μ—°κ²° μμ— ν•„μ”ν• IP μ£Όμ†μ λ‘ λ°°λ¥Ό ν¬ν•¨ν•λ” CIDR λΈ”λ΅μ„ ν• λ‹Ήν•λ” κ²ƒμ΄ μΆ‹μµλ‹λ‹¤.
* ν΄λΌμ΄μ–ΈνΈ CIDR λ²”μ„λ” ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈλ¥Ό μƒμ„±ν• ν›„μ—λ” **λ³€κ²½ν•  μ μ—†μµλ‹λ‹¤**.
* ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈμ™€ μ—°κ΄€λ **μ„λΈλ„·μ€ λ™μΌν• VPCμ— μμ–΄μ•Ό ν•©λ‹λ‹¤**.
* **λ™μΌν• κ°€μ© μμ—­μ μ—¬λ¬ μ„λΈλ„·μ„ ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈμ™€ μ—°κ΄€μ‹ν‚¬ μ μ—†μµλ‹λ‹¤**.
* ν΄λΌμ΄μ–ΈνΈ VPN μ—”λ“ν¬μΈνΈλ” μ „μ© ν…λ„μ‹ VPCμ—μ„ **μ„λΈλ„· μ—°κ΄€μ„ μ§€μ›ν•μ§€ μ•μµλ‹λ‹¤**.
* ν΄λΌμ΄μ–ΈνΈ VPNμ€ **IPv4 νΈλν”½λ§ μ§€μ›**ν•©λ‹λ‹¤.
* ν΄λΌμ΄μ–ΈνΈ VPNμ€ **Federal Information Processing Standards (FIPS) κ·μ •μ„ μ¤€μν•μ§€ μ•μµλ‹λ‹¤**.
* Active Directoryμ—μ„ λ‹¤μ¤‘ μ”μ† μΈμ¦(MFA)μ΄ λΉ„ν™μ„±ν™”λ κ²½μ°, μ‚¬μ©μ μ•”νΈλ” λ‹¤μ ν•μ‹μ΄ λ  μ μ—†μµλ‹λ‹¤.

```
SCRV1:<base64_encoded_string>:<base64_encoded_string>
```
* μƒνΈ μΈμ¦μ„ μ‚¬μ©ν•μ—¬ μΈμ¦ν•λ” ν΄λΌμ΄μ–ΈνΈμ—κ²λ” μ…€ν”„ μ„λΉ„μ¤ ν¬ν„Έμ΄ **μ κ³µλμ§€ μ•μµλ‹λ‹¤**.

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>λ¥Ό ν†µν•΄ AWS ν•΄ν‚Ήμ„ μ²μλ¶€ν„° μ „λ¬Έκ°€κΉμ§€ λ°°μ›λ³΄μ„Έμ”!</summary>

HackTricksλ¥Ό μ§€μ›ν•λ” λ‹¤λ¥Έ λ°©λ²•:

* **νμ‚¬λ¥Ό HackTricksμ—μ„ κ΄‘κ³ ν•κ±°λ‚ HackTricksλ¥Ό PDFλ΅ λ‹¤μ΄λ΅λ“**ν•λ ¤λ©΄ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)λ¥Ό ν™•μΈν•μ„Έμ”!
* [**κ³µμ‹ PEASS & HackTricks μƒν’**](https://peass.creator-spring.com)μ„ κµ¬λ§¤ν•μ„Έμ”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)λ¥Ό λ°κ²¬ν•μ„Έμ”. λ…μ μ μΈ [**NFT**](https://opensea.io/collection/the-peass-family) μ»¬λ ‰μ…μ…λ‹λ‹¤.
* π’¬ [**Discord κ·Έλ£Ή**](https://discord.gg/hRep4RUj7f) λλ” [**ν…”λ κ·Έλ¨ κ·Έλ£Ή**](https://t.me/peass)μ— **μ°Έμ—¬**ν•κ±°λ‚ **Twitter** π¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**λ¥Ό** ν”λ΅μ°ν•μ„Έμ”.
* **HackTricks**μ™€ **HackTricks Cloud** github μ €μ¥μ†μ— PRμ„ μ μ¶ν•μ—¬ **μμ‹ μ ν•΄ν‚Ή κΈ°λ²•μ„ κ³µμ **ν•μ„Έμ”.

</details>
