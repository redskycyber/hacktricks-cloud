# AWS - S3 Post Eksploatacija

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju ogla코enu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## S3

Za vi코e informacija proverite:

{% content-ref url="../aws-services/aws-s3-athena-and-glacier-enum.md" %}
[aws-s3-athena-and-glacier-enum.md](../aws-services/aws-s3-athena-and-glacier-enum.md)
{% endcontent-ref %}

### Osetljive informacije

Ponekad 캖ete mo캖i da prona캠ete osetljive informacije koje su 캜itljive u kantama. Na primer, tajne stanja terraform-a.

### Pivoting

Razli캜ite platforme mogu koristiti S3 za skladi코tenje osetljivih resursa. Na primer, **airflow** mo쬰 skladi코titi **DAG-ove** **kod** tamo, ili **veb stranice** mogu direktno biti servirane iz S3. Napada캜 sa dozvolama za pisanje mo쬰 **izmeniti kod** u kanti da bi se **prebacio** na druge platforme, ili **preuzeo naloge** izmenom JS fajlova.

### S3 Ransomware

U ovom scenariju, **napada캜 kreira KMS (Key Management Service) klju캜 u svom AWS nalogu** ili drugom kompromitovanom nalogu. Zatim 캜ini ovaj **klju캜 dostupnim svima u svetu**, omogu캖avaju캖i bilo kom AWS korisniku, ulozi ili nalogu da 코ifruje objekte koriste캖i ovaj klju캜. Me캠utim, objekti ne mogu biti de코ifrovani.

Napada캜 identifikuje ciljanu **S3 kantu i dobija pristup na nivou pisanja** koriste캖i razli캜ite metode. To mo쬰 biti zbog lo코e konfiguracije kante koja je javno izlo쬰na ili napada캜 dobija pristup samom AWS okru쬰nju. Napada캜 obi캜no cilja kante koje sadr쬰 osetljive informacije kao 코to su li캜no prepoznatljive informacije (PII), za코ti캖ene zdravstvene informacije (PHI), logovi, rezervne kopije i jo코 mnogo toga.

Da bi utvrdio da li se kanta mo쬰 ciljati za ransomware, napada캜 proverava njenu konfiguraciju. To uklju캜uje proveru da li je **S3 Object Versioning** omogu캖eno i da li je omogu캖eno **brisanje sa vi코e faktora autentifikacije (MFA delete)**. Ako Object Versioning nije omogu캖en, napada캜 mo쬰 nastaviti. Ako je Object Versioning omogu캖en, ali MFA delete je onemogu캖en, napada캜 mo쬰 **onemogu캖iti Object Versioning**. Ako su i Object Versioning i MFA delete omogu캖eni, postaje te쬰 napada캜u da izvr코i ransomware na toj odre캠enoj kanti.

Koriste캖i AWS API, napada캜 **zamenjuje svaki objekat u kanti sa 코ifrovanom kopijom koriste캖i svoj KMS klju캜**. Ovo efektivno 코ifruje podatke u kanti, 캜ine캖i ih nedostupnim bez klju캜a.

Da bi dodatno izvr코io pritisak, napada캜 zakazuje brisanje KMS klju캜a koji je kori코캖en u napadu. To daje cilju prozor od 7 dana da povrati svoje podatke pre nego 코to klju캜 bude obrisan i podaci postanu trajno izgubljeni.

Na kraju, napada캜 mo쬰 otpremiti kona캜ni fajl, obi캜no nazvan "ransom-note.txt", koji sadr쬴 instrukcije za cilj kako da povrati svoje fajlove. Ovaj fajl se otprema bez 코ifrovanja, verovatno da bi privukao pa쬹ju cilja i obavestio ga o ransomware napadu.

**Za vi코e informacija** [**proverite originalno istra쬴vanje**](https://rhinosecuritylabs.com/aws/s3-ransomware-part-1-attack-vector/)**.**

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju ogla코enu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
