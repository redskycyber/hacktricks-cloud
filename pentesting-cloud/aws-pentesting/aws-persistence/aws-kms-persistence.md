# AWS - KMS ì§€ì†ì„±

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**ë¥¼** **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **Hacking íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì„¸ìš”.

</details>

## KMS

ìì„¸í•œ ë‚´ìš©ì€ ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

{% content-ref url="../../aws-security/aws-services/aws-kms-enum.md" %}
[aws-kms-enum.md](../../aws-security/aws-services/aws-kms-enum.md)
{% endcontent-ref %}

### KMS ì •ì±…ì„ í†µí•œ ì•¡ì„¸ìŠ¤ ê¶Œí•œ ë¶€ì—¬

ê³µê²©ìëŠ” **`kms:PutKeyPolicy`** ê¶Œí•œì„ ì‚¬ìš©í•˜ì—¬ í‚¤ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ ìì‹ ì´ ì œì–´í•˜ëŠ” ì‚¬ìš©ì ë˜ëŠ” ì™¸ë¶€ ê³„ì •ì—ê²Œ **ë¶€ì—¬**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ [**KMS Privesc í˜ì´ì§€**](../../aws-security/aws-privilege-escalation/aws-kms-privesc.md)ë¥¼ í™•ì¸í•˜ì„¸ìš”.

### ì˜êµ¬ì ì¸ ê¶Œí•œ

ê·¸ëœíŠ¸ëŠ” íŠ¹ì • í‚¤ì— ëŒ€í•´ ì£¼ì²´ì—ê²Œ ì¼ë¶€ ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ” ë˜ ë‹¤ë¥¸ ë°©ë²•ì…ë‹ˆë‹¤. ì‚¬ìš©ìì—ê²Œ ê·¸ëœíŠ¸ë¥¼ ìƒì„±í•  ìˆ˜ ìˆëŠ” ê¶Œí•œì„ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ì‚¬ìš©ìëŠ” ë™ì¼í•œ í‚¤ì— ëŒ€í•´ ì—¬ëŸ¬ ê·¸ëœíŠ¸ (ì‹¬ì§€ì–´ ë™ì¼í•œ ê·¸ëœíŠ¸)ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë”°ë¼ì„œ ì‚¬ìš©ìëŠ” ëª¨ë“  ê¶Œí•œì„ ê°€ì§„ 10ê°œì˜ ê·¸ëœíŠ¸ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê³µê²©ìëŠ” ì´ë¥¼ ì§€ì†ì ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì–´ëŠ ì‹œì ì—ì„œ 1ê°œì˜ ê·¸ëœíŠ¸ê°€ ì œê±°ë˜ë©´ ë‹¤ë¥¸ 10ê°œì˜ ê·¸ëœíŠ¸ê°€ ìƒì„±ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

(ì‚¬ìš©ìê°€ ì—¬ì „íˆ ì¼ë¶€ ê·¸ëœíŠ¸ë¥¼ ê°€ì§€ê³  ìˆëŠ” ë™ì•ˆ ê·¸ëœíŠ¸ê°€ ì œê±°ëœ ê²ƒì„ ê°ì§€í•˜ê¸° ìœ„í•´ 2ê°œê°€ ì•„ë‹Œ 10ê°œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤)
```bash
# To generate grants, generate 10 like this one
aws kms create-grant \
--key-id <key-id> \
--grantee-principal <user_arn> \
--operations "CreateGrant" "Decrypt"

# To monitor grants
aws kms list-grants --key-id <key-id>
```
{% hint style="info" %}
ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ” ë°ì—ëŠ” ë‹¤ìŒì—ì„œë§Œ ê¶Œí•œì„ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: [https://docs.aws.amazon.com/kms/latest/developerguide/grants.html#terms-grant-operations](https://docs.aws.amazon.com/kms/latest/developerguide/grants.html#terms-grant-operations)
{% endhint %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìƒí’ˆ**](https://peass.creator-spring.com)ì„ êµ¬ë§¤í•˜ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFT**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ ì—¬ëŸ¬ë¶„ì˜ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
