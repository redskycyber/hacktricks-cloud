# AWS - Lambda UzantÄ±larÄ±nÄ± KÃ¶tÃ¼ye Kullanma

<details>

<summary><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)'Ä± takip edin.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>

## Lambda UzantÄ±larÄ±

Lambda uzantÄ±larÄ±, Ã§eÅŸitli **izleme, gÃ¶zlemleme, gÃ¼venlik ve yÃ¶netim araÃ§larÄ±** ile iÅŸlevleri geliÅŸtirir. Bu uzantÄ±lar, Lambda katmanlarÄ± kullanÄ±larak [.zip arÅŸivleri kullanÄ±larak](https://docs.aws.amazon.com/lambda/latest/dg/configuration-layers.html) veya [konteyner gÃ¶rÃ¼ntÃ¼ daÄŸÄ±tÄ±mlarÄ±nda](https://aws.amazon.com/blogs/compute/working-with-lambda-layers-and-extensions-in-container-images/) dahil edilerek iki modda Ã§alÄ±ÅŸÄ±r: **dahili** ve **harici**.

* **Dahili uzantÄ±lar**, dil Ã¶zgÃ¼ Ã§evre deÄŸiÅŸkenleri ve sarmalama betikleri kullanarak Ã§alÄ±ÅŸma zamanÄ± sÃ¼reciyle birleÅŸir ve baÅŸlatmasÄ±nÄ± manipÃ¼le eder. Bu Ã¶zelleÅŸtirme, **Java Correto 8 ve 11, Node.js 10 ve 12 ve .NET Core 3.1** gibi Ã§eÅŸitli Ã§alÄ±ÅŸma zamanlarÄ± iÃ§in geÃ§erlidir.

* **Harici uzantÄ±lar**, ayrÄ± sÃ¼reÃ§ler olarak Ã§alÄ±ÅŸÄ±r ve Lambda iÅŸlevinin yaÅŸam dÃ¶ngÃ¼sÃ¼yle uyumlu bir ÅŸekilde Ã§alÄ±ÅŸÄ±r. Bunlar, **Node.js 10 ve 12, Python 3.7 ve 3.8, Ruby 2.5 ve 2.7, Java Corretto 8 ve 11, .NET Core 3.1** ve **Ã¶zel Ã§alÄ±ÅŸma zamanlarÄ±** gibi Ã§eÅŸitli Ã§alÄ±ÅŸma zamanlarÄ±yla uyumludur.

[**Lambda uzantÄ±larÄ±nÄ±n nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ± hakkÄ±nda daha fazla bilgi iÃ§in belgelere bakÄ±n**](https://docs.aws.amazon.com/lambda/latest/dg/runtimes-extensions-api.html).

### KalÄ±cÄ±lÄ±k, Ä°stekleri Ã‡alma ve Ä°stekleri DeÄŸiÅŸtirme iÃ§in Harici UzantÄ±

**Bu yazÄ±da Ã¶nerilen teknik iÃ§in bir Ã¶zet olacak:** [**https://www.clearvector.com/blog/lambda-spy/**](https://www.clearvector.com/blog/lambda-spy/)

AraÅŸtÄ±rmacÄ±lar, Lambda Ã§alÄ±ÅŸma zamanÄ± ortamÄ±ndaki varsayÄ±lan Linux Ã§ekirdeÄŸinin "**process\_vm\_readv**" ve "**process\_vm\_writev**" sistem Ã§aÄŸrÄ±larÄ±yla derlendiÄŸini bulmuÅŸlardÄ±r. Ve tÃ¼m sÃ¼reÃ§ler, harici uzantÄ± iÃ§in oluÅŸturulan yeni sÃ¼reÃ§ dahil olmak Ã¼zere aynÄ± kullanÄ±cÄ± kimliÄŸiyle Ã§alÄ±ÅŸÄ±r. **Bu, harici bir uzantÄ±nÄ±n Rapid'in heap belleÄŸine tam okuma ve yazma eriÅŸimi olduÄŸu anlamÄ±na gelir.**

AyrÄ±ca, Lambda **uzantÄ±larÄ±**, **Ã§aÄŸrÄ± olaylarÄ±na abone olabilir**; ancak AWS, uzantÄ±ya ham verileri aÃ§Ä±ÄŸa Ã§Ä±karmaz. Bu nedenle uzantÄ±, HTTP isteÄŸinde gÃ¶nderilen hassas bilgileri toplayamaz.

**Init** (Rapid) iÅŸlemi, **http://127.0.0.1:9001** Ã¼zerindeki tÃ¼m API isteklerini dinler. Lambda **uzantÄ±larÄ±**, Ã§alÄ±ÅŸma zamanÄ± kodundan Ã¶nce yÃ¼klenir ve Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r, ancak **Rapid'ten sonra**.

<figure><img src="../../../../.gitbook/assets/image (90).png" alt=""><figcaption></figcaption></figure>

â€œ**AWS\_LAMBDA\_RUNTIME\_API**â€ adlÄ± **deÄŸiÅŸken**, Ã§ocuk **Ã§alÄ±ÅŸma zamanÄ±** sÃ¼reÃ§lerine ve diÄŸer uzantÄ±lara Rapid API'nin **IP ve baÄŸlantÄ± noktasÄ± numarasÄ±nÄ± bildirir**.

{% hint style="warning" %}
Bu Ã§evre deÄŸiÅŸkenini, **kontrol ettiÄŸimiz bir baÄŸlantÄ± noktasÄ± numarasÄ±yla Ã¼zerine yazmak**, Lambda Ã§alÄ±ÅŸma zamanÄ± iÃ§indeki **tÃ¼m etkinliÄŸi man-in-the-middle yapmamÄ±za** olanak saÄŸlar.\
Ve Ã§ekirdek bu sistem Ã§aÄŸrÄ±larÄ±yla derlendiÄŸi ve **uzantÄ±**, Rapid Init ile **aynÄ± kullanÄ±cÄ± kimliÄŸiyle Ã§alÄ±ÅŸtÄ±ÄŸÄ±** iÃ§in, iÅŸlem belleÄŸini **Ã¼zerine yazmak** ve **baÄŸlantÄ± noktasÄ±nÄ± deÄŸiÅŸtirmek** mÃ¼mkÃ¼ndÃ¼r.
{% endhint %}

Ã‡Ã¼nkÃ¼ **uzantÄ±lar, Ã§alÄ±ÅŸma zamanÄ± kodundan Ã¶nce** Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r, **gÃ¼ncellenen Ã§evre deÄŸiÅŸkeni, Ã§alÄ±ÅŸma zamanÄ± sÃ¼reci yÃ¼rÃ¼tÃ¼ldÃ¼ÄŸÃ¼nde** (Python, Java, Node, Ruby, vb.) etkili olacaktÄ±r. AyrÄ±ca, bizimkinden sonra yÃ¼klenen ve bu deÄŸiÅŸkeni kullanan herhangi bir uzantÄ± da uzantÄ±mÄ±z aracÄ±lÄ±ÄŸÄ±yla proxy olarak yÃ¶nlendirilecektir. Bu, kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±mlarÄ±n **gÃ¼venlik Ã¼rÃ¼nlerini veya gÃ¼nlÃ¼kleme uzantÄ±larÄ±nÄ± Ã§alÄ±ÅŸma zamanÄ± iÃ§inden tamamen devre dÄ±ÅŸÄ± bÄ±rakmasÄ±na** olanak saÄŸlayabilir.

<figure><img src="../../../../.gitbook/assets/image (3) (4).png" alt=""><figcaption></figcaption></figure>

[**lambda-spy**](https://github.com/clearvector/lambda-spy) aracÄ±, bu bellek yazmasÄ±nÄ± gerÃ§ekleÅŸtirmek ve lambda isteklerinden hassas bilgileri Ã§almak, diÄŸer **uzantÄ±larÄ±n isteklerini** hatta **onlarÄ± deÄŸiÅŸtirmek** iÃ§in oluÅŸturulmuÅŸtur.

# Referanslar
* [https://aws.amazon.com/blogs/compute/building-extensions-for-aws-lambda-in-preview/](https://aws.amazon.com/blogs/compute/building-extensions-for-aws-lambda-in-preview/)

<details>

<summary><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)'Ä± takip edin.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>
