# GCP - Eskalacja uprawnieÅ„ w AppEngine

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## App Engine

Aby uzyskaÄ‡ wiÄ™cej informacji na temat App Engine, sprawdÅº:

{% content-ref url="../gcp-services/gcp-app-engine-enum.md" %}
[gcp-app-engine-enum.md](../gcp-services/gcp-app-engine-enum.md)
{% endcontent-ref %}

### `appengine.applications.get`, `appengine.instances.get`, `appengine.instances.list`, `appengine.operations.get`, `appengine.operations.list`, `appengine.services.get`, `appengine.services.list`, `appengine.versions.create`, `appengine.versions.get`, `appengine.versions.list`, `cloudbuild.builds.get`,`iam.serviceAccounts.actAs`, `resourcemanager.projects.get`, `storage.objects.create`, `storage.objects.list`

To sÄ… wymagane uprawnienia do **wdroÅ¼enia aplikacji za pomocÄ… polecenia `gcloud` cli**. MoÅ¼e byÄ‡ moÅ¼liwe **unikniÄ™cie** uprawnieÅ„ **`get`** i **`list`**.

PrzykÅ‚ady kodu Python moÅ¼na znaleÅºÄ‡ pod adresem [https://github.com/GoogleCloudPlatform/python-docs-samples/tree/main/appengine](https://github.com/GoogleCloudPlatform/python-docs-samples/tree/main/appengine)

DomyÅ›lnie nazwa usÅ‚ugi App to **`default`**, i moÅ¼e istnieÄ‡ tylko 1 instancja o tej samej nazwie.\
Aby to zmieniÄ‡ i utworzyÄ‡ drugÄ… aplikacjÄ™, w pliku **`app.yaml`** zmieÅ„ wartoÅ›Ä‡ klucza gÅ‚Ã³wnego na coÅ› takiego jak **`service: my-second-app`**.
```bash
cd python-docs-samples/appengine/flexible/hello_world
gcloud app deploy #Upload and start application inside the folder
```
Daj mu przynajmniej 10-15 minut, jeÅ›li to nie zadziaÅ‚a, zadzwoÅ„ **i wdroÅ¼ kolejny raz** i poczekaj kilka minut.

{% hint style="info" %}
**MoÅ¼na wskazaÄ‡, ktÃ³re konto usÅ‚ugi ma byÄ‡ uÅ¼ywane**, ale domyÅ›lnie uÅ¼ywane jest domyÅ›lne konto usÅ‚ugi App Engine.
{% endhint %}

Adres URL aplikacji wyglÄ…da tak: `https://<nazwa-projektu>.oa.r.appspot.com/` lub `https://<nazwa-usÅ‚ugi>-dot-<nazwa-projektu>.oa.r.appspot.com`

### `appengine.instances.enableDebug`, `appengine.instances.get`, `appengine.instances.list`, `appengine.operations.get`, `appengine.services.get`, `appengine.services.list`, `appengine.versions.get`, `appengine.versions.list`, `compute.projects.get`

Z tymi uprawnieniami moÅ¼liwe jest **logowanie siÄ™ za pomocÄ… SSH w instancjach App Engine** typu **flexible** (nie standardowego). NiektÃ³re z uprawnieÅ„ **`list`** i **`get`** **mogÄ… nie byÄ‡ naprawdÄ™ potrzebne**.
```bash
gcloud app instances ssh --service <app-name> --version <version-id> <ID>
```
### `appengine.applications.update`, `appengine.operations.get`

MyÅ›lÄ™, Å¼e to po prostu zmienia tÅ‚o SA, ktÃ³re Google bÄ™dzie uÅ¼ywaÄ‡ do konfiguracji aplikacji, wiÄ™c nie sÄ…dzÄ™, Å¼e moÅ¼na to wykorzystaÄ‡ do kradzieÅ¼y konta usÅ‚ugi.

{% code overflow="wrap" %}
```bash
gcloud app update --service-account=<sa_email>
```
{% endcode %}

### `appengine.versions.getFileContents`, `appengine.versions.update`

Nie jestem pewien, jak korzystaÄ‡ z tych uprawnieÅ„ ani czy sÄ… one przydatne (zauwaÅ¼, Å¼e gdy zmieniasz kod, tworzona jest nowa wersja, wiÄ™c nie wiem, czy moÅ¼na po prostu zaktualizowaÄ‡ kod lub rolÄ™ IAM jednej wersji, ale przypuszczam, Å¼e powinieneÅ› mÃ³c to zrobiÄ‡, byÄ‡ moÅ¼e zmieniajÄ…c kod wewnÄ…trz kubeÅ‚ka??).

### DostÄ™p do zapisu w kubeÅ‚kach

Nawet posiadajÄ…c dostÄ™p do zapisu w kubeÅ‚kach, w ktÃ³rych znajduje siÄ™ kod ÅºrÃ³dÅ‚owy, **nie byÅ‚o moÅ¼liwe wykonanie dowolnego kodu poprzez modyfikacjÄ™ kodu ÅºrÃ³dÅ‚owego i pliku `manifest.json`**.\
ByÄ‡ moÅ¼e, jeÅ›li monitorujesz kubeÅ‚ek i wykryjesz moment, w ktÃ³rym tworzona jest nowa wersja i przesyÅ‚any jest kod ÅºrÃ³dÅ‚owy i manifest, moÅ¼na je zmieniÄ‡, aby nowa wersja korzystaÅ‚a z wersji z backdoorami??

WyglÄ…da rÃ³wnieÅ¼ na to, Å¼e warstwy kontenera sÄ… przechowywane w kubeÅ‚ku, moÅ¼e warto je zmieniÄ‡?

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
