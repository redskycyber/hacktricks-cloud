# GCP - Privilegije eskalacije za AppEngine

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## App Engine

Za vi코e informacija o App Engine-u pogledajte:

{% content-ref url="../gcp-services/gcp-app-engine-enum.md" %}
[gcp-app-engine-enum.md](../gcp-services/gcp-app-engine-enum.md)
{% endcontent-ref %}

### `appengine.applications.get`, `appengine.instances.get`, `appengine.instances.list`, `appengine.operations.get`, `appengine.operations.list`, `appengine.services.get`, `appengine.services.list`, `appengine.versions.create`, `appengine.versions.get`, `appengine.versions.list`, `cloudbuild.builds.get`,`iam.serviceAccounts.actAs`, `resourcemanager.projects.get`, `storage.objects.create`, `storage.objects.list`

To su potrebne dozvole za **implementaciju aplikacije koriste캖i `gcloud` cli**. Mo쬯a se **`get`** i **`list`** mogu **izbe캖i**.

Python kod primere mo쬰te prona캖i na [https://github.com/GoogleCloudPlatform/python-docs-samples/tree/main/appengine](https://github.com/GoogleCloudPlatform/python-docs-samples/tree/main/appengine)

Podrazumevano, ime App servisa 캖e biti **`default`**, i mo쬰 postojati samo 1 instanca sa istim imenom.\
Da biste promenili to i kreirali drugu App, u **`app.yaml`**, promenite vrednost glavnog klju캜a na ne코to poput **`service: moja-druga-app`**
```bash
cd python-docs-samples/appengine/flexible/hello_world
gcloud app deploy #Upload and start application inside the folder
```
Dajte mu barem 10-15 minuta, ako ne uspe, pozovite **ponovno izvr코avanje** i sa캜ekajte nekoliko minuta.

{% hint style="info" %}
Mogu캖e je **nazna캜iti koji 캖e se Servisni nalog koristiti**, ali podrazumevano se koristi podrazumevani SA za App Engine.
{% endhint %}

URL aplikacije je ne코to poput `https://<proj-name>.oa.r.appspot.com/` ili `https://<service_name>-dot-<proj-name>.oa.r.appspot.com`

### `appengine.instances.enableDebug`, `appengine.instances.get`, `appengine.instances.list`, `appengine.operations.get`, `appengine.services.get`, `appengine.services.list`, `appengine.versions.get`, `appengine.versions.list`, `compute.projects.get`

Sa ovim dozvolama, mogu캖e je **prijaviti se putem SSH-a na instance App Engine** tipa **fleksibilne** (ne standardne). Neki od dozvola **`list`** i **`get`** mo쬯a **nisu zaista potrebni**.
```bash
gcloud app instances ssh --service <app-name> --version <version-id> <ID>
```
### `appengine.applications.update`, `appengine.operations.get`

Mislim da ovo samo menja pozadinski servisni nalog koji 캖e Google koristiti za pode코avanje aplikacija, tako da ne mislim da mo쬰te zloupotrebiti ovo da biste ukrali servisni nalog. 

{% code overflow="wrap" %}
```bash
gcloud app update --service-account=<sa_email>
```
{% endcode %}

### `appengine.versions.getFileContents`, `appengine.versions.update`

Nisam siguran kako koristiti ova ovla코캖enja ili da li su korisna (napomena da kada promenite kod, nova verzija se kreira, pa ne znam da li mo쬰te samo a쬿rirati kod ili IAM ulogu jedne, ali pretpostavljam da biste trebali mo캖i, mo쬯a promenom koda unutar kante??).

### Pristup pisanju nad kantama

캛ak i sa pristupom pisanju nad kantama gde se nalazi izvorni kod **NIJE bilo mogu캖e izvr코iti proizvoljni kod modifikacijom izvornog koda i `manifest.json`**.\
Mo쬯a, ako pratite kantu i otkrijete trenutak kada se kreira nova verzija i kada se izvorni kod i manifest otpremaju, mogu캖e je promeniti ih tako da nova verzija koristi one sa zadnjim vratima??

Izgleda da se i slojevi kontejnera 캜uvaju u kanti, mo쬯a promenom tih slojeva?
