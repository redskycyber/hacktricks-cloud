# GCP - Cloud Run Enum

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Cloud Run <a href="#reviewing-cloud-run-configurations" id="reviewing-cloud-run-configurations"></a>

Cloud Run je serverless upravljana ra캜unarska platforma koja vam omogu캖ava da **pokre캖ete kontejnere** direktno na Google-ovoj skalabilnoj infrastrukturi.

Mo쬰te pokrenuti svoj kontejner ili, ako koristite Go, Node.js, Python, Java, .NET Core ili Ruby, mo쬰te koristiti opciju [izvorne implementacije](https://cloud.google.com/run/docs/deploying-source-code) koja **gradi kontejner za vas.**

Google je izgradio Cloud Run da **dobro funkcioni코e zajedno sa drugim uslugama na Google Cloud-u**, tako da mo쬰te izgraditi aplikacije sa svim funkcionalnostima.

### Usluge i poslovi <a href="#services-and-jobs" id="services-and-jobs"></a>

Na Cloud Run-u, va코 kod mo쬰 da se izvr코ava kontinuirano kao _**usluga**_ ili kao _**posao**_. I usluge i poslovi se izvr코avaju u istom okru쬰nju i mogu koristiti iste integracije sa drugim uslugama na Google Cloud-u.

* **Cloud Run usluge.** Koriste se za izvr코avanje koda koji odgovara na web zahteve ili doga캠aje.
* **Cloud Run poslovi.** Koriste se za izvr코avanje koda koji obavlja posao i zavr코ava se kada je posao zavr코en.

## Cloud Run Usluga

Google [Cloud Run](https://cloud.google.com/run) je jo코 jedna serverless ponuda gde mo쬰te pretra쬴vati env promenljive. Cloud Run kreira malog veb servera koji podrazumevano radi na portu 8080 unutar kontejnera i 캜eka HTTP GET zahtev. Kada zahtev bude primljen, izvr코ava se posao i log posla se prikazuje putem HTTP odgovora.

### Relevantni detalji

* Podrazumevano, **pristup** veb serveru je **javni**, ali mo쬰 biti **ograni캜en na interni saobra캖aj** (VPC...)\
Osim toga, **autentifikacija** za kontaktiranje veb servera mo쬰 biti **dozvoljena za sve** ili **zahtevati autentifikaciju putem IAM**.
* Podrazumevano, **enkripcija** koristi **Google upravljani klju캜**, ali mo쬰 se izabrati i **CMEK** (Customer Managed Encryption Key) iz **KMS**.
* Podrazumevano, koristi se **servisni nalog** koji je podrazumevani nalog za Compute Engine i ima **Editor** pristup projektu i ima **scope `cloud-platform`.**
* Mogu캖e je definisati **캜itljive environment promenljive** za izvr코avanje, 캜ak i **montirati cloud tajne** ili **dodati cloud tajne u environment promenljive.**
* Tako캠e je mogu캖e **dodati konekcije sa Cloud SQL-om** i **montirati fajl sistem.**
* **URL-ovi** deploy-ovanih usluga su sli캜ni **`https://<svc-name>-<random>.a.run.app`**
* Run Usluga mo쬰 imati **vi코e od 1 verzije ili reviziju**, i **podeliti saobra캖aj** izme캠u nekoliko revizija.

### Enumeracija
```bash
# List services
gcloud run services list
gcloud run services list --platform=managed
gcloud run services list --platform=gke

# Get info of a service
gcloud run services describe --region <region> <svc-name>

# Get info of all the services together
gcloud run services list --format=yaml
gcloud run services list --platform=managed --format=json
gcloud run services list --platform=gke --format=json

# Get policy
gcloud run services get-iam-policy --region <region> <svc-name>

# Get revisions
gcloud run revisions list --region <region>
gcloud run revisions describe --region <region> <revision>

# Get domains
gcloud run domain-mappings list
gcloud run domain-mappings describe <name>

# Attempt to trigger a job unauthenticated
curl <url>

# Attempt to trigger a job with your current gcloud authorization
curl -H "Authorization: Bearer $(gcloud auth print-identity-token)" <url>
```
## Cloud Run poslovi

Cloud Run poslovi su bolje re코enje za **kontejnere koji se izvr코avaju do kraja i ne slu쬰 zahtevima**. Poslovi nemaju mogu캖nost da slu쬰 zahtevima ili oslu코kuju na portu. To zna캜i da, za razliku od Cloud Run servisa, poslovi ne bi trebalo da sadr쬰 veb server. Umesto toga, kontejneri poslova treba da se zavr코e kada zavr코e svoj posao.

### Enumeracija
```bash
gcloud beta run jobs list
gcloud beta run jobs describe --region <region> <job-name>
gcloud beta run jobs get-iam-policy --region <region> <job-name>
```
## Eskalacija privilegija

Na slede캖oj stranici mo쬰te proveriti kako **zloupotrebiti dozvole cloud run-a da biste eskalirali privilegije**:

{% content-ref url="../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md" %}
[gcp-run-privesc.md](../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md)
{% endcontent-ref %}

## Neautentifikovan pristup

{% content-ref url="../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md" %}
[gcp-cloud-run-unauthenticated-enum.md](../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md)
{% endcontent-ref %}

## Post eksploatacija

{% content-ref url="../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md" %}
[gcp-cloud-run-post-exploitation.md](../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md)
{% endcontent-ref %}

## Upornost

{% content-ref url="../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md" %}
[gcp-cloud-run-persistence.md](../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md)
{% endcontent-ref %}

## Reference

* [https://cloud.google.com/run/docs/overview/what-is-cloud-run](https://cloud.google.com/run/docs/overview/what-is-cloud-run)

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
