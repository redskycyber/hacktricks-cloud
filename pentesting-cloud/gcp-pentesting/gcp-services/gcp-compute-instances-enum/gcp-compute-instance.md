# GCP - è®¡ç®—å®ä¾‹

<details>

<summary><strong>ä»é›¶åˆ°è‹±é›„å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œå‚åŠ </strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨**HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä»¥PDFæ ¼å¼ä¸‹è½½HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

### ä¿å¯†VM

ä¿å¯†VMä½¿ç”¨ç”±æœ€æ–°ä¸€ä»£AMD EPYCå¤„ç†å™¨æä¾›çš„**åŸºäºç¡¬ä»¶çš„å®‰å…¨åŠŸèƒ½**ï¼Œå…¶ä¸­åŒ…æ‹¬å†…å­˜åŠ å¯†å’Œå®‰å…¨åŠ å¯†è™šæ‹ŸåŒ–ã€‚è¿™äº›åŠŸèƒ½ä½¿VMèƒ½å¤Ÿä¿æŠ¤å…¶å†…éƒ¨å¤„ç†å’Œå­˜å‚¨çš„æ•°æ®ï¼Œå³ä½¿æ˜¯ä¸»æœºæ“ä½œç³»ç»Ÿå’Œè™šæ‹Ÿæœºç®¡ç†ç¨‹åºä¹Ÿæ— æ³•è®¿é—®ã€‚

è¦è¿è¡Œä¿å¯†VMï¼Œå¯èƒ½éœ€è¦**æ›´æ”¹**ä¸€äº›è®¾ç½®ï¼Œå¦‚**æœºå™¨**çš„**ç±»å‹**ã€ç½‘ç»œ**æ¥å£**ã€**å¯åŠ¨ç£ç›˜æ˜ åƒ**ã€‚

### ç£ç›˜ & ç£ç›˜åŠ å¯†

å¯ä»¥**é€‰æ‹©ä½¿ç”¨çš„ç£ç›˜**æˆ–**åˆ›å»ºæ–°çš„ç£ç›˜**ã€‚å¦‚æœé€‰æ‹©æ–°çš„ç£ç›˜ï¼Œæ‚¨å¯ä»¥ï¼š

* é€‰æ‹©ç£ç›˜çš„**å¤§å°**
* é€‰æ‹©**æ“ä½œç³»ç»Ÿ**
* æŒ‡æ˜æ˜¯å¦å¸Œæœ›åœ¨å®ä¾‹åˆ é™¤æ—¶**åˆ é™¤ç£ç›˜**
* **åŠ å¯†**ï¼š**é»˜è®¤æƒ…å†µä¸‹**å°†ä½¿ç”¨**Googleç®¡ç†çš„å¯†é’¥**ï¼Œä½†æ‚¨ä¹Ÿå¯ä»¥**ä»KMSé€‰æ‹©å¯†é’¥**æˆ–æŒ‡æ˜**è¦ä½¿ç”¨çš„åŸå§‹å¯†é’¥**ã€‚

### éƒ¨ç½²å®¹å™¨

å¯ä»¥åœ¨åˆ›å»ºçš„è™šæ‹Ÿæœºå†…éƒ¨éƒ¨ç½²å®¹å™¨ï¼Œå¹¶ä¸ºæ­¤å®¹å™¨é…ç½®å¤šä¸ªé€‰é¡¹ï¼Œå¦‚ä»¥ç‰¹æƒæ¨¡å¼æ‰§è¡Œã€stdinã€ä¼ªTTYç­‰ã€‚

### æœåŠ¡è´¦æˆ·

é»˜è®¤æƒ…å†µä¸‹ï¼Œå°†ä½¿ç”¨**Compute Engineé»˜è®¤æœåŠ¡è´¦æˆ·**ã€‚æ­¤æœåŠ¡è´¦æˆ·çš„ç”µå­é‚®ä»¶æ ¼å¼å¦‚ä¸‹ï¼š`<proj-num>-compute@developer.gserviceaccount.com`\
è¿™ä¸ªæœåŠ¡è´¦æˆ·åœ¨æ•´ä¸ªé¡¹ç›®ä¸­æ‹¥æœ‰**ç¼–è¾‘è€…è§’è‰²ï¼ˆé«˜æƒé™ï¼‰ã€‚**

é»˜è®¤çš„è®¿é—®èŒƒå›´å¦‚ä¸‹ï¼š

* **https://www.googleapis.com/auth/devstorage.read\_only** -- å¯¹å­˜å‚¨æ¡¶çš„è¯»å–æƒé™ :)
* https://www.googleapis.com/auth/logging.write
* https://www.googleapis.com/auth/monitoring.write
* https://www.googleapis.com/auth/servicecontrol
* https://www.googleapis.com/auth/service.management.readonly
* https://www.googleapis.com/auth/trace.append

ç„¶è€Œï¼Œä¹Ÿå¯ä»¥**ä¸€é”®æˆäºˆ`cloud-platform`æƒé™**æˆ–æŒ‡å®š**è‡ªå®šä¹‰æƒé™**ã€‚

### é˜²ç«å¢™

å¯ä»¥å…è®¸HTTPå’ŒHTTPSæµé‡ã€‚

### IPè½¬å‘

å¯ä»¥åœ¨å®ä¾‹åˆ›å»ºæ—¶**å¯ç”¨IPè½¬å‘**ã€‚

### é¢å¤–å®‰å…¨æ€§

ä»¥ä¸‹é€‰é¡¹å°†**æé«˜VMçš„å®‰å…¨æ€§**ï¼Œå»ºè®®å¯ç”¨ï¼š

* **å®‰å…¨å¯åŠ¨**
* **å¯ç”¨vTPM**
* **å®Œæ•´æ€§ç›‘ç£**

### VMè®¿é—®

å¸¸è§çš„å¯ç”¨å¯¹VMçš„è®¿é—®æ–¹å¼æ˜¯**å…è®¸æŸäº›SSHå…¬é’¥**ã€‚\
ç„¶è€Œï¼Œä¹Ÿå¯ä»¥é€šè¿‡`os-config`æœåŠ¡**å¯ç”¨å¯¹VMçš„è®¿é—®ï¼Œå¹¶ä½¿ç”¨IAM**ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥å¯ç”¨2FAä»¥é€šè¿‡æ­¤æœåŠ¡è®¿é—®VMã€‚\
å½“æ­¤**æœåŠ¡**è¢«**å¯ç”¨**æ—¶ï¼Œé€šè¿‡**SSHå¯†é’¥çš„è®¿é—®å°†è¢«ç¦ç”¨ã€‚**

### å…ƒæ•°æ®

å¯ä»¥å®šä¹‰**userdata**ï¼š**Shellå‘½ä»¤**ï¼Œæ¯æ¬¡æœºå™¨å¼€æœºæˆ–é‡å¯æ—¶éƒ½ä¼šæ‰§è¡Œã€‚

è¿˜å¯ä»¥**æ·»åŠ é¢å¤–çš„å…ƒæ•°æ®é”®å€¼å¯¹**ï¼Œè¿™äº›å°†å¯ä»¥ä»å…ƒæ•°æ®ç«¯ç‚¹è®¿é—®ã€‚è¿™äº›ä¿¡æ¯é€šå¸¸ç”¨äºç¯å¢ƒå˜é‡å’Œå¯åŠ¨/å…³é—­è„šæœ¬ã€‚å¯ä»¥ä½¿ç”¨æšä¸¾éƒ¨åˆ†ä¸­å‘½ä»¤çš„**`describe`æ–¹æ³•**è·å–è¿™äº›ä¿¡æ¯ï¼Œä½†ä¹Ÿå¯ä»¥åœ¨å®ä¾‹å†…éƒ¨è®¿é—®å…ƒæ•°æ®ç«¯ç‚¹æ¥æ£€ç´¢ã€‚
```bash
# view project metadata
curl "http://metadata.google.internal/computeMetadata/v1/project/attributes/?recursive=true&alt=text" \
-H "Metadata-Flavor: Google"

# view instance metadata
curl "http://metadata.google.internal/computeMetadata/v1/instance/attributes/?recursive=true&alt=text" \
-H "Metadata-Flavor: Google"
```
æ­¤å¤–ï¼Œ**é™„åŠ æœåŠ¡è´¦æˆ·çš„è®¤è¯ä»¤ç‰Œ**å’Œæœ‰å…³å®ä¾‹ã€ç½‘ç»œå’Œé¡¹ç›®çš„**ä¸€èˆ¬ä¿¡æ¯**ä¹Ÿå°†å¯ä»**å…ƒæ•°æ®ç«¯ç‚¹**è·å–ã€‚æ›´å¤šä¿¡æ¯è¯·æŸ¥çœ‹ï¼š

{% embed url="https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery/cloud-ssrf#6440" %}

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸º</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨å¸Œæœ›åœ¨**HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDFç‰ˆæœ¬**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹çš„PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**telegramç¾¤ç»„**](https://t.me/peass)æˆ–åœ¨**Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥**åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
