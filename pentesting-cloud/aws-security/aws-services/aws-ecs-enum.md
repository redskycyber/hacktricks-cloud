# AWS - ECS Enum

<details>

<summary><strong>ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§ã®AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•ï¼š

* **HackTricksã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„**ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„å ´åˆ**ã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã‚¹ãƒ¯ãƒƒã‚°**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã‚‹
* **ğŸ’¬ [Discordã‚°ãƒ«ãƒ¼ãƒ—](https://discord.gg/hRep4RUj7f)**ã«å‚åŠ ã™ã‚‹ã‹ã€[telegramã‚°ãƒ«ãƒ¼ãƒ—](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€**[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>

## ECS

### åŸºæœ¬æƒ…å ±

Amazon **Elastic Container Services**ã¾ãŸã¯ECSã¯ã€**ã‚¯ãƒ©ã‚¦ãƒ‰ã§ã‚³ãƒ³ãƒ†ãƒŠåŒ–ã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ›ã‚¹ãƒˆ**ã™ã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’æä¾›ã—ã¾ã™ã€‚ECSã«ã¯ã€**EC2**ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ã¨**ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹**ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚ã‚‹**Fargate**ã®2ã¤ã®**ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ**æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯ã€**ã‚¯ãƒ©ã‚¦ãƒ‰ã§ã®ã‚³ãƒ³ãƒ†ãƒŠã®å®Ÿè¡Œã‚’éå¸¸ã«ç°¡å˜ã§ç—›ã¿ã®ãªã„ã‚‚ã®ã«ã—ã¾ã™**ã€‚

ECSã¯ã€æ¬¡ã®3ã¤ã®æ§‹æˆè¦ç´ ã‚’ä½¿ç”¨ã—ã¦å‹•ä½œã—ã¾ã™ï¼š**ã‚¯ãƒ©ã‚¹ã‚¿**ã€**ã‚µãƒ¼ãƒ“ã‚¹**ã€ãŠã‚ˆã³**ã‚¿ã‚¹ã‚¯å®šç¾©**ã€‚

* **ã‚¯ãƒ©ã‚¹ã‚¿**ã¯ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹**ã‚³ãƒ³ãƒ†ãƒŠã®ã‚°ãƒ«ãƒ¼ãƒ—**ã§ã™ã€‚å‰è¿°ã®ã‚ˆã†ã«ã€ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•ã‚¿ã‚¤ãƒ—ã«ã¯EC2ã¨Fargateã®2ã¤ãŒã‚ã‚Šã¾ã™ã€‚AWSã¯ã€**EC2**èµ·å‹•ã‚¿ã‚¤ãƒ—ã‚’ã€ŒAmazon EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚¯ãƒ©ã‚¹ã‚¿ã§ã‚³ãƒ³ãƒ†ãƒŠåŒ–ã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€ã¨å®šç¾©ã—ã¦ã„ã¾ã™ã€‚**Fargate**ã¯ä¼¼ã¦ãŠã‚Šã€ã€Œãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚’ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ãŠã‚ˆã³ç®¡ç†ã™ã‚‹å¿…è¦ãªã—ã«ã€ã‚³ãƒ³ãƒ†ãƒŠåŒ–ã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã‚‹ã€ã¨å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚
* **ã‚µãƒ¼ãƒ“ã‚¹**ã¯ã‚¯ãƒ©ã‚¹ã‚¿å†…ã«ä½œæˆã•ã‚Œã€**ã‚¿ã‚¹ã‚¯ã®å®Ÿè¡Œ**ã‚’æ‹…å½“ã—ã¾ã™ã€‚ã‚µãƒ¼ãƒ“ã‚¹å®šç¾©ã®ä¸­ã§ã€**å®Ÿè¡Œã™ã‚‹ã‚¿ã‚¹ã‚¯ã®æ•°ã€ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã€ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ãƒ—ãƒ­ãƒã‚¤ãƒ€ï¼ˆFargate/EC2/Externalï¼‰**ã€VPCã€ã‚µãƒ–ãƒãƒƒãƒˆã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ãªã©ã®**ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°**æƒ…å ±ã‚’å®šç¾©ã—ã¾ã™ã€‚
* **2ç¨®é¡ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³**ãŒã‚ã‚Šã¾ã™ï¼š
* **ã‚µãƒ¼ãƒ“ã‚¹**ï¼šé•·æ™‚é–“å®Ÿè¡Œã•ã‚Œã‚‹è¨ˆç®—ä½œæ¥­ã‚’å‡¦ç†ã™ã‚‹ã‚¿ã‚¹ã‚¯ã®ã‚°ãƒ«ãƒ¼ãƒ—ã§ã€åœæ­¢ãŠã‚ˆã³å†èµ·å‹•ãŒå¯èƒ½ã§ã™ã€‚ä¾‹ï¼šWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€‚
* **ã‚¿ã‚¹ã‚¯**ï¼šå®Ÿè¡Œã•ã‚Œã¦çµ‚äº†ã™ã‚‹ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ã®ã‚¿ã‚¹ã‚¯ã€‚ä¾‹ï¼šãƒãƒƒãƒã‚¸ãƒ§ãƒ–ã€‚
* ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¯ã€**2ç¨®é¡ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©**ãŒã‚ã‚Šã¾ã™ï¼š
* [**REPLICA**](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs\_services.html)ï¼šãƒ¬ãƒ—ãƒªã‚«ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°æˆ¦ç•¥ã¯ã€ã‚¯ãƒ©ã‚¹ã‚¿å…¨ä½“ã«**å¿…è¦ãªæ•°ã®ã‚¿ã‚¹ã‚¯ã‚’é…ç½®ãŠã‚ˆã³ç¶­æŒ**ã—ã¾ã™ã€‚ä½•ã‚‰ã‹ã®ç†ç”±ã§ã‚¿ã‚¹ã‚¯ãŒã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã•ã‚ŒãŸå ´åˆã€æ–°ã—ã„ã‚¿ã‚¹ã‚¯ãŒåŒã˜ãƒãƒ¼ãƒ‰ã¾ãŸã¯ç•°ãªã‚‹ãƒãƒ¼ãƒ‰ã«èµ·å‹•ã•ã‚Œã¾ã™ã€‚
* [**DAEMON**](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs\_services.html)ï¼šå¿…è¦ãªè¦ä»¶ã‚’æŒã¤ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã”ã¨ã«1ã¤ã®ã‚¿ã‚¹ã‚¯ã‚’å±•é–‹ã—ã¾ã™ã€‚ã‚¿ã‚¹ã‚¯ã®æ•°ã€ã‚¿ã‚¹ã‚¯é…ç½®æˆ¦ç•¥ã€Service Auto Scalingãƒãƒªã‚·ãƒ¼ã®æŒ‡å®šã¯ä¸è¦ã§ã™ã€‚
* **ã‚¿ã‚¹ã‚¯å®šç¾©**ã¯ã€**ã©ã®ã‚³ãƒ³ãƒ†ãƒŠãŒå®Ÿè¡Œã•ã‚Œã‚‹ã‹**ã¨ã€ãƒ›ã‚¹ãƒˆã¨ã®**ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°**ã€**ç’°å¢ƒå¤‰æ•°**ã€Dockerã®**ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ**ãªã©ã®ã‚³ãƒ³ãƒ†ãƒŠã¨æ§‹æˆã•ã‚Œã‚‹ã•ã¾ã–ã¾ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å®šç¾©ã™ã‚‹è²¬ä»»ãŒã‚ã‚Šã¾ã™ã€‚
* **æ©Ÿå¯†æƒ…å ±ã®ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèªã—ã¦ãã ã•ã„**ï¼

### ã‚¿ã‚¹ã‚¯å®šç¾©å†…ã®æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿

ã‚¿ã‚¹ã‚¯å®šç¾©ã¯ã€ECSã§å®Ÿè¡Œã•ã‚Œã‚‹**å®Ÿéš›ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’æ§‹æˆ**ã™ã‚‹è²¬ä»»ãŒã‚ã‚Šã¾ã™ã€‚ã‚¿ã‚¹ã‚¯å®šç¾©ã¯ã‚³ãƒ³ãƒ†ãƒŠã®å®Ÿè¡Œæ–¹æ³•ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã€å¤šãã®æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

Pacuã¯ECSã‚’åˆ—æŒ™ã§ãã¾ã™ï¼ˆlist-clustersã€list-container-instancesã€list-servicesã€list-task-definitionsï¼‰ã€ã¾ãŸã€ã‚¿ã‚¹ã‚¯å®šç¾©ã‚’ãƒ€ãƒ³ãƒ—ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

### åˆ—æŒ™
```bash
# Clusters info
aws ecs list-clusters
aws ecs describe-clusters --clusters <cluster>

# Container instances
## An Amazon ECS container instance is an Amazon EC2 instance that is running the Amazon ECS container agent and has been registered into an Amazon ECS cluster.
aws ecs list-container-instances --cluster <cluster>
aws ecs describe-container-instances --cluster <cluster> --container-instances <container_instance_arn>

# Services info
aws ecs list-services --cluster <cluster>
aws ecs describe-services --cluster <cluster> --services <services>
aws ecs describe-task-sets --cluster <cluster> --service <service>

# Task definitions
aws ecs list-task-definition-families
aws ecs list-task-definitions
aws ecs list-tasks --cluster <cluster>
aws ecs describe-tasks --cluster <cluster> --tasks <tasks>
## Look for env vars and secrets used from the task definition
aws ecs describe-task-definition --task-definition <TASK_NAME>:<VERSION>
```
### èªè¨¼ã•ã‚Œã¦ã„ãªã„ã‚¢ã‚¯ã‚»ã‚¹

{% content-ref url="../aws-unauthenticated-enum-access/aws-ecs-unauthenticated-enum.md" %}
[aws-ecs-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-ecs-unauthenticated-enum.md)
{% endcontent-ref %}

### Privesc

ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã§ã€**ECSæ¨©é™ã‚’æ‚ªç”¨ã—ã¦ç‰¹æ¨©ã‚’æ˜‡æ ¼ã™ã‚‹æ–¹æ³•**ã‚’ç¢ºèªã§ãã¾ã™:

{% content-ref url="../aws-privilege-escalation/aws-ecs-privesc.md" %}
[aws-ecs-privesc.md](../aws-privilege-escalation/aws-ecs-privesc.md)
{% endcontent-ref %}

### Post Exploitation

{% content-ref url="../aws-post-exploitation/aws-ecs-post-exploitation.md" %}
[aws-ecs-post-exploitation.md](../aws-post-exploitation/aws-ecs-post-exploitation.md)
{% endcontent-ref %}

### Persistence

{% content-ref url="../aws-persistence/aws-ecs-persistence.md" %}
[aws-ecs-persistence.md](../aws-persistence/aws-ecs-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>ã‚’ä½¿ã£ã¦ã€ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã¾ã—ã‚‡ã†</strong></a><strong>!</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricksã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„**ã€ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã—ã¦ãã ã•ã„
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã‚„[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚**
* **HackTricks**ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚

</details>
