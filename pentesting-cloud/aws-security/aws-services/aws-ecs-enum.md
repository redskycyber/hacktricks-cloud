# AWS - ECS Enum

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* ã‚‚ã— **HackTricks ã§ä¼šç¤¾ã‚’å®£ä¼ã—ãŸã„**å ´åˆã‚„ã€**PEASS ã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã„**å ´åˆã€ã¾ãŸã¯ **HackTricks ã‚’ PDF ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼ã® PEASS & HackTricks ã‚¹ãƒ¯ãƒƒã‚°**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ã“ã‚Œã¯ã€ç§ãŸã¡ã®ç‹¬å çš„ãª [**NFT**](https://opensea.io/collection/the-peass-family) ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™
* ğŸ’¬ [**Discord ã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f) ã¾ãŸã¯ [**telegram ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass) ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm) ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€** [**HackTricks**](https://github.com/carlospolop/hacktricks) ã¨ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ã® GitHub ãƒªãƒã‚¸ãƒˆãƒªã« PR ã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>

## ECS

### åŸºæœ¬æƒ…å ±

Amazon **Elastic Container Services**ï¼ˆECSï¼‰ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠåŒ–ã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¯ãƒ©ã‚¦ãƒ‰ä¸Šã§ãƒ›ã‚¹ãƒˆã™ã‚‹ãŸã‚ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’æä¾›ã—ã¾ã™ã€‚ECS ã«ã¯ã€**EC2** ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ã¨ **ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹** ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚ã‚‹ **Fargate** ã®2ã¤ã® **ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ** ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã§ã®ã‚³ãƒ³ãƒ†ãƒŠã®å®Ÿè¡Œã‚’éå¸¸ã«ç°¡å˜ã§ç—›ã¿ã®ãªã„ã‚‚ã®ã«ã—ã¾ã™ã€‚

ECS ã¯ã€æ¬¡ã®3ã¤ã®æ§‹æˆè¦ç´ ã‚’ä½¿ç”¨ã—ã¦å‹•ä½œã—ã¾ã™ï¼š**ã‚¯ãƒ©ã‚¹ã‚¿**ã€**ã‚µãƒ¼ãƒ“ã‚¹**ã€ãŠã‚ˆã³ **ã‚¿ã‚¹ã‚¯å®šç¾©**ã€‚

* **ã‚¯ãƒ©ã‚¹ã‚¿** ã¯ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ **ã‚³ãƒ³ãƒ†ãƒŠã®ã‚°ãƒ«ãƒ¼ãƒ—** ã§ã™ã€‚å‰è¿°ã®ã‚ˆã†ã«ã€ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•ã‚¿ã‚¤ãƒ—ã«ã¯ EC2 ã¨ Fargate ã®2ã¤ãŒã‚ã‚Šã¾ã™ã€‚AWS ã¯ã€EC2 èµ·å‹•ã‚¿ã‚¤ãƒ—ã‚’ã€ŒAmazon EC2 ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚¯ãƒ©ã‚¹ã‚¿ä¸Šã§ã‚³ãƒ³ãƒ†ãƒŠåŒ–ã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ã‚‚ã®ã€ã¨å®šç¾©ã—ã¦ã„ã¾ã™ã€‚Fargate ã‚‚åŒæ§˜ã§ã€ã€Œãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚’ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ãŠã‚ˆã³ç®¡ç†ã™ã‚‹å¿…è¦ãŒãªã„ã§ã€ã‚³ãƒ³ãƒ†ãƒŠåŒ–ã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€ã¨å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚
* **ã‚µãƒ¼ãƒ“ã‚¹** ã¯ã€ã‚¯ãƒ©ã‚¹ã‚¿å†…ã«ä½œæˆã•ã‚Œã€**ã‚¿ã‚¹ã‚¯ã®å®Ÿè¡Œ** ã‚’æ‹…å½“ã—ã¾ã™ã€‚ã‚µãƒ¼ãƒ“ã‚¹å®šç¾©å†…ã§ã¯ã€å®Ÿè¡Œã™ã‚‹ã‚¿ã‚¹ã‚¯ã®æ•°ã€è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã€ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ãƒ—ãƒ­ãƒã‚¤ãƒ€ï¼ˆFargate/EC2/Externalï¼‰ã€VPCã€ã‚µãƒ–ãƒãƒƒãƒˆã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ãªã©ã® **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°** æƒ…å ±ã‚’å®šç¾©ã—ã¾ã™ã€‚
* **2ç¨®é¡ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³** ãŒã‚ã‚Šã¾ã™ï¼š
* **ã‚µãƒ¼ãƒ“ã‚¹**ï¼šé•·æ™‚é–“å®Ÿè¡Œã•ã‚Œã‚‹è¨ˆç®—ä½œæ¥­ã‚’å‡¦ç†ã™ã‚‹ã‚¿ã‚¹ã‚¯ã®ã‚°ãƒ«ãƒ¼ãƒ—ã§ã€åœæ­¢ã—ã¦å†é–‹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* **ã‚¿ã‚¹ã‚¯**ï¼šå˜ç‹¬ã®ã‚¿ã‚¹ã‚¯ãŒå®Ÿè¡Œã•ã‚Œã€çµ‚äº†ã—ã¾ã™ã€‚ä¾‹ãˆã°ã€ãƒãƒƒãƒã‚¸ãƒ§ãƒ–ã§ã™ã€‚
* ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¸­ã«ã¯ã€**2ç¨®é¡ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©** ãŒã‚ã‚Šã¾ã™ï¼š
* [**REPLICA**](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs_services.html)ï¼šãƒ¬ãƒ—ãƒªã‚«ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°æˆ¦ç•¥ã¯ã€ã‚¯ãƒ©ã‚¹ã‚¿å…¨ä½“ã«ã‚¿ã‚¹ã‚¯ã® **æ‰€æœ›ã®æ•°ã‚’é…ç½®ã—ç¶­æŒ** ã—ã¾ã™ã€‚ä½•ã‚‰ã‹ã®ç†ç”±ã§ã‚¿ã‚¹ã‚¯ãŒã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã—ãŸå ´åˆã€åŒã˜ãƒãƒ¼ãƒ‰ã¾ãŸã¯ç•°ãªã‚‹ãƒãƒ¼ãƒ‰ã§æ–°ã—ã„ã‚¿ã‚¹ã‚¯ãŒèµ·å‹•ã•ã‚Œã¾ã™ã€‚
* [**DAEMON**](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs_services.html)ï¼šå¿…è¦ãªè¦ä»¶ã‚’æº€ãŸã™ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã”ã¨ã«æ­£ç¢ºã«1ã¤ã®ã‚¿ã‚¹ã‚¯ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚ã‚¿ã‚¹ã‚¯ã®æ‰€æœ›ã®æ•°ã€ã‚¿ã‚¹ã‚¯é…ç½®æˆ¦ç•¥ã€ã¾ãŸã¯ã‚µãƒ¼ãƒ“ã‚¹ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãƒãƒªã‚·ãƒ¼ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
* **ã‚¿ã‚¹ã‚¯å®šç¾©** ã¯ã€å®Ÿè¡Œã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã‚’ **å®šç¾©** ã—ã€ã‚³ãƒ³ãƒ†ãƒŠã¨é–¢é€£ã™ã‚‹ã•ã¾ã–ã¾ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆãƒ›ã‚¹ãƒˆã¨ã®ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°ã€ç’°å¢ƒå¤‰æ•°ã€Docker ã®ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆãªã©ï¼‰ã‚’è¨­å®šã™ã‚‹è²¬ä»»ãŒã‚ã‚Šã¾ã™ã€‚
* **ç’°å¢ƒå¤‰æ•°ã«ã¯æ©Ÿå¯†æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§æ³¨æ„ã—ã¦ãã ã•ã„**ï¼

### ã‚¿ã‚¹ã‚¯å®šç¾©å†…ã®æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿

ã‚¿ã‚¹ã‚¯å®šç¾©ã¯ã€ECS ã§å®Ÿè¡Œã•ã‚Œã‚‹å®Ÿéš›ã®ã‚³ãƒ³ãƒ†ãƒŠã®è¨­å®šã‚’è¡Œã†è²¬ä»»ãŒã‚ã‚Šã¾ã™ã€‚ã‚¿ã‚¹ã‚¯å®šç¾©ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠã®å®Ÿè¡Œæ–¹æ³•ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã€å¤šãã®æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

Pacu ã¯ ECS ã‚’åˆ—æŒ™ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆlist-clustersã€list-container-instancesã€list-servicesã€list-task-definitionsï¼‰ã€‚ã¾ãŸã€ã‚¿ã‚¹ã‚¯å®šç¾©ã‚’ãƒ€ãƒ³ãƒ—ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

### åˆ—æŒ™
```bash
# Clusters info
aws ecs list-clusters
aws ecs describe-clusters --clusters <cluster>

# Container instances
## An Amazon ECS container instance is an Amazon EC2 instance that is running the Amazon ECS container agent and has been registered into an Amazon ECS cluster.
aws ecs list-container-instances --cluster <cluster>
aws ecs describe-container-instances --cluster <cluster> --container-instances <container_instance_arn>

# Services info
aws ecs list-services --cluster <cluster>
aws ecs describe-services --cluster <cluster> --services <services>
aws ecs describe-task-sets --cluster <cluster> --service <service>

# Task definitions
aws ecs list-task-definition-families
aws ecs list-task-definitions
aws ecs list-tasks --cluster <cluster>
aws ecs describe-tasks --cluster <cluster> --tasks <tasks>
## Look for env vars and secrets used from the task definition
aws ecs describe-task-definition --task-definition <TASK_NAME>:<VERSION>
```
### èªè¨¼ã•ã‚Œã¦ã„ãªã„ã‚¢ã‚¯ã‚»ã‚¹

{% content-ref url="../aws-unauthenticated-enum-access/aws-ecs-unauthenticated-enum.md" %}
[aws-ecs-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-ecs-unauthenticated-enum.md)
{% endcontent-ref %}

### ç‰¹æ¨©æ˜‡æ ¼

ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã§ã¯ã€**ECSã®æ¨©é™ã‚’æ‚ªç”¨ã—ã¦ç‰¹æ¨©ã‚’æ˜‡æ ¼ã•ã›ã‚‹æ–¹æ³•**ã‚’ç¢ºèªã§ãã¾ã™ï¼š

{% content-ref url="../aws-privilege-escalation/aws-ecs-privesc.md" %}
[aws-ecs-privesc.md](../aws-privilege-escalation/aws-ecs-privesc.md)
{% endcontent-ref %}

### æ”»æ’ƒå¾Œã®å‡¦ç†

{% content-ref url="../aws-post-exploitation/aws-ecs-post-exploitation.md" %}
[aws-ecs-post-exploitation.md](../aws-post-exploitation/aws-ecs-post-exploitation.md)
{% endcontent-ref %}

### æ°¸ç¶šåŒ–

{% content-ref url="../aws-persistence/aws-ecs-persistence.md" %}
[aws-ecs-persistence.md](../aws-persistence/aws-ecs-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* ã‚‚ã—ã‚‚ã‚ãªãŸã®**ä¼šç¤¾ã‚’HackTricksã§å®£ä¼ã—ãŸã„**å ´åˆã‚„ã€**æœ€æ–°ç‰ˆã®PEASSã‚’å…¥æ‰‹ã—ãŸã„**å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼ã®PEASSï¼†HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ã€ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§ç§ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¾ã—ã‚‡ã† ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€PRã‚’** [**HackTricks**](https://github.com/carlospolop/hacktricks) **ã¨** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
