# AWS - Elastic Beanstalk Enum

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Elastic Beanstalk

Amazon Elastic Beanstalk pruÅ¾a pojednostavljenu platformu za **implementaciju, upravljanje i skaliranje veb aplikacija i usluga**. PodrÅ¾ava razliÄite programske jezike i okvire, poput Java, .NET, PHP, Node.js, Python, Ruby i Go, kao i Docker kontejnere. Usluga je kompatibilna sa Å¡iroko koriÅ¡Ä‡enim serverima ukljuÄujuÄ‡i Apache, Nginx, Passenger i IIS.

Elastic Beanstalk pruÅ¾a jednostavan i fleksibilan naÄin za **implementaciju vaÅ¡ih aplikacija u AWS oblaku**, bez potrebe za brigu o osnovnoj infrastrukturi. Automatski se bavi detaljima kapaciteta **pruÅ¾anja**, balansiranja optereÄ‡enja, **skaliranja** i praÄ‡enja zdravlja aplikacije, omoguÄ‡avajuÄ‡i vam da se fokusirate na pisanje i implementaciju koda.

Infrastruktura kreirana od strane Elastic Beanstalk-a upravlja se putem **Autoscaling** grupa u **EC2** (sa balanserom optereÄ‡enja). Å to znaÄi da, ako na kraju dana **ugrozite host**, trebalo bi da znate o EC2:

{% content-ref url="aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/" %}
[aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/](aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/)
{% endcontent-ref %}

Osim toga, ako se koristi Docker, moguÄ‡e je koristiti **ECS**.

{% content-ref url="aws-eks-enum.md" %}
[aws-eks-enum.md](aws-eks-enum.md)
{% endcontent-ref %}

### Aplikacija & OkruÅ¾enja

U AWS Elastic Beanstalk-u, koncepti "aplikacije" i "okruÅ¾enja" sluÅ¾e razliÄitim svrhama i imaju razliÄite uloge u procesu implementacije.

#### Aplikacija

* Aplikacija u Elastic Beanstalk-u je **logiÄki kontejner za izvorni kod vaÅ¡e aplikacije, okruÅ¾enja i konfiguracije**. GrupiÅ¡e razliÄite verzije koda vaÅ¡e aplikacije i omoguÄ‡ava vam da ih upravljate kao jednu celinu.
* Kada kreirate aplikaciju, pruÅ¾ate ime i opis, ali **nijedan resurs nije obezbeÄ‘en** u ovom trenutku. To je jednostavno naÄin organizovanja i upravljanja vaÅ¡im kodom i povezanim resursima.
* MoÅ¾ete imati **viÅ¡e verzija aplikacija** unutar jedne aplikacije. Svaka verzija odgovara odreÄ‘enom izdanju vaÅ¡eg koda, koji se moÅ¾e implementirati u jedno ili viÅ¡e okruÅ¾enja.

#### OkruÅ¾enje

* OkruÅ¾enje je **obezbeÄ‘ena instanca vaÅ¡e aplikacije** koja se izvrÅ¡ava na AWS infrastrukturi. To je **gde se vaÅ¡ aplikativni kod implementira i izvrÅ¡ava**. Elastic Beanstalk obezbeÄ‘uje neophodne resurse (npr. EC2 instance, balanseri optereÄ‡enja, auto-skaliranje grupa, baze podataka) na osnovu konfiguracije okruÅ¾enja.
* **Svako okruÅ¾enje pokreÄ‡e jednu verziju vaÅ¡e aplikacije**, i moÅ¾ete imati viÅ¡e okruÅ¾enja za razliÄite svrhe, kao Å¡to su razvoj, testiranje, staging i produkcija.
* Prilikom kreiranja okruÅ¾enja, birate platformu (npr. Java, .NET, Node.js, itd.) i tip okruÅ¾enja (npr. veb server ili radnik). TakoÄ‘e moÅ¾ete prilagoditi konfiguraciju okruÅ¾enja kako biste kontrolisali razliÄite aspekte infrastrukture i postavki aplikacije.

### 2 tipa OkruÅ¾enja

1. **Veb Server OkruÅ¾enje**: Namensko je za **hostovanje i pruÅ¾anje veb aplikacija i API-ja**. Ove aplikacije obiÄno obraÄ‘uju dolazne HTTP/HTTPS zahteve. Veb server okruÅ¾enje obezbeÄ‘uje resurse poput **EC2 instanci, balansera optereÄ‡enja i auto-skaliranja** grupa za upravljanje dolaznim saobraÄ‡ajem, upravljanje kapacitetom i obezbeÄ‘ivanje visoke dostupnosti aplikacije.
2. **Radnik OkruÅ¾enje**: Namensko je za obradu **zadataka u pozadini**, koji su Äesto vremenski zahtevni ili operacije koje zahtevaju resurse, a ne zahtevaju odmah odgovore klijentima. Radnik okruÅ¾enje obezbeÄ‘uje resurse poput **EC2 instanci i auto-skaliranja grupa**, ali **nema balanser optereÄ‡enja** jer ne obraÄ‘uje HTTP/HTTPS zahteve direktno. Umesto toga, konzumira zadatke iz **Amazon Simple Queue Service (SQS) reda**, koji deluje kao bafer izmeÄ‘u radnog okruÅ¾enja i zadataka koje obraÄ‘uje.

### Bezbednost

Prilikom kreiranja Aplikacije u Beanstalk-u, postoje 3 veoma vaÅ¾ne opcije bezbednosti koje treba odabrati:

* **EC2 par kljuÄeva**: Ovo Ä‡e biti **SSH kljuÄ** koji Ä‡e moÄ‡i da pristupi EC2 instancama koje pokreÄ‡u aplikaciju
* **IAM profil instance**: Ovo je **profil instance** koji Ä‡e imati instance (**IAM privilegije**)
* Automatski generisana uloga se zove **`aws-elasticbeanstalk-ec2-role`** i ima neke zanimljive pristupe nad svim ECS, svim SQS, DynamoDB elasticbeanstalk i elasticbeanstalk S3 koristeÄ‡i AWS upravljane politike: [AWSElasticBeanstalkWebTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWebTier), [AWSElasticBeanstalkMulticontainerDocker](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkMulticontainerDocker), [AWSElasticBeanstalkWorkerTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWorkerTier).
* **Uloga servisa**: Ovo je **uloga koju Ä‡e AWS servis** koristiti za obavljanje svih potrebnih akcija. Koliko znam, obiÄan AWS korisnik ne moÅ¾e pristupiti toj ulozi.
* Ova uloga generisana od strane AWS-a se zove **`aws-elasticbeanstalk-service-role`** i koristi AWS upravljane politike [AWSElasticBeanstalkEnhancedHealth](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkEnhancedHealth) i [AWSElasticBeanstalkManagedUpdatesCustomerRolePolicy](https://us-east-1.console.aws.amazon.com/iamv2/home?region=us-east-1#/roles/details/aws-elasticbeanstalk-service-role?section=permissions)

Podrazumevano je **onemoguÄ‡ena verzija metapodataka 1**:

<figure><img src="../../../.gitbook/assets/image (103).png" alt=""><figcaption></figcaption></figure>
### IzloÅ¾enost

Podaci o Beanstalk-u se Äuvaju u **S3 kanti** sa sledeÄ‡im imenom: **`elasticbeanstalk-<region>-<acc-id>`** (ako je kreiran u AWS konzoli). Unutar ove kante Ä‡ete pronaÄ‡i **uÄitani izvorni kod aplikacije**.

**URL** kreirane veb stranice je **`http://<webapp-name>-env.<random>.<region>.elasticbeanstalk.com/`**

{% hint style="warning" %}
Ako dobijete **pristup za Äitanje** nad kantom, moÅ¾ete **proÄitati izvorni kod** i Äak pronaÄ‡i **osetljive akreditive** u njemu.

Ako dobijete **pristup za pisanje** nad kantom, moÅ¾ete **izmeniti izvorni kod** da **ugrozi** **IAM ulogu** koju aplikacija koristi sledeÄ‡i put kada se izvrÅ¡i.
{% endhint %}

### Enumeracija

{% code overflow="wrap" %}
```bash
# Find S3 bucket
ACCOUNT_NUMBER=<account_number>
for r in us-east-1 us-east-2 us-west-1 us-west-2 ap-south-1 ap-south-2 ap-northeast-1 ap-northeast-2 ap-northeast-3 ap-southeast-1 ap-southeast-2 ap-southeast-3 ca-central-1 eu-central-1 eu-central-2 eu-west-1 eu-west-2 eu-west-3 eu-north-1 sa-east-1 af-south-1 ap-east-1 eu-south-1 eu-south-2 me-south-1 me-central-1; do aws s3 ls elasticbeanstalk-$r-$ACCOUNT_NUMBER 2>/dev/null && echo "Found in: elasticbeanstalk-$r-$ACCOUNT_NUMBER"; done

# Get apps and URLs
aws elasticbeanstalk describe-applications # List apps
aws elasticbeanstalk describe-application-versions # Get apps & bucket name with source code
aws elasticbeanstalk describe-environments # List envs
aws elasticbeanstalk describe-environments | grep -E "EndpointURL|CNAME"
aws elasticbeanstalk describe-configuration-settings --application-name <app_name> --environment-name <env_name>
aws elasticbeanstalk describe-environment-resources --environment-name <env_name> # Get env info such as SQS used queues
aws elasticbeanstalk describe-instances-health --environment-name <env_name> # Get the instances of an environment

# Get events
aws elasticbeanstalk describe-events
```
### Neautentifikovan pristup

{% content-ref url="../aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md" %}
[aws-elastic-beanstalk-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md)
{% endcontent-ref %}

### Upornost

{% content-ref url="../aws-persistence/aws-elastic-beanstalk-persistence.md" %}
[aws-elastic-beanstalk-persistence.md](../aws-persistence/aws-elastic-beanstalk-persistence.md)
{% endcontent-ref %}

### Privesc

{% content-ref url="../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md" %}
[aws-elastic-beanstalk-privesc.md](../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md)
{% endcontent-ref %}

### Post Eksploatacija

{% content-ref url="../aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md" %}
[aws-elastic-beanstalk-post-exploitation.md](../aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md)
{% endcontent-ref %}

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
