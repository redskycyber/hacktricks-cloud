# AWS - ECR Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ì—ì„œ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**ë¥¼** **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **Hacking íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì„¸ìš”.

</details>

## ECR

### ê¸°ë³¸ ì •ë³´

Amazon **Elastic Container Registry** (Amazon ECR)ëŠ” **ê´€ë¦¬ë˜ëŠ” ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„œë¹„ìŠ¤**ì…ë‹ˆë‹¤. ì´ ì„œë¹„ìŠ¤ëŠ” ê³ ê°ì´ ì˜ ì•Œë ¤ì§„ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì™€ ìƒí˜¸ ì‘ìš©í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ ì œê³µí•˜ê¸° ìœ„í•´ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. íŠ¹íˆ Docker CLI ë˜ëŠ” ê¸°íƒ€ ì„ í˜¸í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ í‘¸ì‹œ, í’€ ë° ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ê´€ë¦¬ì™€ ê°™ì€ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ECRì€ **ë ˆì§€ìŠ¤íŠ¸ë¦¬**ì™€ **ì €ì¥ì†Œ** ë‘ ê°€ì§€ ìœ í˜•ì˜ ê°ì²´ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.

#### ë ˆì§€ìŠ¤íŠ¸ë¦¬

ëª¨ë“  AWS ê³„ì •ì—ëŠ” **ê°œì¸** ë° **ê³µìš©** ë‘ ê°€ì§€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ê°€ ìˆìŠµë‹ˆë‹¤.

1. **ê°œì¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬**:

* **ê¸°ë³¸ì ìœ¼ë¡œ ê°œì¸**: Amazon ECR ê°œì¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì €ì¥ëœ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ëŠ” AWS ê³„ì • ë‚´ì˜ ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ì ë˜ëŠ” ê¶Œí•œì´ ë¶€ì—¬ëœ ì‚¬ìš©ìì—ê²Œë§Œ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ê°œì¸ ì €ì¥ì†Œ**ì˜ URIëŠ” `<account_id>.dkr.ecr.<region>.amazonaws.com/<repo-name>` í˜•ì‹ì„ ë”°ë¦…ë‹ˆë‹¤.
* **ì•¡ì„¸ìŠ¤ ì œì–´**: IAM ì •ì±…ì„ ì‚¬ìš©í•˜ì—¬ ê°œì¸ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ **ì œì–´**í•  ìˆ˜ ìˆìœ¼ë©°, ì‚¬ìš©ì ë˜ëŠ” ì—­í• ì„ ê¸°ë°˜ìœ¼ë¡œ ì„¸ë°€í•œ ê¶Œí•œì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **AWS ì„œë¹„ìŠ¤ì™€ì˜ í†µí•©**: Amazon ECR ê°œì¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ëŠ” EKS, ECS ë“± ë‹¤ë¥¸ AWS ì„œë¹„ìŠ¤ì™€ ì‰½ê²Œ **í†µí•©**ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ê¸°íƒ€ ê°œì¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì˜µì…˜**:
* íƒœê·¸ ë¶ˆë³€ì„± ì—´ì€ íƒœê·¸ ë¶ˆë³€ì„±ì´ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ë‚˜íƒ€ë‚´ë©°, ì´ë¯¸ì§€ë¥¼ ë®ì–´ì“°ëŠ” **ê¸°ì¡´ íƒœê·¸**ë¡œì˜ ì´ë¯¸ì§€ **í‘¸ì‹œ**ë¥¼ **ë°©ì§€**í•©ë‹ˆë‹¤.
* **ì•”í˜¸í™” ìœ í˜•** ì—´ì€ ì €ì¥ì†Œì˜ ì•”í˜¸í™” ì†ì„±ì„ ë‚˜íƒ€ë‚´ë©°, AES-256ê³¼ ê°™ì€ ê¸°ë³¸ ì•”í˜¸í™” ìœ í˜• ë˜ëŠ” KMSê°€ í™œì„±í™”ëœ ì•”í˜¸í™”ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.
* **Pull through cache** ì—´ì€ Pull through cache ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ë©°, Pull through cache ìƒíƒœê°€ í™œì„±í™”ë˜ë©´ **ì™¸ë¶€ ê³µìš© ì €ì¥ì†Œì˜ ì €ì¥ì†Œë¥¼ ê°œì¸ ì €ì¥ì†Œì— ìºì‹œ**í•©ë‹ˆë‹¤.
* íŠ¹ì • **IAM ì •ì±…**ì„ êµ¬ì„±í•˜ì—¬ ë‹¤ë¥¸ **ê¶Œí•œ**ì„ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ìŠ¤ìº” êµ¬ì„±**ì„ ì‚¬ìš©í•˜ì—¬ ì €ì¥ì†Œ ë‚´ì— ì €ì¥ëœ ì´ë¯¸ì§€ì˜ ì·¨ì•½ì ì„ ìŠ¤ìº”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

2. **ê³µìš© ë ˆì§€ìŠ¤íŠ¸ë¦¬**:

* **ê³µê°œ ì•¡ì„¸ìŠ¤**: ECR ê³µìš© ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì €ì¥ëœ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ëŠ” **ì¸ì¦ ì—†ì´ ì¸í„°ë„·ì˜ ëˆ„êµ¬ë‚˜ ì•¡ì„¸ìŠ¤**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ê³µìš© ì €ì¥ì†Œ**ì˜ URIëŠ” `public.ecr.aws/<random>/<name>`ê³¼ ê°™ì€ í˜•ì‹ì…ë‹ˆë‹¤. `<random>` ë¶€ë¶„ì€ ê´€ë¦¬ìê°€ ê¸°ì–µí•˜ê¸° ì‰¬ìš´ ë‹¤ë¥¸ ë¬¸ìì—´ë¡œ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### **ì €ì¥ì†Œ**

ì´ëŠ” **ê°œì¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬** ë˜ëŠ” **ê³µìš© ë ˆì§€ìŠ¤íŠ¸ë¦¬**ì— ìˆëŠ” **ì´ë¯¸ì§€**ì…ë‹ˆë‹¤.

{% hint style="info" %}
ì´ë¯¸ì§€ë¥¼ ì €ì¥ì†Œì— ì—…ë¡œë“œí•˜ë ¤ë©´ **ECR ì €ì¥ì†Œì˜ ì´ë¦„ì´ ì´ë¯¸ì§€ì™€ ë™ì¼**í•´ì•¼ í•©ë‹ˆë‹¤.
{% endhint %}

### ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë° ì €ì¥ì†Œ ì •ì±…

**ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë° ì €ì¥ì†Œ**ì—ëŠ” ë‹¤ë¥¸ ì£¼ì²´/ê³„ì •ì—ê²Œ ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” **ì •ì±…**ë„ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë‹¤ìŒ ì €ì¥ì†Œ ì •ì±… ì´ë¯¸ì§€ì—ì„œëŠ” ì¡°ì§ ì „ì²´ì˜ ëª¨ë“  ì‚¬ìš©ìê°€ ì´ë¯¸ì§€ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤:

<figure><img src="../../../.gitbook/assets/image (87).png" alt=""><figcaption></figcaption></figure>

### ì—´ê±°

{% code overflow="wrap" %}
```bash
# Get repos
aws ecr describe-repositories
aws ecr describe-registry

# Get image metadata
aws ecr list-images --repository-name <repo_name>
aws ecr describe-images --repository-name <repo_name>
aws ecr describe-image-replication-status --repository-name <repo_name> --image-id <image_id>
aws ecr describe-image-scan-findings --repository-name <repo_name> --image-id <image_id>
aws ecr describe-pull-through-cache-rules --repository-name <repo_name> --image-id <image_id>

# Get public repositories
aws ecr-public describe-repositories

# Get policies
aws ecr get-registry-policy
aws ecr get-repository-policy --repository-name <repo_name>
```
{% endcode %}

### ì¸ì¦ë˜ì§€ ì•Šì€ ì—´ê±°

{% content-ref url="../aws-unauthenticated-enum-access/aws-ecr-unauthenticated-enum.md" %}
[aws-ecr-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-ecr-unauthenticated-enum.md)
{% endcontent-ref %}

### ê¶Œí•œ ìƒìŠ¹

ë‹¤ìŒ í˜ì´ì§€ì—ì„œëŠ” **ECR ê¶Œí•œì„ ì•…ìš©í•˜ì—¬ ê¶Œí•œì„ ìƒìŠ¹**í•˜ëŠ” ë°©ë²•ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="../aws-privilege-escalation/aws-ecr-privesc.md" %}
[aws-ecr-privesc.md](../aws-privilege-escalation/aws-ecr-privesc.md)
{% endcontent-ref %}

### í›„ë°˜ ê³µê²©

{% content-ref url="../aws-post-exploitation/aws-ecr-post-exploitation.md" %}
[aws-ecr-post-exploitation.md](../aws-post-exploitation/aws-ecr-post-exploitation.md)
{% endcontent-ref %}

### ì§€ì†ì„±

{% content-ref url="../aws-persistence/aws-ecr-persistence.md" %}
[aws-ecr-persistence.md](../aws-persistence/aws-ecr-persistence.md)
{% endcontent-ref %}

# ì°¸ê³  ìë£Œ
* [https://docs.aws.amazon.com/AmazonECR/latest/APIReference/Welcome.html](https://docs.aws.amazon.com/AmazonECR/latest/APIReference/Welcome.html)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* HackTricksì—ì„œ **íšŒì‚¬ë¥¼ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* ë…ì ì ì¸ [**NFT**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì¸ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**ë¥¼** **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>
