# AWS - ECR Enum

## AWS - ECR Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team ì „ë¬¸ê°€)</strong>ë¥¼ í†µí•´ **ì œë¡œ**ë¶€í„° **íˆì–´ë¡œ**ê¹Œì§€ AWS í•´í‚¹ì„ ë°°ìš°ì„¸ìš”!</summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

- **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ **í•˜ê±°ë‚˜ **PDFë¡œ HackTricks ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
- [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
- **Discord ê·¸ë£¹**ì— **ê°€ì…**í•˜ê±°ë‚˜ [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ê°€ì…í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
- **HackTricks** ë° **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>

### ECR

#### ê¸°ë³¸ ì •ë³´

Amazon **Elastic Container Registry** (Amazon ECR)ëŠ” **ê´€ë¦¬í˜• ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„œë¹„ìŠ¤**ì…ë‹ˆë‹¤. ê³ ê°ì´ ì˜ ì•Œë ¤ì§„ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì™€ ìƒí˜¸ ì‘ìš©í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ ì œê³µí•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. êµ¬ì²´ì ìœ¼ë¡œ Docker CLI ë˜ëŠ” ì„ í˜¸í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ í‘¸ì‹œ, í’€ ë° ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ê´€ë¦¬ì™€ ê°™ì€ í™œë™ì„ ì§€ì›í•©ë‹ˆë‹¤.

ECRì€ **ë ˆì§€ìŠ¤íŠ¸ë¦¬**ì™€ **ì €ì¥ì†Œ**ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.

**ë ˆì§€ìŠ¤íŠ¸ë¦¬**

ëª¨ë“  AWS ê³„ì •ì—ëŠ” **Private** ë° **Public** 2ê°œì˜ ë ˆì§€ìŠ¤íŠ¸ë¦¬ê°€ ìˆìŠµë‹ˆë‹¤.

1. **Private ë ˆì§€ìŠ¤íŠ¸ë¦¬**:

- **ê¸°ë³¸ì ìœ¼ë¡œ ë¹„ê³µê°œ**: Amazon ECR ë¹„ê³µê°œ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì €ì¥ëœ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ëŠ” **AWS ê³„ì • ë‚´ì˜ ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ì** ë˜ëŠ” ê¶Œí•œì´ ë¶€ì—¬ëœ ì‚¬ìš©ìë§Œ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ë¹„ê³µê°œ ì €ì¥ì†Œ**ì˜ URIëŠ” `<account_id>.dkr.ecr.<region>.amazonaws.com/<repo-name>` í˜•ì‹ì„ ë”°ë¦…ë‹ˆë‹¤.
- **ì•¡ì„¸ìŠ¤ ì œì–´**: **IAM ì •ì±…**ì„ ì‚¬ìš©í•˜ì—¬ ë¹„ê³µê°œ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ **ì œì–´**í•  ìˆ˜ ìˆìœ¼ë©° ì‚¬ìš©ì ë˜ëŠ” ì—­í• ì— ê¸°ë°˜í•œ ì„¸ë°€í•œ ê¶Œí•œì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **AWS ì„œë¹„ìŠ¤ì™€ì˜ í†µí•©**: Amazon ECR ë¹„ê³µê°œ ë ˆì§€ìŠ¤íŠ¸ë¦¬ëŠ” EKS, ECS ë“± ë‹¤ë¥¸ AWS ì„œë¹„ìŠ¤ì™€ ì‰½ê²Œ **í†µí•©**ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ê¸°íƒ€ ë¹„ê³µê°œ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì˜µì…˜**:
- Tag ë¶ˆë³€ì„± ì—´ì€ ìƒíƒœë¥¼ ë‚˜ì—´í•˜ë©°, íƒœê·¸ ë¶ˆë³€ì„±ì´ í™œì„±í™”ë˜ë©´ **ê¸°ì¡´ íƒœê·¸ë¡œ ì´ë¯¸ì§€ í‘¸ì‹œë¥¼ ë°©ì§€**í•©ë‹ˆë‹¤.
- **ì•”í˜¸í™” ìœ í˜•** ì—´ì€ ì €ì¥ì†Œì˜ ì•”í˜¸í™” ì†ì„±ì„ ë‚˜ì—´í•˜ë©°, AES-256ì™€ ê°™ì€ ê¸°ë³¸ ì•”í˜¸í™” ìœ í˜• ë˜ëŠ” **KMS**ê°€ í™œì„±í™”ëœ ì•”í˜¸í™”ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.
- Pull through cache ì—´ì€ ìƒíƒœë¥¼ ë‚˜ì—´í•˜ë©°, Pull through cache ìƒíƒœê°€ í™œì„±í™”ë˜ë©´ **ì™¸ë¶€ ê³µê°œ ì €ì¥ì†Œì˜ ì €ì¥ì†Œë¥¼ ê°œì¸ ì €ì¥ì†Œë¡œ ìºì‹œ**í•©ë‹ˆë‹¤.
- íŠ¹ì • **IAM ì •ì±…**ì„ êµ¬ì„±í•˜ì—¬ ë‹¤ë¥¸ **ê¶Œí•œ**ì„ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ìŠ¤ìº” êµ¬ì„±**ì„ í†µí•´ ì €ì¥ì†Œ ë‚´ì— ì €ì¥ëœ ì´ë¯¸ì§€ì˜ ì·¨ì•½ì ì„ ìŠ¤ìº”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

2. **Public ë ˆì§€ìŠ¤íŠ¸ë¦¬**:

- **ê³µê°œ ì•¡ì„¸ìŠ¤**: ECR Public ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì €ì¥ëœ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ëŠ” **ì¸ì¦ ì—†ì´ ì¸í„°ë„· ìƒì˜ ëˆ„êµ¬ì—ê²Œë‚˜ ì•¡ì„¸ìŠ¤**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ê³µê°œ ì €ì¥ì†Œ**ì˜ URIëŠ” `public.ecr.aws/<random>/<name>`ì™€ ê°™ìŠµë‹ˆë‹¤. `<random>` ë¶€ë¶„ì€ ê´€ë¦¬ìê°€ ë‹¤ë¥¸ ë¬¸ìì—´ë¡œ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì €ì¥ì†Œ**

ì´ê²ƒì€ **ë¹„ê³µê°œ ë ˆì§€ìŠ¤íŠ¸ë¦¬**ë‚˜ **ê³µê°œ ë ˆì§€ìŠ¤íŠ¸ë¦¬**ì— ìˆëŠ” **ì´ë¯¸ì§€**ì…ë‹ˆë‹¤.

{% hint style="info" %}
ì´ë¯¸ì§€ë¥¼ ì €ì¥ì†Œì— ì—…ë¡œë“œí•˜ë ¤ë©´ **ECR ì €ì¥ì†Œê°€ ì´ë¯¸ì§€ì™€ ë™ì¼í•œ ì´ë¦„**ì„ ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤.
{% endhint %}

#### ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë° ì €ì¥ì†Œ ì •ì±…

**ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë° ì €ì¥ì†Œ**ì—ëŠ” ë‹¤ë¥¸ ì£¼ì²´/ê³„ì •ì— **ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì •ì±…**ì´ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë‹¤ìŒ ì €ì¥ì†Œ ì •ì±… ì´ë¯¸ì§€ì—ì„œ ì¡°ì§ ì „ì²´ì˜ ëª¨ë“  ì‚¬ìš©ìê°€ ì´ë¯¸ì§€ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<figure><img src="../../../.gitbook/assets/image (280).png" alt=""><figcaption></figcaption></figure>

#### ì—´ê±°

{% code overflow="wrap" %}
```bash
# Get repos
aws ecr describe-repositories
aws ecr describe-registry

# Get image metadata
aws ecr list-images --repository-name <repo_name>
aws ecr describe-images --repository-name <repo_name>
aws ecr describe-image-replication-status --repository-name <repo_name> --image-id <image_id>
aws ecr describe-image-scan-findings --repository-name <repo_name> --image-id <image_id>
aws ecr describe-pull-through-cache-rules --repository-name <repo_name> --image-id <image_id>

# Get public repositories
aws ecr-public describe-repositories

# Get policies
aws ecr get-registry-policy
aws ecr get-repository-policy --repository-name <repo_name>
```
{% endcode %}

#### ì¸ì¦ë˜ì§€ ì•Šì€ Enum

{% content-ref url="../aws-unauthenticated-enum-access/aws-ecr-unauthenticated-enum.md" %}
[aws-ecr-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-ecr-unauthenticated-enum.md)
{% endcontent-ref %}

#### ê¶Œí•œ ìƒìŠ¹

ë‹¤ìŒ í˜ì´ì§€ì—ì„œ **ECR ê¶Œí•œì„ ë‚¨ìš©í•˜ì—¬ ê¶Œí•œ ìƒìŠ¹**í•˜ëŠ” ë°©ë²•ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="../aws-privilege-escalation/aws-ecr-privesc.md" %}
[aws-ecr-privesc.md](../aws-privilege-escalation/aws-ecr-privesc.md)
{% endcontent-ref %}

#### ì‚¬í›„ ê³µê²©

{% content-ref url="../aws-post-exploitation/aws-ecr-post-exploitation.md" %}
[aws-ecr-post-exploitation.md](../aws-post-exploitation/aws-ecr-post-exploitation.md)
{% endcontent-ref %}

#### ì§€ì†ì„±

{% content-ref url="../aws-persistence/aws-ecr-persistence.md" %}
[aws-ecr-persistence.md](../aws-persistence/aws-ecr-persistence.md)
{% endcontent-ref %}

## ì°¸ê³  ìë£Œ

* [https://docs.aws.amazon.com/AmazonECR/latest/APIReference/Welcome.html](https://docs.aws.amazon.com/AmazonECR/latest/APIReference/Welcome.html)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ ì œë¡œë¶€í„° AWS í•´í‚¹ì„ ì „ë¬¸ê°€ë¡œ ë°°ìš°ì„¸ìš”!</summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ PDFë¡œ ë‹¤ìš´ë¡œë“œí•˜ë ¤ë©´** [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>
