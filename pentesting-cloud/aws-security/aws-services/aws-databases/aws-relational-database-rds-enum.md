# AWS - Enumeracija Relacione Baze Podataka (RDS)

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Pogledajte [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Osnovne Informacije

**Relational Database Service (RDS)** koji nudi AWS je dizajniran da pojednostavi implementaciju, operaciju i skaliranje **relacione baze podataka u oblaku**. Ova usluga nudi prednosti u pogledu efikasnosti tro코kova i skalabilnosti, istovremeno automatizuju캖i zadatke koji zahtevaju puno rada, kao 코to su obezbe캠ivanje hardvera, konfiguracija baze podataka, zakrpe i rezervne kopije.

AWS RDS podr쬬va razli캜ite 코iroko kori코캖ene baze podataka, uklju캜uju캖i MySQL, PostgreSQL, MariaDB, Oracle Database, Microsoft SQL Server i Amazon Aurora, sa kompatibilno코캖u za MySQL i PostgreSQL.

Klju캜ne funkcionalnosti RDS-a uklju캜uju:

- Pojednostavljeno **upravljanje instancama baze podataka**.
- Kreiranje **read replika** radi pobolj코anja performansi 캜itanja.
- Konfiguracija **multi-Availability Zone (AZ) implementacija** radi obezbe캠ivanja visoke dostupnosti i mehanizama za preusmeravanje.
- **Integracija** sa drugim AWS uslugama, kao 코to su:
- AWS Identity and Access Management (**IAM**) za sna쬹u kontrolu pristupa.
- AWS **CloudWatch** za sveobuhvatno pra캖enje i metrike.
- AWS Key Management Service (**KMS**) za obezbe캠ivanje 코ifrovanja u mirovanju.

## Kredencijali

Prilikom kreiranja DB klastera, glavno **korisni캜ko ime** mo쬰 se konfigurisati (**`admin`** je podrazumevano). Da biste generisali lozinku za ovog korisnika, mo쬰te:

* **Samostalno odabrati** lozinku
* Reci RDS-u da je **automatski generi코e**
* Reci RDS-u da je upravlja u **AWS Secret Manager-u** 코ifrovanom KMS klju캜em

<figure><img src="../../../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

### Autentifikacija

Postoji 3 vrste opcija za autentifikaciju, ali kori코캖enje **glavne lozinke je uvek dozvoljeno**:

<figure><img src="../../../../.gitbook/assets/image (19) (2).png" alt=""><figcaption></figcaption></figure>

### Javni pristup i VPC

Podrazumevano **nema javnog pristupa** bazama podataka, me캠utim, **mo쬰 biti omogu캖en**. Dakle, podrazumevano samo ma코ine iz iste VPC 캖e mo캖i da joj pristupe ako odabrana **grupa bezbednosti** (koje se 캜uvaju u EC2 SG) to dozvoljava.

Umesto izlaganja DB instance, mogu캖e je kreirati **RDS Proxy** koji **pobolj코ava** **skalabilnost** i **dostupnost** DB klastera.

Tako캠e, **port baze podataka se mo쬰 izmeniti**.

### 말frovanje

**말frovanje je podrazumevano omogu캖eno** kori코캖enjem AWS upravljanog klju캜a (umesto toga mo쬰 se izabrati CMK).

Omogu캖avanjem 코ifrovanja, omogu캖avate **코ifrovanje u mirovanju za va코e skladi코te, snimke, read replike i rezervne kopije**. Klju캜evi za upravljanje ovim 코ifrovanjem mogu se izdati kori코캖enjem **KMS**-a.\
Nije mogu캖e dodati ovaj nivo 코ifrovanja nakon 코to je va코a baza podataka kreirana. **To se mora uraditi prilikom njenog kreiranja**.

Me캠utim, postoji **zaobilaznica koja vam omogu캖ava da 코ifrujete ne코ifrovanu bazu podataka na slede캖i na캜in**. Mo쬰te kreirati snimak va코e ne코ifrovane baze podataka, kreirati 코ifrovanu kopiju tog snimka, koristiti tu 코ifrovanu kopiju za kreiranje nove baze podataka, a zatim, na kraju, va코a baza podataka 캖e biti 코ifrovana.

#### Transparentno 코ifrovanje podataka (TDE)

Pored mogu캖nosti 코ifrovanja inherentnih RDS-u na nivou aplikacije, RDS tako캠e podr쬬va **dodatne mehanizme 코ifrovanja na platformi** radi za코tite podataka u mirovanju. To uklju캜uje **Transparentno 코ifrovanje podataka (TDE)** za Oracle i SQL Server. Me캠utim, va쬹o je napomenuti da dok TDE pobolj코ava bezbednost 코ifrovanjem podataka u mirovanju, mo쬰 tako캠e **uticati na performanse baze podataka**. Ovaj uticaj na performanse posebno je primetan kada se koristi u kombinaciji sa MySQL kriptografskim funkcijama ili Microsoft Transact-SQL kriptografskim funkcijama.

Da biste koristili TDE, potrebni su odre캠eni preliminarni koraci:

1. **Povezivanje sa grupom opcija**:
- Baza podataka mora biti povezana sa grupom opcija. Grupe opcija slu쬰 kao kontejneri za pode코avanja i funkcionalnosti, olak코avaju캖i upravljanje bazom podataka, uklju캜uju캖i i pobolj코anja bezbednosti.
- Me캠utim, va쬹o je napomenuti da su grupe opcija dostupne samo za odre캠ene baze podataka i verzije.

2. **Uklju캜ivanje TDE u grupu opcija**:
- Jednom kada je povezan sa grupom opcija, opcija Transparentno 코ifrovanje podataka za Oracle mora biti uklju캜ena u tu grupu.
- Va쬹o je prepoznati da kada je TDE opcija dodata grupi opcija, postaje trajni deo i ne mo쬰 se ukloniti.

3. **TDE re쬴mi 코ifrovanja**:
- TDE nudi dva razli캜ita re쬴ma 코ifrovanja:
- **TDE 코ifrovanje tabele prostora**: Ovaj re쬴m 코ifruje cele tabele, pru쬬ju캖i 코iri opseg za코tite podataka.
- **TDE 코ifrovanje kolone**: Ovaj re쬴m se fokusira na 코ifrovanje odre캠enih, pojedina캜nih elemenata unutar baze podataka, omogu캖avaju캖i precizniju kontrolu nad tim podacima koji se 코ifruju.

Razumevanje ovih preduslova i operativnih slo쬰nosti TDE-a klju캜no je za efikasnu implementaciju i upravljanje 코ifrovanjem unutar RDS-a, obezbe캠uju캖i sigurnost podataka i uskla캠enost sa neophodnim standardima.

### Enumeracija

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### Neautentifikovani pristup

{% content-ref url="../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### Privesc

{% content-ref url="../../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### Post Eksploatacija

{% content-ref url="../../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### Upornost

{% content-ref url="../../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### SQL Injekcija

Postoje na캜ini za pristup podacima DynamoDB-a sa **SQL sintaksom**, stoga su mogu캖i i tipi캜ni **SQL injection napadi**.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od po캜etka do naprednog nivoa sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini za podr코ku HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
