# AWS - å…³ç³»å‹æ•°æ®åº“ï¼ˆRDSï¼‰æšä¸¾

<details>

<summary><strong>æ”¯æŒ HackTricks å¹¶è·å¾—ç¦åˆ©ï¼</strong></summary>

* å¦‚æœæ‚¨æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Šï¼Œæˆ–è€…å¦‚æœæ‚¨æƒ³è®¿é—® PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDFï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹ PEASS å’Œ HackTricks å•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFT**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) **å’Œ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## åŸºæœ¬ä¿¡æ¯

**å…³ç³»å‹æ•°æ®åº“æœåŠ¡ï¼ˆRDSï¼‰**æ˜¯ä¸€ç§æ‰˜ç®¡çš„æ•°æ®åº“æœåŠ¡ï¼Œç®€åŒ–äº†åœ¨äº‘ä¸­è®¾ç½®ã€è¿è¡Œå’Œæ‰©å±•**å…³ç³»å‹æ•°æ®åº“**çš„è¿‡ç¨‹ã€‚AWS RDS æä¾›äº†å…·æœ‰æˆæœ¬æ•ˆç›Šå’Œå¯è°ƒæ•´å¤§å°çš„å®¹é‡ï¼Œå¹¶è‡ªåŠ¨åŒ–äº†è€—æ—¶çš„ç®¡ç†ä»»åŠ¡ï¼Œå¦‚ç¡¬ä»¶é…ç½®ã€æ•°æ®åº“è®¾ç½®ã€æ‰“è¡¥ä¸å’Œå¤‡ä»½ã€‚

AWS RDS æ”¯æŒ**å‡ ç§æµè¡Œçš„å…³ç³»å‹æ•°æ®åº“å¼•æ“**ï¼šMySQLã€PostgreSQLã€MariaDBã€Oracle Databaseã€Microsoft SQL Server å’Œä¸ MySQL æˆ– PostgreSQL å…¼å®¹çš„ Amazon Auroraã€‚

ä½¿ç”¨ RDSï¼Œæ‚¨å¯ä»¥è½»æ¾ç®¡ç†æ•°æ®åº“å®ä¾‹ï¼Œåˆ›å»ºè¯»å–**å‰¯æœ¬**ä»¥æé«˜è¯»å–**æ€§èƒ½**ï¼Œå¹¶è®¾ç½®**å¤šå¯ç”¨åŒºï¼ˆAZï¼‰**éƒ¨ç½²ä»¥å®ç°é«˜å¯ç”¨æ€§å’Œæ•…éšœè½¬ç§»æ”¯æŒã€‚æ­¤å¤–ï¼ŒRDS **ä¸å…¶ä»– AWS æœåŠ¡é›†æˆ**ï¼Œå¦‚ç”¨äº**è®¿é—®æ§åˆ¶**çš„ AWS Identity and Access Managementï¼ˆIAMï¼‰ã€ç”¨äºç›‘æ§å’ŒæŒ‡æ ‡çš„ AWS **CloudWatch**ï¼Œä»¥åŠç”¨äºé™æ€åŠ å¯†çš„ AWS Key Management Serviceï¼ˆKMSï¼‰ã€‚

## å‡­æ®

åœ¨åˆ›å»º DB é›†ç¾¤æ—¶ï¼Œå¯ä»¥é…ç½®ä¸»**ç”¨æˆ·å**ï¼ˆé»˜è®¤ä¸º`admin`ï¼‰ã€‚è¦ç”Ÿæˆæ­¤ç”¨æˆ·çš„å¯†ç ï¼Œæ‚¨å¯ä»¥ï¼š

* è‡ªå·±**æŒ‡å®š**ä¸€ä¸ª**å¯†ç **
* å‘Šè¯‰ RDS **è‡ªåŠ¨ç”Ÿæˆ**å¯†ç 
* å‘Šè¯‰ RDS ä½¿ç”¨ KMS å¯†é’¥åœ¨ **AWS Secret Manager** ä¸­ç®¡ç†å¯†ç çš„åŠ å¯†

<figure><img src="../../../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

### è®¤è¯

æœ‰ 3 ç§è®¤è¯é€‰é¡¹ï¼Œä½†å§‹ç»ˆå…è®¸ä½¿ç”¨**ä¸»å¯†ç **ï¼š

<figure><img src="../../../../.gitbook/assets/image (19) (2).png" alt=""><figcaption></figcaption></figure>

### å…¬å…±è®¿é—®å’Œ VPC

é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°æ®åº“**ä¸å…è®¸å…¬å…±è®¿é—®**ï¼Œä½†**å¯ä»¥å…è®¸**ã€‚å› æ­¤ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰æ¥è‡ªåŒä¸€ VPC çš„æœºå™¨æ‰èƒ½è®¿é—®å®ƒï¼Œå¦‚æœæ‰€é€‰çš„**å®‰å…¨ç»„**ï¼ˆå­˜å‚¨åœ¨ EC2 SG ä¸­ï¼‰å…è®¸è®¿é—®ã€‚

å¯ä»¥åˆ›å»ºä¸€ä¸ª**RDS ä»£ç†**æ¥ä»£æ›¿æš´éœ² DB å®ä¾‹ï¼Œè¿™å°†**æé«˜**DB é›†ç¾¤çš„**å¯æ‰©å±•æ€§**å’Œ**å¯ç”¨æ€§**ã€‚

æ­¤å¤–ï¼Œè¿˜å¯ä»¥ä¿®æ”¹**æ•°æ®åº“ç«¯å£**ã€‚

### åŠ å¯†

ä½¿ç”¨ AWS æ‰˜ç®¡çš„å¯†é’¥ï¼ˆä¹Ÿå¯ä»¥é€‰æ‹© CMKï¼‰ï¼Œ**é»˜è®¤å¯ç”¨åŠ å¯†**ã€‚

é€šè¿‡å¯ç”¨åŠ å¯†ï¼Œæ‚¨å¯ä»¥ä¸ºå­˜å‚¨ã€å¿«ç…§ã€è¯»å–å‰¯æœ¬å’Œå¤‡ä»½å¯ç”¨**é™æ€åŠ å¯†**ã€‚å¯ä»¥ä½¿ç”¨ **KMS** å‘è¡Œç”¨äºç®¡ç†æ­¤åŠ å¯†çš„å¯†é’¥ã€‚\
åœ¨åˆ›å»ºæ•°æ®åº“æ—¶ï¼Œæ— æ³•æ·»åŠ æ­¤çº§åˆ«çš„åŠ å¯†ã€‚**å¿…é¡»åœ¨åˆ›å»ºæœŸé—´å®Œæˆ**ã€‚

ä½†æ˜¯ï¼Œæœ‰ä¸€ç§**è§£å†³æ–¹æ³•å…è®¸æ‚¨å¯¹æœªåŠ å¯†çš„æ•°æ®åº“è¿›è¡ŒåŠ å¯†**ã€‚æ‚¨å¯ä»¥åˆ›å»ºæœªåŠ å¯†æ•°æ®åº“çš„å¿«ç…§ï¼Œåˆ›å»ºè¯¥å¿«ç…§çš„åŠ å¯†å‰¯æœ¬ï¼Œä½¿ç”¨è¯¥åŠ å¯†å¿«ç…§åˆ›å»ºæ–°æ•°æ®åº“ï¼Œç„¶åæœ€ç»ˆæ‚¨çš„æ•°æ®åº“å°†è¢«åŠ å¯†ã€‚

#### TDE åŠ å¯†

é™¤äº† RDS æœ¬èº«åœ¨åº”ç”¨ç¨‹åºçº§åˆ«æä¾›çš„åŠ å¯†å¤–ï¼Œè¿˜æœ‰**å…¶ä»–å¹³å°çº§åˆ«çš„åŠ å¯†æœºåˆ¶**å¯ç”¨äºä¿æŠ¤é™æ€æ•°æ®ï¼ŒåŒ…æ‹¬ç§°ä¸º TDE çš„ Oracle å’Œ SQL Server é€æ˜æ•°æ®åŠ å¯†ã€‚è¿™å¯ä»¥ä¸ä¸Šè¿°æ–¹æ³•é¡ºåºä¸€èµ·ä½¿ç”¨ï¼Œä½†ä¼š**å½±å“**æ•°æ®åº“ MySQL åŠ å¯†å‡½æ•°å’Œ Microsoft Transact-SQL åŠ å¯†å‡½æ•°çš„æ€§èƒ½ã€‚

å¦‚æœè¦ä½¿ç”¨ TDE æ–¹æ³•ï¼Œåˆ™å¿…é¡»é¦–å…ˆç¡®ä¿æ•°æ®åº“ä¸é€‰é¡¹ç»„å…³è”ã€‚é€‰é¡¹ç»„ä¸ºæ•°æ®åº“æä¾›é»˜è®¤è®¾ç½®ï¼Œå¹¶å¸®åŠ©è¿›è¡Œç®¡ç†ï¼ŒåŒ…æ‹¬ä¸€äº›å®‰å…¨åŠŸèƒ½ã€‚ä½†æ˜¯ï¼Œé€‰é¡¹ç»„ä»…é€‚ç”¨äºä»¥ä¸‹æ•°æ®åº“å¼•æ“å’Œç‰ˆæœ¬ã€‚

å°†æ•°æ®åº“ä¸é€‰é¡¹ç»„å…³è”åï¼Œå¿…é¡»ç¡®ä¿å°† Oracle é€æ˜æ•°æ®åŠ å¯†é€‰é¡¹æ·»åŠ åˆ°è¯¥ç»„ä¸­ã€‚ä¸€æ—¦å°† TDE é€‰é¡¹æ·»åŠ åˆ°é€‰é¡¹ç»„ä¸­ï¼Œå°±æ— æ³•åˆ é™¤ã€‚TDE å¯ä»¥ä½¿ç”¨ä¸¤ç§ä¸åŒçš„åŠ å¯†æ¨¡å¼ï¼Œé¦–å…ˆæ˜¯ TDE è¡¨ç©ºé—´åŠ å¯†ï¼Œå®ƒåŠ å¯†æ•´ä¸ªè¡¨ï¼Œå…¶æ¬¡æ˜¯ TDE åˆ—åŠ å¯†ï¼Œå®ƒåªåŠ å¯†æ•°æ®åº“çš„ä¸ªåˆ«å…ƒç´ ã€‚

### æšä¸¾

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### æœªç»èº«ä»½éªŒè¯çš„è®¿é—®

{% content-ref url="../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### ææƒ

{% content-ref url="../../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### æ¼æ´åˆ©ç”¨å

{% content-ref url="../../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### æŒä¹…åŒ–

{% content-ref url="../../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### SQLæ³¨å…¥

æœ‰ä¸€äº›æ–¹æ³•å¯ä»¥ä½¿ç”¨**SQLè¯­æ³•**è®¿é—®DynamoDBæ•°æ®ï¼Œå› æ­¤ï¼Œå…¸å‹çš„**SQLæ³¨å…¥ä¹Ÿæ˜¯å¯èƒ½çš„**ã€‚

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

<details>

<summary><strong>æ”¯æŒHackTrickså¹¶è·å¾—ç¦åˆ©ï¼</strong></summary>

* å¦‚æœæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**ï¼Œæˆ–è€…å¦‚æœæ‚¨æƒ³è®¿é—®**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“ï¼Œ[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) **å’Œ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
