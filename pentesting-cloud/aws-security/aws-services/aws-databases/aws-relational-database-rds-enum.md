# AWS - κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤ (RDS) μ—΄κ±°

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>λ¥Ό ν†µν•΄ AWS ν•΄ν‚Ήμ„ μ²μλ¶€ν„° μ „λ¬Έκ°€κΉμ§€ λ°°μ›λ³΄μ„Έμ”<strong>!</strong></summary>

HackTricksλ¥Ό μ§€μ›ν•λ” λ‹¤λ¥Έ λ°©λ²•:

* **νμ‚¬λ¥Ό HackTricksμ—μ„ κ΄‘κ³ ν•κ±°λ‚ HackTricksλ¥Ό PDFλ΅ λ‹¤μ΄λ΅λ“**ν•λ ¤λ©΄ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)λ¥Ό ν™•μΈν•μ„Έμ”!
* [**κ³µμ‹ PEASS & HackTricks μ¤μ›¨κ·Έ**](https://peass.creator-spring.com)λ¥Ό μ–»μΌμ„Έμ”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)λ¥Ό λ°κ²¬ν•μ„Έμ”. λ…μ μ μΈ [**NFTs**](https://opensea.io/collection/the-peass-family) μ»¬λ ‰μ…μ…λ‹λ‹¤.
* π’¬ [**Discord κ·Έλ£Ή**](https://discord.gg/hRep4RUj7f) λλ” [**ν…”λ κ·Έλ¨ κ·Έλ£Ή**](https://t.me/peass)μ— **μ°Έμ—¬**ν•κ±°λ‚ **Twitter** π¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**λ¥Ό** ν”λ΅μ°ν•μ„Έμ”.
* **HackTricks**μ™€ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github μ €μ¥μ†μ— PRμ„ μ μ¶ν•μ—¬ μ—¬λ¬λ¶„μ ν•΄ν‚Ή κΈ°λ²•μ„ κ³µμ ν•μ„Έμ”.

</details>

## κΈ°λ³Έ μ •λ³΄

AWSμ—μ„ μ κ³µν•λ” **κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤ μ„λΉ„μ¤ (RDS)**λ” **ν΄λΌμ°λ“μ—μ„ κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤μ λ°°ν¬, μ΄μ λ° ν™•μ¥μ„ κ°„μ†ν™”**ν•κΈ° μ„ν•΄ μ„¤κ³„λμ—μµλ‹λ‹¤. μ΄ μ„λΉ„μ¤λ” ν•λ“μ›¨μ–΄ ν”„λ΅λΉ„μ €λ‹, λ°μ΄ν„°λ² μ΄μ¤ κµ¬μ„±, ν¨μΉ λ° λ°±μ—…κ³Ό κ°™μ€ λ…Έλ™ μ§‘μ•½μ μΈ μ‘μ—…μ„ μλ™ν™”ν•λ©΄μ„ λΉ„μ© ν¨μ¨μ„±κ³Ό ν™•μ¥μ„±μ μ¥μ μ„ μ κ³µν•©λ‹λ‹¤.

AWS RDSλ” MySQL, PostgreSQL, MariaDB, Oracle Database, Microsoft SQL Server λ° Amazon Auroraμ™€ κ°™μ€ λ‹¤μ–‘ν• λ„λ¦¬ μ‚¬μ©λλ” κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤ μ—”μ§„μ„ μ§€μ›ν•λ©°, MySQL λ° PostgreSQL λ¨λ‘μ™€ νΈν™λ©λ‹λ‹¤.

RDSμ μ£Όμ” κΈ°λ¥μ€ λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:

- **λ°μ΄ν„°λ² μ΄μ¤ μΈμ¤ν„΄μ¤ κ΄€λ¦¬**κ°€ κ°„μ†ν™”λ©λ‹λ‹¤.
- μ½κΈ° μ„±λ¥μ„ ν–¥μƒμ‹ν‚¤κΈ° μ„ν•΄ **μ½κΈ° λ³µμ λ³Έ**μ„ μƒμ„±ν•©λ‹λ‹¤.
- κ³ κ°€μ©μ„± λ° μ¥μ•  μ΅°μΉ λ©”μ»¤λ‹μ¦μ„ λ³΄μ¥ν•κΈ° μ„ν•΄ **λ‹¤μ¤‘ κ°€μ© μμ—­ (AZ) λ°°ν¬**λ¥Ό κµ¬μ„±ν•©λ‹λ‹¤.
- λ‹¤λ¥Έ AWS μ„λΉ„μ¤μ™€μ **ν†µν•©**, μλ¥Ό λ“¤μ–΄:
- κ²¬κ³ ν• μ•΅μ„Έμ¤ μ μ–΄λ¥Ό μ„ν• AWS Identity and Access Management (**IAM**).
- ν¬κ΄„μ μΈ λ¨λ‹ν„°λ§ λ° λ©”νΈλ¦­μ„ μ„ν• AWS **CloudWatch**.
- μ•”νΈν™” λ³΄μ¥μ„ μ„ν• AWS Key Management Service (**KMS**).

## μκ²© μ¦λ…

DB ν΄λ¬μ¤ν„°λ¥Ό μƒμ„±ν•  λ• λ§μ¤ν„° **μ‚¬μ©μ μ΄λ¦„**μ„ κµ¬μ„±ν•  μ μμµλ‹λ‹¤ (κΈ°λ³Έκ°’μ€ **`admin`**μ…λ‹λ‹¤). μ΄ μ‚¬μ©μμ μ•”νΈλ¥Ό μƒμ„±ν•λ ¤λ©΄ λ‹¤μμ„ μν–‰ν•  μ μμµλ‹λ‹¤:

* μ§μ ‘ **μ•”νΈ**λ¥Ό μ§€μ •ν•©λ‹λ‹¤.
* RDSμ—κ² **μλ™ μƒμ„±**ν•λ„λ΅ μ§€μ‹ν•©λ‹λ‹¤.
* RDSκ°€ KMS ν‚¤λ΅ μ•”νΈν™”λ **AWS Secret Manager**μ—μ„ κ΄€λ¦¬ν•λ„λ΅ μ§€μ‹ν•©λ‹λ‹¤.

<figure><img src="../../../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

### μΈμ¦

μΈμ¦ μµμ…μ€ 3κ°€μ§€ μ ν•μ΄ μμ§€λ§, **λ§μ¤ν„° μ•”νΈλ¥Ό μ‚¬μ©ν•λ” κ²ƒμ€ ν•­μƒ ν—μ©λ©λ‹λ‹¤**:

<figure><img src="../../../../.gitbook/assets/image (19) (2).png" alt=""><figcaption></figcaption></figure>

### κ³µκ° μ•΅μ„Έμ¤ λ° VPC

κΈ°λ³Έμ μΌλ΅ λ°μ΄ν„°λ² μ΄μ¤μ—λ” **κ³µκ° μ•΅μ„Έμ¤ κ¶ν•μ΄ λ¶€μ—¬λμ§€ μ•μµλ‹λ‹¤**, κ·Έλ¬λ‚ **λ¶€μ—¬λ  μ μμµλ‹λ‹¤**. λ”°λΌμ„ κΈ°λ³Έμ μΌλ΅ λ™μΌν• VPCμ κΈ°κΈ°λ§ μ•΅μ„Έμ¤ν•  μ μμµλ‹λ‹¤. μ„ νƒν• **λ³΄μ• κ·Έλ£Ή** (EC2 SGμ— μ €μ¥λ¨)μ΄ ν—μ©ν•λ” κ²½μ°μ—λ§ μ•΅μ„Έμ¤ν•  μ μμµλ‹λ‹¤.

DB μΈμ¤ν„΄μ¤λ¥Ό λ…Έμ¶ν•λ” λ€μ‹ , DB ν΄λ¬μ¤ν„°μ **ν™•μ¥μ„±** λ° **κ°€μ©μ„±**μ„ ν–¥μƒμ‹ν‚¤λ” **RDS Proxy**λ¥Ό μƒμ„±ν•  μ μμµλ‹λ‹¤.

λν•, **λ°μ΄ν„°λ² μ΄μ¤ ν¬νΈλ¥Ό μμ •**ν•  μλ„ μμµλ‹λ‹¤.

### μ•”νΈν™”

AWS κ΄€λ¦¬ ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ **μ•”νΈν™”κ°€ κΈ°λ³Έμ μΌλ΅ ν™μ„±ν™”**λ©λ‹λ‹¤ (λ€μ‹  CMKλ¥Ό μ„ νƒν•  μ μμ).

μ•”νΈν™”λ¥Ό ν™μ„±ν™”ν•λ©΄ μ €μ¥μ†, μ¤λƒ…μƒ·, μ½κΈ° λ³µμ λ³Έ λ° λ°±μ—…μ— λ€ν• **μ•μ • μƒνƒμ μ•”νΈν™”**κ°€ ν™μ„±ν™”λ©λ‹λ‹¤. μ΄ μ•”νΈν™”λ¥Ό κ΄€λ¦¬ν•κΈ° μ„ν•΄ **KMS**λ¥Ό μ‚¬μ©ν•μ—¬ ν‚¤λ¥Ό λ°κΈ‰ν•  μ μμµλ‹λ‹¤.\
λ°μ΄ν„°λ² μ΄μ¤κ°€ μƒμ„±λ ν›„μ—λ” μ΄λ¬ν• μ•”νΈν™” μμ¤€μ„ μ¶”κ°€ν•  μ μ—†μµλ‹λ‹¤. **μƒμ„± μ¤‘μ— μν–‰**ν•΄μ•Ό ν•©λ‹λ‹¤.

κ·Έλ¬λ‚ λ‹¤μκ³Ό κ°™μ€ **νν”Ό λ°©λ²•μ„ μ‚¬μ©ν•μ—¬ μ•”νΈν™”λμ§€ μ•μ€ λ°μ΄ν„°λ² μ΄μ¤λ¥Ό μ•”νΈν™”**ν•  μ μμµλ‹λ‹¤. μ•”νΈν™”λμ§€ μ•μ€ λ°μ΄ν„°λ² μ΄μ¤μ μ¤λƒ…μƒ·μ„ μƒμ„±ν•κ³  ν•΄λ‹Ή μ¤λƒ…μƒ·μ μ•”νΈν™”λ μ‚¬λ³Έμ„ μƒμ„±ν• λ‹¤μ ν•΄λ‹Ή μ•”νΈν™”λ μ¤λƒ…μƒ·μ„ μ‚¬μ©ν•μ—¬ μƒ λ°μ΄ν„°λ² μ΄μ¤λ¥Ό μƒμ„±ν•λ©΄ λ°μ΄ν„°λ² μ΄μ¤κ°€ μ•”νΈν™”λ©λ‹λ‹¤.

#### ν¬λ…ν• λ°μ΄ν„° μ•”νΈν™” (TDE)

RDSμ μ‘μ© ν”„λ΅κ·Έλ¨ μμ¤€μ—μ„ μ κ³µλλ” μ•”νΈν™” κΈ°λ¥ μ™Έμ—λ„, RDSλ” Oracle λ° SQL Serverλ¥Ό μ„ν• **μ¶”κ°€ ν”λ«νΌ μμ¤€μ μ•”νΈν™” λ©”μ»¤λ‹μ¦**μ„ μ§€μ›ν•©λ‹λ‹¤. μ΄λ” Oracle λ° SQL Serverμ **ν¬λ…ν• λ°μ΄ν„° μ•”νΈν™” (TDE)**λ¥Ό ν¬ν•¨ν•©λ‹λ‹¤. κ·Έλ¬λ‚ TDEλ” λ°μ΄ν„°λ¥Ό μ•μ • μƒνƒλ΅ μ•”νΈν™”ν•μ—¬ λ³΄μ•μ„ κ°•ν™”ν•μ§€λ§ λ°μ΄ν„°λ² μ΄μ¤ μ„±λ¥μ— **μν–¥μ„ μ¤„ μ μμµλ‹λ‹¤**. μ΄λ¬ν• μ„±λ¥ μν–¥μ€ νΉν MySQL μ•”νΈν™” ν•¨μ λλ” Microsoft Transact-SQL μ•”νΈν™” ν•¨μμ™€ ν•¨κ» μ‚¬μ©ν•  λ• λ”μ± λ‘λ“λ¬μ§‘λ‹λ‹¤.

TDEλ¥Ό ν™μ©ν•κΈ° μ„ν•΄μ„λ” λ‹¤μκ³Ό κ°™μ€ μ‚¬μ „ λ‹¨κ³„κ°€ ν•„μ”ν•©λ‹λ‹¤:

1. **μµμ… κ·Έλ£Ή μ—°κ²°**:
- λ°μ΄ν„°λ² μ΄μ¤λ” μµμ… κ·Έλ£Ήκ³Ό μ—°κ²°λμ–΄μ•Ό ν•©λ‹λ‹¤. μµμ… κ·Έλ£Ήμ€ μ„¤μ • λ° κΈ°λ¥μ„ μ„ν• μ»¨ν…μ΄λ„λ΅μ„ λ°μ΄ν„°λ² μ΄μ¤ κ΄€λ¦¬λ¥Ό μ©μ΄ν•κ² ν•΄μ£Όλ©°, λ³΄μ• κ°•ν™”λ¥Ό λΉ„λ΅―ν• κΈ°λ¥μ„ μ κ³µν•©λ‹λ‹¤.
- κ·Έλ¬λ‚ μµμ… κ·Έλ£Ήμ€ νΉμ • λ°μ΄ν„°λ² μ΄μ¤ μ—”μ§„ λ° λ²„μ „μ—λ§ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

2. **μµμ… κ·Έλ£Ήμ— TDE ν¬ν•¨**:
- μµμ… κ·Έλ£Ήκ³Ό μ—°κ²°λ ν›„, Oracle ν¬λ…ν• λ°μ΄ν„° μ•”νΈν™” μµμ…μ„ ν•΄λ‹Ή κ·Έλ£Ήμ— ν¬ν•¨ν•΄μ•Ό ν•©λ‹λ‹¤.
- TDE μµμ…μ΄ μµμ… κ·Έλ£Ήμ— μ¶”κ°€λλ©΄ μκµ¬μ μΌλ΅ μ„¤μ •λμ–΄ μ κ±°ν•  μ μ—†μμ„ μΈμ‹ν•λ” κ²ƒμ΄ μ¤‘μ”ν•©λ‹λ‹¤.

3. **TDE μ•”νΈν™” λ¨λ“**:
- TDEλ” λ‘ κ°€μ§€ λ‹¤λ¥Έ μ•”νΈν™” λ¨λ“λ¥Ό μ κ³µν•©λ‹λ‹¤:
- **TDE ν…μ΄λΈ”μ¤νμ΄μ¤ μ•”νΈν™”**: μ΄ λ¨λ“λ” μ „μ²΄ ν…μ΄λΈ”μ„ μ•”νΈν™”ν•μ—¬ λ” λ„“μ€ λ²”μ„μ λ°μ΄ν„° λ³΄νΈλ¥Ό μ κ³µν•©λ‹λ‹¤.
- **TDE μ—΄ μ•”νΈν™”**: μ΄ λ¨λ“λ” λ°μ΄ν„°λ² μ΄μ¤ λ‚΄μ—μ„ νΉμ • κ°λ³„ μ”μ†λ¥Ό μ•”νΈν™”ν•λ” λ° μ¤‘μ μ„ λ‘΅λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ μ–΄λ–¤ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν• μ§€μ— λ€ν• λ” μ„Έλ°€ν• μ μ–΄κ°€ κ°€λ¥ν•©λ‹λ‹¤.

μ΄λ¬ν• μ‚¬μ „ μ”κµ¬ μ‚¬ν•­κ³Ό TDEμ μ΄μ λ³µμ΅μ„±μ„ μ΄ν•΄ν•λ” κ²ƒμ€ RDS λ‚΄μ—μ„ μ•”νΈν™”λ¥Ό ν¨κ³Όμ μΌλ΅ κµ¬ν„ν•κ³  κ΄€λ¦¬ν•κΈ° μ„ν•΄ ν•„μμ μ…λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ λ°μ΄ν„° λ³΄μ•κ³Ό ν•„μ”ν• ν‘μ¤€ μ¤€μλ¥Ό λ¨λ‘ λ³΄μ¥ν•  μ μμµλ‹λ‹¤.

### μ—΄κ±°

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### μΈμ¦λμ§€ μ•μ€ μ•΅μ„Έμ¤

{% content-ref url="../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### κ¶ν• μƒμΉ

{% content-ref url="../../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### ν›„λ° κ³µκ²©

{% content-ref url="../../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### μ§€μ†μ„±

{% content-ref url="../../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### SQL μΈμ μ…

**SQL κµ¬λ¬Έ**μ„ μ‚¬μ©ν•μ—¬ DynamoDB λ°μ΄ν„°μ— μ•΅μ„Έμ¤ν•λ” λ°©λ²•μ΄ μμΌλ―€λ΅, μ „ν•μ μΈ **SQL μΈμ μ…λ„ κ°€λ¥**ν•©λ‹λ‹¤.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>λ¥Ό ν†µν•΄ AWS ν•΄ν‚Ήμ„ μ²μλ¶€ν„° μ „λ¬Έκ°€κΉμ§€ λ°°μ›λ³΄μ„Έμ”<strong>!</strong></summary>

HackTricksλ¥Ό μ§€μ›ν•λ” λ‹¤λ¥Έ λ°©λ²•:

* νμ‚¬λ¥Ό **HackTricksμ—μ„ κ΄‘κ³ **ν•κ±°λ‚ **PDFλ΅ HackTricksλ¥Ό λ‹¤μ΄λ΅λ“**ν•λ ¤λ©΄ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)λ¥Ό ν™•μΈν•μ„Έμ”!
* [**κ³µμ‹ PEASS & HackTricks μ¤μ›¨κ·Έ**](https://peass.creator-spring.com)λ¥Ό μ–»μΌμ„Έμ”.
* λ…μ μ μΈ [**NFT**](https://opensea.io/collection/the-peass-family) μ»¬λ ‰μ…μΈ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)λ¥Ό λ°κ²¬ν•μ„Έμ”.
* π’¬ [**Discord κ·Έλ£Ή**](https://discord.gg/hRep4RUj7f) λλ” [**ν…”λ κ·Έλ¨ κ·Έλ£Ή**](https://t.me/peass)μ— **μ°Έμ—¬**ν•κ±°λ‚ **Twitter** π¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**λ¥Ό** **ν”λ΅μ°**ν•μ„Έμ”.
* **HackTricks**μ™€ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github μ €μ¥μ†μ— PRμ„ μ μ¶ν•μ—¬ **λ‹Ήμ‹ μ ν•΄ν‚Ή κΈ°μ μ„ κ³µμ **ν•μ„Έμ”.

</details>
