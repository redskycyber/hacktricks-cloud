# AWS - å…³ç³»å‹æ•°æ®åº“ (RDS) æšä¸¾

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æ”»å‡»ç›´è‡³æˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS çº¢é˜Ÿä¸“å®¶)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨ **HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š** æˆ– **ä¸‹è½½HackTricksçš„PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## åŸºæœ¬ä¿¡æ¯

**å…³ç³»å‹æ•°æ®åº“æœåŠ¡ (RDS)** æ˜¯ä¸€ç§æ‰˜ç®¡æ•°æ®åº“æœåŠ¡ï¼Œç®€åŒ–äº†åœ¨äº‘ä¸­è®¾ç½®ã€æ“ä½œå’Œæ‰©å±•**å…³ç³»å‹æ•°æ®åº“**çš„è¿‡ç¨‹ã€‚AWS RDSæä¾›æˆæœ¬æ•ˆç›Šé«˜ä¸”å¯è°ƒæ•´å¤§å°çš„å®¹é‡ï¼Œå¹¶è‡ªåŠ¨æ‰§è¡Œè€—æ—¶çš„ç®¡ç†ä»»åŠ¡ï¼Œå¦‚ç¡¬ä»¶é…ç½®ã€æ•°æ®åº“è®¾ç½®ã€è¡¥ä¸å’Œå¤‡ä»½ã€‚

AWS RDSæ”¯æŒ**å‡ ç§æµè¡Œçš„å…³ç³»å‹æ•°æ®åº“å¼•æ“**ï¼šMySQLã€PostgreSQLã€MariaDBã€Oracleæ•°æ®åº“ã€Microsoft SQL Serverå’Œå…¼å®¹MySQLæˆ–PostgreSQLçš„Amazon Auroraã€‚

ä½¿ç”¨RDSï¼Œæ‚¨å¯ä»¥è½»æ¾ç®¡ç†æ•°æ®åº“å®ä¾‹ï¼Œåˆ›å»ºè¯»å–**å‰¯æœ¬**ä»¥æé«˜è¯»å–**æ€§èƒ½**ï¼Œå¹¶è®¾ç½®**å¤šå¯ç”¨åŒº (AZ)** éƒ¨ç½²ä»¥å®ç°é«˜å¯ç”¨æ€§å’Œæ•…éšœè½¬ç§»æ”¯æŒã€‚æ­¤å¤–ï¼ŒRDSè¿˜**é›†æˆ**äº†å…¶ä»–AWSæœåŠ¡ï¼Œå¦‚AWSèº«ä»½å’Œè®¿é—®ç®¡ç†ï¼ˆ**IAM**ï¼‰ç”¨äº**è®¿é—®æ§åˆ¶**ï¼ŒAWS **CloudWatch**ç”¨äºç›‘æ§å’ŒæŒ‡æ ‡ï¼Œä»¥åŠAWSå¯†é’¥ç®¡ç†æœåŠ¡ï¼ˆ**KMS**ï¼‰ç”¨äºé™æ€æ•°æ®åŠ å¯†ã€‚

## å‡­è¯

åˆ›å»ºDBé›†ç¾¤æ—¶ï¼Œå¯ä»¥é…ç½®ä¸»**ç”¨æˆ·å**ï¼ˆé»˜è®¤ä¸º**`admin`**ï¼‰ã€‚è¦ç”Ÿæˆæ­¤ç”¨æˆ·çš„å¯†ç ï¼Œæ‚¨å¯ä»¥ï¼š

* **æŒ‡å®š**ä¸€ä¸ª**å¯†ç **
* è®©RDS**è‡ªåŠ¨ç”Ÿæˆ**å¯†ç 
* è®©RDSåœ¨**AWS Secret Manager**ä¸­ç®¡ç†å¯†ç ï¼Œå¹¶ä½¿ç”¨KMSå¯†é’¥åŠ å¯†

<figure><img src="../../../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

### è®¤è¯

æœ‰3ç§è®¤è¯é€‰é¡¹ï¼Œä½†å§‹ç»ˆå…è®¸ä½¿ç”¨**ä¸»å¯†ç **ï¼š

<figure><img src="../../../../.gitbook/assets/image (19) (2).png" alt=""><figcaption></figcaption></figure>

### å…¬å…±è®¿é—® & VPC

é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°æ®åº“**ä¸å…è®¸å…¬å…±è®¿é—®**ï¼Œä½†**å¯ä»¥æˆæƒ**ã€‚å› æ­¤ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœé€‰å®šçš„**å®‰å…¨ç»„**ï¼ˆå­˜å‚¨åœ¨EC2 SGä¸­ï¼‰å…è®¸ï¼Œåˆ™åªæœ‰æ¥è‡ªåŒä¸€VPCçš„æœºå™¨æ‰èƒ½è®¿é—®å®ƒã€‚

å¯ä»¥åˆ›å»ºä¸€ä¸ª**RDSä»£ç†**ï¼Œè€Œä¸æ˜¯æš´éœ²DBå®ä¾‹ï¼Œè¿™å¯ä»¥**æé«˜**æ•°æ®åº“é›†ç¾¤çš„**å¯æ‰©å±•æ€§**å’Œ**å¯ç”¨æ€§**ã€‚

æ­¤å¤–ï¼Œ**æ•°æ®åº“ç«¯å£ä¹Ÿå¯ä»¥ä¿®æ”¹**ã€‚

### åŠ å¯†

é»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨AWSç®¡ç†çš„å¯†é’¥ï¼ˆä¹Ÿå¯ä»¥é€‰æ‹©CMKï¼‰å¯ç”¨**åŠ å¯†**ã€‚

å¯ç”¨åŠ å¯†æ„å‘³ç€æ‚¨ä¸ºå­˜å‚¨ã€å¿«ç…§ã€è¯»å–å‰¯æœ¬å’Œå¤‡ä»½å¯ç”¨äº†**é™æ€æ•°æ®åŠ å¯†**ã€‚å¯ä»¥ä½¿ç”¨**KMS**æ¥ç®¡ç†è¿™äº›åŠ å¯†å¯†é’¥ã€‚\
åœ¨æ•°æ®åº“åˆ›å»ºåï¼Œæ— æ³•æ·»åŠ è¿™ç§çº§åˆ«çš„åŠ å¯†ã€‚**å¿…é¡»åœ¨åˆ›å»ºè¿‡ç¨‹ä¸­å®Œæˆ**ã€‚

ç„¶è€Œï¼Œæœ‰ä¸€ç§**å˜é€šæ–¹æ³•å…è®¸æ‚¨åŠ å¯†æœªåŠ å¯†çš„æ•°æ®åº“**ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚æ‚¨å¯ä»¥åˆ›å»ºæœªåŠ å¯†æ•°æ®åº“çš„å¿«ç…§ï¼Œåˆ›å»ºè¯¥å¿«ç…§çš„åŠ å¯†å‰¯æœ¬ï¼Œä½¿ç”¨è¯¥åŠ å¯†å¿«ç…§åˆ›å»ºæ–°æ•°æ®åº“ï¼Œç„¶åï¼Œæœ€ç»ˆï¼Œæ‚¨çš„æ•°æ®åº“å°†è¢«åŠ å¯†ã€‚

#### TDEåŠ å¯†

é™¤äº†RDSæœ¬èº«åœ¨åº”ç”¨ç¨‹åºçº§åˆ«æä¾›çš„åŠ å¯†ä¹‹å¤–ï¼Œè¿˜æœ‰**é¢å¤–çš„å¹³å°çº§åˆ«åŠ å¯†æœºåˆ¶**å¯ç”¨äºä¿æŠ¤é™æ€æ•°æ®ï¼ŒåŒ…æ‹¬**Oracleå’ŒSQL Serveré€æ˜æ•°æ®åŠ å¯†**ï¼Œå³TDEï¼Œè¿™å¯ä»¥ä¸å‰é¢è®¨è®ºçš„æ–¹æ³•ç»“åˆä½¿ç”¨ï¼Œä½†å®ƒä¼š**å½±å“æ•°æ®åº“çš„æ€§èƒ½**ï¼ŒMySQLåŠ å¯†å‡½æ•°å’ŒMicrosoft Transact-SQLåŠ å¯†å‡½æ•°ã€‚

å¦‚æœæ‚¨æƒ³ä½¿ç”¨TDEæ–¹æ³•ï¼Œé‚£ä¹ˆæ‚¨å¿…é¡»é¦–å…ˆç¡®ä¿æ•°æ®åº“ä¸é€‰é¡¹ç»„å…³è”ã€‚é€‰é¡¹ç»„ä¸ºæ‚¨çš„æ•°æ®åº“æä¾›é»˜è®¤è®¾ç½®ï¼Œå¹¶å¸®åŠ©ç®¡ç†ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€äº›å®‰å…¨åŠŸèƒ½ã€‚ç„¶è€Œï¼Œåªæœ‰ä»¥ä¸‹æ•°æ®åº“å¼•æ“å’Œç‰ˆæœ¬å­˜åœ¨é€‰é¡¹ç»„ã€‚

ä¸€æ—¦æ•°æ®åº“ä¸é€‰é¡¹ç»„å…³è”ï¼Œæ‚¨å¿…é¡»ç¡®ä¿Oracleé€æ˜æ•°æ®åŠ å¯†é€‰é¡¹å·²æ·»åŠ åˆ°è¯¥ç»„ã€‚ä¸€æ—¦å°†TDEé€‰é¡¹æ·»åŠ åˆ°é€‰é¡¹ç»„ï¼Œå°±æ— æ³•ç§»é™¤ã€‚TDEå¯ä»¥ä½¿ç”¨ä¸¤ç§ä¸åŒçš„åŠ å¯†æ¨¡å¼ï¼Œé¦–å…ˆæ˜¯TDEè¡¨ç©ºé—´åŠ å¯†ï¼Œå®ƒåŠ å¯†æ•´ä¸ªè¡¨ï¼Œå…¶æ¬¡æ˜¯TDEåˆ—åŠ å¯†ï¼Œå®ƒåªåŠ å¯†æ•°æ®åº“çš„ä¸ªåˆ«å…ƒç´ ã€‚

### æšä¸¾

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### æœªç»è®¤è¯çš„è®¿é—®

{% content-ref url="../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### æƒé™æå‡

{% content-ref url="../../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### åæœŸåˆ©ç”¨

{% content-ref url="../../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### æŒä¹…åŒ–

{% content-ref url="../../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### SQL æ³¨å…¥

å­˜åœ¨ä½¿ç”¨ **SQL è¯­æ³•** è®¿é—® DynamoDB æ•°æ®çš„æ–¹æ³•ï¼Œå› æ­¤ï¼Œå…¸å‹çš„ **SQL æ³¨å…¥ä¹Ÿæ˜¯å¯èƒ½çš„**ã€‚

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

<details>

<summary><strong>é€šè¿‡</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS çº¢é˜Ÿä¸“å®¶)</strong></a><strong>ä»é›¶åˆ°è‹±é›„å­¦ä¹  AWS é»‘å®¢æ”»å‡»ï¼</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨å¸Œæœ›åœ¨ HackTricks ä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½ HackTricks çš„ PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTs é›†åˆ**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥**åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
