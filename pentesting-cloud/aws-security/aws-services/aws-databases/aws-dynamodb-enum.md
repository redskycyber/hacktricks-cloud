# AWS - DynamoDB æšä¸¾

<details>

<summary><strong>æ”¯æŒ HackTricks å¹¶è·å¾—ç¦åˆ©ï¼</strong></summary>

* å¦‚æœæ‚¨æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Šï¼Œæˆ–è€…å¦‚æœæ‚¨æƒ³è®¿é—® PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDFï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹ PEASS å’Œ HackTricks å•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFT**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) **å’Œ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## DynamoDB

### åŸºæœ¬ä¿¡æ¯

Amazon DynamoDB æ˜¯ä¸€ä¸ª**å®Œå…¨æ‰˜ç®¡çš„ã€æ— æœåŠ¡å™¨çš„ã€é”®å€¼ NoSQL æ•°æ®åº“**ï¼Œæ—¨åœ¨ä»¥ä»»ä½•è§„æ¨¡è¿è¡Œé«˜æ€§èƒ½åº”ç”¨ç¨‹åºã€‚DynamoDB æä¾›å†…ç½®çš„å®‰å…¨æ€§ã€æŒç»­å¤‡ä»½ã€è‡ªåŠ¨å¤šåŒºåŸŸå¤åˆ¶ã€å†…å­˜ç¼“å­˜å’Œæ•°æ®å¯¼å‡ºå·¥å…·ã€‚

åœ¨ DynamoDB ä¸­ï¼Œæ‚¨ä¸åˆ›å»ºæ•°æ®åº“ï¼Œè€Œæ˜¯**åˆ›å»ºè¡¨**ã€‚æ¯ä¸ªè¡¨éƒ½éœ€è¦é…ç½®ä¸€ä¸ª**åˆ†åŒºé”®**ï¼Œè¯¥é”®æ˜¯è¡¨çš„**ä¸»é”®çš„ä¸€éƒ¨åˆ†**ã€‚å®ƒæ˜¯ç”¨äºä»è¡¨ä¸­æ£€ç´¢é¡¹ç›®å¹¶åœ¨å¯æ‰©å±•æ€§å’Œå¯ç”¨æ€§æ–¹é¢åˆ†é…æ•°æ®çš„**å“ˆå¸Œå€¼**ã€‚è¿˜å¯ä»¥é…ç½®ä¸€ä¸ª**æ’åºé”®**ã€‚

### åŠ å¯†

é»˜è®¤æƒ…å†µä¸‹ï¼ŒDynamoDB ä½¿ç”¨çš„æ˜¯å±äº Amazon DynamoDB çš„ KMS å¯†é’¥ï¼Œè€Œä¸æ˜¯è‡³å°‘å±äºæ‚¨è´¦æˆ·çš„ AWS æ‰˜ç®¡å¯†é’¥ã€‚

<figure><img src="https://lh4.googleusercontent.com/JjtNS7aA-_GRMgZb4v93jWEQJi6DQdUPq0FEpzZPdeyCeNoG05p0NJiV9Zs-ULs_-Tfjmx0W1ZgsE2Ui2ljo7D-1a87Xny-gpLVQO0XmXdFoph9ci1RepbVNwaCe9oPruEZSEDxGTxF5dIv6pW1WpT6kWA=s2048" alt=""><figcaption></figcaption></figure>

### å¤‡ä»½å’Œå¯¼å‡ºåˆ° S3

å¯ä»¥**å®šæœŸ**ç”Ÿæˆ**è¡¨å¤‡ä»½**æˆ–æ ¹æ®**éœ€æ±‚**åˆ›å»ºå¤‡ä»½ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥ä¸ºè¡¨å¯ç”¨**æ—¶ç‚¹æ¢å¤ (PITR)**ã€‚æ—¶ç‚¹æ¢å¤å¯ä¸º DynamoDB æ•°æ®æä¾›**è¿ç»­å¤‡ä»½**ï¼ŒæŒç»­**35å¤©**ï¼Œä»¥å¸®åŠ©æ‚¨é˜²æ­¢æ„å¤–çš„å†™å…¥æˆ–åˆ é™¤æ“ä½œã€‚

è¿˜å¯ä»¥å°†è¡¨çš„æ•°æ®å¯¼å‡ºåˆ° S3ï¼Œä½†éœ€è¦**å¯ç”¨ PITR**ã€‚

### å›¾å½¢ç•Œé¢

æœ‰ä¸€äº›ç”¨äºæœ¬åœ° Dynamo æœåŠ¡çš„å›¾å½¢ç•Œé¢ï¼Œå¦‚ [DynamoDB Local](https://aws.amazon.com/blogs/aws/dynamodb-local-for-desktop-development/)ã€[dynalite](https://github.com/mhart/dynalite)ã€[localstack](https://github.com/localstack/localstack) ç­‰ï¼Œå¯èƒ½ä¼šå¾ˆæœ‰ç”¨ï¼š[https://github.com/aaronshaf/dynamodb-admin](https://github.com/aaronshaf/dynamodb-admin)

### æšä¸¾
```bash
# Tables
aws dynamodb list-tables
aws dynamodb describe-table --table-name <t_name> #Get metadata info
## The primary key and sort key will appear inside the KeySchema field

#Check if point in time recovery is enabled
aws dynamodb describe-continuous-backups \
--table-name tablename

# Backups
aws dynamodb list-backups
aws dynamodb describe-backup --backup-arn <arn>
aws dynamodb describe-continuous-backups --table-name <t_name>

# Global tables
aws dynamodb list-global-tables
aws dynamodb describe-global-table --global-table-name <name>

# Exports
aws dynamodb list-exports
aws dynamodb describe-export --export-arn <arn>

# Misc
aws dynamodb describe-endpoints #Dynamodb endpoints
```
### æœªç»èº«ä»½éªŒè¯çš„è®¿é—®

{% content-ref url="../../aws-unauthenticated-enum-access/aws-dynamodb-unauthenticated-access.md" %}
[aws-dynamodb-unauthenticated-access.md](../../aws-unauthenticated-enum-access/aws-dynamodb-unauthenticated-access.md)
{% endcontent-ref %}

### ç‰¹æƒå‡çº§

{% content-ref url="../../aws-privilege-escalation/aws-dynamodb-privesc.md" %}
[aws-dynamodb-privesc.md](../../aws-privilege-escalation/aws-dynamodb-privesc.md)
{% endcontent-ref %}

### æ¼æ´åˆ©ç”¨å

{% content-ref url="../../aws-post-exploitation/aws-dynamodb-post-exploitation.md" %}
[aws-dynamodb-post-exploitation.md](../../aws-post-exploitation/aws-dynamodb-post-exploitation.md)
{% endcontent-ref %}

### æŒä¹…æ€§

{% content-ref url="../../aws-persistence/aws-dynamodb-persistence.md" %}
[aws-dynamodb-persistence.md](../../aws-persistence/aws-dynamodb-persistence.md)
{% endcontent-ref %}

## DynamoDBæ³¨å…¥

### SQLæ³¨å…¥

æœ‰ä¸€äº›æ–¹æ³•å¯ä»¥ä½¿ç”¨**SQLè¯­æ³•**è®¿é—®DynamoDBæ•°æ®ï¼Œå› æ­¤ï¼Œå…¸å‹çš„**SQLæ³¨å…¥ä¹Ÿæ˜¯å¯èƒ½çš„**ã€‚

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

### NoSQLæ³¨å…¥

åœ¨DynamoDBä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„**æ¡ä»¶**æ¥æ£€ç´¢æ•°æ®ï¼Œå°±åƒåœ¨å¸¸è§çš„NoSQLæ³¨å…¥ä¸­ä¸€æ ·ï¼Œå¦‚æœå¯ä»¥**é“¾æ¥æ›´å¤šæ¡ä»¶æ¥æ£€ç´¢**æ•°æ®ï¼Œæ‚¨å¯ä»¥è·å–éšè—çš„æ•°æ®ï¼ˆæˆ–è½¬å‚¨æ•´ä¸ªè¡¨ï¼‰ã€‚
æ‚¨å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°DynamoDBæ”¯æŒçš„æ¡ä»¶ï¼š[https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API\_Condition.html](https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API\_Condition.html)

è¯·æ³¨æ„ï¼Œå¦‚æœé€šè¿‡**`query`**æˆ–**`scan`**è®¿é—®æ•°æ®ï¼Œåˆ™æ”¯æŒ**ä¸åŒçš„æ¡ä»¶**ã€‚

{% hint style="info" %}
å®é™…ä¸Šï¼Œ**æŸ¥è¯¢**æ“ä½œéœ€è¦åœ¨**ä¸»é”®**ä¸­æŒ‡å®šæ¡ä»¶**â€œEQâ€ï¼ˆç­‰äºï¼‰**æ‰èƒ½æ­£å¸¸å·¥ä½œï¼Œè¿™ä½¿å¾—å®ƒæ›´ä¸å®¹æ˜“å—åˆ°NoSQLæ³¨å…¥çš„å½±å“ï¼ˆä¹Ÿä½¿æ“ä½œéå¸¸æœ‰é™ï¼‰ã€‚
{% endhint %}

å¦‚æœæ‚¨å¯ä»¥**æ›´æ”¹æ‰§è¡Œçš„æ¯”è¾ƒ**æˆ–æ·»åŠ æ–°çš„æ¯”è¾ƒï¼Œæ‚¨å¯ä»¥æ£€ç´¢æ›´å¤šæ•°æ®ã€‚
```bash
# Comparators to dump the database
"NE": "a123" #Get everything that doesn't equal "a123"
"NOT_CONTAINS": "a123" #What you think
"GT": " " #All strings are greater than a space
```
### åŸå§‹Jsonæ³¨å…¥

**DynamoDB**æ¥å—**Json**å¯¹è±¡æ¥åœ¨æ•°æ®åº“ä¸­æœç´¢æ•°æ®ã€‚å¦‚æœä½ å‘ç°ä½ å¯ä»¥åœ¨å‘é€çš„jsonå¯¹è±¡ä¸­å†™å…¥å†…å®¹ï¼Œä½ å¯ä»¥å¯¼å‡ºæ•´ä¸ªæ•°æ®åº“çš„å†…å®¹ã€‚

ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªè¯·æ±‚ä¸­æ³¨å…¥å†…å®¹ï¼š

{% code overflow="wrap" %}
```bash
'{"Id": {"ComparisonOperator": "EQ","AttributeValueList": [{"N": "' + user_input + '"}]}}'
```
{% endcode %}

æ”»å‡»è€…å¯ä»¥æ³¨å…¥ç±»ä¼¼ä»¥ä¸‹å†…å®¹çš„ä»£ç ï¼š

`1000"}],"ComparisonOperator": "GT","AttributeValueList": [{"N": "0`

ä¿®å¤"EQ"æ¡ä»¶ï¼Œæœç´¢IDä¸º1000çš„æ•°æ®ï¼Œç„¶åæŸ¥æ‰¾æ‰€æœ‰IDå­—ç¬¦ä¸²å¤§äº0çš„æ•°æ®ï¼Œå³æ‰€æœ‰æ•°æ®ã€‚

### :property æ³¨å…¥

æŸäº›SDKå…è®¸ä½¿ç”¨å­—ç¬¦ä¸²æŒ‡ç¤ºè¦æ‰§è¡Œçš„è¿‡æ»¤æ“ä½œï¼Œä¾‹å¦‚ï¼š
```java
new ScanSpec().withProjectionExpression("UserName").withFilterExpression(user_input+" = :username and Password = :password").withValueMap(valueMap)
```
{% endcode %}

ä½ éœ€è¦çŸ¥é“ï¼Œåœ¨DynamoDBä¸­æœç´¢æ—¶ï¼Œç”¨äºåœ¨æ‰«æé¡¹ç›®æ—¶æ›¿æ¢è¿‡æ»¤è¡¨è¾¾å¼ä¸­çš„å±æ€§å€¼ï¼Œä»¤ç‰Œåº”è¯¥ä»¥`:`å­—ç¬¦å¼€å¤´ã€‚è¿™äº›ä»¤ç‰Œå°†åœ¨è¿è¡Œæ—¶è¢«å®é™…çš„å±æ€§å€¼æ›¿æ¢ã€‚

å› æ­¤ï¼Œå¯ä»¥é€šè¿‡ç±»ä¼¼ä»¥ä¸‹æ–¹å¼ç»•è¿‡å‰é¢çš„ç™»å½•ï¼š
```bash
:username = :username or :username
# This will generate the query:
# :username = :username or :username = :username and Password = :password
# which is always true
```
<details>

<summary><strong>æ”¯æŒHackTrickså¹¶è·å¾—ç¦åˆ©ï¼</strong></summary>

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­è¢«å¹¿å‘Š**ï¼Œæˆ–è€…å¦‚æœæ‚¨æƒ³è®¿é—®**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“ï¼Œ[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ–è€… [**Telegramç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…åœ¨**Twitter**ä¸Š**å…³æ³¨**æˆ‘ ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥**åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
