# AWS - DynamoDB æšä¸¾

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸º</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS çº¢é˜Ÿä¸“å®¶)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨ **HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š** æˆ– **ä»¥PDFæ ¼å¼ä¸‹è½½HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## DynamoDB

### åŸºæœ¬ä¿¡æ¯

Amazon DynamoDB æ˜¯ä¸€ä¸ª**å®Œå…¨æ‰˜ç®¡çš„ï¼Œæ— æœåŠ¡å™¨çš„ï¼Œé”®å€¼NoSQLæ•°æ®åº“**ï¼Œæ—¨åœ¨è¿è¡Œä»»ä½•è§„æ¨¡çš„é«˜æ€§èƒ½åº”ç”¨ç¨‹åºã€‚DynamoDBæä¾›å†…ç½®å®‰å…¨æ€§ã€æŒç»­å¤‡ä»½ã€è‡ªåŠ¨å¤šåŒºåŸŸå¤åˆ¶ã€å†…å­˜ç¼“å­˜å’Œæ•°æ®å¯¼å‡ºå·¥å…·ã€‚

åœ¨DynamoDBä¸­ï¼Œæ‚¨ä¸åˆ›å»ºæ•°æ®åº“ï¼Œè€Œæ˜¯**åˆ›å»ºè¡¨**ã€‚æ¯ä¸ªè¡¨éƒ½éœ€è¦é…ç½®ä¸€ä¸ª**åˆ†åŒºé”®**ï¼Œå®ƒæ˜¯**è¡¨çš„ä¸»é”®**çš„ä¸€éƒ¨åˆ†ã€‚å®ƒæ˜¯ä¸€ä¸ª**å“ˆå¸Œå€¼**ï¼Œç”¨äºä»è¡¨ä¸­æ£€ç´¢é¡¹ç›®ï¼Œå¹¶åœ¨ä¸»æœºä¹‹é—´åˆ†é…æ•°æ®ä»¥å®ç°å¯ä¼¸ç¼©æ€§å’Œå¯ç”¨æ€§ã€‚ä¹Ÿå¯ä»¥é…ç½®**æ’åºé”®**ã€‚

### åŠ å¯†

é»˜è®¤æƒ…å†µä¸‹ï¼ŒDynamoDBä½¿ç”¨ä¸€ä¸ªå±äº**Amazon DynamoDBçš„KMSå¯†é’¥**ï¼Œç”šè‡³ä¸æ˜¯è‡³å°‘å±äºæ‚¨è´¦æˆ·çš„AWSæ‰˜ç®¡å¯†é’¥ã€‚

<figure><img src="https://lh4.googleusercontent.com/JjtNS7aA-_GRMgZb4v93jWEQJi6DQdUPq0FEpzZPdeyCeNoG05p0NJiV9Zs-ULs_-Tfjmx0W1ZgsE2Ui2ljo7D-1a87Xny-gpLVQO0XmXdFoph9ci1RepbVNwaCe9oPruEZSEDxGTxF5dIv6pW1WpT6kWA=s2048" alt=""><figcaption></figcaption></figure>

### å¤‡ä»½å’Œå¯¼å‡ºåˆ°S3

å¯ä»¥**å®‰æ’**ç”Ÿæˆ**è¡¨å¤‡ä»½**æˆ–æ ¹æ®**éœ€æ±‚**åˆ›å»ºã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥ä¸ºè¡¨å¯ç”¨**ç‚¹æ—¶é—´æ¢å¤ï¼ˆPITRï¼‰**ã€‚ç‚¹æ—¶é—´æ¢å¤ä¸ºæ‚¨çš„DynamoDBæ•°æ®æä¾›è¿ç»­çš„**å¤‡ä»½**ï¼Œä¸ºæœŸ**35å¤©**ï¼Œä»¥å¸®åŠ©æ‚¨é˜²æ­¢æ„å¤–å†™å…¥æˆ–åˆ é™¤æ“ä½œã€‚

ä¹Ÿå¯ä»¥å°†**è¡¨çš„æ•°æ®å¯¼å‡ºåˆ°S3**ï¼Œä½†è¡¨éœ€è¦å¯ç”¨**PITR**ã€‚

### GUI

å¯¹äºæœ¬åœ°DynamoæœåŠ¡ï¼ˆå¦‚[DynamoDB Local](https://aws.amazon.com/blogs/aws/dynamodb-local-for-desktop-development/)ã€[dynalite](https://github.com/mhart/dynalite)ã€[localstack](https://github.com/localstack/localstack)ç­‰ï¼‰ï¼Œæœ‰ä¸€ä¸ªGUIå¯èƒ½ä¼šæœ‰ç”¨ï¼š[https://github.com/aaronshaf/dynamodb-admin](https://github.com/aaronshaf/dynamodb-admin)

### æšä¸¾
```bash
# Tables
aws dynamodb list-tables
aws dynamodb describe-table --table-name <t_name> #Get metadata info
## The primary key and sort key will appear inside the KeySchema field

#Check if point in time recovery is enabled
aws dynamodb describe-continuous-backups \
--table-name tablename

# Backups
aws dynamodb list-backups
aws dynamodb describe-backup --backup-arn <arn>
aws dynamodb describe-continuous-backups --table-name <t_name>

# Global tables
aws dynamodb list-global-tables
aws dynamodb describe-global-table --global-table-name <name>

# Exports
aws dynamodb list-exports
aws dynamodb describe-export --export-arn <arn>

# Misc
aws dynamodb describe-endpoints #Dynamodb endpoints
```
### æœªç»è®¤è¯çš„è®¿é—®

{% content-ref url="../../aws-unauthenticated-enum-access/aws-dynamodb-unauthenticated-access.md" %}
[aws-dynamodb-unauthenticated-access.md](../../aws-unauthenticated-enum-access/aws-dynamodb-unauthenticated-access.md)
{% endcontent-ref %}

### æƒé™æå‡

{% content-ref url="../../aws-privilege-escalation/aws-dynamodb-privesc.md" %}
[aws-dynamodb-privesc.md](../../aws-privilege-escalation/aws-dynamodb-privesc.md)
{% endcontent-ref %}

### åæœŸåˆ©ç”¨

{% content-ref url="../../aws-post-exploitation/aws-dynamodb-post-exploitation.md" %}
[aws-dynamodb-post-exploitation.md](../../aws-post-exploitation/aws-dynamodb-post-exploitation.md)
{% endcontent-ref %}

### æŒä¹…åŒ–

{% content-ref url="../../aws-persistence/aws-dynamodb-persistence.md" %}
[aws-dynamodb-persistence.md](../../aws-persistence/aws-dynamodb-persistence.md)
{% endcontent-ref %}

## DynamoDB æ³¨å…¥

### SQL æ³¨å…¥

å­˜åœ¨ä½¿ç”¨ **SQL è¯­æ³•** è®¿é—® DynamoDB æ•°æ®çš„æ–¹æ³•ï¼Œå› æ­¤ï¼Œå…¸å‹çš„ **SQL æ³¨å…¥ä¹Ÿæ˜¯å¯èƒ½çš„**ã€‚

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

### NoSQL æ³¨å…¥

åœ¨ DynamoDB ä¸­å¯ä»¥ä½¿ç”¨ä¸åŒçš„ **æ¡ä»¶** æ¥æ£€ç´¢æ•°æ®ï¼Œå°±åƒåœ¨å¸¸è§çš„ NoSQL æ³¨å…¥ä¸­ï¼Œå¦‚æœå¯ä»¥ **é“¾æ¥æ›´å¤šæ¡ä»¶ä»¥æ£€ç´¢** æ•°æ®ï¼Œä½ å¯èƒ½ä¼šè·å¾—éšè—çš„æ•°æ®ï¼ˆæˆ–è½¬å‚¨æ•´ä¸ªè¡¨ï¼‰ã€‚
ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ° DynamoDB æ”¯æŒçš„æ¡ä»¶ï¼š[https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API\_Condition.html](https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API\_Condition.html)

è¯·æ³¨æ„ï¼Œå¦‚æœæ•°æ®æ˜¯é€šè¿‡ **`query`** æˆ– **`scan`** è®¿é—®çš„ï¼Œæ”¯æŒçš„ **ä¸åŒæ¡ä»¶** ä¼šæœ‰æ‰€ä¸åŒã€‚

{% hint style="info" %}
å®é™…ä¸Šï¼Œ**Query** æ“ä½œéœ€è¦æŒ‡å®š **ä¸»é”®** ä¸­çš„ **æ¡ä»¶ "EQ"ï¼ˆç­‰äºï¼‰** æ‰èƒ½å·¥ä½œï¼Œè¿™ä½¿å¾—å®ƒå¯¹ NoSQL æ³¨å…¥çš„ **æŠµæŠ—åŠ›æ›´å¼º**ï¼ˆåŒæ—¶ä¹Ÿä½¿å¾—æ“ä½œéå¸¸æœ‰é™ï¼‰ã€‚
{% endhint %}

å¦‚æœä½ èƒ½ **æ”¹å˜æ¯”è¾ƒ** æ‰§è¡Œæˆ–æ·»åŠ æ–°çš„æ¯”è¾ƒï¼Œä½ å¯èƒ½ä¼šæ£€ç´¢åˆ°æ›´å¤šæ•°æ®ã€‚
```bash
# Comparators to dump the database
"NE": "a123" #Get everything that doesn't equal "a123"
"NOT_CONTAINS": "a123" #What you think
"GT": " " #All strings are greater than a space
```
{% embed url="https://book.hacktricks.xyz/pentesting-web/nosql-injection" %}

### åŸå§‹ Json æ³¨å…¥

**DynamoDB** æ¥å— **Json** å¯¹è±¡æ¥åœ¨æ•°æ®åº“å†…**æœç´¢**æ•°æ®ã€‚å¦‚æœä½ å‘ç°ä½ å¯ä»¥å†™å…¥å‘é€åˆ°æœç´¢çš„ json å¯¹è±¡ï¼Œä½ å¯ä»¥ä½¿æ•°æ®åº“è½¬å‚¨æ‰€æœ‰å†…å®¹ã€‚

ä¾‹å¦‚ï¼Œåœ¨è¿™æ ·çš„è¯·æ±‚ä¸­æ³¨å…¥ï¼š

{% code overflow="wrap" %}
```bash
'{"Id": {"ComparisonOperator": "EQ","AttributeValueList": [{"N": "' + user_input + '"}]}}'
```
{% endcode %}

æ”»å‡»è€…å¯ä»¥æ³¨å…¥ç±»ä¼¼ä»¥ä¸‹å†…å®¹ï¼š

`1000"}],"ComparisonOperator": "GT","AttributeValueList": [{"N": "0`

ä¿®å¤â€œEQâ€æ¡ä»¶ï¼Œæœç´¢IDä¸º1000çš„æ•°æ®ï¼Œç„¶åæŸ¥æ‰¾æ‰€æœ‰Idå­—ç¬¦ä¸²å¤§äº0çš„æ•°æ®ï¼Œå³æ‰€æœ‰æ•°æ®ã€‚

### :property æ³¨å…¥

ä¸€äº›SDKå…è®¸ä½¿ç”¨å­—ç¬¦ä¸²æ¥æŒ‡ç¤ºè¦æ‰§è¡Œçš„è¿‡æ»¤ï¼Œä¾‹å¦‚ï¼š

{% code overflow="wrap" %}
```java
new ScanSpec().withProjectionExpression("UserName").withFilterExpression(user_input+" = :username and Password = :password").withValueMap(valueMap)
```
{% endcode %}

æ‚¨éœ€è¦çŸ¥é“ï¼Œåœ¨DynamoDBä¸­æœç´¢æ—¶ï¼Œä¸ºäº†åœ¨æ‰«æé¡¹ç›®æ—¶åœ¨**è¿‡æ»¤è¡¨è¾¾å¼**ä¸­**æ›¿æ¢**ä¸€ä¸ªå±æ€§**å€¼**ï¼Œä»¤ç‰Œåº”è¯¥ä»¥**`:`** å­—ç¬¦**å¼€å§‹**ã€‚è¿™æ ·çš„ä»¤ç‰Œå°†åœ¨**è¿è¡Œæ—¶**è¢«å®é™…çš„**å±æ€§å€¼æ›¿æ¢**ã€‚

å› æ­¤ï¼Œåƒå‰é¢çš„ç™»å½•å¯ä»¥ç”¨ç±»ä¼¼ä»¥ä¸‹æ–¹å¼ç»•è¿‡ï¼š
```bash
:username = :username or :username
# This will generate the query:
# :username = :username or :username = :username and Password = :password
# which is always true
```
<details>

<summary><strong>ä»é›¶åˆ°è‹±é›„å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œé€šè¿‡</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨**HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**telegramç¾¤ç»„**](https://t.me/peass)æˆ–åœ¨**Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
