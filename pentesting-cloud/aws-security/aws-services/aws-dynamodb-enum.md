# AWS - DynamoDB æšä¸¾

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹  AWS é»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS çº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„ **å…¬å¸åœ¨ HackTricks ä¸­åšå¹¿å‘Š** æˆ– **ä¸‹è½½ HackTricks çš„ PDF**ï¼Œè¯·æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å– [**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* æ¢ç´¢ [**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶ [**NFT**](https://opensea.io/collection/the-peass-family) æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## DynamoDB

### åŸºæœ¬ä¿¡æ¯

Amazon DynamoDB è¢« AWS æä¾›ä¸ºä¸€ç§ **å®Œå…¨æ‰˜ç®¡ã€æ— æœåŠ¡å™¨ã€é”®å€¼ NoSQL æ•°æ®åº“**ï¼Œä¸“ä¸ºé©±åŠ¨é«˜æ€§èƒ½åº”ç”¨è€Œè®¾è®¡ï¼Œæ— è®ºå…¶è§„æ¨¡å¦‚ä½•ã€‚è¯¥æœåŠ¡ç¡®ä¿å¼ºå¤§çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬å›ºæœ‰çš„å®‰å…¨æªæ–½ã€ä¸é—´æ–­çš„å¤‡ä»½ã€è·¨å¤šä¸ªåŒºåŸŸçš„è‡ªåŠ¨å¤åˆ¶ã€é›†æˆå†…å­˜ç¼“å­˜ä»¥åŠä¾¿æ·çš„æ•°æ®å¯¼å‡ºå·¥å…·ã€‚

åœ¨ DynamoDB çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œ**ä¸æ˜¯å»ºç«‹ä¼ ç»Ÿæ•°æ®åº“ï¼Œè€Œæ˜¯åˆ›å»ºè¡¨**ã€‚æ¯ä¸ªè¡¨éƒ½è¦æ±‚æŒ‡å®šä¸€ä¸ª **åˆ†åŒºé”®** ä½œä¸º **è¡¨çš„ä¸»é”®** çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ã€‚è¿™ä¸ªåˆ†åŒºé”®ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª **å“ˆå¸Œå€¼**ï¼Œåœ¨æ£€ç´¢é¡¹ç›®å’Œåœ¨å„ä¸ªä¸»æœºä¹‹é—´åˆ†å‘æ•°æ®æ–¹é¢å‘æŒ¥å…³é”®ä½œç”¨ã€‚è¿™ç§åˆ†å‘å¯¹äºç»´æŠ¤æ•°æ®åº“çš„å¯ä¼¸ç¼©æ€§å’Œå¯ç”¨æ€§è‡³å…³é‡è¦ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥é€‰æ‹©æ·»åŠ ä¸€ä¸ª **æ’åºé”®** æ¥è¿›ä¸€æ­¥ç»†åŒ–æ•°æ®ç»„ç»‡ã€‚

### åŠ å¯†

é»˜è®¤æƒ…å†µä¸‹ï¼ŒDynamoDB ä½¿ç”¨å±äº Amazon DynamoDB çš„ KMS å¯†é’¥ï¼Œè€Œä¸æ˜¯è‡³å°‘å±äºæ‚¨è´¦æˆ·çš„ AWS æ‰˜ç®¡å¯†é’¥ã€‚

<figure><img src="https://lh4.googleusercontent.com/JjtNS7aA-_GRMgZb4v93jWEQJi6DQdUPq0FEpzZPdeyCeNoG05p0NJiV9Zs-ULs_-Tfjmx0W1ZgsE2Ui2ljo7D-1a87Xny-gpLVQO0XmXdFoph9ci1RepbVNwaCe9oPruEZSEDxGTxF5dIv6pW1WpT6kWA=s2048" alt=""><figcaption></figcaption></figure>

### å¤‡ä»½ & å¯¼å‡ºåˆ° S3

å¯ä»¥**å®‰æ’**ç”Ÿæˆ**è¡¨å¤‡ä»½**æˆ–æ ¹æ®**éœ€æ±‚**åˆ›å»ºå¤‡ä»½ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥ä¸ºè¡¨å¯ç”¨**æ¢å¤åˆ°æŸä¸ªæ—¶é—´ç‚¹ (PITR)**ã€‚æ¢å¤åˆ°æŸä¸ªæ—¶é—´ç‚¹æä¾›äº† DynamoDB æ•°æ®çš„è¿ç»­**å¤‡ä»½**ï¼ŒæŒç»­ **35 å¤©**ï¼Œä»¥å¸®åŠ©æ‚¨é˜²èŒƒæ„å¤–çš„å†™å…¥æˆ–åˆ é™¤æ“ä½œã€‚

è¿˜å¯ä»¥å°†è¡¨çš„**æ•°æ®å¯¼å‡ºåˆ° S3**ï¼Œä½†éœ€è¦å¯ç”¨**PITR**ã€‚

### GUI

æœ‰ä¸€ä¸ªç”¨äºæœ¬åœ° Dynamo æœåŠ¡çš„ GUIï¼Œå¦‚ [DynamoDB Local](https://aws.amazon.com/blogs/aws/dynamodb-local-for-desktop-development/)ã€[dynalite](https://github.com/mhart/dynalite)ã€[localstack](https://github.com/localstack/localstack) ç­‰ï¼Œå¯èƒ½ä¼šå¾ˆæœ‰ç”¨ï¼š[https://github.com/aaronshaf/dynamodb-admin](https://github.com/aaronshaf/dynamodb-admin)

### æšä¸¾
```bash
# Tables
aws dynamodb list-tables
aws dynamodb describe-table --table-name <t_name> #Get metadata info
## The primary key and sort key will appear inside the KeySchema field

#Check if point in time recovery is enabled
aws dynamodb describe-continuous-backups \
--table-name tablename

# Backups
aws dynamodb list-backups
aws dynamodb describe-backup --backup-arn <arn>
aws dynamodb describe-continuous-backups --table-name <t_name>

# Global tables
aws dynamodb list-global-tables
aws dynamodb describe-global-table --global-table-name <name>

# Exports
aws dynamodb list-exports
aws dynamodb describe-export --export-arn <arn>

# Misc
aws dynamodb describe-endpoints #Dynamodb endpoints
```
### æœªç»èº«ä»½éªŒè¯çš„è®¿é—®

{% content-ref url="../aws-unauthenticated-enum-access/aws-dynamodb-unauthenticated-access.md" %}
[aws-dynamodb-unauthenticated-access.md](../aws-unauthenticated-enum-access/aws-dynamodb-unauthenticated-access.md)
{% endcontent-ref %}

### æƒé™æå‡

{% content-ref url="../aws-privilege-escalation/aws-dynamodb-privesc.md" %}
[aws-dynamodb-privesc.md](../aws-privilege-escalation/aws-dynamodb-privesc.md)
{% endcontent-ref %}

### æ¼æ´åˆ©ç”¨å

{% content-ref url="../aws-post-exploitation/aws-dynamodb-post-exploitation.md" %}
[aws-dynamodb-post-exploitation.md](../aws-post-exploitation/aws-dynamodb-post-exploitation.md)
{% endcontent-ref %}

### æŒä¹…æ€§

{% content-ref url="../aws-persistence/aws-dynamodb-persistence.md" %}
[aws-dynamodb-persistence.md](../aws-persistence/aws-dynamodb-persistence.md)
{% endcontent-ref %}

## DynamoDBæ³¨å…¥

### SQLæ³¨å…¥

æœ‰æ–¹æ³•å¯ä»¥ä½¿ç”¨**SQLè¯­æ³•**è®¿é—®DynamoDBæ•°æ®ï¼Œå› æ­¤ï¼Œå…¸å‹çš„**SQLæ³¨å…¥ä¹Ÿæ˜¯å¯èƒ½çš„**ã€‚

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

### NoSQLæ³¨å…¥

åœ¨DynamoDBä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„**æ¡ä»¶**æ¥æ£€ç´¢æ•°æ®ï¼Œå°±åƒåœ¨å¸¸è§çš„NoSQLæ³¨å…¥ä¸­ï¼Œå¦‚æœå¯ä»¥**é“¾æ¥æ›´å¤šæ¡ä»¶æ¥æ£€ç´¢**æ•°æ®ï¼Œæ‚¨å¯ä»¥è·å–éšè—æ•°æ®ï¼ˆæˆ–è½¬å‚¨æ•´ä¸ªè¡¨ï¼‰ã€‚\
æ‚¨å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°DynamoDBæ”¯æŒçš„æ¡ä»¶ï¼š[https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API\_Condition.html](https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API\_Condition.html)

è¯·æ³¨æ„ï¼Œå¦‚æœé€šè¿‡**`query`**æˆ–**`scan`**è®¿é—®æ•°æ®ï¼Œåˆ™æ”¯æŒ**ä¸åŒçš„æ¡ä»¶**ã€‚

{% hint style="info" %}
å®é™…ä¸Šï¼Œ**æŸ¥è¯¢**æ“ä½œéœ€è¦åœ¨**ä¸»**é”®ä¸­æŒ‡å®š**æ¡ä»¶â€œEQâ€ï¼ˆç›¸ç­‰ï¼‰**æ‰èƒ½æ­£å¸¸å·¥ä½œï¼Œè¿™ä½¿å…¶æ›´ä¸å®¹æ˜“å—åˆ°NoSQLæ³¨å…¥çš„å½±å“ï¼ˆä¹Ÿä½¿æ“ä½œéå¸¸æœ‰é™ï¼‰ã€‚
{% endhint %}

å¦‚æœæ‚¨å¯ä»¥**æ›´æ”¹æ‰§è¡Œçš„æ¯”è¾ƒ**æˆ–æ·»åŠ æ–°çš„æ¯”è¾ƒï¼Œæ‚¨å¯ä»¥æ£€ç´¢æ›´å¤šæ•°æ®ã€‚
```bash
# Comparators to dump the database
"NE": "a123" #Get everything that doesn't equal "a123"
"NOT_CONTAINS": "a123" #What you think
"GT": " " #All strings are greater than a space
```
### åŸå§‹Jsonæ³¨å…¥

**DynamoDB**æ¥å—**Json**å¯¹è±¡æ¥**æœç´¢**æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚å¦‚æœæ‚¨å‘ç°å¯ä»¥åœ¨å‘é€åˆ°æœç´¢çš„jsonå¯¹è±¡ä¸­å†™å…¥å†…å®¹ï¼Œæ‚¨å¯ä»¥å¯¼å‡ºæ•´ä¸ªæ•°æ®åº“çš„å†…å®¹ã€‚

ä¾‹å¦‚ï¼Œåœ¨ç±»ä¼¼ä»¥ä¸‹è¯·æ±‚ä¸­æ³¨å…¥ï¼š

{% code overflow="wrap" %}
```bash
'{"Id": {"ComparisonOperator": "EQ","AttributeValueList": [{"N": "' + user_input + '"}]}}'
```
{% endcode %}

æ”»å‡»è€…å¯ä»¥æ³¨å…¥ç±»ä¼¼ä»¥ä¸‹å†…å®¹ï¼š

`1000"}],"ComparisonOperator": "GT","AttributeValueList": [{"N": "0`

ä¿®å¤"EQ"æ¡ä»¶ï¼Œæœç´¢IDä¸º1000çš„æ•°æ®ï¼Œç„¶åæŸ¥æ‰¾æ‰€æœ‰IDå­—ç¬¦ä¸²å¤§äº0çš„æ•°æ®ï¼Œå³æ‰€æœ‰æ•°æ®ã€‚

### :propertyæ³¨å…¥

æŸäº›SDKå…è®¸ä½¿ç”¨å­—ç¬¦ä¸²æŒ‡ç¤ºè¦æ‰§è¡Œçš„è¿‡æ»¤æ“ä½œï¼Œå¦‚ï¼š
```java
new ScanSpec().withProjectionExpression("UserName").withFilterExpression(user_input+" = :username and Password = :password").withValueMap(valueMap)
```
{% endcode %}

æ‚¨éœ€è¦çŸ¥é“ï¼Œåœ¨DynamoDBä¸­æœç´¢**æ›¿æ¢**æ‰«æé¡¹ç›®æ—¶**è¿‡æ»¤è¡¨è¾¾å¼**ä¸­çš„å±æ€§**å€¼**ï¼Œä»¤ç‰Œåº”è¯¥ä»¥**`:`**å­—ç¬¦**å¼€å¤´**ã€‚è¿™äº›ä»¤ç‰Œå°†åœ¨è¿è¡Œæ—¶**æ›¿æ¢**ä¸ºå®é™…çš„**å±æ€§å€¼**ã€‚

å› æ­¤ï¼Œç±»ä¼¼ä¸Šä¸€ä¸ªç¤ºä¾‹çš„ç™»å½•å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç»•è¿‡ï¼š
```bash
:username = :username or :username
# This will generate the query:
# :username = :username or :username = :username and Password = :password
# which is always true
```
<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

å…¶ä»–æ”¯æŒHackTricksçš„æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
