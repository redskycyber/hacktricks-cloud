# AWS - Nitro

<details>

<summary><strong>htARTE (HackTricks AWS Red Team ì „ë¬¸ê°€)</strong>ì—ì„œ <a href="https://training.hacktricks.xyz/courses/arte"><strong>AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ìš°ì„¸ìš”</strong></a><strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ê°€ HackTricksì— ê´‘ê³ ë˜ê¸¸ ì›í•˜ê±°ë‚˜** **HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œí•˜ê³  ì‹¶ë‹¤ë©´** [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>

## ê¸°ë³¸ ì •ë³´

AWS NitroëŠ” AWS EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ ê¸°ë³¸ í”Œë«í¼ì„ í˜•ì„±í•˜ëŠ” **í˜ì‹ ì ì¸ ê¸°ìˆ  ëª¨ìŒ**ì…ë‹ˆë‹¤. Amazonì— ì˜í•´ ì†Œê°œëœ NitroëŠ” **ë³´ì•ˆ, ì„±ëŠ¥ ë° ì‹ ë¢°ì„±ì„ í–¥ìƒ**ì‹œí‚¤ê¸° ìœ„í•´ ì‚¬ìš©ì ì •ì˜ **í•˜ë“œì›¨ì–´ êµ¬ì„± ìš”ì†Œ ë° ê°€ë²¼ìš´ í•˜ì´í¼ë°”ì´ì €**ë¥¼ í™œìš©í•©ë‹ˆë‹¤. NitroëŠ” ì „í†µì ì¸ ê°€ìƒí™” ê¸°ëŠ¥ì˜ ë§ì€ ë¶€ë¶„ì„ ì „ìš© í•˜ë“œì›¨ì–´ ë° ì†Œí”„íŠ¸ì›¨ì–´ë¡œ ì¶”ìƒí™”í•˜ì—¬ **ê³µê²© í‘œë©´ì„ ìµœì†Œí™”**í•˜ê³  ìì› íš¨ìœ¨ì„±ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤. ê°€ìƒí™” ê¸°ëŠ¥ì„ ì˜¤í”„ë¡œë“œí•¨ìœ¼ë¡œì¨ NitroëŠ” EC2 ì¸ìŠ¤í„´ìŠ¤ê°€ **ê±°ì˜ ë² ì–´ ë©”íƒˆ ì„±ëŠ¥**ì„ ì œê³µí•  ìˆ˜ ìˆë„ë¡ í•˜ì—¬ ìì› ì§‘ì•½ì ì¸ ì‘ìš© í”„ë¡œê·¸ë¨ì— íŠ¹íˆ ìœ ìµí•©ë‹ˆë‹¤. ë˜í•œ Nitro ë³´ì•ˆ ì¹©ì€ **í•˜ë“œì›¨ì–´ ë° íŒì›¨ì–´ì˜ ë³´ì•ˆ**ì„ íŠ¹íˆ ë³´ì¥í•˜ì—¬ ê²¬ê³ í•œ ì•„í‚¤í…ì²˜ë¥¼ ë”ìš± í™•ê³ íˆ í•©ë‹ˆë‹¤.

### Nitro Enclaves

**AWS Nitro Enclaves**ëŠ” Amazon EC2 ì¸ìŠ¤í„´ìŠ¤ ë‚´ì—ì„œ **ê³ ë„ë¡œ ë¯¼ê°í•œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ íŠ¹ë³„íˆ ì„¤ê³„ëœ ì•ˆì „í•œ, ê²©ë¦¬ëœ ì»´í“¨íŒ… í™˜ê²½**ì„ ì œê³µí•©ë‹ˆë‹¤. AWS Nitro ì‹œìŠ¤í…œì„ í™œìš©í•˜ì—¬ ì´ëŸ¬í•œ EnclavesëŠ” ê²¬ê³ í•œ **ê²©ë¦¬ ë° ë³´ì•ˆ**ì„ ë³´ì¥í•˜ì—¬ PII ë˜ëŠ” ê¸ˆìœµ ê¸°ë¡ê³¼ ê°™ì€ **ê¸°ë°€ ì •ë³´ë¥¼ ì²˜ë¦¬**í•˜ëŠ” ë° ì´ìƒì ì…ë‹ˆë‹¤. ì´ë“¤ì€ ë°ì´í„° ë…¸ì¶œ ìœ„í—˜ì„ í¬ê²Œ ì¤„ì´ëŠ” ìµœì†Œí•œì˜ í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤. ë˜í•œ Nitro EnclavesëŠ” ì•”í˜¸í™” ì¸ì¦ì„ ì§€ì›í•˜ì—¬ ì‚¬ìš©ìê°€ ì‹¤í–‰ ì¤‘ì¸ ì½”ë“œê°€ ì¸ì¦ëœ ì½”ë“œì¸ì§€ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ í•˜ì—¬ ì—„ê²©í•œ ê·œì • ì¤€ìˆ˜ ë° ë°ì´í„° ë³´í˜¸ í‘œì¤€ì„ ìœ ì§€í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤.

{% hint style="danger" %}
Nitro Enclave ì´ë¯¸ì§€ëŠ” **EC2 ì¸ìŠ¤í„´ìŠ¤ ë‚´ë¶€ì—ì„œ ì‹¤í–‰**ë˜ë©° AWS ì›¹ ì½˜ì†”ì—ì„œ EC2 ì¸ìŠ¤í„´ìŠ¤ê°€ Nitro Enclave ì´ë¯¸ì§€ë¥¼ ì‹¤í–‰ ì¤‘ì¸ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
{% endhint %}

### Nitro Enclave CLI ì„¤ì¹˜

ëª¨ë“  ì§€ì¹¨ì„ [**ë¬¸ì„œ**](https://catalog.us-east-1.prod.workshops.aws/event/dashboard/en-US/workshop/1-my-first-enclave/1-1-nitro-enclaves-cli#run-connect-and-terminate-the-enclave)ì—ì„œ ë”°ë¥´ì„¸ìš”. ê·¸ëŸ¬ë‚˜ ì´ê²ƒë“¤ì´ ê°€ì¥ ì¤‘ìš”í•©ë‹ˆë‹¤:
```bash
# Install tools
sudo amazon-linux-extras install aws-nitro-enclaves-cli -y
sudo yum install aws-nitro-enclaves-cli-devel -y

# Config perms
sudo usermod -aG ne $USER
sudo usermod -aG docker $USER

# Check installation
nitro-cli --version

# Start and enable the Nitro Enclaves allocator service.
sudo systemctl start nitro-enclaves-allocator.service && sudo systemctl enable nitro-enclaves-allocator.service
```
### Nitro Enclave ì´ë¯¸ì§€

Nitro Enclaveì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ì´ë¯¸ì§€ë“¤ì€ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ë©°, ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì´ ë„ì»¤ ì´ë¯¸ì§€ë¡œë¶€í„° Nitro Enclave ì´ë¯¸ì§€ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
# You need to have the docker image accesible in your running local registry
# Or indicate the full docker image URL to access the image
nitro-cli build-enclave --docker-uri <docker-img>:<tag> --output-file nitro-img.eif
```
Nitro Enclave ì´ë¯¸ì§€ëŠ” **`eif`** (Enclave Image File) í™•ì¥ìë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

ì¶œë ¥ì€ ë‹¤ìŒê³¼ ìœ ì‚¬í•©ë‹ˆë‹¤:
```
Using the locally available Docker image...
Enclave Image successfully created.
{
"Measurements": {
"HashAlgorithm": "Sha384 { ... }",
"PCR0": "e199261541a944a93129a52a8909d29435dd89e31299b59c371158fc9ab3017d9c450b0a580a487e330b4ac691943284",
"PCR1": "bcdf05fefccaa8e55bf2c8d6dee9e79bbff31e34bf28a99aa19e6b29c37ee80b214a414b7607236edf26fcb78654e63f",
"PCR2": "2e1fca1dbb84622ec141557dfa971b4f8ea2127031b264136a20278c43d1bba6c75fea286cd4de9f00450b6a8db0e6d3"
}
}
```
[**ë¬¸ì„œ**](https://catalog.us-east-1.prod.workshops.aws/event/dashboard/en-US/workshop/1-my-first-enclave/1-1-nitro-enclaves-cli#run-connect-and-terminate-the-enclave)ì— ë”°ë¥´ë©´, ì—”í´ë ˆì´ë¸Œ ì´ë¯¸ì§€ë¥¼ ì‹¤í–‰í•˜ë ¤ë©´ í•´ë‹¹ ì´ë¯¸ì§€ì— í• ë‹¹ëœ ë©”ëª¨ë¦¬ê°€ ë””ìŠ¤í¬ì— ì €ì¥ëœ **`eif`** íŒŒì¼ í¬ê¸°ì˜ ìµœì†Œ 4ë°° ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.
