# AWS - Nitro

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Podstawowe informacje

AWS Nitro to zestaw **innowacyjnych technologii**, kt贸re stanowi podstawow platform dla instancji AWS EC2. Wprowadzony przez Amazon w celu **poprawy bezpieczestwa, wydajnoci i niezawodnoci**, Nitro wykorzystuje dedykowane **komponenty sprztowe i lekki hipernadzorca**. Abstrahuje wiele tradycyjnych funkcji wirtualizacji do dedykowanego sprztu i oprogramowania, **minimalizujc powierzchni ataku** i poprawiajc efektywno zasob贸w. Poprzez przeniesienie funkcji wirtualizacji, Nitro pozwala instancjom EC2 osiga **wydajno zbli偶on do metalu**, co jest szczeg贸lnie korzystne dla aplikacji wymagajcych du偶ych zasob贸w. Dodatkowo, specjalny ukad zabezpiecze Nitro zapewnia **bezpieczestwo sprztu i oprogramowania**, dodatkowo umacniajc jego solidn architektur.

### Komory Nitro

**AWS Nitro Enclaves** zapewniaj bezpieczne, **izolowane rodowisko obliczeniowe w instancjach Amazon EC2**, specjalnie zaprojektowane do przetwarzania bardzo wra偶liwych danych. Wykorzystujc System AWS Nitro, te komory zapewniaj solidn **izolacj i bezpieczestwo**, idealne do **obsugi poufnych informacji** takich jak PII lub dane finansowe. Charakteryzuj si minimalistycznym rodowiskiem, znaczco zmniejszajc ryzyko ujawnienia danych. Dodatkowo, komory Nitro obsuguj atestacj kryptograficzn, pozwalajc u偶ytkownikom zweryfikowa, 偶e uruchamiany jest tylko autoryzowany kod, co jest kluczowe dla zachowania cisych standard贸w zgodnoci i ochrony danych.

{% hint style="danger" %}
Obrazy kom贸r Nitro s **uruchamiane wewntrz instancji EC2** i nie mo偶na ich zobaczy w konsoli internetowej AWS, czy instancja EC2 uruchamia obrazy w komorze Nitro, czy nie.
{% endhint %}

### Instalacja interfejsu wiersza polece komory Nitro

Postpuj zgodnie ze wszystkimi instrukcjami [**z dokumentacji**](https://catalog.us-east-1.prod.workshops.aws/event/dashboard/en-US/workshop/1-my-first-enclave/1-1-nitro-enclaves-cli#run-connect-and-terminate-the-enclave). Jednak偶e, oto najwa偶niejsze:
```bash
# Install tools
sudo amazon-linux-extras install aws-nitro-enclaves-cli -y
sudo yum install aws-nitro-enclaves-cli-devel -y

# Config perms
sudo usermod -aG ne $USER
sudo usermod -aG docker $USER

# Check installation
nitro-cli --version

# Start and enable the Nitro Enclaves allocator service.
sudo systemctl start nitro-enclaves-allocator.service && sudo systemctl enable nitro-enclaves-allocator.service
```
### Obrazy Enklawy Nitro

Obrazy, kt贸re mo偶na uruchamia w Enklawie Nitro, s oparte na obrazach dockerowych, wic mo偶esz tworzy swoje obrazy Enklawy Nitro z obraz贸w dockerowych, takich jak:
```bash
# You need to have the docker image accesible in your running local registry
# Or indicate the full docker image URL to access the image
nitro-cli build-enclave --docker-uri <docker-img>:<tag> --output-file nitro-img.eif
```
Jak wida obrazy Nitro Enclave u偶ywaj rozszerzenia **`eif`** (Enclave Image File).

Wyjcie bdzie wyglda podobnie jak:
```
Using the locally available Docker image...
Enclave Image successfully created.
{
"Measurements": {
"HashAlgorithm": "Sha384 { ... }",
"PCR0": "e199261541a944a93129a52a8909d29435dd89e31299b59c371158fc9ab3017d9c450b0a580a487e330b4ac691943284",
"PCR1": "bcdf05fefccaa8e55bf2c8d6dee9e79bbff31e34bf28a99aa19e6b29c37ee80b214a414b7607236edf26fcb78654e63f",
"PCR2": "2e1fca1dbb84622ec141557dfa971b4f8ea2127031b264136a20278c43d1bba6c75fea286cd4de9f00450b6a8db0e6d3"
}
}
```
Zgodnie z [**dokumentacj**](https://catalog.us-east-1.prod.workshops.aws/event/dashboard/en-US/workshop/1-my-first-enclave/1-1-nitro-enclaves-cli#run-connect-and-terminate-the-enclave), aby uruchomi obraz enklawy, musisz przypisa mu pami co najmniej 4 razy wiksz ni偶 zajmuje na dysku plik **`eif`**.
