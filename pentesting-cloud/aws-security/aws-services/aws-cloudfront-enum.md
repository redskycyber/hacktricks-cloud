# AWS - Enumeraci√≥n de CloudFront

<details>

<summary><strong>¬°Apoya a HackTricks y obt√©n beneficios!</strong></summary>

* Si quieres ver tu **empresa anunciada en HackTricks** o si quieres acceder a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop).
* Obt√©n el [**merchandising oficial de PEASS y HackTricks**](https://peass.creator-spring.com).
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family).
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).

* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en GitHub.

</details>

## CloudFront

CloudFront es la **red de distribuci√≥n de contenido de AWS que acelera la distribuci√≥n** de tu contenido est√°tico y din√°mico a trav√©s de su red mundial de ubicaciones de borde. Cuando utilizas un contenido que alojas a trav√©s de Amazon CloudFront, la solicitud se dirige a la ubicaci√≥n de borde m√°s cercana que proporciona la latencia m√°s baja para ofrecer el mejor rendimiento. Cuando se habilitan los **registros de acceso de CloudFront**, puedes registrar la solicitud de cada usuario que solicita acceso a tu sitio web y distribuci√≥n. Al igual que los registros de acceso de S3, estos registros tambi√©n se **almacenan en Amazon S3 para un almacenamiento duradero y persistente**. No hay cargos por habilitar el registro en s√≠, sin embargo, como los registros se almacenan en S3, se te cobrar√° por el almacenamiento utilizado por S3.

Los archivos de registro capturan datos durante un per√≠odo de tiempo y dependiendo de la cantidad de solicitudes que reciba Amazon CloudFront para esa distribuci√≥n, se generar√°n diferentes archivos de registro. Es importante saber que estos archivos de registro no se crean ni se escriben en S3. S3 es simplemente donde se entregan una vez que el archivo de registro est√° lleno. **Amazon CloudFront retiene estos registros hasta que est√©n listos para ser entregados a S3**. Nuevamente, dependiendo del tama√±o de estos archivos de registro, esta entrega puede tardar **entre una y 24 horas**.

**De forma predeterminada, el registro de cookies est√° deshabilitado**, pero puedes habilitarlo.

### Funciones

Puedes crear funciones en CloudFront. Estas funciones tendr√°n su **punto final en CloudFront** definido y ejecutar√°n un **c√≥digo NodeJS** declarado. Este c√≥digo se ejecutar√° dentro de un **sandbox** en una m√°quina que se ejecuta en una m√°quina administrada por AWS (necesitar√≠as un bypass de sandbox para lograr escapar al sistema operativo subyacente).

Como las funciones no se ejecutan en la cuenta de AWS del usuario, no se adjunta ning√∫n rol de IAM, por lo que no es posible realizar una escalada de privilegios directa abusando de esta caracter√≠stica.

### Enumeraci√≥n
```bash
aws cloudfront list-distributions
aws cloudfront get-distribution --id <id> # Just get 1
aws cloudfront get-distribution-config --id <id>

aws cloudfront list-functions
aws cloudfront get-function --name TestFunction function_code.js

aws cloudfront list-distributions | jq ".DistributionList.Items[] | .Id, .Origins.Items[].Id, .Origins.Items[].DomainName, .AliasICPRecordals[].CNAME"
```
## Acceso no autenticado

{% content-ref url="../aws-unauthenticated-enum-access/aws-cloudfront-unauthenticated-enum.md" %}
[aws-cloudfront-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-cloudfront-unauthenticated-enum.md)
{% endcontent-ref %}

## Post Explotaci√≥n

{% content-ref url="../aws-post-exploitation/aws-cloudfront-post-exploitation.md" %}
[aws-cloudfront-post-exploitation.md](../aws-post-exploitation/aws-cloudfront-post-exploitation.md)
{% endcontent-ref %}

<details>

<summary><strong>¬°Apoya a HackTricks y obt√©n beneficios!</strong></summary>

* Si quieres ver tu **empresa anunciada en HackTricks** o si quieres acceder a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop).
* Obt√©n el [**merchandising oficial de PEASS y HackTricks**](https://peass.creator-spring.com).
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family).
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en GitHub.

</details>
