# AWS - Enumeraci贸n de Firewall Manager

<details>

<summary><strong>Aprende hacking de AWS de cero a h茅roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Firewall Manager

**AWS Firewall Manager** simplifica la gesti贸n y el mantenimiento de **AWS WAF, AWS Shield Advanced, grupos de seguridad de Amazon VPC y AWS Network Firewall** en m煤ltiples cuentas y recursos. Te permite configurar tus reglas de firewall, protecciones Shield Advanced, grupos de seguridad de VPC y configuraciones de Network Firewall solo una vez, con el servicio **haciendo cumplir autom谩ticamente estas reglas y protecciones en tus cuentas y recursos**, incluyendo los reci茅n agregados.

El servicio ofrece la capacidad de **agrupar y proteger recursos espec铆ficos juntos**, como aquellos que comparten una etiqueta com煤n o todas tus distribuciones de CloudFront. Una ventaja significativa de Firewall Manager es su habilidad para **extender autom谩ticamente la protecci贸n a recursos reci茅n agregados** en tu cuenta.

Los **prerrequisitos** incluyen configurar una Cuenta Maestra de Firewall Manager, establecer una organizaci贸n de AWS con cuentas miembro y habilitar AWS Config.

Un **grupo de reglas** (una colecci贸n de reglas de WAF) puede incorporarse en una Pol铆tica de AWS Firewall Manager, que luego se vincula a recursos espec铆ficos de AWS como distribuciones de CloudFront o balanceadores de carga de aplicaciones.

Es importante notar que las **pol铆ticas de Firewall Manager solo permiten acciones de "Bloqueo" o "Conteo"** para un grupo de reglas, sin una opci贸n de "Permitir".

## Enumeraci贸n
```
# Get admin account
aws fms get-admin-account

# Get member accounts
aws fms list-member-accounts

# Get policies
aws fms list-policies

# Get App list
aws fms list-apps-lists --max-results 10

# Get notification channel (if any)
aws fms get-notification-channel

# Get resource sets
aws fms list-resource-sets

# Get admin scope: Get resources Firewall Manager can manage
aws fms get-admin-scope --admin-account <acc-id> # ReadOnly policy is not enough for this

# Get Firewall Manager administrators within the organization that are onboarded to Firewall Manager by AssociateAdminAccount
aws fms list-admin-accounts-for-organization # ReadOnly policy is not enough for this
```
## Bypass Detection

TODO, se aceptan PRs

# Referencias
* [https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html](https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html)

<details>

<summary><strong>Aprende hacking en AWS de cero a h茅roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
