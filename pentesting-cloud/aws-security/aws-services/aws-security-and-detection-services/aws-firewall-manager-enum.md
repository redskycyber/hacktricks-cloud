# AWS - Firewall Manager Enum

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikova slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Firewall Menad쬰r

**AWS Firewall Menad쬰r** olak코ava upravljanje i odr쬬vanje **AWS WAF, AWS Shield Advanced, Amazon VPC sigurnosnim grupama i listama kontrola pristupa mre쬴 (ACLs), AWS Network Firewall-om, AWS Route 53 Resolver DNS Firewall-om i firewall-ovima tre캖ih strana** preko vi코e naloga i resursa. Omogu캖ava vam da konfiguri코ete pravila va코eg firewall-a, Shield Advanced za코tite, VPC sigurnosne grupe i postavke Network Firewall-a samo jednom, sa uslugom koja **automatski sprovodi ova pravila i za코tite preko va코ih naloga i resursa**, uklju캜uju캖i i novo dodate.

Usluga nudi mogu캖nost da **grupi코e i za코titi odre캠ene resurse zajedno**, poput onih koji dele zajedni캜ku oznaku ili sve va코e CloudFront distribucije. Zna캜ajna prednost Firewall Menad쬰ra je njegova sposobnost da **automatski pro코iri za코titu na novo dodate resurse** u va코em nalogu.

**Grupa pravila** (kolekcija WAF pravila) mo쬰 biti uklju캜ena u AWS Firewall Menad쬰r Politiku, koja je zatim povezana sa odre캠enim AWS resursima kao 코to su CloudFront distribucije ili balanseri optere캖enja aplikacija.

AWS Firewall Menad쬰r pru쬬 **upravljane liste aplikacija i protokola** kako bi pojednostavio konfiguraciju i upravljanje sigurnosnim grupnim pravilima. Ove liste vam omogu캖avaju da defini코ete protokole i aplikacije koje su dozvoljene ili zabranjene od strane va코ih pravila. Postoje dva tipa upravljanih lista:

* **Firewall Menad쬰r upravljane liste**: Ove liste uklju캜uju **FMS-Default-Public-Access-Apps-Allowed**, **FMS-Default-Protocols-Allowed** i **FMS-Default-Protocols-Allowed**. One su upravljane od strane Firewall Menad쬰ra i uklju캜uju 캜esto kori코캖ene aplikacije i protokole koji bi trebalo da budu dozvoljeni ili zabranjeni 코iroj javnosti. Nije mogu캖e ure캠ivati ili brisati ih, me캠utim, mo쬰te izabrati njihovu verziju.
* **Upravljane liste po meri**: Vi upravljate ovim listama sami. Mo쬰te kreirati liste aplikacija i protokola prilago캠ene potrebama va코e organizacije. Za razliku od Firewall Menad쬰r upravljanih lista, ove liste nemaju verzije, ali imate potpunu kontrolu nad listama po meri, 코to vam omogu캖ava da ih kreirate, ure캠ujete i bri코ete po potrebi.

Va쬹o je napomenuti da **Firewall Menad쬰r politike dozvoljavaju samo akcije "Blokiraj" ili "Broj"** za grupu pravila, bez opcije "Dozvoli".

### Preduslovi

Slede캖i preduslovni koraci moraju biti zavr코eni pre nego 코to nastavite sa konfigurisanjem Firewall Menad쬰ra kako biste efikasno za코titili resurse va코e organizacije. Ovi koraci obezbe캠uju osnovnu postavku potrebnu za Firewall Menad쬰r kako bi sproveo sigurnosne politike i osigurao uskla캠enost 코irom va코eg AWS okru쬰nja:

1. **Pridru쬴te se i konfiguri코ite AWS Organizacije:** Proverite da li je va코 AWS nalog deo AWS Organizacija organizacije gde su planirane AWS Firewall Menad쬰r politike. Ovo omogu캖ava centralizovano upravljanje resursima i politikama preko vi코e AWS naloga unutar organizacije.
2. **Kreirajte podrazumevani administratorski nalog AWS Firewall Menad쬰ra:** Uspostavite podrazumevani administratorski nalog posebno za upravljanje sigurnosnim politikama Firewall Menad쬰ra. Ovaj nalog 캖e biti odgovoran za konfigurisanje i sprovo캠enje sigurnosnih politika 코irom organizacije. Samo upravlja캜ki nalog organizacije mo쬰 kreirati podrazumevane administratorske naloge Firewall Menad쬰ra.
3. **Omogu캖ite AWS Config:** Aktivirajte AWS Config kako biste Firewall Menad쬰ru obezbedili potrebne podatke o konfiguraciji i uvide potrebne za efikasno sprovo캠enje sigurnosnih politika. AWS Config poma쬰 u analizi, reviziji, pra캖enju i reviziji konfiguracija resursa i promena, olak코avaju캖i bolje upravljanje sigurno코캖u.
4. **Za politike tre캖ih strana, Pretplatite se na AWS Marketplace i Konfiguri코ite Postavke Tre캖ih Strana:** Ako planirate da koristite politike tre캖ih strana, pretplatite se na njih na AWS Marketplace-u i konfiguri코ite neophodne postavke. Ovaj korak osigurava da Firewall Menad쬰r mo쬰 integrisati i sprovoditi politike od pouzdanih dobavlja캜a tre캖ih strana.
5. **Za politike Network Firewall-a i DNS Firewall-a, omogu캖ite deljenje resursa:** Omogu캖ite deljenje resursa posebno za politike Network Firewall-a i DNS Firewall-a. Ovo omogu캖ava Firewall Menad쬰ru da primeni firewall za코tite na VPC-ove va코e organizacije i DNS rezoluciju, pobolj코avaju캖i sigurnost mre쬰.
6. **Da biste koristili AWS Firewall Menad쬰r u regionima koji su podrazumevano onemogu캖eni:** Ako nameravate da koristite Firewall Menad쬰r u AWS regionima koji su podrazumevano onemogu캖eni, pobrinite se da preduzmete neophodne korake da omogu캖ite njegovu funkcionalnost u tim regionima. Ovo osigurava dosledno sprovo캠enje sigurnosti 코irom svih regiona gde va코a organizacija posluje.

Za vi코e informacija, proverite: [Po캜etak rada sa AWS Firewall Menad쬰r AWS WAF politikama](https://docs.aws.amazon.com/waf/latest/developerguide/getting-started-fms.html).

### Vrste politika za코tite

AWS Firewall Menad쬰r upravlja nekoliko vrsta politika kako bi sproveo sigurnosne kontrole 코irom razli캜itih aspekata infrastrukture va코e organizacije:

1. **AWS WAF Politika:** Ovaj tip politike podr쬬va kako AWS WAF tako i AWS WAF Classic. Mo쬰te definisati koje resurse 코titi politika. Za AWS WAF politike, mo쬰te specificirati setove grupa pravila koje 캖e se izvr코avati prvo i poslednje u web ACL-u. Dodatno, vlasnici naloga mogu dodati pravila i grupe pravila koje 캖e se izvr코avati izme캠u ovih setova.
2. **Shield Advanced Politika:** Ova politika primenjuje Shield Advanced za코tite 코irom va코e organizacije za odre캠ene tipove resursa. Poma쬰 u za코titi od DDoS napada i drugih pretnji.
3. **Amazon VPC Sigurnosna Grupa Politika:** Sa ovom politikom, mo쬰te upravljati sigurnosnim grupama kori코캖enim 코irom va코e organizacije, sprovode캖i osnovni set pravila 코irom va코eg AWS okru쬰nja kako biste kontrolisali pristup mre쬴.
4. **Amazon VPC Lista Kontrola Pristupa Mre쬴 (ACL) Politika:** Ovaj tip politike vam daje kontrolu nad listama kontrola pristupa mre쬴 kori코캖enim u va코oj organizaciji, omogu캖avaju캖i vam da sprovedete osnovni set lista kontrola pristupa mre쬴 코irom va코eg AWS okru쬰nja.
5. **Network Firewall Politika:** Ova politika primenjuje AWS Network Firewall za코titu na VPC-ove va코e organizacije, pobolj코avaju캖i sigurnost mre쬰 filtriranjem saobra캖aja na osnovu unapred definisanih pravila.
6. **Amazon Route 53 Resolver DNS Firewall Politika:** Ova politika primenjuje DNS Firewall za코tite na VPC-ove va코e organizacije, poma쬿캖i u blokiranju poku코aja zlonamernog re코avanja domena i sprovo캠enju sigurnosnih politika za DNS saobra캖aj.
7. **Politika Firewall-a Tre캖ih Strana:** Ovaj tip politike primenjuje za코tite od firewall-a tre캖ih strana, koje su dostupne putem pretplate preko AWS Marketplace konzole. Omogu캖ava vam da integri코ete dodatne sigurnosne mere od pouzdanih dobavlja캜a u va코e AWS okru쬰nje.
1. **Palo Alto Networks Cloud NGFW Politika:** Ova politika primenjuje Palo Alto Networks Cloud Next Generation Firewall (NGFW) za코tite i rulestacks na VPC-ove va코e organizacije, pru쬬ju캖i naprednu prevenciju pretnji i kontrole sigurnosti na nivou aplikacije.
2. **Fortigate Cloud Native Firewall (CNF) as a Service Politika:** Ova politika primenjuje Fortigate Cloud Native Firewall (CNF) as a Service za코tite, nude캖i vode캖u za코titu od pretnji, web aplikacioni firewall (WAF) i za코titu API-ja prilago캠enu za cloud infrastrukture.
### Administratorski nalozi

AWS Firewall Manager nudi fleksibilnost u upravljanju resursima za코titnog zida unutar va코e organizacije putem svog administrativnog opsega i dva tipa administratorskih naloga.

**Administrativni opseg defini코e resurse koje Firewall Manager administrator mo쬰 upravljati**. Nakon 코to AWS Organizations upravlja캜ki nalog uklju캜i organizaciju u Firewall Manager, mo쬰 kreirati dodatne administratore sa razli캜itim administrativnim opsezima. Ti opsezi mogu uklju캜ivati:

- Naloge ili organizacione jedinice (OJ) na koje administrator mo쬰 primeniti politike.
- Regioni u kojima administrator mo쬰 izvr코avati akcije.
- Tipovi politika Firewall Manager-a koje administrator mo쬰 upravljati.

Administrativni opseg mo쬰 biti ili **potpun ili ograni캜en**. Potpuni opseg daje administratoru pristup **svim navedenim tipovima resursa, regionima i tipovima politika**. Nasuprot tome, **ograni캜eni opseg pru쬬 administrativnu dozvolu samo za podskup resursa, regiona ili tipova politika**. Preporu캜ljivo je dodeliti administratorima samo dozvole koje su im potrebne da bi efikasno obavljali svoje uloge. Mo쬰te primeniti bilo koju kombinaciju ovih uslova administrativnog opsega administratoru, osiguravaju캖i po코tovanje principa najmanjih privilegija.

Postoje dva razli캜ita tipa administratorskih naloga, svaki obavljaju캖i specifi캜ne uloge i odgovornosti:

- **Podrazumevani administrator:**
- Podrazumevani administratorski nalog kreira AWS Organizations upravlja캜ki nalog organizacije tokom procesa uklju캜ivanja u Firewall Manager.
- Ovaj nalog ima mogu캖nost upravljanja spoljnim za코titnim zidovima i poseduje potpuni administrativni opseg.
- Slu쬴 kao primarni administratorski nalog za Firewall Manager, odgovoran za konfigurisanje i sprovo캠enje sigurnosnih politika 코irom organizacije.
- Iako podrazumevani administrator ima pun pristup svim tipovima resursa i administrativnim funkcijama, funkcioni코e na istom nivou kao i drugi administratori ako se koristi vi코e administratora unutar organizacije.
- **Administratori Firewall Manager-a:**
- Ovi administratori mogu upravljati resursima unutar opsega odre캠enog od strane AWS Organizations upravlja캜kog naloga, kako je definisano konfiguracijom administrativnog opsega.
- Administratori Firewall Manager-a se kreiraju da bi obavljali specifi캜ne uloge unutar organizacije, omogu캖avaju캖i delegiranje odgovornosti dok se odr쬬vaju sigurnosni i uskla캠enost standardi.
- Prilikom kreiranja, Firewall Manager proverava sa AWS Organizations da bi utvrdio da li je nalog ve캖 delegirani administrator. Ako nije, Firewall Manager poziva Organizations da odredi nalog kao delegiranog administratora za Firewall Manager.

Upravljanje ovim administratorskim nalozima uklju캜uje njihovo kreiranje unutar Firewall Manager-a i definisanje njihovih administrativnih opsega prema sigurnosnim zahtevima organizacije i principu najmanjih privilegija. Dodelom odgovaraju캖ih administratorskih uloga, organizacije mogu osigurati efikasno upravljanje sigurno코캖u dok odr쬬vaju granularnu kontrolu nad pristupom osetljivim resursima.

Va쬹o je ista캖i da **samo jedan nalog unutar organizacije mo쬰 slu쬴ti kao podrazumevani administrator Firewall Manager-a**, pridr쬬vaju캖i se principa "**prvi unutra, poslednji napolje**". Da bi se odredio novi podrazumevani administrator, mora se pratiti serija koraka:

- Prvo, svaki Firewall Administrator administratorski nalog mora opozvati svoj nalog.
- Zatim, postoje캖i podrazumevani administrator mo쬰 opozvati svoj nalog, efikasno isklju캜uju캖i organizaciju iz Firewall Manager-a. Ovaj proces rezultira brisanjem svih Firewall Manager politika kreiranih od strane opozvanog naloga.
- Da bi se zavr코ilo, AWS Organizations upravlja캜ki nalog mora odrediti podrazumevanog administratora Firewall Manager-a.

## Enumeracija
```
# Users/Administrators

## Get the AWS Organizations account that is associated with AWS Firewall Manager as the AWS Firewall Manager default administrator
aws fms get-admin-account

## List of Firewall Manager administrators within the organization
aws fms list-admin-accounts-for-organization # ReadOnlyAccess policy is not enough for this

## Return a list of the member accounts in the FM administrator's AWS organization
aws fms list-member-accounts # Only a Firewall Manager administrator or the Organization's management account can make this request

## List the accounts that are managing the specified AWS Organizations member account
aws fms list-admins-managing-account # ReadOnlyAccess policy is not enough for this

# Resources

## Get the resources that a Firewall Manager administrator can manage
aws fms get-admin-scope --admin-account <value> # ReadOnlyAccess policy is not enough for this

## Returns the summary of the resource sets used
aws fms list-resource-sets # ReadOnlyAccess policy is not enough for this

## Get information about a specific resource set
aws fms get-resource-set --identifier <value>  # ReadOnlyAccess policy is not enough for this

## Retrieve the list of tags for a given resource
aws fms list-tags-for-resource --resource-arn <value>

## List of the resources in the AWS Organization's accounts that are available to be associated with a FM resource set. Only one account is supported per request.
aws fms list-compliance-status --member-account-ids <value> --resource-type <value> # ReadOnlyAccess policy is not enough for this

## List the resources that are currently associated to a resource set
aws fms list-resource-set-resources --identifier <value> # ReadOnlyAccess policy is not enough for this

# Policies

## Returns the list of policies
aws fms list-policies

## Get information about the specified AWS Firewall Manager policy
aws fms get-policy --policy-id <value>

## List all of the third-party firewall policies that are associated with the third-party firewall administrator's account
aws fms list-third-party-firewall-firewall-policies --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

# AppsList

## Return a list of apps list
aws fms list-apps-lists --max-results [1-100]

## Get information about the specified AWS Firewall Manager applications list
aws fms get-apps-list --list-id <value>

# Protocols

## Get the details of the Firewall Manager protocols list.
aws fms list-protocols-lists

## Get information about the specified AWS Firewall Manager Protocols list
aws fms get-protocols-list --list-id <value>

# Compliance

## Return a summary of which member accounts are protected by the specified policy
aws fms list-compliance-status --policy-id <policy-id>

## Get detailed compliance information about the specified member account (resources that are in and out of compliance with the specified policy)
aws fms get-compliance-detail --policy-id <value> --member-account <value>

# Other useful info

## Get information about the SNS topic that is used to record AWS Firewall Manager SNS logs (if any)
aws fms get-notification-channel

## Get policy-level attack summary information in the event of a potential DDoS attack
aws fms get-protection-status --policy-id <value> # Just for Shield Advanced policy

## Get the onboarding status of a Firewall Manager admin account to third-party firewall vendor tenant.
aws fms get-third-party-firewall-association-status --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

## Get violations' details for a resource based on the specified AWS Firewall Manager policy and AWS account.
aws fms get-violation-details --policy-id <value> --member-account <value> --resource-id <value> --resource-type <value>
```
## Post Eksploatacija / Zaobila쬰nje Detekcije

### `organizations:DescribeOrganization` & (`fms:AssociateAdminAccount`, `fms:DisassociateAdminAccount`, `fms:PutAdminAccount`)
Napada캜 sa dozvolom **`fms:AssociateAdminAccount`** bio bi u mogu캖nosti da postavi podrazumevani administratorski nalog Firewall Manager-a. Sa dozvolom **`fms:PutAdminAccount`**, napada캜 bi bio u mogu캖nosti da kreira ili a쬿rira administratorski nalog Firewall Manager-a, a sa dozvolom **`fms:DisassociateAdminAccount`**, potencijalni napada캜 bi mogao ukloniti trenutnu asocijaciju administratorskog naloga Firewall Manager-a.

- Razdvajanje podrazumevanog administratora Firewall Manager-a prati politiku "prvi unutra, poslednji napolje". Svi administratori Firewall Manager-a moraju biti razdvojeni pre nego 코to podrazumevani administrator Firewall Manager-a mo쬰 razdvojiti nalog.
- Da bi se kreirao administratorski nalog Firewall Manager-a pomo캖u **PutAdminAccount**, nalog mora pripadati organizaciji koja je prethodno uklju캜ena u Firewall Manager kori코캖enjem **AssociateAdminAccount**.
- Kreiranje administratorskog naloga Firewall Manager-a mo쬰 obaviti samo upravlja캜ki nalog organizacije.
```bash
aws fms associate-admin-account --admin-account <value>
aws fms disassociate-admin-account
aws fms put-admin-account --admin-account <value>
```
**Potencijalni uticaj:** Gubitak centralizovanog upravljanja, izbegavanje pravila, kr코enje usagla코enosti i naru코avanje sigurnosnih kontrola unutar okru쬰nja.

### `fms:PutPolicy`, `fms:DeletePolicy`

Napada캜 sa dozvolama **`fms:PutPolicy`**, **`fms:DeletePolicy`** bio bi u mogu캖nosti da kreira, modifikuje ili trajno obri코e AWS Firewall Manager pravilo.
```bash
aws fms put-policy --policy <value> | --cli-input-json file://<policy.json> [--tag-list <value>]
aws fms delete-policy --policy-id <value> [--delete-all-policy-resources | --no-delete-all-policy-resources]
```
Primer dozvoljene politike kroz dozvolnu sigurnosnu grupu, kako bi se izbeglo otkrivanje, mogao bi biti slede캖i:
```json
{
"Policy": {
"PolicyName": "permisive_policy",
"SecurityServicePolicyData": {
"Type": "SECURITY_GROUPS_COMMON",
"ManagedServiceData": "{\"type\":\"SECURITY_GROUPS_COMMON\",\"securityGroups\":[{\"id\":\"<permisive_security_group_id>\"}], \"applyToAllEC2InstanceENIs\":\"true\",\"IncludeSharedVPC\":\"true\"}"
},
"ResourceTypeList": ["AWS::EC2::Instance", "AWS::EC2::NetworkInterface", "AWS::EC2::SecurityGroup", "AWS::ElasticLoadBalancingV2::LoadBalancer", "AWS::ElasticLoadBalancing::LoadBalancer"],
"ResourceType": "AWS::EC2::SecurityGroup",
"ExcludeResourceTags": false,
"ResourceTags": [],
"RemediationEnabled": true
},
"TagList": []
}
```
**Potencijalni uticaj:** Rasklapanje sigurnosnih kontrola, izbegavanje pravila, kr코enje usagla코enosti, operativne smetnje i potencijalno curenje podataka unutar okru쬰nja.

### `fms:BatchAssociateResource`, `fms:BatchDisassociateResource`, `fms:PutResourceSet`, `fms:DeleteResourceSet`

Napada캜 sa dozvolama **`fms:BatchAssociateResource`** i **`fms:BatchDisassociateResource`** bio bi u mogu캖nosti da pove쬰 ili razdvoji resurse iz skupa resursa Firewall Manager-a, respektivno. Pored toga, dozvole **`fms:PutResourceSet`** i **`fms:DeleteResourceSet`** omogu캖ile bi napada캜u da kreira, modifikuje ili obri코e ove skupove resursa iz AWS Firewall Manager-a.
```bash
# Associate/Disassociate resources from a resource set
aws fms batch-associate-resource --resource-set-identifier <value> --items <value>
aws fms batch-disassociate-resource --resource-set-identifier <value> --items <value>

# Create, modify or delete a resource set
aws fms put-resource-set --resource-set <value> [--tag-list <value>]
aws fms delete-resource-set --identifier <value>
```
**Potencijalni uticaj:** Dodavanje nepotrebnog broja stavki u skup resursa pove캖a캖e nivo buke u Servisu, potencijalno izazivaju캖i DoS. Pored toga, promene u skupovima resursa mogu dovesti do poreme캖aja resursa, izbegavanja politika, kr코enja usagla코enosti i poreme캖aja sigurnosnih kontrola unutar okru쬰nja.

### `fms:PutAppsList`, `fms:DeleteAppsList`

Napada캜 sa dozvolama **`fms:PutAppsList`** i **`fms:DeleteAppsList`** bio bi u mogu캖nosti da kreira, modifikuje ili obri코e liste aplikacija iz AWS Firewall Manager-a. Ovo mo쬰 biti kriti캜no, jer neovla코캖ene aplikacije mogu dobiti pristup op코toj javnosti, ili pristup ovla코캖enim aplikacijama mo쬰 biti uskra캖en, izazivaju캖i DoS.
```bash
aws fms put-apps-list --apps-list <value> [--tag-list <value>]
aws fms delete-apps-list --list-id <value>
```
**Potencijalni uticaj:** Ovo bi moglo rezultirati neispravnim konfiguracijama, izbegavanjem pravila, kr코enjem usagla코enosti i naru코avanjem sigurnosnih kontrola unutar okru쬰nja.

### `fms:PutProtocolsList`, `fms:DeleteProtocolsList`

Napada캜 sa dozvolama **`fms:PutProtocolsList`** i **`fms:DeleteProtocolsList`** bio bi u mogu캖nosti da kreira, modifikuje ili obri코e liste protokola iz AWS Firewall Manager-a. Sli캜no kao sa listama aplikacija, ovo bi moglo biti kriti캜no jer neovla코캖eni protokoli mogu biti kori코캖eni od strane op코te javnosti, ili kori코캖enje odobrenih protokola mo쬰 biti odbijeno, uzrokuju캖i DoS.
```bash
aws fms put-protocols-list --apps-list <value> [--tag-list <value>]
aws fms delete-protocols-list --list-id <value>
```
**Potencijalni uticaj:** Ovo bi moglo rezultirati nepravilnim konfiguracijama, izbegavanjem pravila, kr코enjem usagla코enosti i naru코avanjem sigurnosnih kontrola unutar okru쬰nja.

### `fms:PutNotificationChannel`, `fms:DeleteNotificationChannel`

Napada캜 sa dozvolama **`fms:PutNotificationChannel`** i **`fms:DeleteNotificationChannel`** bio bi u mogu캖nosti da obri코e i odredi IAM ulogu i Amazon Simple Notification Service (SNS) temu koju Firewall Manager koristi za bele쬰nje SNS zapisa.

Da biste koristili **`fms:PutNotificationChannel`** van konzole, potrebno je postaviti pristupnu politiku teme SNS, omogu캖avaju캖i odre캠enoj **SnsRoleName** da objavljuje SNS zapise. Ako je pru쬰ni **SnsRoleName** uloga koja nije **`AWSServiceRoleForFMS`**, potrebno je konfigurisati povereni캜ki odnos koji dozvoljava Firewall Manager servisnom principalu **fms.amazonaws.com** da preuzme ovu ulogu.

Za informacije o konfigurisanju pristupne politike SNS:

{% content-ref url="../aws-services/aws-sns-enum.md" %}
[aws-sns-enum.md](../aws-services/aws-sns-enum.md)
{% endcontent-ref %}
```bash
aws fms put-notification-channel --sns-topic-arn <value> --sns-role-name <value>
aws fms delete-notification-channel
```
**Potencijalni uticaj:** Ovo bi potencijalno moglo dovesti do propu코tanja sigurnosnih upozorenja, odlo쬰nog odgovora na incidente, potencijalnih povreda podataka i operativnih poreme캖aja unutar okru쬰nja.

### `fms:AssociateThirdPartyFirewall`, `fms:DisssociateThirdPartyFirewall`
Napada캜 sa dozvolama **`fms:AssociateThirdPartyFirewall`**, **`fms:DisssociateThirdPartyFirewall`** bio bi u mogu캖nosti da pove쬰 ili razdvoji tre캖e strane vatrozide koji se upravljaju centralno putem AWS Firewall Manager-a.
{% hint style="warning" %}
Samo podrazumevani administrator mo쬰 kreirati i upravljati tre캖im stranama vatrozidovima.
{% endhint %}
```bash
aws fms associate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
aws fms disassociate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
```
**Potencijalni uticaj:** Raskidanje veze bi dovelo do izbegavanja politike, kr코enja usagla코enosti i poreme캖aja sigurnosnih kontrola unutar okru쬰nja. S druge strane, veza bi dovela do poreme캖aja alokacije tro코kova i bud쬰ta.

### `fms:TagResource`, `fms:UntagResource`

Napada캜 bi mogao da dodaje, menja ili uklanja oznake sa resursa Firewall Manager-a, poremetiv코i alokaciju tro코kova, pra캖enje resursa i politike kontrole pristupa va코e organizacije na osnovu oznaka.
```bash
aws fms tag-resource --resource-arn <value> --tag-list <value>
aws fms untag-resource --resource-arn <value> --tag-keys <value>
```
**Potencijalni uticaj**: Poremec패aj alokacije tro코kova, prac패enja resursa i politika kontrole pristupa zasnovanih na oznakama.

## Reference

* [https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html](https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html)
* [https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html](https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html)

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRETPLATU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
