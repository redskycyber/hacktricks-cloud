# AWS - GÃ¼venlik DuvarÄ± YÃ¶neticisi Enum

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olacak ÅŸekilde AWS hacklemeyi Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong> ile!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## GÃ¼venlik DuvarÄ± YÃ¶neticisi

**AWS GÃ¼venlik DuvarÄ± YÃ¶neticisi**, **AWS WAF, AWS Shield Advanced, Amazon VPC gÃ¼venlik gruplarÄ± ve AÄŸ EriÅŸim Kontrol Listeleri (ACL'ler), AWS AÄŸ GÃ¼venlik DuvarÄ±, AWS Route 53 Resolver DNS GÃ¼venlik DuvarÄ± ve Ã¼Ã§Ã¼ncÃ¼ taraf gÃ¼venlik duvarlarÄ±** yÃ¶netimini ve bakÄ±mÄ±nÄ± kolaylaÅŸtÄ±rÄ±r. Birden fazla hesap ve kaynak Ã¼zerinde **gÃ¼venlik duvarÄ± kurallarÄ±nÄ±, Shield Advanced korumalarÄ±nÄ±, VPC gÃ¼venlik gruplarÄ±nÄ± ve AÄŸ GÃ¼venlik DuvarÄ± ayarlarÄ±nÄ± yalnÄ±zca bir kez yapÄ±landÄ±rmanÄ±zÄ± saÄŸlar, hizmet bu kurallarÄ± ve korumalarÄ± otomatik olarak hesaplarÄ±nÄ±z ve kaynaklarÄ±nÄ±z Ã¼zerinde uygular**, yeni eklenenler de dahil.

Hizmet, **belirli kaynaklarÄ± bir araya getirip koruma altÄ±na alma** yeteneÄŸi sunar, Ã¶rneÄŸin aynÄ± etiketi paylaÅŸanlarÄ± veya tÃ¼m CloudFront daÄŸÄ±tÄ±mlarÄ±nÄ±zÄ±. GÃ¼venlik DuvarÄ± YÃ¶neticisinin Ã¶nemli bir avantajÄ±, hesabÄ±nÄ±za yeni eklenen kaynaklara koruma saÄŸlama yeteneÄŸidir.

Bir **kural grubu** (bir WAF kurallarÄ± koleksiyonu) bir AWS GÃ¼venlik DuvarÄ± YÃ¶neticisi PolitikasÄ±na dahil edilebilir, bu politika daha sonra CloudFront daÄŸÄ±tÄ±mlarÄ± veya uygulama yÃ¼k dengeleyicileri gibi belirli AWS kaynaklarÄ±na baÄŸlanÄ±r.

AWS GÃ¼venlik DuvarÄ± YÃ¶neticisi, gÃ¼venlik grup politikalarÄ±nÄ±n yapÄ±landÄ±rÄ±lmasÄ±nÄ± ve yÃ¶netilmesini kolaylaÅŸtÄ±rmak iÃ§in **yÃ¶netilen uygulama ve protokol listeleri** sunar. Bu listeler, politikalarÄ±nÄ±zda izin verilen veya reddedilen protokoller ve uygulamalarÄ± tanÄ±mlamanÄ±za olanak tanÄ±r. Ä°ki tÃ¼r yÃ¶netilen liste vardÄ±r:

* **GÃ¼venlik DuvarÄ± YÃ¶neticisi tarafÄ±ndan yÃ¶netilen listeler**: Bu listeler **FMS-Default-Public-Access-Apps-Allowed**, **FMS-Default-Protocols-Allowed** ve **FMS-Default-Protocols-Allowed**'Ä± iÃ§erir. Bunlar GÃ¼venlik DuvarÄ± YÃ¶neticisi tarafÄ±ndan yÃ¶netilir ve genel halka izin verilmesi veya reddedilmesi gereken yaygÄ±n olarak kullanÄ±lan uygulamalarÄ± ve protokolleri iÃ§erir. BunlarÄ± dÃ¼zenleyemez veya silinemez, ancak sÃ¼rÃ¼mÃ¼nÃ¼ seÃ§ebilirsiniz.
* **Ã–zel yÃ¶netilen listeler**: Bu listeleri kendiniz yÃ¶netirsiniz. KuruluÅŸunuzun ihtiyaÃ§larÄ±na uygun Ã¶zel uygulama ve protokol listeleri oluÅŸturabilirsiniz. GÃ¼venlik DuvarÄ± YÃ¶neticisi tarafÄ±ndan yÃ¶netilen listelerin aksine, bu listelerin sÃ¼rÃ¼mleri yoktur, ancak Ã¶zel listeler Ã¼zerinde tam kontrol sahibisiniz, gerektiÄŸinde oluÅŸturabilir, dÃ¼zenleyebilir ve silebilirsiniz.

Ã–nemli bir not olarak **GÃ¼venlik DuvarÄ± YÃ¶neticisi politikalarÄ±, bir kural grubu iÃ§in yalnÄ±zca "Engelle" veya "Say" eylemlerine izin verir**, "Ä°zin Ver" seÃ§eneÄŸi yoktur.

### Ã–nkoÅŸullar

KuruluÅŸunuzun kaynaklarÄ±nÄ± etkili bir ÅŸekilde korumaya baÅŸlamak iÃ§in GÃ¼venlik DuvarÄ± YÃ¶neticisini yapÄ±landÄ±rmadan Ã¶nce tamamlanmasÄ± gereken aÅŸaÄŸÄ±daki Ã¶nkoÅŸullar adÄ±mlarÄ± saÄŸlar. Bu adÄ±mlar, GÃ¼venlik DuvarÄ± YÃ¶neticisinin gÃ¼venlik politikalarÄ±nÄ± uygulamak ve AWS ortamÄ±nÄ±zda uyumluluÄŸu saÄŸlamak iÃ§in gereken temel yapÄ±landÄ±rmayÄ± saÄŸlar:

1. **AWS Organizations'a katÄ±lÄ±n ve yapÄ±landÄ±rÄ±n:** AWS hesabÄ±nÄ±zÄ±n, AWS GÃ¼venlik DuvarÄ± YÃ¶neticisi politikalarÄ±nÄ±n uygulanmasÄ± planlanan AWS Organizations organizasyonunun bir parÃ§asÄ± olduÄŸundan emin olun. Bu, organizasyon iÃ§indeki birden fazla AWS hesabÄ± Ã¼zerinde merkezi yÃ¶netim saÄŸlar.
2. **Bir AWS GÃ¼venlik DuvarÄ± YÃ¶neticisi VarsayÄ±lan YÃ¶netici HesabÄ± OluÅŸturun:** GÃ¼venlik DuvarÄ± YÃ¶neticisi gÃ¼venlik politikalarÄ±nÄ± yÃ¶netmek iÃ§in Ã¶zel olarak oluÅŸturulmuÅŸ bir varsayÄ±lan yÃ¶netici hesabÄ± oluÅŸturun. Bu hesap, organizasyon genelinde gÃ¼venlik politikalarÄ±nÄ± yapÄ±landÄ±rmak ve uygulamaktan sorumlu olacaktÄ±r. YalnÄ±zca organizasyonun yÃ¶netim hesabÄ± GÃ¼venlik DuvarÄ± YÃ¶neticisi varsayÄ±lan yÃ¶netici hesaplarÄ± oluÅŸturabilir.
3. **AWS Config'i EtkinleÅŸtirin:** AWS Config'i etkinleÅŸtirerek, GÃ¼venlik DuvarÄ± YÃ¶neticisine gerekli yapÄ±landÄ±rma verilerini ve etkinlikleri saÄŸlar, gÃ¼venlik politikalarÄ±nÄ± etkili bir ÅŸekilde uygulamak iÃ§in gereken bilgileri saÄŸlar. AWS Config, kaynak yapÄ±landÄ±rmalarÄ±nÄ± ve deÄŸiÅŸikliklerini analiz etmeye, denetlemeye, izlemeye ve denetlemeye yardÄ±mcÄ± olarak daha iyi gÃ¼venlik yÃ¶netimi saÄŸlar.
4. **ÃœÃ§Ã¼ncÃ¼ Taraf PolitikalarÄ± iÃ§in AWS Marketplace'e Abone Olun ve ÃœÃ§Ã¼ncÃ¼ Taraf AyarlarÄ±nÄ± YapÄ±landÄ±rÄ±n:** ÃœÃ§Ã¼ncÃ¼ taraf gÃ¼venlik duvarÄ± politikalarÄ±nÄ± kullanmayÄ± planlÄ±yorsanÄ±z, bunlara AWS Marketplace'de abone olun ve gerekli ayarlarÄ± yapÄ±landÄ±rÄ±n. Bu adÄ±m, GÃ¼venlik DuvarÄ± YÃ¶neticisinin gÃ¼venilir Ã¼Ã§Ã¼ncÃ¼ taraf satÄ±cÄ±larÄ±ndan politikalarÄ± entegre etmesini ve uygulamasÄ±nÄ± saÄŸlar.
5. **AÄŸ GÃ¼venlik DuvarÄ± ve DNS GÃ¼venlik DuvarÄ± PolitikalarÄ± iÃ§in kaynak paylaÅŸÄ±mÄ±nÄ± etkinleÅŸtirin:** AÄŸ GÃ¼venlik DuvarÄ± ve DNS GÃ¼venlik DuvarÄ± politikalarÄ± iÃ§in Ã¶zel olarak kaynak paylaÅŸÄ±mÄ±nÄ± etkinleÅŸtirin. Bu, GÃ¼venlik DuvarÄ± YÃ¶neticisinin organizasyonunuzun VPC'lerine ve DNS Ã§Ã¶zÃ¼mlemesine gÃ¼venlik duvarÄ± korumalarÄ± uygulamasÄ±na olanak tanÄ±r, aÄŸ gÃ¼venliÄŸini artÄ±rÄ±r.
6. **VarsayÄ±lan olarak devre dÄ±ÅŸÄ± bÄ±rakÄ±lan bÃ¶lgelerde AWS GÃ¼venlik DuvarÄ± YÃ¶neticisini kullanmak iÃ§in:** VarsayÄ±lan olarak devre dÄ±ÅŸÄ± bÄ±rakÄ±lan AWS bÃ¶lgelerinde GÃ¼venlik DuvarÄ± YÃ¶neticisini kullanmayÄ± planlÄ±yorsanÄ±z, bu bÃ¶lgelerde iÅŸlevselliÄŸini etkinleÅŸtirmek iÃ§in gerekli adÄ±mlarÄ± atmanÄ±zÄ± saÄŸlayÄ±n. Bu, organizasyonunuzun faaliyet gÃ¶sterdiÄŸi tÃ¼m bÃ¶lgelerde tutarlÄ± gÃ¼venlik uygulamasÄ±nÄ± saÄŸlar.

Daha fazla bilgi iÃ§in: [AWS GÃ¼venlik DuvarÄ± YÃ¶neticisi AWS WAF politikalarÄ± ile baÅŸlarken](https://docs.aws.amazon.com/waf/latest/developerguide/getting-started-fms.html).

### Koruma politikalarÄ±nÄ±n tÃ¼rleri

AWS GÃ¼venlik DuvarÄ± YÃ¶neticisi, organizasyonunuzun altyapÄ±sÄ±nÄ±n farklÄ± yÃ¶nlerinde gÃ¼venlik kontrollerini uygulamak iÃ§in Ã§eÅŸitli tÃ¼rde politikalarÄ± yÃ¶netir:

1. **AWS WAF PolitikasÄ±:** Bu politika tÃ¼rÃ¼ hem AWS WAF hem de AWS WAF Classic'i destekler. Politika tarafÄ±ndan korunan kaynaklarÄ± tanÄ±mlayabilirsiniz. AWS WAF politikalarÄ± iÃ§in, web ACL'de Ã§alÄ±ÅŸacak kural gruplarÄ±nÄ± ilk ve son olarak belirleyebilirsiniz. AyrÄ±ca, hesap sahipleri bu setler arasÄ±nda Ã§alÄ±ÅŸacak kurallar ve kural gruplarÄ± ekleyebilir.
2. **Shield Advanced PolitikasÄ±:** Bu politika, belirli kaynak tÃ¼rleri iÃ§in organizasyonunuzda Shield Advanced korumalarÄ±nÄ± uygular. DDoS saldÄ±rÄ±larÄ±na ve diÄŸer tehditlere karÅŸÄ± koruma saÄŸlar.
3. **Amazon VPC GÃ¼venlik Grubu PolitikasÄ±:** Bu politika ile organizasyonunuz genelinde kullanÄ±lan gÃ¼venlik gruplarÄ±nÄ± yÃ¶netebilir, AWS ortamÄ±nÄ±zda aÄŸ eriÅŸimini kontrol etmek iÃ§in temel bir kural setini zorlayabilirsiniz.
4. **Amazon VPC AÄŸ EriÅŸim Kontrol Listesi (ACL) PolitikasÄ±:** Bu politika tÃ¼rÃ¼, organizasyonunuzda kullanÄ±lan aÄŸ ACL'ler Ã¼zerinde kontrol saÄŸlar, AWS ortamÄ±nÄ±zda temel bir aÄŸ ACL setini zorlamak iÃ§in kullanÄ±labilir.
5. **AÄŸ GÃ¼venlik DuvarÄ± PolitikasÄ±:** Bu politika, organizasyonunuzun VPC'lerine AWS AÄŸ GÃ¼venlik DuvarÄ± korumasÄ± uygular, Ã¶nceden tanÄ±mlanmÄ±ÅŸ kurallara dayalÄ± olarak trafiÄŸi filtreleyerek aÄŸ gÃ¼venliÄŸini artÄ±rÄ±r.
6. **Amazon Route 53 Resolver DNS GÃ¼venlik DuvarÄ± PolitikasÄ±:** Bu politika, organizasyonunuzun VPC'lerine DNS GÃ¼venlik DuvarÄ± korumalarÄ± uygular, kÃ¶tÃ¼ niyetli alan Ã§Ã¶zÃ¼mleme giriÅŸimlerini engellemeye ve DNS trafiÄŸi iÃ§in gÃ¼venlik politikalarÄ±nÄ± zorlamaya yardÄ±mcÄ± olur.
7. **ÃœÃ§Ã¼ncÃ¼ Taraf GÃ¼venlik DuvarÄ± PolitikasÄ±:** Bu politika tÃ¼rÃ¼, AWS Marketplace konsolu aracÄ±lÄ±ÄŸÄ±yla abonelikle sunulan Ã¼Ã§Ã¼ncÃ¼ taraf gÃ¼venlik duvarlarÄ±ndan korumalarÄ± uygular. GÃ¼venilir satÄ±cÄ±lardan ek gÃ¼venlik Ã¶nlemlerini AWS ortamÄ±nÄ±za entegre etmenizi saÄŸlar.
1. **Palo Alto Networks Cloud NGFW PolitikasÄ±:** Bu politika, Palo Alto Networks Cloud Next Generation Firewall (NGFW) korumalarÄ±nÄ± ve kural yÄ±ÄŸÄ±nlarÄ±nÄ± organizasyonunuzun VPC'lerine uygular, geliÅŸmiÅŸ tehdit Ã¶nleme ve uygulama dÃ¼zeyinde gÃ¼venlik kontrolleri saÄŸlar.
2. **Fortigate Cloud Native Firewall (CNF) as a Service PolitikasÄ±:** Bu politika, Fortigate Cloud Native Firewall (CNF) as a Service korumalarÄ±nÄ± uygular, endÃ¼stri lideri tehdit Ã¶nleme, web uygulama gÃ¼venlik duvarÄ± (WAF) ve bulut altyapÄ±larÄ± iÃ§in uyarlanmÄ±ÅŸ API korumasÄ± sunar.
### YÃ¶netici hesaplarÄ±

AWS Firewall Manager, yÃ¶netici kapsamÄ± ve iki tÃ¼r yÃ¶netici hesabÄ± aracÄ±lÄ±ÄŸÄ±yla kuruluÅŸunuzdaki gÃ¼venlik duvarÄ± kaynaklarÄ±nÄ± yÃ¶netmede esneklik sunar.

**YÃ¶netici kapsamÄ±, bir Firewall Manager yÃ¶neticisinin yÃ¶netebileceÄŸi kaynaklarÄ± tanÄ±mlar**. Bir AWS Organizations yÃ¶netim hesabÄ±, bir organizasyonu Firewall Manager'a kaydettikten sonra farklÄ± yÃ¶netici kapsamlarÄ±na sahip ek yÃ¶neticiler oluÅŸturabilir. Bu kapsamlar ÅŸunlarÄ± iÃ§erebilir:

- YÃ¶neticinin politikalarÄ± uygulayabileceÄŸi hesaplar veya organizasyon birimleri (OUs).
- YÃ¶neticinin iÅŸlemler gerÃ§ekleÅŸtirebileceÄŸi bÃ¶lgeler.
- YÃ¶neticinin yÃ¶netebileceÄŸi Firewall Manager politika tÃ¼rleri.

YÃ¶netici kapsamÄ± ya **tam ya da kÄ±sÄ±tlÄ±** olabilir. Tam kapsam, yÃ¶neticiye **belirtilen tÃ¼m kaynak tÃ¼rlerine, bÃ¶lgelere ve politika tÃ¼rlerine eriÅŸim** saÄŸlar. Buna karÅŸÄ±lÄ±k, **kÄ±sÄ±tlÄ± kapsam yalnÄ±zca belirli bir kaynak, bÃ¶lge veya politika tÃ¼rÃ¼ alt kÃ¼mesine yÃ¶netici izni saÄŸlar**. YÃ¶neticilere rollerini etkili bir ÅŸekilde yerine getirebilmeleri iÃ§in ihtiyaÃ§larÄ± olan izinleri vermek tavsiye edilir. Bir yÃ¶neticiye bu yÃ¶netici kapsamÄ± koÅŸullarÄ±nÄ±n herhangi bir kombinasyonunu uygulayarak, en az ayrÄ±calÄ±k ilkesine uyulmasÄ±nÄ± saÄŸlayabilirsiniz.

Belirli rolleri ve sorumluluklarÄ± yerine getiren iki farklÄ± tÃ¼rde yÃ¶netici hesabÄ± bulunmaktadÄ±r:

- **VarsayÄ±lan YÃ¶netici:**
- VarsayÄ±lan yÃ¶netici hesabÄ±, AWS Organizations organizasyonunun yÃ¶netim hesabÄ± tarafÄ±ndan Firewall Manager'a kayÄ±t sÄ±rasÄ±nda oluÅŸturulur.
- Bu hesap, Ã¼Ã§Ã¼ncÃ¼ taraf gÃ¼venlik duvarlarÄ±nÄ± yÃ¶netme yeteneÄŸine sahiptir ve tam yÃ¶netici kapsamÄ±na sahiptir.
- Firewall Manager iÃ§in birincil yÃ¶netici hesabÄ± olarak hizmet verir ve organizasyon genelinde gÃ¼venlik politikalarÄ±nÄ± yapÄ±landÄ±rmak ve uygulamaktan sorumludur.
- VarsayÄ±lan yÃ¶netici, tÃ¼m kaynak tÃ¼rlerine ve yÃ¶netici iÅŸlevlerine tam eriÅŸime sahip olmasÄ±na raÄŸmen, organizasyon iÃ§inde birden fazla yÃ¶netici kullanÄ±lÄ±yorsa aynÄ± dÃ¼zeyde iÅŸlem yapar.
- **Firewall Manager YÃ¶neticileri:**
- Bu yÃ¶neticiler, AWS Organizations yÃ¶netim hesabÄ± tarafÄ±ndan belirlenen yÃ¶netici kapsamÄ± yapÄ±landÄ±rmasÄ±na gÃ¶re belirlenen kapsam iÃ§inde kaynaklarÄ± yÃ¶netebilir.
- Firewall Manager yÃ¶neticileri, gÃ¼venlik ve uyumluluk standartlarÄ±nÄ± korurken belirli rolleri yerine getirmek Ã¼zere organizasyon iÃ§inde oluÅŸturulur.
- OluÅŸturulduÄŸunda, Firewall Manager, hesabÄ±n zaten devredilmiÅŸ bir yÃ¶netici olup olmadÄ±ÄŸÄ±nÄ± belirlemek iÃ§in AWS Organizations ile kontrol eder. DeÄŸilse, Firewall Manager, hesabÄ± Firewall Manager iÃ§in bir devredilmiÅŸ yÃ¶netici olarak belirlemek Ã¼zere Organizations'Ä± arar.

Bu yÃ¶netici hesaplarÄ±nÄ± yÃ¶netmek, onlarÄ± Firewall Manager iÃ§inde oluÅŸturmak ve kuruluÅŸun gÃ¼venlik gereksinimlerine ve en az ayrÄ±calÄ±k ilkesine gÃ¶re yÃ¶netici kapsamlarÄ±nÄ± tanÄ±mlamakla ilgilidir. Uygun yÃ¶netici rolleri atayarak, organizasyonlar etkili gÃ¼venlik yÃ¶netimini saÄŸlayabilir ve hassas kaynaklara eriÅŸim Ã¼zerinde granÃ¼ler kontrolÃ¼ koruyabilir.

**Bir organizasyon iÃ§inde yalnÄ±zca bir hesap, Firewall Manager varsayÄ±lan yÃ¶neticisi olarak hizmet edebilir** ilkesini vurgulamak Ã¶nemlidir, "**ilk giren, son Ã§Ä±kar**" ilkesine uygun olarak. Yeni bir varsayÄ±lan yÃ¶netici belirlemek iÃ§in belirli adÄ±mlar izlenmelidir:

- Ä°lk olarak, her Firewall YÃ¶neticisi yÃ¶netici hesabÄ± kendi hesabÄ±nÄ± iptal etmelidir.
- ArdÄ±ndan, mevcut varsayÄ±lan yÃ¶netici kendi hesabÄ±nÄ± iptal edebilir, bÃ¶ylece organizasyonu Firewall Manager'dan Ã§Ä±karÄ±r. Bu sÃ¼reÃ§, iptal edilen hesap tarafÄ±ndan oluÅŸturulan tÃ¼m Firewall Manager politikalarÄ±nÄ±n silinmesine neden olur.
- Son olarak, AWS Organizations yÃ¶netim hesabÄ±, Firewall Manager varsayÄ±lan yÃ¶neticiyi belirlemelidir.

## NumaralandÄ±rma
```
# Users/Administrators

## Get the AWS Organizations account that is associated with AWS Firewall Manager as the AWS Firewall Manager default administrator
aws fms get-admin-account

## List of Firewall Manager administrators within the organization
aws fms list-admin-accounts-for-organization # ReadOnlyAccess policy is not enough for this

## Return a list of the member accounts in the FM administrator's AWS organization
aws fms list-member-accounts # Only a Firewall Manager administrator or the Organization's management account can make this request

## List the accounts that are managing the specified AWS Organizations member account
aws fms list-admins-managing-account # ReadOnlyAccess policy is not enough for this

# Resources

## Get the resources that a Firewall Manager administrator can manage
aws fms get-admin-scope --admin-account <value> # ReadOnlyAccess policy is not enough for this

## Returns the summary of the resource sets used
aws fms list-resource-sets # ReadOnlyAccess policy is not enough for this

## Get information about a specific resource set
aws fms get-resource-set --identifier <value>  # ReadOnlyAccess policy is not enough for this

## Retrieve the list of tags for a given resource
aws fms list-tags-for-resource --resource-arn <value>

## List of the resources in the AWS Organization's accounts that are available to be associated with a FM resource set. Only one account is supported per request.
aws fms list-compliance-status --member-account-ids <value> --resource-type <value> # ReadOnlyAccess policy is not enough for this

## List the resources that are currently associated to a resource set
aws fms list-resource-set-resources --identifier <value> # ReadOnlyAccess policy is not enough for this

# Policies

## Returns the list of policies
aws fms list-policies

## Get information about the specified AWS Firewall Manager policy
aws fms get-policy --policy-id <value>

## List all of the third-party firewall policies that are associated with the third-party firewall administrator's account
aws fms list-third-party-firewall-firewall-policies --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

# AppsList

## Return a list of apps list
aws fms list-apps-lists --max-results [1-100]

## Get information about the specified AWS Firewall Manager applications list
aws fms get-apps-list --list-id <value>

# Protocols

## Get the details of the Firewall Manager protocols list.
aws fms list-protocols-lists

## Get information about the specified AWS Firewall Manager Protocols list
aws fms get-protocols-list --list-id <value>

# Compliance

## Return a summary of which member accounts are protected by the specified policy
aws fms list-compliance-status --policy-id <policy-id>

## Get detailed compliance information about the specified member account (resources that are in and out of compliance with the specified policy)
aws fms get-compliance-detail --policy-id <value> --member-account <value>

# Other useful info

## Get information about the SNS topic that is used to record AWS Firewall Manager SNS logs (if any)
aws fms get-notification-channel

## Get policy-level attack summary information in the event of a potential DDoS attack
aws fms get-protection-status --policy-id <value> # Just for Shield Advanced policy

## Get the onboarding status of a Firewall Manager admin account to third-party firewall vendor tenant.
aws fms get-third-party-firewall-association-status --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

## Get violations' details for a resource based on the specified AWS Firewall Manager policy and AWS account.
aws fms get-violation-details --policy-id <value> --member-account <value> --resource-id <value> --resource-type <value>
```
## SaldÄ±rÄ± SonrasÄ± / AlgÄ±lamayÄ± Atlatma

### `organizations:DescribeOrganization` & (`fms:AssociateAdminAccount`, `fms:DisassociateAdminAccount`, `fms:PutAdminAccount`)
**`fms:AssociateAdminAccount`** iznine sahip bir saldÄ±rgan, GÃ¼venlik DuvarÄ± YÃ¶neticisi varsayÄ±lan yÃ¶netici hesabÄ±nÄ± ayarlayabilir. **`fms:PutAdminAccount`** izni ile bir saldÄ±rgan, GÃ¼venlik DuvarÄ± YÃ¶neticisi yÃ¶netici hesabÄ± oluÅŸturabilir veya gÃ¼ncelleme yapabilir ve **`fms:DisassociateAdminAccount`** izni ile potansiyel bir saldÄ±rgan mevcut GÃ¼venlik DuvarÄ± YÃ¶neticisi yÃ¶netici hesabÄ± iliÅŸkisini kaldÄ±rabilir.

- **GÃ¼venlik DuvarÄ± YÃ¶neticisi varsayÄ±lan yÃ¶neticisinin iliÅŸkisinin Ã§Ã¶zÃ¼lmesi ilk giren-son Ã§Ä±kar politikasÄ±nÄ± takip eder**. GÃ¼venlik DuvarÄ± YÃ¶neticisi yÃ¶neticilerinin hepsi Ã§Ã¶zÃ¼lmelidir, ardÄ±ndan GÃ¼venlik DuvarÄ± YÃ¶neticisi varsayÄ±lan yÃ¶neticisi hesabÄ± Ã§Ã¶zÃ¼lebilir.
- Bir GÃ¼venlik DuvarÄ± YÃ¶neticisi yÃ¶neticisi oluÅŸturmak iÃ§in **PutAdminAccount** kullanÄ±larak, hesabÄ±n Ã¶nceden **AssociateAdminAccount** kullanÄ±larak GÃ¼venlik DuvarÄ± YÃ¶neticisine katÄ±lan organizasyona ait olmasÄ± gerekir.
- Bir GÃ¼venlik DuvarÄ± YÃ¶neticisi yÃ¶netici hesabÄ± oluÅŸturulabilir sadece organizasyonun yÃ¶netim hesabÄ± tarafÄ±ndan yapÄ±labilir.
```bash
aws fms associate-admin-account --admin-account <value>
aws fms disassociate-admin-account
aws fms put-admin-account --admin-account <value>
```
**Potansiyel Etki:** Merkezi yÃ¶netimin kaybÄ±, politika kaÃ§Ä±nÄ±lmasÄ±, uyumluluk ihlalleri ve Ã§evredeki gÃ¼venlik kontrollerinin bozulmasÄ±.

### `fms:PutPolicy`, `fms:DeletePolicy`

Bir saldÄ±rgan **`fms:PutPolicy`**, **`fms:DeletePolicy`** izinlerine sahipse bir AWS Firewall Manager politikasÄ± oluÅŸturabilir, deÄŸiÅŸtirebilir veya kalÄ±cÄ± olarak silebilir.
```bash
aws fms put-policy --policy <value> | --cli-input-json file://<policy.json> [--tag-list <value>]
aws fms delete-policy --policy-id <value> [--delete-all-policy-resources | --no-delete-all-policy-resources]
```
AÅŸaÄŸÄ±daki gibi, algÄ±lamayÄ± atlamak iÃ§in izin verici bir gÃ¼venlik grubu aracÄ±lÄ±ÄŸÄ±yla izin verici bir politika Ã¶rneÄŸi olabilir:
```json
{
"Policy": {
"PolicyName": "permisive_policy",
"SecurityServicePolicyData": {
"Type": "SECURITY_GROUPS_COMMON",
"ManagedServiceData": "{\"type\":\"SECURITY_GROUPS_COMMON\",\"securityGroups\":[{\"id\":\"<permisive_security_group_id>\"}], \"applyToAllEC2InstanceENIs\":\"true\",\"IncludeSharedVPC\":\"true\"}"
},
"ResourceTypeList": ["AWS::EC2::Instance", "AWS::EC2::NetworkInterface", "AWS::EC2::SecurityGroup", "AWS::ElasticLoadBalancingV2::LoadBalancer", "AWS::ElasticLoadBalancing::LoadBalancer"],
"ResourceType": "AWS::EC2::SecurityGroup",
"ExcludeResourceTags": false,
"ResourceTags": [],
"RemediationEnabled": true
},
"TagList": []
}
```
**Potansiyel Etki:** GÃ¼venlik kontrollerinin devre dÄ±ÅŸÄ± bÄ±rakÄ±lmasÄ±, politika kaÃ§Ä±nÄ±lmasÄ±, uyumluluk ihlalleri, operasyonel aksaklÄ±klar ve ortamdaki potansiyel veri ihlalleri.

### `fms:BatchAssociateResource`, `fms:BatchDisassociateResource`, `fms:PutResourceSet`, `fms:DeleteResourceSet`

Bir saldÄ±rganÄ±n **`fms:BatchAssociateResource`** ve **`fms:BatchDisassociateResource`** izinleri ile sÄ±rasÄ±yla bir Firewall YÃ¶neticisi kaynak kÃ¼mesinden kaynaklarÄ± iliÅŸkilendirebilir veya iliÅŸkisiz hale getirebilir. AyrÄ±ca, **`fms:PutResourceSet`** ve **`fms:DeleteResourceSet`** izinleri bir saldÄ±rganÄ±n bu kaynak kÃ¼melerini oluÅŸturmasÄ±na, deÄŸiÅŸtirmesine veya silmesine izin verecektir.
```bash
# Associate/Disassociate resources from a resource set
aws fms batch-associate-resource --resource-set-identifier <value> --items <value>
aws fms batch-disassociate-resource --resource-set-identifier <value> --items <value>

# Create, modify or delete a resource set
aws fms put-resource-set --resource-set <value> [--tag-list <value>]
aws fms delete-resource-set --identifier <value>
```
**Potansiyel Etki:** Bir kaynak kÃ¼mesine gereksiz miktarda Ã¶ÄŸe eklenmesi, Hizmetteki gÃ¼rÃ¼ltÃ¼ seviyesini artÄ±rarak potansiyel olarak bir DoS'a neden olabilir. AyrÄ±ca, kaynak kÃ¼melerinin deÄŸiÅŸiklikleri, bir kaynak kesintisine, politika kaÃ§Ä±rma, uyumluluk ihlallerine ve ortamdaki gÃ¼venlik kontrollerinin bozulmasÄ±na yol aÃ§abilir.

### `fms:PutAppsList`, `fms:DeleteAppsList`

**`fms:PutAppsList`** ve **`fms:DeleteAppsList`** izinlerine sahip bir saldÄ±rgan, AWS Firewall Manager'dan uygulama listeleri oluÅŸturabilir, deÄŸiÅŸtirebilir veya silebilir. Bu kritik olabilir, Ã§Ã¼nkÃ¼ yetkisiz uygulamalara genel halka eriÅŸim izni verilebilir veya yetkili uygulamalara eriÅŸim engellenebilir, bÃ¶ylece bir DoS'a neden olabilir.
```bash
aws fms put-apps-list --apps-list <value> [--tag-list <value>]
aws fms delete-apps-list --list-id <value>
```
**Potansiyel Etki:** Bu, ortam iÃ§inde yapÄ±landÄ±rma hatalarÄ±na, politika kaÃ§Ä±nmalarÄ±na, uyumluluk ihlallerine ve gÃ¼venlik kontrollerinin bozulmasÄ±na neden olabilir.

### `fms:PutProtocolsList`, `fms:DeleteProtocolsList`

**`fms:PutProtocolsList`** ve **`fms:DeleteProtocolsList`** izinlerine sahip bir saldÄ±rgan, AWS Firewall Manager'dan protokol listeleri oluÅŸturabilir, deÄŸiÅŸtirebilir veya silebilir. Uygulama listeleriyle benzer ÅŸekilde, yetkisiz protokoller genel halk tarafÄ±ndan kullanÄ±labilir veya yetkili protokollerin kullanÄ±mÄ± reddedilebilir, bu da bir Hizmet Reddi saldÄ±rÄ±sÄ±na neden olabilir.
```bash
aws fms put-protocols-list --apps-list <value> [--tag-list <value>]
aws fms delete-protocols-list --list-id <value>
```
**Potansiyel Etki:** Bu, ortam iÃ§inde yapÄ±landÄ±rma hatalarÄ±na, politika kaÃ§Ä±nmalarÄ±na, uyumluluk ihlallerine ve gÃ¼venlik kontrollerinin bozulmasÄ±na neden olabilir.

### `fms:PutNotificationChannel`, `fms:DeleteNotificationChannel`

**`fms:PutNotificationChannel`** ve **`fms:DeleteNotificationChannel`** izinlerine sahip bir saldÄ±rgan, Firewall Manager'Ä±n SNS gÃ¼nlÃ¼klerini kaydetmek iÃ§in kullandÄ±ÄŸÄ± IAM rolÃ¼nÃ¼ ve Amazon Simple Notification Service (SNS) konusunu silip belirleyebilir.

**`fms:PutNotificationChannel`**'Ä± konsol dÄ±ÅŸÄ±nda kullanmak iÃ§in, belirtilen **SnsRoleName**'in SNS gÃ¼nlÃ¼klerini yayÄ±nlamasÄ±na izin veren SNS konusunun eriÅŸim politikasÄ±nÄ± yapÄ±landÄ±rmanÄ±z gerekir. SaÄŸlanan **SnsRoleName**, **`AWSServiceRoleForFMS`** dÄ±ÅŸÄ±ndaki bir rol ise, Firewall Manager hizmet baÅŸlÄ±ÄŸÄ±nÄ±n bu role geÃ§mesine izin vermek iÃ§in yapÄ±landÄ±rÄ±lmÄ±ÅŸ bir gÃ¼ven iliÅŸkisi gerektirir.

Bir SNS eriÅŸim politikasÄ±nÄ± yapÄ±landÄ±rma hakkÄ±nda bilgi iÃ§in:

{% content-ref url="../aws-services/aws-sns-enum.md" %}
[aws-sns-enum.md](../aws-services/aws-sns-enum.md)
{% endcontent-ref %}
```bash
aws fms put-notification-channel --sns-topic-arn <value> --sns-role-name <value>
aws fms delete-notification-channel
```
**Potansiyel Etki:** Bu potansiyel olarak gÃ¼venlik uyarÄ±larÄ±nÄ±n kaÃ§Ä±rÄ±lmasÄ±na, gecikmiÅŸ olay yanÄ±tlarÄ±na, potansiyel veri ihlallerine ve ortam iÃ§indeki iÅŸletme kesintilerine yol aÃ§abilir.

### `fms:AssociateThirdPartyFirewall`, `fms:DisssociateThirdPartyFirewall`
Bir saldÄ±rgan **`fms:AssociateThirdPartyFirewall`**, **`fms:DisssociateThirdPartyFirewall`** izinlerine sahipse, Ã¼Ã§Ã¼ncÃ¼ taraf gÃ¼venlik duvarlarÄ±nÄ± AWS GÃ¼venlik DuvarÄ± YÃ¶neticisi aracÄ±lÄ±ÄŸÄ±yla merkezi olarak yÃ¶netmeye baÄŸlayabilir veya baÄŸlantÄ±sÄ±nÄ± Ã§Ã¶zebilir.
{% hint style="warning" %}
YalnÄ±zca varsayÄ±lan yÃ¶netici Ã¼Ã§Ã¼ncÃ¼ taraf gÃ¼venlik duvarlarÄ± oluÅŸturabilir ve yÃ¶netebilir.
{% endhint %}
```bash
aws fms associate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
aws fms disassociate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
```
**Potansiyel Etki:** BaÄŸlantÄ±nÄ±n kesilmesi, bir politika kaÃ§Ä±nma, uyumluluk ihlalleri ve Ã§evredeki gÃ¼venlik kontrollerinin bozulmasÄ±na yol aÃ§abilir. Ã–te yandan baÄŸlantÄ±, maliyet ve bÃ¼tÃ§e tahsisinin bozulmasÄ±na neden olabilir.

### `fms:TagResource`, `fms:UntagResource`

SaldÄ±rgan, Firewall YÃ¶neticisi kaynaklarÄ±ndan etiket ekleyebilir, deÄŸiÅŸtirebilir veya kaldÄ±rabilir; bu da kuruluÅŸunuzun maliyet tahsisini, kaynak izleme ve etiketlere dayalÄ± eriÅŸim kontrol politikalarÄ±nÄ± bozabilir.
```bash
aws fms tag-resource --resource-arn <value> --tag-list <value>
aws fms untag-resource --resource-arn <value> --tag-keys <value>
```
**Potansiyel Etki**: Maliyet tahsisi, kaynak izleme ve etiket tabanlÄ± eriÅŸim kontrol politikalarÄ±nÄ±n bozulmasÄ±.

## Referanslar

* [https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html](https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html)
* [https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html](https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html)

<details>

<summary><strong>SÄ±fÄ±rdan kahraman olana kadar AWS hacklemeyi Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin**.
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'ler gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
