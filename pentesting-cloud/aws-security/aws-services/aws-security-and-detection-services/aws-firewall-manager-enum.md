# AWS - Enumeraci칩n de AWS Firewall Manager

<details>

<summary><strong>Aprende hacking en AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop)!
* Obt칠n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Firewall Manager

**AWS Firewall Manager** simplifica la gesti칩n y mantenimiento de **AWS WAF, AWS Shield Advanced, grupos de seguridad de Amazon VPC y listas de control de acceso de red (ACL), y AWS Network Firewall, AWS Route 53 Resolver DNS Firewall y firewalls de terceros** en m칰ltiples cuentas y recursos. Te permite configurar tus reglas de firewall, protecciones avanzadas de Shield, grupos de seguridad de VPC y configuraciones de Network Firewall solo una vez, con el servicio **aplicando autom치ticamente estas reglas y protecciones en todas tus cuentas y recursos**, incluidos los reci칠n agregados.

El servicio ofrece la capacidad de **agrupar y proteger recursos espec칤ficos juntos**, como aquellos que comparten una etiqueta com칰n o todas tus distribuciones de CloudFront. Una ventaja significativa de Firewall Manager es su capacidad de **extender autom치ticamente la protecci칩n a los recursos reci칠n agregados** en tu cuenta.

Un **grupo de reglas** (una colecci칩n de reglas de WAF) puede incorporarse en una Pol칤tica de AWS Firewall Manager, que luego se vincula a recursos espec칤ficos de AWS como distribuciones de CloudFront o balanceadores de carga de aplicaciones.

AWS Firewall Manager proporciona **listas de aplicaciones y protocolos administradas** para simplificar la configuraci칩n y gesti칩n de pol칤ticas de grupos de seguridad. Estas listas te permiten definir los protocolos y aplicaciones permitidos o denegados por tus pol칤ticas. Hay dos tipos de listas administradas:

* **Listas administradas por Firewall Manager**: Estas listas incluyen **FMS-Default-Public-Access-Apps-Allowed**, **FMS-Default-Protocols-Allowed** y **FMS-Default-Protocols-Allowed**. Son administradas por Firewall Manager e incluyen aplicaciones y protocolos com칰nmente utilizados que deben permitirse o denegarse al p칰blico en general. No es posible editar o eliminarlas, sin embargo, puedes elegir su versi칩n.
* **Listas administradas personalizadas**: T칰 administras estas listas. Puedes crear listas personalizadas de aplicaciones y protocolos adaptadas a las necesidades de tu organizaci칩n. A diferencia de las listas administradas por Firewall Manager, estas listas no tienen versiones, pero tienes control total sobre las listas personalizadas, lo que te permite crear, editar y eliminarlas seg칰n sea necesario.

Es importante tener en cuenta que **las pol칤ticas de Firewall Manager solo permiten acciones de "Bloquear" o "Contar"** para un grupo de reglas, sin opci칩n de "Permitir".

### Requisitos previos

Los siguientes pasos previos deben completarse antes de proceder a configurar Firewall Manager para comenzar a proteger efectivamente los recursos de tu organizaci칩n. Estos pasos proporcionan la configuraci칩n fundamental requerida para que Firewall Manager haga cumplir las pol칤ticas de seguridad y garantice el cumplimiento en tu entorno de AWS:

1. **Unirse y configurar AWS Organizations:** Aseg칰rate de que tu cuenta de AWS sea parte de la organizaci칩n de AWS Organizations donde se planea implementar las pol칤ticas de AWS Firewall Manager. Esto permite la gesti칩n centralizada de recursos y pol칤ticas en m칰ltiples cuentas de AWS dentro de la organizaci칩n.
2. **Crear una Cuenta de Administrador Predeterminada de AWS Firewall Manager:** Establece una cuenta de administrador predeterminada espec칤ficamente para administrar las pol칤ticas de seguridad de Firewall Manager. Esta cuenta ser치 responsable de configurar y hacer cumplir las pol칤ticas de seguridad en toda la organizaci칩n. Solo la cuenta de administraci칩n de la organizaci칩n puede crear cuentas de administrador predeterminadas de Firewall Manager.
3. **Activar AWS Config:** Activa AWS Config para proporcionar a Firewall Manager los datos de configuraci칩n e informaci칩n necesarios para hacer cumplir efectivamente las pol칤ticas de seguridad. AWS Config ayuda a analizar, auditar, monitorear y auditar las configuraciones y cambios de recursos, facilitando una mejor gesti칩n de la seguridad.
4. **Para Pol칤ticas de Terceros, Suscribirse en el AWS Marketplace y Configurar Ajustes de Terceros:** Si planeas utilizar pol칤ticas de firewall de terceros, suscr칤bete a ellas en el AWS Marketplace y configura los ajustes necesarios. Este paso garantiza que Firewall Manager pueda integrar y hacer cumplir pol칤ticas de proveedores de terceros confiables.
5. **Para Pol칤ticas de Network Firewall y DNS Firewall, habilitar el intercambio de recursos:** Habilita el intercambio de recursos espec칤ficamente para las pol칤ticas de Network Firewall y DNS Firewall. Esto permite que Firewall Manager aplique protecciones de firewall a las VPC de tu organizaci칩n y a la resoluci칩n de DNS, mejorando la seguridad de la red.
6. **Para usar AWS Firewall Manager en Regiones que est치n deshabilitadas de forma predeterminada:** Si planeas utilizar Firewall Manager en regiones de AWS que est치n deshabilitadas de forma predeterminada, aseg칰rate de tomar los pasos necesarios para habilitar su funcionalidad en esas regiones. Esto garantiza la aplicaci칩n consistente de la seguridad en todas las regiones donde opera tu organizaci칩n.

Para obtener m치s informaci칩n, consulta:[Empezar con las pol칤ticas de AWS Firewall Manager AWS WAF](https://docs.aws.amazon.com/waf/latest/developerguide/getting-started-fms.html).

### Tipos de pol칤ticas de protecci칩n

AWS Firewall Manager administra varios tipos de pol칤ticas para hacer cumplir controles de seguridad en diferentes aspectos de la infraestructura de tu organizaci칩n:

1. **Pol칤tica de AWS WAF:** Este tipo de pol칤tica admite tanto AWS WAF como AWS WAF Classic. Puedes definir qu칠 recursos est치n protegidos por la pol칤tica. Para las pol칤ticas de AWS WAF, puedes especificar conjuntos de grupos de reglas para ejecutar primero y 칰ltimo en el ACL web. Adem치s, los propietarios de cuentas pueden agregar reglas y grupos de reglas para ejecutar entre estos conjuntos.
2. **Pol칤tica de Shield Advanced:** Esta pol칤tica aplica protecciones de Shield Advanced en toda tu organizaci칩n para tipos de recursos especificados. Ayuda a proteger contra ataques DDoS y otras amenazas.
3. **Pol칤tica de Grupo de Seguridad de Amazon VPC:** Con esta pol칤tica, puedes gestionar grupos de seguridad utilizados en toda tu organizaci칩n, haciendo cumplir un conjunto b치sico de reglas en tu entorno de AWS para controlar el acceso a la red.
4. **Pol칤tica de Lista de Control de Acceso de Red (ACL) de Amazon VPC:** Este tipo de pol칤tica te brinda control sobre las ACL de red utilizadas en tu organizaci칩n, permiti칠ndote hacer cumplir un conjunto b치sico de ACL de red en tu entorno de AWS.
5. **Pol칤tica de Network Firewall:** Esta pol칤tica aplica protecci칩n de AWS Network Firewall a las VPC de tu organizaci칩n, mejorando la seguridad de la red al filtrar el tr치fico seg칰n reglas predefinidas.
6. **Pol칤tica de DNS Firewall de Amazon Route 53 Resolver:** Esta pol칤tica aplica protecciones de DNS Firewall a las VPC de tu organizaci칩n, ayudando a bloquear intentos maliciosos de resoluci칩n de dominios y hacer cumplir pol칤ticas de seguridad para el tr치fico de DNS.
7. **Pol칤tica de Firewall de Terceros:** Este tipo de pol칤tica aplica protecciones de firewalls de terceros, que est치n disponibles mediante suscripci칩n a trav칠s de la consola del AWS Marketplace. Te permite integrar medidas de seguridad adicionales de proveedores confiables en tu entorno de AWS.
1. **Pol칤tica de Palo Alto Networks Cloud NGFW:** Esta pol칤tica aplica protecciones y conjuntos de reglas de Palo Alto Networks Cloud Next Generation Firewall (NGFW) a las VPC de tu organizaci칩n, proporcionando prevenci칩n avanzada de amenazas y controles de seguridad a nivel de aplicaci칩n.
2. **Pol칤tica de Fortigate Cloud Native Firewall (CNF) as a Service:** Esta pol칤tica aplica protecciones de Fortigate Cloud Native Firewall (CNF) as a Service, ofreciendo prevenci칩n de amenazas l칤der en la industria, firewall de aplicaciones web (WAF) y protecci칩n de API adaptada para infraestructuras en la nube.
### Cuentas de administrador

AWS Firewall Manager ofrece flexibilidad en la gesti칩n de recursos de firewall dentro de su organizaci칩n a trav칠s de su alcance administrativo y dos tipos de cuentas de administrador.

**El alcance administrativo define los recursos que un administrador de Firewall Manager puede gestionar**. Despu칠s de que una cuenta de administraci칩n de AWS Organizations integra una organizaci칩n en Firewall Manager, puede crear administradores adicionales con diferentes alcances administrativos. Estos alcances pueden incluir:

- Cuentas o unidades organizativas (OUs) a las que el administrador puede aplicar pol칤ticas.
- Regiones donde el administrador puede realizar acciones.
- Tipos de pol칤ticas de Firewall Manager que el administrador puede gestionar.

El alcance administrativo puede ser **completo o restringido**. El alcance completo otorga al administrador acceso a **todos los tipos de recursos especificados, regiones y tipos de pol칤ticas**. En contraste, **el alcance restringido proporciona permisos administrativos solo a un subconjunto de recursos, regiones o tipos de pol칤ticas**. Es recomendable otorgar a los administradores solo los permisos que necesitan para cumplir eficazmente con sus roles. Puede aplicar cualquier combinaci칩n de estas condiciones de alcance administrativo a un administrador, asegurando el cumplimiento del principio de privilegio m칤nimo.

Existen dos tipos distintos de cuentas de administrador, cada una con roles y responsabilidades espec칤ficos:

- **Administrador predeterminado:**
- La cuenta de administrador predeterminado es creada por la cuenta de administraci칩n de la organizaci칩n de AWS Organizations durante el proceso de integraci칩n en Firewall Manager.
- Esta cuenta tiene la capacidad de gestionar firewalls de terceros y posee un alcance administrativo completo.
- Sirve como la cuenta de administrador principal de Firewall Manager, responsable de configurar y hacer cumplir pol칤ticas de seguridad en toda la organizaci칩n.
- Si bien el administrador predeterminado tiene acceso completo a todos los tipos de recursos y funcionalidades administrativas, opera al mismo nivel de pares que otros administradores si se utilizan m칰ltiples administradores dentro de la organizaci칩n.
- **Administradores de Firewall Manager:**
- Estos administradores pueden gestionar recursos dentro del alcance designado por la cuenta de administraci칩n de AWS Organizations, seg칰n lo definido por la configuraci칩n de alcance administrativo.
- Los administradores de Firewall Manager se crean para cumplir roles espec칤ficos dentro de la organizaci칩n, permitiendo la delegaci칩n de responsabilidades mientras se mantienen est치ndares de seguridad y cumplimiento.
- Al crearse, Firewall Manager verifica con AWS Organizations para determinar si la cuenta ya es un administrador delegado. Si no lo es, Firewall Manager llama a Organizations para designar la cuenta como administrador delegado para Firewall Manager.

La gesti칩n de estas cuentas de administrador implica crearlas dentro de Firewall Manager y definir sus alcances administrativos de acuerdo con los requisitos de seguridad de la organizaci칩n y el principio de privilegio m칤nimo. Al asignar roles administrativos apropiados, las organizaciones pueden garantizar una gesti칩n efectiva de la seguridad mientras mantienen un control detallado sobre el acceso a recursos sensibles.

Es importante destacar que **solo una cuenta dentro de una organizaci칩n puede servir como administrador predeterminado de Firewall Manager**, cumpliendo con el principio de "**primero en entrar, 칰ltimo en salir**". Para designar un nuevo administrador predeterminado, se deben seguir una serie de pasos:

- Primero, cada cuenta de administrador de Firewall debe revocar su propia cuenta.
- Luego, el administrador predeterminado existente puede revocar su propia cuenta, lo que efectivamente da de baja a la organizaci칩n de Firewall Manager. Este proceso resulta en la eliminaci칩n de todas las pol칤ticas de Firewall Manager creadas por la cuenta revocada.
- Para concluir, la cuenta de administraci칩n de AWS Organizations debe designar al administrador predeterminado de Firewall Manager.

## Enumeraci칩n
```
# Users/Administrators

## Get the AWS Organizations account that is associated with AWS Firewall Manager as the AWS Firewall Manager default administrator
aws fms get-admin-account

## List of Firewall Manager administrators within the organization
aws fms list-admin-accounts-for-organization # ReadOnlyAccess policy is not enough for this

## Return a list of the member accounts in the FM administrator's AWS organization
aws fms list-member-accounts # Only a Firewall Manager administrator or the Organization's management account can make this request

## List the accounts that are managing the specified AWS Organizations member account
aws fms list-admins-managing-account # ReadOnlyAccess policy is not enough for this

# Resources

## Get the resources that a Firewall Manager administrator can manage
aws fms get-admin-scope --admin-account <value> # ReadOnlyAccess policy is not enough for this

## Returns the summary of the resource sets used
aws fms list-resource-sets # ReadOnlyAccess policy is not enough for this

## Get information about a specific resource set
aws fms get-resource-set --identifier <value>  # ReadOnlyAccess policy is not enough for this

## Retrieve the list of tags for a given resource
aws fms list-tags-for-resource --resource-arn <value>

## List of the resources in the AWS Organization's accounts that are available to be associated with a FM resource set. Only one account is supported per request.
aws fms list-compliance-status --member-account-ids <value> --resource-type <value> # ReadOnlyAccess policy is not enough for this

## List the resources that are currently associated to a resource set
aws fms list-resource-set-resources --identifier <value> # ReadOnlyAccess policy is not enough for this

# Policies

## Returns the list of policies
aws fms list-policies

## Get information about the specified AWS Firewall Manager policy
aws fms get-policy --policy-id <value>

## List all of the third-party firewall policies that are associated with the third-party firewall administrator's account
aws fms list-third-party-firewall-firewall-policies --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

# AppsList

## Return a list of apps list
aws fms list-apps-lists --max-results [1-100]

## Get information about the specified AWS Firewall Manager applications list
aws fms get-apps-list --list-id <value>

# Protocols

## Get the details of the Firewall Manager protocols list.
aws fms list-protocols-lists

## Get information about the specified AWS Firewall Manager Protocols list
aws fms get-protocols-list --list-id <value>

# Compliance

## Return a summary of which member accounts are protected by the specified policy
aws fms list-compliance-status --policy-id <policy-id>

## Get detailed compliance information about the specified member account (resources that are in and out of compliance with the specified policy)
aws fms get-compliance-detail --policy-id <value> --member-account <value>

# Other useful info

## Get information about the SNS topic that is used to record AWS Firewall Manager SNS logs (if any)
aws fms get-notification-channel

## Get policy-level attack summary information in the event of a potential DDoS attack
aws fms get-protection-status --policy-id <value> # Just for Shield Advanced policy

## Get the onboarding status of a Firewall Manager admin account to third-party firewall vendor tenant.
aws fms get-third-party-firewall-association-status --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

## Get violations' details for a resource based on the specified AWS Firewall Manager policy and AWS account.
aws fms get-violation-details --policy-id <value> --member-account <value> --resource-id <value> --resource-type <value>
```
## Post Explotaci칩n / Evadir Detecci칩n

### `organizations:DescribeOrganization` & (`fms:AssociateAdminAccount`, `fms:DisassociateAdminAccount`, `fms:PutAdminAccount`)
Un atacante con el permiso **`fms:AssociateAdminAccount`** podr칤a establecer la cuenta de administrador predeterminada de Firewall Manager. Con el permiso **`fms:PutAdminAccount`**, un atacante podr칤a crear o actualizar una cuenta de administrador de Firewall Manager y con el permiso **`fms:DisassociateAdminAccount`**, un posible atacante podr칤a eliminar la asociaci칩n de la cuenta de administrador actual de Firewall Manager.

- La desasociaci칩n del **administrador predeterminado de Firewall Manager sigue la pol칤tica de primero en entrar, 칰ltimo en salir**. Todos los administradores de Firewall Manager deben desasociarse antes de que el administrador predeterminado de Firewall Manager pueda desasociar la cuenta.
- Para crear un administrador de Firewall Manager mediante **PutAdminAccount**, la cuenta debe pertenecer a la organizaci칩n que fue previamente integrada en Firewall Manager usando **AssociateAdminAccount**.
- La creaci칩n de una cuenta de administrador de Firewall Manager solo puede ser realizada por la cuenta de administraci칩n de la organizaci칩n.
```bash
aws fms associate-admin-account --admin-account <value>
aws fms disassociate-admin-account
aws fms put-admin-account --admin-account <value>
```
**Impacto Potencial:** P칠rdida de gesti칩n centralizada, evasi칩n de pol칤ticas, violaciones de cumplimiento y alteraci칩n de controles de seguridad dentro del entorno.

### `fms:PutPolicy`, `fms:DeletePolicy`

Un atacante con los permisos **`fms:PutPolicy`**, **`fms:DeletePolicy`** ser칤a capaz de crear, modificar o eliminar permanentemente una pol칤tica de AWS Firewall Manager.
```bash
aws fms put-policy --policy <value> | --cli-input-json file://<policy.json> [--tag-list <value>]
aws fms delete-policy --policy-id <value> [--delete-all-policy-resources | --no-delete-all-policy-resources]
```
Un ejemplo de pol칤tica permisiva a trav칠s de un grupo de seguridad permisivo, con el fin de evadir la detecci칩n, podr칤a ser el siguiente:
```json
{
"Policy": {
"PolicyName": "permisive_policy",
"SecurityServicePolicyData": {
"Type": "SECURITY_GROUPS_COMMON",
"ManagedServiceData": "{\"type\":\"SECURITY_GROUPS_COMMON\",\"securityGroups\":[{\"id\":\"<permisive_security_group_id>\"}], \"applyToAllEC2InstanceENIs\":\"true\",\"IncludeSharedVPC\":\"true\"}"
},
"ResourceTypeList": ["AWS::EC2::Instance", "AWS::EC2::NetworkInterface", "AWS::EC2::SecurityGroup", "AWS::ElasticLoadBalancingV2::LoadBalancer", "AWS::ElasticLoadBalancing::LoadBalancer"],
"ResourceType": "AWS::EC2::SecurityGroup",
"ExcludeResourceTags": false,
"ResourceTags": [],
"RemediationEnabled": true
},
"TagList": []
}
```
**Impacto Potencial:** Desmantelamiento de controles de seguridad, evasi칩n de pol칤ticas, violaciones de cumplimiento, interrupciones operativas y posibles filtraciones de datos dentro del entorno.

### `fms:BatchAssociateResource`, `fms:BatchDisassociateResource`, `fms:PutResourceSet`, `fms:DeleteResourceSet`

Un atacante con los permisos **`fms:BatchAssociateResource`** y **`fms:BatchDisassociateResource`** podr칤a asociar o desasociar recursos de un conjunto de recursos de Firewall Manager respectivamente. Adem치s, los permisos **`fms:PutResourceSet`** y **`fms:DeleteResourceSet`** permitir칤an a un atacante crear, modificar o eliminar estos conjuntos de recursos de AWS Firewall Manager.
```bash
# Associate/Disassociate resources from a resource set
aws fms batch-associate-resource --resource-set-identifier <value> --items <value>
aws fms batch-disassociate-resource --resource-set-identifier <value> --items <value>

# Create, modify or delete a resource set
aws fms put-resource-set --resource-set <value> [--tag-list <value>]
aws fms delete-resource-set --identifier <value>
```
**Impacto potencial:** La adici칩n de una cantidad innecesaria de elementos a un conjunto de recursos aumentar치 el nivel de ruido en el Servicio, lo que potencialmente podr칤a causar un DoS. Adem치s, los cambios en los conjuntos de recursos podr칤an provocar una interrupci칩n de recursos, evasi칩n de pol칤ticas, violaciones de cumplimiento y la interrupci칩n de controles de seguridad dentro del entorno.

### `fms:PutAppsList`, `fms:DeleteAppsList`

Un atacante con los permisos **`fms:PutAppsList`** y **`fms:DeleteAppsList`** podr칤a crear, modificar o eliminar listas de aplicaciones desde AWS Firewall Manager. Esto podr칤a ser cr칤tico, ya que aplicaciones no autorizadas podr칤an permitir el acceso al p칰blico en general, o se podr칤a denegar el acceso a aplicaciones autorizadas, lo que causar칤a un DoS.
```bash
aws fms put-apps-list --apps-list <value> [--tag-list <value>]
aws fms delete-apps-list --list-id <value>
```
**Impacto Potencial:** Esto podr칤a resultar en configuraciones incorrectas, evasi칩n de pol칤ticas, violaciones de cumplimiento y alteraci칩n de controles de seguridad dentro del entorno.

### `fms:PutProtocolsList`, `fms:DeleteProtocolsList`

Un atacante con los permisos **`fms:PutProtocolsList`** y **`fms:DeleteProtocolsList`** ser칤a capaz de crear, modificar o eliminar listas de protocolos de AWS Firewall Manager. De manera similar a las listas de aplicaciones, esto podr칤a ser cr칤tico ya que protocolos no autorizados podr칤an ser utilizados por el p칰blico en general, o se podr칤a denegar el uso de protocolos autorizados, causando un DoS.
```bash
aws fms put-protocols-list --apps-list <value> [--tag-list <value>]
aws fms delete-protocols-list --list-id <value>
```
**Impacto potencial:** Esto podr칤a resultar en configuraciones incorrectas, evasi칩n de pol칤ticas, violaciones de cumplimiento y alteraci칩n de controles de seguridad dentro del entorno.

### `fms:PutNotificationChannel`, `fms:DeleteNotificationChannel`

Un atacante con los permisos **`fms:PutNotificationChannel`** y **`fms:DeleteNotificationChannel`** podr칤a eliminar y designar el rol IAM y el tema de Amazon Simple Notification Service (SNS) que Firewall Manager utiliza para grabar registros de SNS.

Para utilizar **`fms:PutNotificationChannel`** fuera de la consola, es necesario configurar la pol칤tica de acceso del tema de SNS, permitiendo que el **SnsRoleName** especificado publique registros de SNS. Si el **SnsRoleName** proporcionado es un rol distinto al **`AWSServiceRoleForFMS`**, se requiere una relaci칩n de confianza configurada para permitir que el principal de servicio de Firewall Manager **fms.amazonaws.com** asuma este rol.

Para obtener informaci칩n sobre c칩mo configurar una pol칤tica de acceso de SNS:

{% content-ref url="../aws-services/aws-sns-enum.md" %}
[aws-sns-enum.md](../aws-services/aws-sns-enum.md)
{% endcontent-ref %}
```bash
aws fms put-notification-channel --sns-topic-arn <value> --sns-role-name <value>
aws fms delete-notification-channel
```
**Impacto Potencial:** Esto podr칤a llevar potencialmente a perder alertas de seguridad, respuestas a incidentes retrasadas, posibles filtraciones de datos y interrupciones operativas dentro del entorno.

### `fms:AssociateThirdPartyFirewall`, `fms:DisssociateThirdPartyFirewall`
Un atacante con los permisos **`fms:AssociateThirdPartyFirewall`**, **`fms:DisssociateThirdPartyFirewall`** podr칤a asociar o disociar firewalls de terceros para ser gestionados de forma centralizada a trav칠s de AWS Firewall Manager.
{% hint style="warning" %}
Solo el administrador predeterminado puede crear y gestionar firewalls de terceros.
{% endhint %}
```bash
aws fms associate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
aws fms disassociate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
```
**Impacto Potencial:** La disociaci칩n llevar칤a a una evasi칩n de pol칤ticas, violaciones de cumplimiento y la interrupci칩n de los controles de seguridad dentro del entorno. Por otro lado, la asociaci칩n llevar칤a a una interrupci칩n de la asignaci칩n de costos y presupuesto.

### `fms:TagResource`, `fms:UntagResource`

Un atacante podr칤a agregar, modificar o eliminar etiquetas de los recursos de Firewall Manager, interrumpiendo la asignaci칩n de costos, el seguimiento de recursos y las pol칤ticas de control de acceso de su organizaci칩n basadas en etiquetas.
```bash
aws fms tag-resource --resource-arn <value> --tag-list <value>
aws fms untag-resource --resource-arn <value> --tag-keys <value>
```
**Impacto potencial**: Disrupci칩n de la asignaci칩n de costos, seguimiento de recursos y pol칤ticas de control de acceso basadas en etiquetas.

## Referencias

* [https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html](https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html)
* [https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html](https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html)

<details>

<summary><strong>Aprende hacking en AWS de cero a h칠roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** 춰Consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop)!
* Obt칠n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
