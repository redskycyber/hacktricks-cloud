# AWS - Macie æšä¸¾

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸º</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS çº¢é˜Ÿä¸“å®¶)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³åœ¨ **HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š** æˆ– **ä¸‹è½½HackTricksçš„PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

# Macie

Amazon Macie æ˜¯ä¸€ä¸ªæ—¨åœ¨**è‡ªåŠ¨æ£€æµ‹ã€åˆ†ç±»å’Œè¯†åˆ«**AWSè´¦æˆ·ä¸­æ•°æ®çš„æœåŠ¡ã€‚å®ƒåˆ©ç”¨**æœºå™¨å­¦ä¹ **ä¸æ–­ç›‘æ§å’Œåˆ†ææ•°æ®ï¼Œä¸»è¦å…³æ³¨é€šè¿‡æ£€æŸ¥**äº‘è¿¹äº‹ä»¶**æ•°æ®å’Œç”¨æˆ·è¡Œä¸ºæ¨¡å¼æ¥æ£€æµ‹å’Œè­¦å‘Šä¸å¯»å¸¸æˆ–å¯ç–‘æ´»åŠ¨ã€‚

Amazon Macieçš„å…³é”®ç‰¹æ€§ï¼š

1. **ä¸»åŠ¨æ•°æ®å®¡æŸ¥**ï¼šä½¿ç”¨æœºå™¨å­¦ä¹ åœ¨AWSè´¦æˆ·å†…å‘ç”Ÿå„ç§æ“ä½œæ—¶ä¸»åŠ¨å®¡æŸ¥æ•°æ®ã€‚
2. **å¼‚å¸¸æ£€æµ‹**ï¼šè¯†åˆ«ä¸è§„åˆ™æ´»åŠ¨æˆ–è®¿é—®æ¨¡å¼ï¼Œç”Ÿæˆè­¦æŠ¥ä»¥å‡è½»æ½œåœ¨çš„æ•°æ®æš´éœ²é£é™©ã€‚
3. **æŒç»­ç›‘æ§**ï¼šè‡ªåŠ¨ç›‘æ§å¹¶æ£€æµ‹Amazon S3ä¸­çš„æ–°æ•°æ®ï¼Œä½¿ç”¨æœºå™¨å­¦ä¹ å’Œäººå·¥æ™ºèƒ½éšæ—¶é—´é€‚åº”æ•°æ®è®¿é—®æ¨¡å¼ã€‚
4. **ä½¿ç”¨NLPçš„æ•°æ®åˆ†ç±»**ï¼šåˆ©ç”¨è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰æ¥åˆ†ç±»å’Œè§£é‡Šä¸åŒæ•°æ®ç±»å‹ï¼Œåˆ†é…é£é™©è¯„åˆ†ä»¥ä¼˜å…ˆå¤„ç†å‘ç°ã€‚
5. **å®‰å…¨ç›‘æ§**ï¼šè¯†åˆ«å®‰å…¨æ•æ„Ÿæ•°æ®ï¼ŒåŒ…æ‹¬APIå¯†é’¥ã€å¯†é’¥å’Œä¸ªäººä¿¡æ¯ï¼Œå¸®åŠ©é˜²æ­¢æ•°æ®æ³„éœ²ã€‚

Amazon Macieæ˜¯ä¸€ä¸ª**åŒºåŸŸæ€§æœåŠ¡**ï¼Œéœ€è¦'AWSMacieServiceCustomerSetupRole' IAMè§’è‰²å’Œå¯ç”¨çš„AWS CloudTrailæ‰èƒ½æ­£å¸¸å·¥ä½œã€‚

## è­¦æŠ¥ç³»ç»Ÿ

Macieå°†è­¦æŠ¥åˆ†ç±»ä¸ºé¢„å®šä¹‰çš„ç±»åˆ«ï¼Œå¦‚ï¼š

- åŒ¿åè®¿é—®
- æ•°æ®åˆè§„æ€§
- å‡­è¯ä¸¢å¤±
- æƒé™æå‡
- å‹’ç´¢è½¯ä»¶
- å¯ç–‘è®¿é—®ç­‰ã€‚

è¿™äº›è­¦æŠ¥æä¾›è¯¦ç»†æè¿°å’Œç»“æœåˆ†è§£ï¼Œä»¥ä¾¿æœ‰æ•ˆå“åº”å’Œè§£å†³ã€‚

## ä»ªè¡¨æ¿ç‰¹æ€§

ä»ªè¡¨æ¿å°†æ•°æ®åˆ†ç±»ä¸ºä¸åŒéƒ¨åˆ†ï¼ŒåŒ…æ‹¬ï¼š

- S3å¯¹è±¡ï¼ˆæŒ‰æ—¶é—´èŒƒå›´ã€ACLã€PIIï¼‰
- é«˜é£é™©CloudTrailäº‹ä»¶/ç”¨æˆ·
- æ´»åŠ¨ä½ç½®
- CloudTrailç”¨æˆ·èº«ä»½ç±»å‹ç­‰ã€‚

## ç”¨æˆ·åˆ†ç±»

æ ¹æ®APIè°ƒç”¨çš„é£é™©çº§åˆ«ï¼Œå°†ç”¨æˆ·åˆ†ç±»ä¸ºä¸åŒç­‰çº§ï¼š

- **ç™½é‡‘**ï¼šé«˜é£é™©APIè°ƒç”¨ï¼Œé€šå¸¸å…·æœ‰ç®¡ç†å‘˜æƒé™ã€‚
- **é»„é‡‘**ï¼šä¸åŸºç¡€è®¾æ–½ç›¸å…³çš„APIè°ƒç”¨ã€‚
- **ç™½é“¶**ï¼šä¸­ç­‰é£é™©APIè°ƒç”¨ã€‚
- **é’é“œ**ï¼šä½é£é™©APIè°ƒç”¨ã€‚

## èº«ä»½ç±»å‹

èº«ä»½ç±»å‹åŒ…æ‹¬æ ¹ç”¨æˆ·ã€IAMç”¨æˆ·ã€å‡å®šè§’è‰²ã€è”åˆç”¨æˆ·ã€AWSè´¦æˆ·å’ŒAWSæœåŠ¡ï¼ŒæŒ‡ç¤ºè¯·æ±‚çš„æ¥æºã€‚

## æ•°æ®åˆ†ç±»

æ•°æ®åˆ†ç±»åŒ…æ‹¬ï¼š

- å†…å®¹ç±»å‹ï¼šåŸºäºæ£€æµ‹åˆ°çš„å†…å®¹ç±»å‹ã€‚
- æ–‡ä»¶æ‰©å±•åï¼šåŸºäºæ–‡ä»¶æ‰©å±•åã€‚
- ä¸»é¢˜ï¼šæ ¹æ®æ–‡ä»¶ä¸­çš„å…³é”®è¯åˆ†ç±»ã€‚
- æ­£åˆ™è¡¨è¾¾å¼ï¼šåŸºäºç‰¹å®šæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼åˆ†ç±»ã€‚

è¿™äº›ç±»åˆ«ä¸­çš„æœ€é«˜é£é™©å†³å®šäº†æ–‡ä»¶çš„æœ€ç»ˆé£é™©çº§åˆ«ã€‚

## ç ”ç©¶å’Œåˆ†æ

Amazon Macieçš„ç ”ç©¶åŠŸèƒ½å…è®¸å¯¹æ‰€æœ‰Macieæ•°æ®è¿›è¡Œè‡ªå®šä¹‰æŸ¥è¯¢ï¼Œè¿›è¡Œæ·±å…¥åˆ†æã€‚è¿‡æ»¤å™¨åŒ…æ‹¬CloudTrailæ•°æ®ã€S3å­˜å‚¨æ¡¶å±æ€§å’ŒS3å¯¹è±¡ã€‚æ­¤å¤–ï¼Œå®ƒæ”¯æŒé‚€è¯·å…¶ä»–è´¦æˆ·å…±äº«Amazon Macieï¼Œä¿ƒè¿›åä½œæ•°æ®ç®¡ç†å’Œå®‰å…¨ç›‘æ§ã€‚


## æšä¸¾
```
# Get buckets
aws macie2 describe-buckets

# Org config
aws macie2 describe-organization-configuration

# Get admin account (if any)
aws macie2 get-administrator-account
aws macie2 list-organization-admin-accounts # Run from the management account of the org

# Get macie account members (run this form the admin account)
aws macie2 list-members

# Check if automated sensitive data discovey is enabled
aws macie2 get-automated-discovery-configuration

# Get findings
aws macie2 list-findings
aws macie2 get-findings --finding-ids <ids>
aws macie2 list-findings-filters
aws macie2 get -findings-filters --id <id>

# Get allow lists
aws macie2 list-allow-lists
aws macie2 get-allow-list --id <id>

# Get different info
aws macie2 list-classification-jobs
aws macie2 list-classification-scopes
aws macie2 list-custom-data-identifiers
```
### åæ¸—é€

{% hint style="success" %}
ä»æ”»å‡»è€…çš„è§’åº¦æ¥çœ‹ï¼Œè¿™é¡¹æœåŠ¡å¹¶ä¸æ˜¯ä¸ºäº†æ£€æµ‹æ”»å‡»è€…ï¼Œè€Œæ˜¯ä¸ºäº†æ£€æµ‹å­˜å‚¨æ–‡ä»¶ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚å› æ­¤ï¼Œè¿™é¡¹æœåŠ¡å¯èƒ½ä¼š**å¸®åŠ©æ”»å‡»è€…åœ¨å­˜å‚¨æ¡¶ä¸­æ‰¾åˆ°æ•æ„Ÿä¿¡æ¯**ã€‚\
ç„¶è€Œï¼Œæ”»å‡»è€…ä¹Ÿå¯èƒ½å¯¹ç ´åå®ƒæ„Ÿå…´è¶£ï¼Œä»¥é˜²æ­¢å—å®³è€…æ”¶åˆ°è­¦æŠ¥ï¼Œä»è€Œæ›´å®¹æ˜“åœ°çªƒå–é‚£äº›ä¿¡æ¯ã€‚
{% endhint %}

TODO: æ¬¢è¿æäº¤PRï¼

# å‚è€ƒèµ„æ–™
* [https://cloudacademy.com/blog/introducing-aws-security-hub/](https://cloudacademy.com/blog/introducing-aws-security-hub/)

<details>

<summary><strong>é€šè¿‡</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS çº¢é˜Ÿä¸“å®¶)</strong></a><strong>ä»é›¶åˆ°è‹±é›„å­¦ä¹ AWSé»‘å®¢æ”»å‡»ï¼</strong></summary>

å…¶ä»–æ”¯æŒHackTricksçš„æ–¹å¼ï¼š

* å¦‚æœä½ æƒ³åœ¨**HackTricksä¸­çœ‹åˆ°ä½ çš„å…¬å¸å¹¿å‘Š**æˆ–**ä¸‹è½½HackTricksçš„PDFç‰ˆæœ¬**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹çš„PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥**åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚

</details>
