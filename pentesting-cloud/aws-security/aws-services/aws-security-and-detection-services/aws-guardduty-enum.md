# AWS - GuardDuty æšä¸¾

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹  AWS é»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS çº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨ HackTricks ä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½ PDF ç‰ˆæœ¬çš„ HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[NFT](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Šå…³æ³¨æˆ‘ä»¬ ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## GuardDuty

æ ¹æ®[**æ–‡æ¡£**](https://aws.amazon.com/guardduty/features/)ï¼šGuardDuty ç»“åˆäº†**æœºå™¨å­¦ä¹ ã€å¼‚å¸¸æ£€æµ‹ã€ç½‘ç»œç›‘æ§å’Œæ¶æ„æ–‡ä»¶å‘ç°**ï¼Œåˆ©ç”¨ AWS å’Œè¡Œä¸šé¢†å…ˆçš„ç¬¬ä¸‰æ–¹æ¥æºï¼Œå¸®åŠ©ä¿æŠ¤ AWS ä¸Šçš„å·¥ä½œè´Ÿè½½å’Œæ•°æ®ã€‚GuardDuty èƒ½å¤Ÿåˆ†ææ•°åäº¿ä¸ªäº‹ä»¶ï¼Œæ¶µç›–å¤šä¸ª AWS æ•°æ®æºï¼Œå¦‚ AWS CloudTrail äº‹ä»¶æ—¥å¿—ã€Amazon Virtual Private Cloud (VPC) æµæ—¥å¿—ã€Amazon Elastic Kubernetes Service (EKS) å®¡è®¡å’Œç³»ç»Ÿçº§æ—¥å¿—ï¼Œä»¥åŠ DNS æŸ¥è¯¢æ—¥å¿—ã€‚

Amazon GuardDuty **è¯†åˆ«è´¦æˆ·å†…çš„å¼‚å¸¸æ´»åŠ¨**ï¼Œåˆ†ææ´»åŠ¨çš„**å®‰å…¨ç›¸å…³æ€§**ï¼Œå¹¶æä¾›è°ƒç”¨æ´»åŠ¨çš„**ä¸Šä¸‹æ–‡**ã€‚è¿™ä½¿å¾—å“åº”è€…å¯ä»¥ç¡®å®šæ˜¯å¦åº”èŠ±æ—¶é—´è¿›è¡Œè¿›ä¸€æ­¥è°ƒæŸ¥ã€‚

è­¦æŠ¥**ä¼šå‡ºç°åœ¨ GuardDuty æ§åˆ¶å°ï¼ˆ90 å¤©ï¼‰**å’Œ CloudWatch äº‹ä»¶ä¸­ã€‚

{% hint style="warning" %}
å½“ç”¨æˆ·**ç¦ç”¨ GuardDuty** æ—¶ï¼Œå®ƒå°†åœæ­¢ç›‘è§†æ‚¨çš„ AWS ç¯å¢ƒï¼Œå¹¶ä¸”ä¸ä¼šç”Ÿæˆä»»ä½•æ–°çš„å‘ç°ï¼Œ**ç°æœ‰çš„å‘ç°å°†ä¸¢å¤±**ã€‚\
å¦‚æœåªæ˜¯åœæ­¢å®ƒï¼Œç°æœ‰çš„å‘ç°å°†ä¿ç•™ã€‚
{% endhint %}

### å‘ç°ç¤ºä¾‹

* **ä¾¦å¯Ÿ**ï¼šæ´»åŠ¨è¡¨æ˜æ”»å‡»è€…è¿›è¡Œä¾¦å¯Ÿï¼Œå¦‚**å¼‚å¸¸çš„ API æ´»åŠ¨**ã€å¯ç–‘çš„æ•°æ®åº“**ç™»å½•**å°è¯•ã€VPC å†…éƒ¨**ç«¯å£æ‰«æ**ã€å¼‚å¸¸çš„ç™»å½•è¯·æ±‚å¤±è´¥æ¨¡å¼ï¼Œæˆ–æ¥è‡ªå·²çŸ¥æ¶æ„ IP çš„æœªé˜»æ­¢ç«¯å£æ¢æµ‹ã€‚
* **å®ä¾‹è¢«å…¥ä¾µ**ï¼šè¡¨æ˜å®ä¾‹è¢«å…¥ä¾µçš„æ´»åŠ¨ï¼Œå¦‚**åŠ å¯†è´§å¸æŒ–çŸ¿ã€åé—¨å‘½ä»¤å’Œæ§åˆ¶ (C\&C)** æ´»åŠ¨ã€ä½¿ç”¨åŸŸç”Ÿæˆç®—æ³• (DGA) çš„æ¶æ„è½¯ä»¶ã€å‡ºç«™æ‹’ç»æœåŠ¡æ´»åŠ¨ã€å¼‚å¸¸**é«˜ç½‘ç»œ**æµé‡é‡ã€å¼‚å¸¸çš„ç½‘ç»œåè®®ã€å®ä¾‹ä¸å·²çŸ¥æ¶æ„ IP çš„å‡ºç«™é€šä¿¡ã€å¤–éƒ¨ IP åœ°å€ä½¿ç”¨çš„ä¸´æ—¶ Amazon EC2 å‡­è¯ï¼Œä»¥åŠä½¿ç”¨ DNS è¿›è¡Œæ•°æ®å¤–æ³„ã€‚
* **è´¦æˆ·è¢«å…¥ä¾µ**ï¼šè¡¨æ˜è´¦æˆ·è¢«å…¥ä¾µçš„å¸¸è§æ¨¡å¼åŒ…æ‹¬æ¥è‡ªå¼‚å¸¸åœ°ç†ä½ç½®æˆ–åŒ¿åä»£ç†çš„ API è°ƒç”¨ã€å°è¯•ç¦ç”¨ AWS CloudTrail æ—¥å¿—è®°å½•ã€å‰Šå¼±è´¦æˆ·å¯†ç ç­–ç•¥çš„æ›´æ”¹ã€å¼‚å¸¸çš„å®ä¾‹æˆ–åŸºç¡€è®¾æ–½å¯åŠ¨ã€åœ¨å¼‚å¸¸åŒºåŸŸéƒ¨ç½²åŸºç¡€è®¾æ–½ã€å‡­è¯ç›—çªƒã€å¯ç–‘çš„æ•°æ®åº“ç™»å½•æ´»åŠ¨ï¼Œä»¥åŠæ¥è‡ªå·²çŸ¥æ¶æ„ IP åœ°å€çš„ API è°ƒç”¨ã€‚
* **å­˜å‚¨æ¡¶è¢«å…¥ä¾µ**ï¼šè¡¨æ˜å­˜å‚¨æ¡¶è¢«å…¥ä¾µçš„æ´»åŠ¨ï¼Œå¦‚æ˜¾ç¤ºå‡ºè¯ä¹¦è¢«æ»¥ç”¨çš„å¯ç–‘æ•°æ®è®¿é—®æ¨¡å¼ã€æ¥è‡ªè¿œç¨‹ä¸»æœºçš„å¼‚å¸¸ Amazon S3 API æ´»åŠ¨ã€æ¥è‡ªå·²çŸ¥æ¶æ„ IP åœ°å€çš„æœªç»æˆæƒçš„ S3 è®¿é—®ï¼Œä»¥åŠä»ä»¥å‰æœªè®¿é—®è¿‡è¯¥å­˜å‚¨æ¡¶çš„ç”¨æˆ·æˆ–ä»å¼‚å¸¸ä½ç½®è°ƒç”¨çš„ç”¨æˆ·æ£€ç´¢ S3 å­˜å‚¨æ¡¶ä¸­çš„æ•°æ®çš„ API è°ƒç”¨ã€‚Amazon GuardDuty æŒç»­ç›‘è§†å’Œåˆ†æ AWS CloudTrail S3 æ•°æ®äº‹ä»¶ï¼ˆä¾‹å¦‚ GetObjectã€ListObjectsã€DeleteObjectï¼‰ä»¥æ£€æµ‹æ‰€æœ‰ Amazon S3 å­˜å‚¨æ¡¶ä¸­çš„å¯ç–‘æ´»åŠ¨ã€‚

<details>

<summary>å‘ç°ä¿¡æ¯</summary>

å‘ç°æ‘˜è¦ï¼š

* å‘ç°ç±»å‹
* ä¸¥é‡æ€§ï¼š7-8.9 é«˜ï¼Œ4-6.9 ä¸­ï¼Œ01-3.9 ä½
* åŒºåŸŸ
* è´¦æˆ· ID
* èµ„æº ID
* æ£€æµ‹æ—¶é—´
* ä½¿ç”¨çš„å¨èƒåˆ—è¡¨

æ­£æ–‡åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š

* å—å½±å“èµ„æº
* æ“ä½œ
* æ“ä½œè€…ï¼šIP åœ°å€ã€ç«¯å£å’ŒåŸŸ
* é™„åŠ ä¿¡æ¯

</details>

### æ‰€æœ‰å‘ç°

è®¿é—®ä»¥ä¸‹é“¾æ¥æŸ¥çœ‹æ‰€æœ‰ GuardDuty å‘ç°ï¼š[https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-active.html](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-active.html)

### å¤šè´¦æˆ·

#### é‚€è¯·æ–¹å¼

æ‚¨å¯ä»¥**é‚€è¯·å…¶ä»–è´¦æˆ·**åŠ å…¥ä¸åŒçš„ AWS GuardDuty è´¦æˆ·ï¼Œä»¥ä¾¿**æ¯ä¸ªè´¦æˆ·éƒ½ä»åŒä¸€ä¸ª GuardDuty è¿›è¡Œç›‘æ§**ã€‚ä¸»è´¦æˆ·å¿…é¡»é‚€è¯·æˆå‘˜è´¦æˆ·ï¼Œç„¶åæˆå‘˜è´¦æˆ·çš„ä»£è¡¨å¿…é¡»æ¥å—é‚€è¯·ã€‚

#### é€šè¿‡ç»„ç»‡

æ‚¨å¯ä»¥æŒ‡å®šç»„ç»‡å†…çš„ä»»ä½•è´¦æˆ·ä¸º**GuardDuty å§”æ´¾ç®¡ç†å‘˜**ã€‚åªæœ‰ç»„ç»‡ç®¡ç†è´¦æˆ·å¯ä»¥æŒ‡å®šå§”æ´¾ç®¡ç†å‘˜ã€‚

è¢«æŒ‡å®šä¸ºå§”æ´¾ç®¡ç†å‘˜çš„è´¦æˆ·å°†æˆä¸º GuardDuty ç®¡ç†å‘˜è´¦æˆ·ï¼Œåœ¨æŒ‡å®šçš„ AWS åŒºåŸŸä¸­è‡ªåŠ¨å¯ç”¨ GuardDutyï¼Œå¹¶ä¸”è¿˜å…·æœ‰**å¯ç”¨å’Œç®¡ç†è¯¥åŒºåŸŸå†…æ‰€æœ‰ç»„ç»‡è´¦æˆ·çš„ GuardDuty æƒé™**ã€‚ç»„ç»‡ä¸­çš„å…¶ä»–è´¦æˆ·å¯ä»¥è¢«è§†ä¸ºä¸æ­¤å§”æ´¾ç®¡ç†å‘˜è´¦æˆ·å…³è”çš„ GuardDuty æˆå‘˜è´¦æˆ·ï¼Œå¹¶åŠ å…¥å…¶ä¸­ã€‚

## æšä¸¾

{% code overflow="wrap" %}
```bash
# Get Org config
aws guardduty list-organization-admin-accounts #Get Delegated Administrator
aws guardduty describe-organization-configuration --detector-id <id>

# Check external invitations
aws guardduty list-invitations
aws guardduty get-invitations-count

# Detector Information
aws guardduty list-detectors # 1 detector per account with GuardDuty
aws guardduty get-detector --detector-id <id> # Get detector info
aws guardduty get-master-account --detector-id <id>

# Get filters
aws guardduty list-filters --detector-id <id> # Check filters
aws guardduty get-filter --detector-id <id> --filter-name <name>

# Findings
aws guardduty list-findings --detector-id <id> # List findings
aws guardduty get-findings --detector-id <id> --finding-ids <id> # Get details about the finding
aws guardduty get-findings-statistics --detector-id <id> --finding-statistic-types <types>

# Get trusted IP addresses
aws guardduty list-ip-sets --detector-id <id>
aws guardduty get-ip-set --detector-id <id>

# Member accounts of the current AWS GuardDuty master account
aws guardduty list-members --detector-id <id>
aws guardduty get-members --detector-id <id> --account-ids <id>
aws guardduty get-member-detectors --detector-id <id> --account-ids <id>

# Continuously export its findings to an Amazon S3 bucket
aws guardduty list-publishing-destinations --detector-id <id>

# Intelligence sets that you have uploaded to GuardDuty
aws guardduty list-threat-intel-sets --detector-id <id>
aws guardduty get-threat-intel-set --detector-id <id> --threat-intel-set-id <id>
```
## GuardDutyç»•è¿‡

### ä¸€èˆ¬æŒ‡å¯¼

å°½é‡äº†è§£å°†è¦ä½¿ç”¨çš„å‡­æ®çš„è¡Œä¸ºï¼š

- ä½¿ç”¨æ¬¡æ•°
- ä½ç½®
- ç”¨æˆ·ä»£ç†/æœåŠ¡ï¼ˆå¯èƒ½æ˜¯ä»awscliã€webconsoleã€lambdaç­‰ä½¿ç”¨ï¼‰
- å¸¸ç”¨æƒé™

æœ‰äº†è¿™äº›ä¿¡æ¯ï¼Œå°½é‡é‡æ–°åˆ›å»ºç›¸åŒçš„åœºæ™¯æ¥ä½¿ç”¨è¿™äº›è®¿é—®æƒé™ï¼š

- å¦‚æœæ˜¯**ç”¨æˆ·æˆ–ç”¨æˆ·è®¿é—®çš„è§’è‰²**ï¼Œå°è¯•åœ¨ç›¸åŒçš„æ—¶é—´æ®µä½¿ç”¨ï¼Œæ¥è‡ªç›¸åŒçš„åœ°ç†ä½ç½®ï¼ˆç”šè‡³æ˜¯ç›¸åŒçš„ISPå’ŒIPï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼‰
- å¦‚æœæ˜¯**æœåŠ¡ä½¿ç”¨çš„è§’è‰²**ï¼Œåœ¨ç›¸åŒçš„åŒºåŸŸåˆ›å»ºç›¸åŒçš„æœåŠ¡ï¼Œå¹¶åœ¨ç›¸åŒçš„æ—¶é—´èŒƒå›´å†…ä½¿ç”¨
- æ€»æ˜¯å°è¯•ä½¿ç”¨è¿™ä¸ªä¸»ä½“å·²ç»ä½¿ç”¨è¿‡çš„**ç›¸åŒæƒé™**
- å¦‚æœéœ€è¦**ä½¿ç”¨å…¶ä»–æƒé™æˆ–æ»¥ç”¨æƒé™**ï¼ˆä¾‹å¦‚ï¼Œä¸‹è½½1,000,000ä¸ªcloudtrailæ—¥å¿—æ–‡ä»¶ï¼‰ï¼Œè¯·**æ…¢æ…¢æ¥**ï¼Œå¹¶ä¸”ä¸AWSçš„**æœ€å°‘äº¤äº’**ï¼ˆæœ‰æ—¶awscliåœ¨å†™å…¥ä¹‹å‰ä¼šè°ƒç”¨å¤šä¸ªè¯»å–APIï¼‰

### çªç ´GuardDuty

#### `guardduty:UpdateDetector`

æ‹¥æœ‰æ­¤æƒé™å¯ä»¥ç¦ç”¨GuardDutyä»¥é¿å…è§¦å‘è­¦æŠ¥ã€‚

{% code overflow="wrap" %}
```bash
aws guardduty update-detector --detector-id <detector-id> --no-enable
aws guardduty update-detector --detector-id <detector-id> --data-sources S3Logs={Enable=false}
```
{% endcode %}

#### `guardduty:CreateFilter`

æ‹¥æœ‰æ­¤æƒé™çš„æ”»å‡»è€…å¯ä»¥**ä½¿ç”¨è¿‡æ»¤å™¨è‡ªåŠ¨**å­˜æ¡£å‘ç°ï¼š
```bash
aws guardduty create-filter  --detector-id <detector-id> --name <filter-name> --finding-criteria file:///tmp/criteria.json --action ARCHIVE
```
#### `iam:PutRolePolicy`, (`guardduty:CreateIPSet`|`guardduty:UpdateIPSet`)

æ”»å‡»è€…å¦‚æœæ‹¥æœ‰ä¸Šè¿°æƒé™ï¼Œåˆ™å¯ä»¥é€šè¿‡å°†å…¶IPåœ°å€æ·»åŠ åˆ°å…¶ä¸­æ¥ä¿®æ”¹GuardDutyçš„[**å—ä¿¡ä»»IPåˆ—è¡¨**](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_upload-lists.html)ï¼Œä»è€Œé¿å…ç”Ÿæˆè­¦æŠ¥ã€‚

{% code overflow="wrap" %}
```bash
aws guardduty update-ip-set --detector-id <detector-id> --activate --ip-set-id <ip-set-id> --location https://some-bucket.s3-eu-west-1.amazonaws.com/attacker.csv
```
{% endcode %}

#### `guardduty:DeletePublishingDestination`

æ”»å‡»è€…å¯ä»¥ç§»é™¤ç›®çš„åœ°ä»¥é˜²æ­¢è­¦æŠ¥ï¼š 

{% code overflow="wrap" %}
```bash
aws guardduty delete-publishing-destination --detector-id <detector-id> --destination-id <dest-id>
```
{% endcode %}

{% hint style="danger" %}
åˆ é™¤æ­¤å‘å¸ƒç›®çš„åœ°**ä¸ä¼šå½±å“ GuardDuty æ§åˆ¶å°ä¸­çš„å‘ç°ç”Ÿæˆæˆ–å¯è§æ€§**ã€‚GuardDuty å°†ç»§ç»­åˆ†ææ‚¨çš„ AWS ç¯å¢ƒä¸­çš„äº‹ä»¶ï¼Œè¯†åˆ«å¯ç–‘æˆ–æ„å¤–è¡Œä¸ºï¼Œå¹¶ç”Ÿæˆå‘ç°ã€‚
{% endhint %}

### ç‰¹å®šå‘ç°ç»•è¿‡ç¤ºä¾‹

è¯·æ³¨æ„ï¼ŒGuardDuty æœ‰æ•°åä¸ªå‘ç°ï¼Œ**ä½œä¸ºçº¢é˜Ÿäººå‘˜ï¼Œå¹¶éæ‰€æœ‰å‘ç°éƒ½ä¼šå½±å“æ‚¨**ï¼Œæ›´å¥½çš„æ˜¯ï¼Œæ‚¨å¯ä»¥åœ¨[https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-active.html](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-active.html)ä¸­æ‰¾åˆ°æ¯ä¸ªå‘ç°çš„**å®Œæ•´æ–‡æ¡£**ï¼Œåœ¨é‡‡å–ä»»ä½•æ“ä½œä¹‹å‰ï¼Œè¯·æŸ¥çœ‹ä»¥é¿å…è¢«å‘ç°ã€‚

ä»¥ä¸‹æ˜¯å‡ ä¸ªç‰¹å®š GuardDuty å‘ç°ç»•è¿‡ç¤ºä¾‹ï¼š

#### [PenTest:IAMUser/KaliLinux](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-iam.html#pentest-iam-kalilinux) <a href="#pentest-iam-kalilinux" id="pentest-iam-kalilinux"></a>

GuardDuty æ£€æµ‹å¸¸è§æ¸—é€æµ‹è¯•å·¥å…·å‘å‡ºçš„ AWS API è¯·æ±‚ï¼Œå¹¶è§¦å‘ [PenTest Finding](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-iam.html#pentest-iam-kalilinux)ã€‚\
å®ƒæ˜¯é€šè¿‡ API è¯·æ±‚ä¸­ä¼ é€’çš„**ç”¨æˆ·ä»£ç†åç§°**æ¥æ£€æµ‹çš„ã€‚\
å› æ­¤ï¼Œ**ä¿®æ”¹ç”¨æˆ·ä»£ç†**å¯ä»¥é˜²æ­¢ GuardDuty æ£€æµ‹åˆ°æ”»å‡»ã€‚

ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µï¼Œæ‚¨å¯ä»¥ä» `botocore` åŒ…ä¸­çš„ `session.py` è„šæœ¬ä¸­æœç´¢å¹¶ä¿®æ”¹ç”¨æˆ·ä»£ç†ï¼Œæˆ–è€…å°† Burp Suite è®¾ç½®ä¸º AWS CLI ä»£ç†å¹¶ä½¿ç”¨ MitM æ›´æ”¹ç”¨æˆ·ä»£ç†ï¼Œæˆ–è€…åªéœ€ä½¿ç”¨ Ubuntuã€Mac æˆ– Windows ç­‰æ“ä½œç³»ç»Ÿå³å¯é˜²æ­¢æ­¤è­¦æŠ¥è§¦å‘ã€‚

#### UnauthorizedAccess:IAMUser/InstanceCredentialExfiltration

ä»å…ƒæ•°æ®æœåŠ¡ä¸­æå– EC2 å‡­æ®å¹¶**åœ¨ AWS ç¯å¢ƒå¤–éƒ¨ä½¿ç”¨**è¿™äº›å‡­æ®ä¼šè§¦å‘ [**`UnauthorizedAccess:IAMUser/InstanceCredentialExfiltration.OutsideAWS`**](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-iam.html#unauthorizedaccess-iam-instancecredentialexfiltrationoutsideaws) è­¦æŠ¥ã€‚ç›¸åï¼Œä»æ‚¨çš„ EC2 å®ä¾‹ä¸­ä½¿ç”¨è¿™äº›å‡­æ®ä¼šè§¦å‘ [**`UnauthorizedAccess:IAMUser/InstanceCredentialExfiltration.InsideAWS`**](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-iam.html#unauthorizedaccess-iam-instancecredentialexfiltrationinsideaws) è­¦æŠ¥ã€‚ç„¶è€Œï¼Œ**åœ¨åŒä¸€å¸æˆ·ä¸­çš„å¦ä¸€ä¸ªå—æŸ EC2 å®ä¾‹ä¸Šä½¿ç”¨å‡­æ®ä¸ä¼šè¢«æ£€æµ‹åˆ°**ï¼Œä¸ä¼šå¼•å‘è­¦æŠ¥ã€‚

{% hint style="success" %}
å› æ­¤ï¼Œ**è¯·åœ¨å‘ç°å‡­æ®çš„æœºå™¨å†…éƒ¨ä½¿ç”¨è¢«æå–çš„å‡­æ®**ï¼Œä»¥é¿å…è§¦å‘æ­¤è­¦æŠ¥ã€‚
{% endhint %}

## å‚è€ƒèµ„æ–™

* [https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-active.html](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-active.html)
* [https://docs.aws.amazon.com/guardduty/latest/ug/findings\_suppression-rule.html](https://docs.aws.amazon.com/guardduty/latest/ug/findings\_suppression-rule.html)
* [https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_upload-lists.html](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_upload-lists.html)
* [https://docs.aws.amazon.com/cli/latest/reference/guardduty/delete-publishing-destination.html](https://docs.aws.amazon.com/cli/latest/reference/guardduty/delete-publishing-destination.html)
* [https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-ec2.html#unauthorizedaccess-ec2-torclient](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-ec2.html#unauthorizedaccess-ec2-torclient)
* [https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-iam.html#unauthorizedaccess-iam-instancecredentialexfiltrationoutsideaws](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-iam.html#unauthorizedaccess-iam-instancecredentialexfiltrationoutsideaws)
* [https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-iam.html#unauthorizedaccess-iam-instancecredentialexfiltrationinsideaws](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty\_finding-types-iam.html#unauthorizedaccess-iam-instancecredentialexfiltrationinsideaws)
* [https://docs.aws.amazon.com/whitepapers/latest/aws-privatelink/what-are-vpc-endpoints.html](https://docs.aws.amazon.com/whitepapers/latest/aws-privatelink/what-are-vpc-endpoints.html)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹  AWS é»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS çº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨ HackTricks ä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½ PDF ç‰ˆæœ¬çš„ HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)** ä¸Šå…³æ³¨æˆ‘ä»¬**ã€‚
* é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
