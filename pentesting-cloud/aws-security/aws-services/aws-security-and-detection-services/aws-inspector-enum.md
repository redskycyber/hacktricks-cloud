# AWS - Inspector Enum

<details>

<summary><strong>隆Apoya a HackTricks y obt茅n beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **煤ltima versi贸n de PEASS o descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop).
* Obt茅n el [**merchandising oficial de PEASS y HackTricks**](https://peass.creator-spring.com).
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family).
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm).

* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en GitHub.

</details>

## Inspector

El servicio Amazon Inspector es **basado en agentes**, lo que significa que requiere que se **instalen agentes de software en las instancias EC2** que deseas evaluar. Esto hace que sea un servicio f谩cil de configurar y agregar en cualquier momento a los recursos existentes que ya se ejecutan dentro de tu infraestructura de AWS. Esto ayuda a que Amazon Inspector se integre sin problemas con cualquiera de tus procesos y procedimientos de seguridad existentes como otro nivel de seguridad.

Estas son las pruebas que AWS Inspector te permite realizar:

* **CVEs**
* **CIS Benchmarks**
* **Mejores pr谩cticas de seguridad**
* **Alcance de la red**

Puedes ejecutar cualquiera de estas pruebas en las m谩quinas EC2 que elijas.

### Elemento de AWS Inspector

**Rol**: Crea o selecciona un rol para permitir que Amazon Inspector tenga acceso de solo lectura a las instancias EC2 (DescribeInstances)\
**Objetivos de evaluaci贸n**: Grupo de instancias EC2 en las que deseas ejecutar una evaluaci贸n\
**Agentes de AWS**: Agentes de software que deben instalarse en las instancias EC2 para monitorear. Los datos se env铆an a Amazon Inspector utilizando un canal TLS. El agente env铆a peri贸dicamente un latido al inspector solicitando instrucciones. Puede actualizarse autom谩ticamente\
**Plantillas de evaluaci贸n**: Define configuraciones espec铆ficas sobre c贸mo se ejecuta una evaluaci贸n en tus instancias EC2. Una plantilla de evaluaci贸n no se puede modificar despu茅s de su creaci贸n.

* Paquetes de reglas que se utilizar谩n
* Duraci贸n de la ejecuci贸n de la evaluaci贸n: 15 minutos / 1 hora / 8 horas
* Temas de SNS, selecciona cu谩ndo notificar: inicio, finalizaci贸n, cambio de estado, informe de un hallazgo
* Atributos asignados a los hallazgos

**Paquete de reglas**: Contiene una serie de reglas individuales que se verifican en una instancia EC2 cuando se ejecuta una evaluaci贸n. Cada una tambi茅n tiene una gravedad (alta, media, baja, informativa). Las posibilidades son:

* Vulnerabilidades y exposiciones comunes (CVEs)
* Centro de seguridad de Internet (CIS) Benchmark
* Mejores pr谩cticas de seguridad

Una vez que hayas configurado el Rol de Amazon Inspector, instalado los Agentes de AWS, configurado el objetivo y configurado la plantilla, podr谩s ejecutarlo. Una ejecuci贸n de evaluaci贸n se puede detener, reanudar o eliminar.

Amazon Inspector tiene un conjunto predefinido de reglas agrupadas en paquetes. Cada plantilla de evaluaci贸n define qu茅 paquetes de reglas se incluir谩n en la prueba. Las instancias se eval煤an en funci贸n de los paquetes de reglas incluidos en la plantilla de evaluaci贸n.

{% hint style="info" %}
Ten en cuenta que hoy en d铆a AWS ya te permite **crear autom谩ticamente** todas las **configuraciones** necesarias e incluso **instalar autom谩ticamente los agentes dentro de las instancias EC2**.
{% endhint %}

### **Informes**

**Telemetr铆a**: datos que se recopilan de una instancia, detallando su configuraci贸n, comportamiento y procesos durante una ejecuci贸n de evaluaci贸n. Una vez recopilados, los datos se env铆an a Amazon Inspector en tiempo casi real a trav茅s de TLS, donde se almacenan y cifran en S3 mediante una clave KMS ef铆mera. Luego, Amazon Inspector accede al bucket de S3, descifra los datos en memoria y los analiza con respecto a los paquetes de reglas utilizados para esa evaluaci贸n para generar los hallazgos.

**Informe de evaluaci贸n**: Proporciona detalles sobre lo que se evalu贸 y los resultados de la evaluaci贸n.

* El informe de **hallazgos** contiene el resumen de la evaluaci贸n, informaci贸n sobre la instancia EC2 y las reglas, y los hallazgos que ocurrieron.
* El **informe completo** es el informe de hallazgos + una lista de reglas que se aprobaron.

## Enumeraci贸n
```
# Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

# Get findings
aws inspector list-findings

# Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

# Rule packages
aws inspector list-rules-packages
```
### Post Explotaci贸n

{% hint style="success" %}
Desde la perspectiva de un atacante, este servicio puede ayudar al atacante a encontrar vulnerabilidades y exposiciones de red que podr铆an ayudarlo a comprometer otras instancias/contenedores.

Sin embargo, un atacante tambi茅n podr铆a estar interesado en interrumpir este servicio para que la v铆ctima no pueda ver las vulnerabilidades (todas o espec铆ficas).
{% endhint %}

TODO: Se aceptan PRs

<details>

<summary><strong>隆Apoya a HackTricks y obt茅n beneficios!</strong></summary>

* Si quieres ver tu **empresa anunciada en HackTricks** o si quieres acceder a la **煤ltima versi贸n de PEASS o descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop).
* Obt茅n el [**merchandising oficial de PEASS y HackTricks**](https://peass.creator-spring.com).
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family).
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en GitHub.

</details>
