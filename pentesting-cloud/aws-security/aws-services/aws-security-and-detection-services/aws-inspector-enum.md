# AWS - Inspector Enum

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Inspector

Usuga Amazon Inspector jest oparta na **agentach**, co oznacza, 偶e wymaga zainstalowania agent贸w oprogramowania na dowolnych instancjach EC2, kt贸re chcesz oceni. Sprawia to, 偶e jest to atwa usuga do skonfigurowania i dodania w dowolnym momencie do istniejcych zasob贸w ju偶 dziaajcych w Twojej infrastrukturze AWS. Pomaga to Amazon Inspectorowi sta si bezproblemow integracj z istniejcymi procesami i procedurami zwizanymi z bezpieczestwem.

Oto testy, kt贸re umo偶liwia wykonanie AWS Inspector:

* **CVEs**
* **CIS Benchmarks**
* **Najlepsze praktyki dotyczce bezpieczestwa**
* **Dostpno sieciowa**

Mo偶esz uruchomi dowolny z tych test贸w na maszynach EC2, kt贸re wybierzesz.

### Elementy AWS Inspector

**Rola**: Utw贸rz lub wybierz rol, kt贸ra umo偶liwi Amazon Inspectorowi dostp tylko do odczytu do instancji EC2 (DescribeInstances)\
**Cele oceny**: Grupa instancji EC2, na kt贸rych chcesz przeprowadzi ocen\
**Agenci AWS**: Agenci oprogramowania, kt贸re musz by zainstalowane na instancjach EC2 w celu monitorowania. Dane s wysyane do Amazon Inspector za pomoc kanau TLS. Regularnie wysyany jest sygna 偶ycia od agenta do inspektora, pytajc o instrukcje. Mo偶e automatycznie aktualizowa si\
**Szablony oceny**: Okrel konkretne konfiguracje dotyczce sposobu przeprowadzania oceny na instancjach EC2. Szablon oceny nie mo偶e by modyfikowany po utworzeniu.

* Pakiety regu do u偶ycia
* Czas trwania oceny: 15 minut/1 godzina/8 godzin
* Tematy SNS, wybierz, kiedy powiadamia: Rozpoczcie, zakoczenie, zmiana stanu, zgoszenie wynik贸w
* Atrybuty przypisane do wynik贸w

**Pakiet regu**: Zawiera wiele indywidualnych regu, kt贸re s sprawdzane podczas uruchamiania oceny na instancji EC2. Ka偶da z nich ma r贸wnie偶 stopie powagi (wysoki, redni, niski, informacyjny). Mo偶liwoci to:

* Wsp贸lne podatnoci i wystawienia (CVEs)
* Centrum Bezpieczestwa Internetowego (CIS) - Benchmark
* Najlepsze praktyki dotyczce bezpieczestwa

Po skonfigurowaniu roli Amazon Inspector, zainstalowaniu agent贸w AWS, skonfigurowaniu celu i skonfigurowaniu szablonu, bdziesz m贸g go uruchomi. Ocena mo偶e zosta zatrzymana, wznowiona lub usunita.

Amazon Inspector ma predefiniowany zestaw regu, pogrupowanych w paczki. Ka偶dy szablon oceny okrela, kt贸re pakiety regu maj by uwzgldnione w tecie. Instancje s oceniane na podstawie pakiet贸w regu zawartych w szablonie oceny.

{% hint style="info" %}
Nale偶y zauwa偶y, 偶e obecnie AWS pozwala ju偶 na **automatyczne tworzenie** wszystkich **konfiguracji** i nawet automatyczne **instalowanie agent贸w wewntrz instancji EC2**.
{% endhint %}

### **Raportowanie**

**Telemetria**: dane zbierane z instancji, szczeg贸owo opisujce jej konfiguracj, zachowanie i procesy podczas uruchomienia oceny. Po zebraniu danych s one wysyane z powrotem do Amazon Inspector w czasie zbli偶onym do rzeczywistego za pomoc protokou TLS, gdzie s przechowywane i szyfrowane na S3 za pomoc tymczasowego klucza KMS. Nastpnie Amazon Inspector uzyskuje dostp do kubeka S3, odszyfrowuje dane w pamici i analizuje je pod ktem pakiet贸w regu u偶ywanych w tej ocenie w celu wygenerowania wynik贸w.

**Raport z oceny**: Zapewnia szczeg贸y dotyczce tego, co zostao ocenione i wynik贸w oceny.

* Raport **wynik贸w** zawiera podsumowanie oceny, informacje o instancji EC2 i reguach oraz wynikach, kt贸re wystpiy.
* **Peny raport** to raport wynik贸w + lista regu, kt贸re zostay zaliczone.

## Wyliczanie
```
# Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

# Get findings
aws inspector list-findings

# Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

# Rule packages
aws inspector list-rules-packages
```
## Post Eksploatacja

{% hint style="success" %}
Z perspektywy atakujcego, ta usuga mo偶e pom贸c atakujcemu w znalezieniu podatnoci i nara偶e sieciowych, kt贸re mog pom贸c mu w kompromitacji innych instancji/kontener贸w.

Jednak atakujcy mo偶e r贸wnie偶 by zainteresowany zak贸ceniem tej usugi, aby ofiara nie moga zobaczy podatnoci (wszystkich lub konkretnych).
{% endhint %}

TODO: PRy s mile widziane

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
