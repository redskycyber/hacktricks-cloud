# AWS - Inspector Enum

<details>

<summary><strong>隆Apoya a HackTricks y obt茅n beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **煤ltima versi贸n de PEASS o descargar HackTricks en PDF** 隆Consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n de exclusivos [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Comparte tus trucos de hacking enviando PR a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en Github.

</details>

## Inspector

El servicio Amazon Inspector es **basado en agentes**, lo que significa que requiere que se **instalen agentes de software en cualquier instancia EC2** que desee evaluar. Esto hace que sea un servicio f谩cil de configurar y agregar en cualquier momento a los recursos existentes que ya se ejecutan dentro de su infraestructura de AWS. Esto ayuda a que Amazon Inspector se convierta en una integraci贸n perfecta con cualquiera de sus procesos y procedimientos de seguridad existentes como otro nivel de seguridad.

Estas son las pruebas que AWS Inspector le permite realizar:

* **CVEs**
* **CIS Benchmarks**
* **Mejores pr谩cticas de seguridad**
* **Alcance de la red**

Puede hacer que cualquiera de ellas se ejecute en las m谩quinas EC2 que decida.

### Elemento de AWS Inspector

**Rol**: Cree o seleccione un rol para permitir que Amazon Inspector tenga acceso de solo lectura a las instancias EC2 (DescribeInstances)\
**Objetivos de evaluaci贸n**: Grupo de instancias EC2 contra las que desea ejecutar una evaluaci贸n\
**Agentes de AWS**: Agentes de software que deben instalarse en las instancias EC2 para monitorear. Los datos se env铆an a Amazon Inspector utilizando un canal TLS. Se env铆a un latido de coraz贸n regular desde el agente al inspector solicitando instrucciones. Puede actualizarse autom谩ticamente\
**Plantillas de evaluaci贸n**: Defina configuraciones espec铆ficas sobre c贸mo se ejecuta una evaluaci贸n en sus instancias EC2. Una plantilla de evaluaci贸n no se puede modificar despu茅s de la creaci贸n.

* Paquetes de reglas a utilizar
* Duraci贸n de la ejecuci贸n de la evaluaci贸n 15min/1hora/8horas
* Temas de SNS, seleccione cu谩ndo notificar: Inicio, finalizaci贸n, cambio de estado, informes de hallazgos
* Atributos para asignar a los hallazgos

**Paquete de reglas**: Contiene una serie de reglas individuales que se verifican en una EC2 cuando se ejecuta una evaluaci贸n. Cada uno tambi茅n tiene una gravedad (alta, media, baja, informativa). Las posibilidades son:

* Vulnerabilidades y exposiciones comunes (CVEs)
* Centro de seguridad de Internet (CIS) Benchmark
* Mejores pr谩cticas de seguridad

Una vez que haya configurado el Rol de Amazon Inspector, se hayan instalado los Agentes de AWS, se haya configurado el objetivo y se haya configurado la plantilla, podr谩 ejecutarlo. Una ejecuci贸n de evaluaci贸n se puede detener, reanudar o eliminar.

Amazon Inspector tiene un conjunto predefinido de reglas, agrupadas en paquetes. Cada plantilla de evaluaci贸n define qu茅 paquetes de reglas se incluir谩n en la prueba. Las instancias se eval煤an en funci贸n de los paquetes de reglas incluidos en la plantilla de evaluaci贸n.

{% hint style="info" %}
Tenga en cuenta que hoy en d铆a AWS ya le permite **crear autom谩ticamente** todas las **configuraciones** necesarias e incluso **instalar autom谩ticamente los agentes dentro de las instancias EC2.**
{% endhint %}

### **Informes**

**Telemetr铆a**: datos que se recopilan de una instancia, detallando su configuraci贸n, comportamiento y procesos durante una ejecuci贸n de evaluaci贸n. Una vez recopilados, los datos se env铆an de vuelta a Amazon Inspector en tiempo casi real sobre TLS, donde se almacenan y cifran en S3 a trav茅s de una clave KMS ef铆mera. Luego, Amazon Inspector accede al bucket de S3, descifra los datos en memoria y los analiza en funci贸n de cualquier paquete de reglas utilizado para esa evaluaci贸n para generar los hallazgos.

**Informe de evaluaci贸n**: Proporciona detalles sobre lo que se evalu贸 y los resultados de la evaluaci贸n.

* El informe de **hallazgos** contiene el resumen de la evaluaci贸n, informaci贸n sobre EC2 y reglas y los hallazgos que ocurrieron.
* El **informe completo** es el informe de hallazgos + una lista de reglas que se aprobaron.

<details>

<summary><strong>隆Apoya a HackTricks y obt茅n beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **煤ltima versi贸n de PEASS o descargar HackTricks en PDF** 隆Consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n de exclusivos [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Comparte tus trucos de hacking enviando PR a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en Github.

</details>