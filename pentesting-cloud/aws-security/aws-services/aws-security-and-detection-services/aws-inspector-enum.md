# AWS - Inspector Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya HackTricks'i **PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)'Ä± **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>

## Inspector

Amazon Inspector hizmeti, **ajans tabanlÄ±** olduÄŸundan, deÄŸerlendirmek istediÄŸiniz herhangi bir EC2 Ã¶rneÄŸine **kurulu yazÄ±lÄ±m ajanslarÄ±nÄ±n gerektiÄŸini** gerektirir. Bu, mevcut AWS altyapÄ±nÄ±zda zaten Ã§alÄ±ÅŸan var olan kaynaklara herhangi bir noktada kolayca yapÄ±landÄ±rÄ±labilen ve eklenen bir hizmet olmasÄ±nÄ± saÄŸlar. Bu, Amazon Inspector'Ä±n mevcut gÃ¼venlik sÃ¼reÃ§leriniz ve prosedÃ¼rlerinizle sorunsuz bir entegrasyon haline gelmesine yardÄ±mcÄ± olur.

AWS Inspector ile yapabileceÄŸiniz testler ÅŸunlardÄ±r:

* **CVE'ler**
* **CIS Benchmarks**
* **GÃ¼venlik En Ä°yi UygulamalarÄ±**
* **AÄŸ EriÅŸilebilirliÄŸi**

Bu testlerden herhangi birini EC2 makinelerinde Ã§alÄ±ÅŸtÄ±rabilirsiniz.

### AWS Inspector'Ä±n ElemanlarÄ±

**Rol**: Amazon Inspector'Ä±n EC2 Ã¶rneklerine salt okunur eriÅŸime sahip olmasÄ±na izin vermek iÃ§in bir rol oluÅŸturun veya seÃ§in (DescribeInstances)\
**DeÄŸerlendirme Hedefleri**: Bir deÄŸerlendirme yapmak istediÄŸiniz EC2 Ã¶rneklerinin bir grubu\
**AWS ajanslarÄ±**: Ä°zlemek iÃ§in EC2 Ã¶rneklerine kurulmasÄ± gereken yazÄ±lÄ±m ajanslarÄ±. Veriler, bir TLS kanalÄ± kullanarak Amazon Inspector'a gÃ¶nderilir. Ajans, talimatlar iÃ§in Inspector'a dÃ¼zenli bir kalp atÄ±ÅŸÄ± gÃ¶nderir. Kendini otomatik olarak gÃ¼ncelleyebilir\
**DeÄŸerlendirme ÅablonlarÄ±**: EC2 Ã¶rneklerinizde bir deÄŸerlendirmenin nasÄ±l Ã§alÄ±ÅŸtÄ±rÄ±lacaÄŸÄ±na iliÅŸkin belirli yapÄ±landÄ±rmalarÄ± tanÄ±mlayÄ±n. Bir deÄŸerlendirme ÅŸablonu oluÅŸturulduktan sonra deÄŸiÅŸtirilemez.

* KullanÄ±lacak kurallar paketleri
* DeÄŸerlendirme sÃ¼resi 15 dakika/1 saat/8 saat
* Bildirim gÃ¶ndermek iÃ§in SNS konularÄ±: BaÅŸladÄ±ÄŸÄ±nda, bittiÄŸinde, durum deÄŸiÅŸtiÄŸinde, bir bulgu raporladÄ±ÄŸÄ±nda
* Bulgulara atanacak Ã¶znitelikler

**Kural paketi**: Bir deÄŸerlendirme Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±ÄŸÄ±nda bir EC2 Ã¼zerinde kontrol edilen bir dizi bireysel kural iÃ§erir. Her birinin ayrÄ±ca bir ciddiyeti vardÄ±r (yÃ¼ksek, orta, dÃ¼ÅŸÃ¼k, bilgilendirici). OlasÄ±lÄ±klar ÅŸunlardÄ±r:

* Ortak ZayÄ±flÄ±klar ve Maruziyetler (CVE'ler)
* Ä°nternet GÃ¼venlik Merkezi (CIS) Benchmark
* GÃ¼venlik En Ä°yi UygulamalarÄ±

Amazon Inspector RolÃ¼nÃ¼ yapÄ±landÄ±rdÄ±ktan sonra, AWS AjanslarÄ± Kuruldu, hedef yapÄ±landÄ±rÄ±ldÄ± ve ÅŸablon yapÄ±landÄ±rÄ±ldÄ±ktan sonra Ã§alÄ±ÅŸtÄ±rabilirsiniz. Bir deÄŸerlendirme Ã§alÄ±ÅŸtÄ±rmasÄ± durdurulabilir, devam ettirilebilir veya silinebilir.

Amazon Inspector'Ä±n Ã¶nceden tanÄ±mlanmÄ±ÅŸ bir dizi kuralÄ±, paketlere gruplandÄ±rÄ±lmÄ±ÅŸtÄ±r. Her DeÄŸerlendirme Åablonu, testte kullanÄ±lacak kurallar paketlerini tanÄ±mlar. Ã–rnekler, deÄŸerlendirme ÅŸablonuna dahil edilen kurallar paketlerine karÅŸÄ± deÄŸerlendirilir.

{% hint style="info" %}
GÃ¼nÃ¼mÃ¼zde AWS, **tÃ¼m gerekli yapÄ±landÄ±rmalarÄ± otomatik olarak oluÅŸturmanÄ±za** ve hatta EC2 Ã¶rneklerinin iÃ§ine otomatik olarak **ajanslarÄ± yÃ¼klemenize** izin verir.
{% endhint %}

### **Raporlama**

**Telemetri**: Bir Ã¶rneÄŸin yapÄ±landÄ±rmasÄ±, davranÄ±ÅŸÄ± ve sÃ¼reÃ§leri hakkÄ±nda ayrÄ±ntÄ±larÄ± iÃ§eren bir deÄŸerlendirme Ã§alÄ±ÅŸmasÄ± sÄ±rasÄ±nda toplanan veriler. Toplanan veriler, ardÄ±ndan TLS Ã¼zerinden Amazon Inspector'a geri gÃ¶nderilir ve orada geÃ§ici bir KMS anahtarÄ± aracÄ±lÄ±ÄŸÄ±yla S3 Ã¼zerinde depolanÄ±r ve ÅŸifrelenir. Amazon Inspector daha sonra S3 Kova'sÄ±na eriÅŸir, bellekteki verileri ÅŸifre Ã§Ã¶zer ve bulgularÄ± oluÅŸturmak iÃ§in o deÄŸerlendirmeler iÃ§in kullanÄ±lan kurallar paketlerine karÅŸÄ± analiz eder.

**DeÄŸerlendirme Raporu**: DeÄŸerlendirilen ve deÄŸerlendirmenin sonuÃ§larÄ± hakkÄ±nda ayrÄ±ntÄ±lar saÄŸlar.

* **Bulgular raporu**, deÄŸerlendirmenin Ã¶zeti, EC2 hakkÄ±nda bilgiler ve kurallar ve meydana gelen bulgularÄ± iÃ§erir.
* **Tam rapor**, bulgu raporu + geÃ§en kurallarÄ±n bir listesidir.

## NumaralandÄ±rma
```
# Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

# Get findings
aws inspector list-findings

# Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

# Rule packages
aws inspector list-rules-packages
```
## Son AÅŸama SaldÄ±rÄ±

{% hint style="success" %}
Bir saldÄ±rganÄ±n perspektifinden, bu hizmet saldÄ±rgana diÄŸer Ã¶rnekler/konteynerlerin gÃ¼venlik aÃ§Ä±klarÄ±nÄ± ve aÄŸ maruziyetlerini bulmasÄ±na yardÄ±mcÄ± olabilir.

Ancak, bir saldÄ±rgan da bu hizmeti engellemekle ilgilenebilir, bÃ¶ylece kurban gÃ¼venlik aÃ§Ä±klarÄ±nÄ± (tÃ¼mÃ¼nÃ¼ veya belirli olanlarÄ±) gÃ¶remez.
{% endhint %}

TODO: PR'lar kabul edilir

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya HackTricks'i **PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya bizi **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)'da takip edin.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.

</details>
