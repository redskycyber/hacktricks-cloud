# AWS - Inspector Enum

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Inspector

Usluga Amazon Inspector je **bazirana na agentima**, 코to zna캜i da zahteva instalaciju softverskih agenata na bilo kojim EC2 instancama koje 쬰lite da procenite. Ovo 캜ini uslugu lako konfigurabilnom i dodatnom ta캜kom za postoje캖e resurse koji ve캖 rade unutar va코e AWS infrastrukture. Ovo poma쬰 Amazon Inspector-u da postane neprimetna integracija sa bilo kojim postoje캖im procesima i procedurama za bezbednost.

Ovo su testovi koje AWS Inspector vam omogu캖ava da izvr코ite:

* **CVEs**
* **CIS Benchmarks**
* **Najbolje prakse za bezbednost**
* **Dostupnost mre쬰**

Mo쬰te pokrenuti bilo koji od ovih testova na EC2 ma코inama koje odaberete.

### Elementi AWS Inspector-a

**Uloga**: Kreirajte ili odaberite ulogu koja 캖e omogu캖iti Amazon Inspector-u samo 캜itanje pristupa EC2 instancama (DescribeInstances)\
**Ciljevi procene**: Grupa EC2 instanci na kojima 쬰lite da pokrenete procenu\
**AWS agenti**: Softverski agenti koji moraju biti instalirani na EC2 instancama radi pra캖enja. Podaci se 코alju Amazon Inspector-u koriste캖i TLS kanal. Redovno se 코alje otkucaj srca sa agenta na inspektora koji tra쬴 instrukcije. Mo쬰 se automatski a쬿rirati\
**마bloni procene**: Defini코u specifi캜ne konfiguracije za pokretanje procene na va코im EC2 instancama. 마blon procene se ne mo쬰 menjati nakon kreiranja.

* Paketi pravila koji 캖e se koristiti
* Trajanje pokretanja procene 15min/1sat/8sat
* SNS teme, odaberite kada obavestiti: Po캜etak, zavr코etak, promena stanja, prijavljuje pronalazak
* Atributi koji 캖e biti dodeljeni pronalascima

**Paket pravila**: Sadr쬴 nekoliko pojedina캜nih pravila koja se proveravaju na EC2 instanci prilikom pokretanja procene. Svako pravilo tako캠e ima ozbiljnost (visoka, srednja, niska, informativna). Mogu캖nosti su:

* Common Vulnerabilities and Exposures (CVEs)
* Center for Internet Security (CIS) Benchmark
* Najbolje prakse za bezbednost

Kada ste konfigurisali Amazon Inspector ulogu, instalirali AWS agente, konfigurisali cilj i konfigurisali 코ablon, mo캖i 캖ete da ga pokrenete. Pokretanje procene mo쬰 se zaustaviti, nastaviti ili obrisati.

Amazon Inspector ima unapred definisan set pravila, grupisanih u pakete. Svaki 코ablon procene defini코e koje pakete pravila treba uklju캜iti u test. Instancama se vr코i evaluacija na osnovu paketa pravila uklju캜enih u 코ablon procene.

{% hint style="info" %}
Imajte na umu da AWS danas ve캖 omogu캖ava **automatsko kreiranje** svih potrebnih **konfiguracija** i 캜ak automatsko **instaliranje agenata unutar EC2 instanci**.
{% endhint %}

### **Izve코tavanje**

**Telemetrija**: podaci koji se prikupljaju sa instance, detalji o njenoj konfiguraciji, pona코anju i procesima tokom pokretanja procene. Nakon prikupljanja, podaci se 코alju natrag Amazon Inspector-u u skoro realnom vremenu preko TLS-a, gde se zatim skladi코te i 코ifruju na S3 putem privremenog KMS klju캜a. Amazon Inspector zatim pristupa S3 kanti, de코ifruje podatke u memoriji i analizira ih u odnosu na bilo koje pakete pravila kori코캖ene za tu procenu kako bi generisao rezultate.

**Izve코taj o proceni**: Pru쬬 detalje o tome 코ta je procenjeno i rezultatima procene.

* Izve코taj o **pronalascima** sadr쬴 sa쬰tak procene, informacije o EC2 i pravilima i pronalascima koji su se dogodili.
* **Puni izve코taj** je izve코taj o pronalascima + lista pravila koja su pro코la.

## Enumeracija
```
# Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

# Get findings
aws inspector list-findings

# Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

# Rule packages
aws inspector list-rules-packages
```
## Post Eksploatacija

{% hint style="success" %}
Sa perspektive napada캜a, ovaj servis mo쬰 pomo캖i napada캜u da prona캠e ranjivosti i izlo쬰nosti mre쬰 koje mu mogu pomo캖i da kompromituje druge instance/kontejnere.

Me캠utim, napada캜 tako캠e mo쬰 biti zainteresovan za ometanje ovog servisa kako bi rtva ne mogla videti ranjivosti (sve ili odre캠ene).
{% endhint %}

TODO: PR-ovi su dobrodo코li

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite **va코u kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Pogledajte [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 游냕 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
