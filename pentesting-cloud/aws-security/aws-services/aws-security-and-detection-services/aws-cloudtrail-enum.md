# AWS - CloudTrail Enum

## AWS - CloudTrail Enum

<details>

<summary><strong>‡§ú‡§æ‡§®‡•á‡§Ç AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§∂‡•Ç‡§®‡•ç‡§Ø ‡§∏‡•á ‡§π‡•Ä‡§∞‡•ã ‡§§‡§ï</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a> <strong>‡§ï‡•á ‡§∏‡§æ‡§•!</strong></summary>

HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§§‡§∞‡•Ä‡§ï‡•á:

* ‡§Ö‡§ó‡§∞ ‡§Ü‡§™ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§Ü‡§™‡§ï‡•Ä **‡§ï‡§Ç‡§™‡§®‡•Ä HackTricks ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§ø‡§§ ‡§π‡•ã** ‡§Ø‡§æ **HackTricks ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç** ‡§§‡•ã [**‡§∏‡§¨‡•ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§™‡•ç‡§≤‡§æ‡§®**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* [**‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï PEASS ‡§î‡§∞ HackTricks ‡§∏‡•ç‡§µ‡•à‡§ó**](https://peass.creator-spring.com) ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç
* ‡§π‡§Æ‡§æ‡§∞‡§æ ‡§µ‡§ø‡§∂‡•á‡§∑ [**NFTs**](https://opensea.io/collection/the-peass-family) ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π, ‡§Ø‡§æ‡§®‡•Ä [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ‡§ñ‡•ã‡§ú‡•á‡§Ç
* **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** üí¨ [**‡§°‡§ø‡§∏‡•ç‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ ‡§π‡§Æ‡•á‡§Ç **‡§ü‡•ç‡§µ‡§ø‡§ü‡§∞** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)\*\* ‡§™‡§∞ ‡§´‡•â‡§≤‡•ã\*\* ‡§ï‡§∞‡•á‡§Ç‡•§
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç, PRs ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡§ï‡•á** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos ‡§Æ‡•á‡§Ç‡•§

</details>

### **CloudTrail**

AWS CloudTrail **‡§Ü‡§™‡§ï‡•á AWS ‡§™‡§∞‡§ø‡§µ‡•á‡§∂ ‡§Æ‡•á‡§Ç ‡§ó‡§§‡§ø‡§µ‡§ø‡§ß‡§ø ‡§ï‡•ã ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§î‡§∞ ‡§Æ‡•â‡§®‡§ø‡§ü‡§∞ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à**‡•§ ‡§Ø‡§π ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ **‡§ò‡§ü‡§®‡§æ ‡§≤‡•â‡§ó** ‡§ï‡•ã ‡§ï‡•à‡§™‡•ç‡§ö‡§∞ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§∏‡§≠‡•Ä AWS ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§®‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§π‡•Å‡§è ‡§∏‡§≠‡•Ä ‡§á‡§Ç‡§ü‡§∞‡•à‡§ï‡•ç‡§∂‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•å‡§® ‡§ï‡•ç‡§Ø‡§æ ‡§ï‡§∞‡§§‡§æ ‡§•‡§æ, ‡§ï‡§¨ ‡§î‡§∞ ‡§ï‡§π‡§æ‡§Å ‡§∏‡•á, ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£, ‡§Ö‡§®‡•Å‡§™‡§æ‡§≤‡§® ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§®‡•ã‡§Ç ‡§î‡§∞ ‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§ì‡§Ç ‡§ï‡§æ ‡§è‡§ï ‡§ë‡§°‡§ø‡§ü ‡§ü‡•ç‡§∞‡•á‡§≤ ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ CloudTrail, ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§î‡§∞ ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§® ‡§µ‡•ç‡§Ø‡§µ‡§π‡§æ‡§∞ ‡§ï‡•ã ‡§∏‡§Æ‡§ù‡§®‡•á, ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§ï‡•ã ‡§¨‡§¢‡§º‡§æ‡§®‡•á ‡§î‡§∞ ‡§µ‡§ø‡§®‡§ø‡§Ø‡§æ‡§Æ‡§ï ‡§Ö‡§®‡•Å‡§™‡§æ‡§≤‡§® ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à‡•§

‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§≤‡•â‡§ó ‡§ò‡§ü‡§®‡§æ ‡§Æ‡•á‡§Ç ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡§Ç:

* ‡§ï‡•â‡§≤ ‡§ï‡§ø‡§è ‡§ó‡§è API ‡§ï‡§æ ‡§®‡§æ‡§Æ: `eventName`
* ‡§ï‡•â‡§≤ ‡§ï‡•Ä ‡§∏‡•á‡§µ‡§æ: `eventSource`
* ‡§∏‡§Æ‡§Ø: `eventTime`
* IP ‡§™‡§§‡§æ: `SourceIPAddress`
* ‡§è‡§ú‡•á‡§Ç‡§ü ‡§Æ‡•á‡§•‡§°: `userAgent`‡•§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£:
* Signing.amazonaws.com - AWS ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§ï‡§Ç‡§∏‡•ã‡§≤ ‡§∏‡•á
* console.amazonaws.com - ‡§ñ‡§æ‡§§‡•á ‡§ï‡§æ ‡§∞‡•Ç‡§ü ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ
* lambda.amazonaws.com - AWS Lambda
* ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞: `requestParameters`
* ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§§‡§§‡•ç‡§µ: `responseElements`

‡§ò‡§ü‡§®‡§æ‡§è‡§Å **‡§≤‡§ó‡§≠‡§ó ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï 5 ‡§Æ‡§ø‡§®‡§ü ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§®‡§è ‡§≤‡•â‡§ó ‡§´‡§º‡§æ‡§á‡§≤ ‡§Æ‡•á‡§Ç ‡§≤‡§ø‡§ñ‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§µ‡•á CloudTrail ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§ß‡§æ‡§∞‡§ø‡§§ ‡§ï‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§Ö‡§Ç‡§§‡§§‡§É, ‡§≤‡•â‡§ó ‡§´‡§º‡§æ‡§á‡§≤‡•á‡§Ç S3 ‡§Æ‡•á‡§Ç ‡§≤‡§ó‡§≠‡§ó 15 ‡§Æ‡§ø‡§®‡§ü ‡§¨‡§æ‡§¶ ‡§™‡§π‡•Å‡§Ç‡§ö‡§æ‡§à ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡§Ç‡•§**\
CloudTrails ‡§≤‡•â‡§ó ‡§ñ‡§æ‡§§‡•ã‡§Ç ‡§î‡§∞ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§¨‡•Ä‡§ö **‡§∏‡§Æ‡•Ç‡§π‡•Ä‡§ï‡•É‡§§ ‡§ï‡§ø‡§è ‡§ú‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§**\
CloudTrail ‡§Ü‡§™‡§ï‡•ã ‡§≤‡•â‡§ó ‡§´‡§º‡§æ‡§á‡§≤ ‡§Ö‡§ñ‡§Ç‡§°‡§§‡§æ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§Ü‡§™ ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡•á‡§Ç ‡§ï‡§ø ‡§Ü‡§™‡§ï‡•Ä ‡§≤‡•â‡§ó ‡§´‡§º‡§æ‡§á‡§≤‡•á‡§Ç ‡§â‡§∏‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§Æ‡•á‡§Ç ‡§¨‡§®‡•Ä ‡§π‡•Å‡§à ‡§π‡•à‡§Ç ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç CloudTrail ‡§®‡•á ‡§Ü‡§™‡§ï‡•ã ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§™‡§π‡•Å‡§Ç‡§ö‡§æ‡§Ø‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§è‡§ï ‡§°‡§æ‡§á‡§ú‡•á‡§∏‡•ç‡§ü ‡§´‡§º‡§æ‡§á‡§≤ ‡§Æ‡•á‡§Ç ‡§≤‡•â‡§ó ‡§ï‡§æ SHA-256 ‡§π‡•à‡§∂ ‡§¨‡§®‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§®‡§à ‡§≤‡•â‡§ó ‡§ï‡§æ sha-256 ‡§π‡•à‡§∂ ‡§™‡•ç‡§∞‡§§‡§ø ‡§ò‡§Ç‡§ü‡•á ‡§¨‡§®‡§æ‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§\
‡§ü‡•ç‡§∞‡•á‡§≤ ‡§¨‡§®‡§æ‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§á‡§µ‡•á‡§Ç‡§ü ‡§∏‡§ø‡§≤‡•á‡§ï‡•ç‡§ü‡§∞‡•ç‡§∏ ‡§Ü‡§™‡§ï‡•ã ‡§∏‡•Ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§Ç‡§ó‡•á ‡§ï‡§ø ‡§≤‡•â‡§ó ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ü‡•ç‡§∞‡•á‡§≤: ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®, ‡§°‡•á‡§ü‡§æ ‡§Ø‡§æ ‡§á‡§Ç‡§∏‡§æ‡§á‡§ü‡•ç‡§∏ ‡§á‡§µ‡•á‡§Ç‡§ü‡•ç‡§∏‡•§

‡§≤‡•â‡§ó S3 ‡§¨‡§ï‡•á‡§ü ‡§Æ‡•á‡§Ç ‡§∏‡§π‡•á‡§ú‡•á ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§∏‡§æ‡§á‡§° ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à (SSE-S3) ‡§§‡§æ‡§ï‡§ø AWS ‡§â‡§® ‡§≤‡•ã‡§ó‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•ã ‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡•á ‡§ú‡§ø‡§®‡§ï‡•á ‡§™‡§æ‡§∏ ‡§™‡§π‡•Å‡§Ç‡§ö ‡§π‡•à, ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™ SSE ‡§ï‡•á ‡§∏‡§æ‡§• KMS ‡§î‡§∞ ‡§Ö‡§™‡§®‡•á ‡§ñ‡•Å‡§¶ ‡§ï‡•á ‡§ï‡•Å‡§Ç‡§ú‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

‡§≤‡•â‡§ó ‡§è‡§ï **S3 ‡§¨‡§ï‡•á‡§ü ‡§Æ‡•á‡§Ç ‡§á‡§∏ ‡§®‡§æ‡§Æ ‡§™‡•ç‡§∞‡§æ‡§∞‡•Ç‡§™ ‡§ï‡•á ‡§∏‡§æ‡§•** ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡§ø‡§è ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç:

* **`BucketName/AWSLogs/AccountID/CloudTrail/RegionName/YYY/MM/DD`**
* ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç BucketName ‡§π‡•à: **`aws-cloudtrail-logs-<accountid>-<random>`**
* ‡§â‡§¶‡§æ‡§π‡§∞‡§£: **`aws-cloudtrail-logs-947247140022-ffb95fe7/AWSLogs/947247140022/CloudTrail/ap-south-1/2023/02/22/`**

‡§π‡§∞ ‡§´‡§º‡•ã‡§≤‡•ç‡§°‡§∞ ‡§Æ‡•á‡§Ç ‡§π‡§∞ ‡§≤‡•â‡§ó ‡§ï‡§æ **‡§®‡§æ‡§Æ ‡§á‡§∏ ‡§™‡•ç‡§∞‡§æ‡§∞‡•Ç‡§™ ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§∏‡§∞‡§£ ‡§ï‡§∞‡•á‡§ó‡§æ**: **`AccountID_CloudTrail_RegionName_YYYYMMDDTHHMMZ_Random.json.gz`**

‡§≤‡•â‡§ó ‡§´‡§º‡§æ‡§á‡§≤ ‡§®‡•á‡§Æ‡§ø‡§Ç‡§ó ‡§ï‡§®‡§µ‡•á‡§Ç‡§∂‡§®

![](<../../../../.gitbook/assets/image (29).png>)

‡§á‡§∏‡§ï‡•á ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§, **‡§°‡§æ‡§á‡§ú‡•á‡§∏‡•ç‡§ü ‡§´‡§º‡§æ‡§á‡§≤‡•á‡§Ç (‡§´‡§º‡§æ‡§á‡§≤ ‡§Ö‡§ñ‡§Ç‡§°‡§§‡§æ ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡•á ‡§≤‡§ø‡§è)** **‡§è‡§ï ‡§π‡•Ä ‡§¨‡§ï‡•á‡§ü ‡§Æ‡•á‡§Ç** ‡§π‡•ã‡§Ç‡§ó‡•Ä:

![](<../../../../.gitbook/assets/image (22).png>)

#### ‡§Æ‡§≤‡•ç‡§ü‡•Ä‡§™‡§≤ ‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü ‡§∏‡•á ‡§≤‡•â‡§ó‡•ç‡§∏ ‡§ï‡•ã ‡§∏‡§Æ‡•Ç‡§π‡•Ä‡§ï‡•É‡§§ ‡§ï‡§∞‡•á‡§Ç

* ‡§â‡§∏ AWS ‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§ü‡•ç‡§∞‡§æ‡§Ø‡§≤ ‡§¨‡§®‡§æ‡§è‡§Ç ‡§ú‡§π‡§æ‡§Ç ‡§Ü‡§™ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§≤‡•â‡§ó ‡§´‡§º‡§æ‡§á‡§≤‡•á‡§Ç ‡§™‡§π‡•Å‡§Ç‡§ö‡§æ‡§à ‡§ú‡§æ‡§è‡§Ç
* CloudTrail ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§æ‡§∞‡§Ç‡§ó‡§§‡§ø‡§Ø‡§æ‡§Å ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç ‡§ú‡•ã CloudTrail ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ç‡§∞‡•â‡§∏-‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü ‡§™‡§π‡•Å‡§Ç‡§ö ‡§ï‡•ã ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§π‡§∞ AWS ‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü ‡§ï‡•ã ‡§™‡§π‡•Å‡§Ç‡§ö ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•à
* ‡§Ö‡§®‡•ç‡§Ø AWS ‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§®‡§Ø‡§æ ‡§ü‡•ç‡§∞‡•á‡§≤ ‡§¨‡§®‡§æ‡§è‡§Ç ‡§î‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç ‡§ï‡§ø ‡§ö‡§∞‡§£ 1 ‡§Æ‡•á‡§Ç ‡§¨‡§®‡§æ‡§è ‡§ó‡§è ‡§¨‡§ï‡•á‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç

‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø, ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§∏‡§≠‡•Ä ‡§≤‡•â‡§ó‡•ç‡§∏ ‡§ï‡•ã ‡§è‡§ï ‡§π‡•Ä S3 ‡§¨‡§ï‡•á‡§ü ‡§Æ‡•á‡§Ç ‡§∏‡§π‡•á‡§ú ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§Ü‡§™ ‡§è‡§ï‡§≤ AWS ‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡•ç‡§Æ‡§ø‡§≤‡§ø‡§§ ‡§ï‡•ç‡§≤‡§æ‡§â‡§°‡§ü‡•ç‡§∞‡•á‡§≤ ‡§≤‡•â‡§ó‡•ç‡§∏ ‡§ï‡•ã ‡§ï‡•ç‡§≤‡§æ‡§â‡§°‡§µ‡•â‡§ö ‡§≤‡•â‡§ó‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡•Ç‡§π‡•Ä‡§ï‡•É‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á‡•§

{% hint style="danger" %}
‡§ß‡•ç‡§Ø‡§æ‡§® ‡§∞‡§ñ‡•á‡§Ç ‡§ï‡§ø ‡§è‡§ï ‡§ñ‡§æ‡§§‡§æ ‡§Æ‡•á‡§Ç **‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§ü‡•ç‡§∞‡•á‡§≤** ‡§π‡•ã ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡§ø‡§®‡•ç‡§π‡•á‡§Ç CloudTrail **‡§∏‡§ï‡•ç‡§∑‡§Æ** ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à ‡§î‡§∞ ‡§µ‡•á ‡§è‡§ï ‡§π‡•Ä (‡§Ø‡§æ ‡§≠‡§ø‡§®‡•ç‡§®) ‡§≤‡•â‡§ó‡•ç‡§∏ ‡§ï‡•ã ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§¨‡§ï‡•á‡§ü ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§
{% endhint %}

#### 1 ‡§Æ‡•á‡§Ç ‡§∏‡§≠‡•Ä ‡§ë‡§∞‡•ç‡§ó ‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü ‡§∏‡•á ‡§ï‡•ç‡§≤‡§æ‡§â‡§°‡§ü‡•ç‡§∞‡•á‡§≤

‡§ï‡•ç‡§≤‡§æ‡§â‡§°‡§ü‡•ç‡§∞‡•á‡§≤ ‡§¨‡§®‡§æ‡§§‡•á ‡§∏‡§Æ‡§Ø, ‡§∏‡§Ç‡§ó‡§†‡§® ‡§ï‡•á ‡§∏‡§≠‡•Ä ‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ç‡§≤‡§æ‡§â‡§°‡§ü‡•ç‡§∞‡•á‡§≤ ‡§ï‡•ã ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§ï‡§∞‡§®‡•á ‡§î‡§∞ ‡§ï‡•á‡§µ‡§≤ 1 ‡§¨‡§ï‡•á‡§ü ‡§Æ‡•á‡§Ç ‡§≤‡•â‡§ó ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§∏‡§Ç‡§ï‡•á‡§§‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à:

<figure><img src="../../../../.gitbook/assets/image (1) (1) (5).png" alt=""><figcaption></figcaption></figure>

‡§á‡§∏ ‡§§‡§∞‡§π ‡§Ü‡§™ ‡§∏‡§≠‡•Ä ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡§≠‡•Ä ‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§ï‡•ç‡§≤‡§æ‡§â‡§°‡§ü‡•ç‡§∞‡•á‡§≤ ‡§ï‡•ã ‡§Ü‡§∏‡§æ‡§®‡•Ä ‡§∏‡•á ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§≤‡•â‡§ó‡•ç‡§∏ ‡§ï‡•ã 1 ‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§Ç‡§ü‡•ç‡§∞‡§≤‡§æ‡§á‡§ú ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç (‡§ú‡§ø‡§∏‡•á ‡§Ü‡§™‡§ï‡•ã ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§∞‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è)‡•§

#### ‡§≤‡•â‡§ó ‡§´‡§º‡§æ‡§á‡§≤‡•á‡§Ç ‡§ú‡§æ‡§Ç‡§ö‡§®‡§æ

‡§Ü‡§™ ‡§Ø‡§π ‡§¶‡•á‡§ñ‡§ï‡§∞ ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§≤‡•â‡§ó ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à ‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§® ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à

{% code overflow="wrap" %}
```javascript
aws cloudtrail validate-logs --trail-arn <trailARN> --start-time <start-time> [--end-time <end-time>] [--s3-bucket <bucket-name>] [--s3-prefix <prefix>] [--verbose]
```
{% endcode %}

#### ‡§≤‡•â‡§ó‡•ç‡§∏ ‡§ï‡•ã CloudWatch ‡§Æ‡•á‡§Ç ‡§≠‡•á‡§ú‡•á‡§Ç

**CloudTrail ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§≤‡•â‡§ó‡•ç‡§∏ ‡§ï‡•ã CloudWatch ‡§Æ‡•á‡§Ç ‡§≠‡•á‡§ú ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§Ü‡§™ ‡§Ü‡§≤‡§∞‡•ç‡§ü ‡§∏‡•á‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡•á‡§Ç ‡§ú‡§¨ ‡§∏‡§Ç‡§¶‡•á‡§π‡§™‡•Ç‡§∞‡•ç‡§£ ‡§ó‡§§‡§ø‡§µ‡§ø‡§ß‡§ø‡§Ø‡§æ‡§Å ‡§ï‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡§Ç‡•§**\
‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø CloudTrail ‡§ï‡•ã ‡§≤‡•â‡§ó‡•ç‡§∏ ‡§ï‡•ã CloudWatch ‡§Æ‡•á‡§Ç ‡§≠‡•á‡§ú‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï **‡§∞‡•ã‡§≤** ‡§¨‡§®‡§æ‡§®‡§æ ‡§π‡•ã‡§ó‡§æ ‡§ú‡•ã ‡§á‡§∏ ‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§¶‡§ø ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•ã ‡§§‡•ã, ‡§Ø‡•á ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂ ‡§ï‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à ‡§ï‡§ø ‡§á‡§® ‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è AWS ‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§∞‡•ã‡§≤ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡•§ ‡§Ø‡§π ‡§∞‡•ã‡§≤ CloudTrail ‡§ï‡•ã ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§ï‡§æ‡§∞‡•ç‡§∞‡§µ‡§æ‡§á‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§ó‡§æ:

* CreateLogStream: ‡§á‡§∏‡§∏‡•á CloudWatch Logs ‡§≤‡•â‡§ó ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Æ ‡§¨‡§®‡§æ‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§Æ‡§ø‡§≤‡§§‡•Ä ‡§π‡•à
* PutLogEvents: CloudTrail ‡§≤‡•â‡§ó‡•ç‡§∏ ‡§ï‡•ã CloudWatch Logs ‡§≤‡•â‡§ó ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Æ ‡§Æ‡•á‡§Ç ‡§™‡§π‡•Å‡§Ç‡§ö‡§æ‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§Æ‡§ø‡§≤‡§§‡•Ä ‡§π‡•à

#### ‡§ò‡§ü‡§®‡§æ ‡§á‡§§‡§ø‡§π‡§æ‡§∏

CloudTrail ‡§á‡§µ‡•á‡§Ç‡§ü ‡§π‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§Ü‡§™‡§ï‡•ã ‡§è‡§ï ‡§§‡§æ‡§≤‡§ø‡§ï‡§æ ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§Ç‡§ö‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§ï‡§ø‡§è ‡§ó‡§è ‡§≤‡•â‡§ó‡•ç‡§∏ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç:

![](<../../../../.gitbook/assets/image (24).png>)

#### ‡§á‡§Ç‡§∏‡§æ‡§á‡§ü‡•ç‡§∏

**CloudTrail Insights** ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á **‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£** ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, CloudTrail trails ‡§∏‡•á ‡§≤‡•á‡§ñ‡§® ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§ò‡§ü‡§®‡§æ‡§ì‡§Ç ‡§ï‡§æ **‡§Ö‡§≤‡§∞‡•ç‡§ü** ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§Ü‡§™‡§ï‡•ã **‡§Ö‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ó‡§§‡§ø‡§µ‡§ø‡§ß‡§ø** ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡§®‡§æ ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ø‡§¶‡§ø `TerminateInstance` ‡§ò‡§ü‡§®‡§æ‡§ì‡§Ç ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§µ‡•É‡§¶‡•ç‡§ß‡§ø ‡§π‡•ã‡§§‡•Ä ‡§π‡•à ‡§ú‡•ã ‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§ ‡§Ü‡§ß‡§æ‡§∞‡•ã‡§Ç ‡§∏‡•á ‡§≠‡§ø‡§®‡•ç‡§® ‡§π‡•à, ‡§§‡•ã ‡§Ü‡§™ ‡§á‡§∏‡•á ‡§è‡§ï ‡§á‡§Ç‡§∏‡§æ‡§á‡§ü ‡§ò‡§ü‡§®‡§æ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ‡•á‡§Ç‡§ó‡•á‡•§ ‡§Ø‡•á ‡§ò‡§ü‡§®‡§æ‡§è‡§Ç **‡§Ö‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø API ‡§ó‡§§‡§ø‡§µ‡§ø‡§ß‡§ø ‡§ï‡•ã ‡§ñ‡•ã‡§ú‡§®‡§æ ‡§î‡§∞ ‡§â‡§∏‡§ï‡•á ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§∏‡•á ‡§®‡§ø‡§™‡§ü‡§®‡§æ** ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§≠‡•Ä ‡§Ü‡§∏‡§æ‡§® ‡§¨‡§®‡§æ ‡§¶‡•á‡§§‡•Ä ‡§π‡•à‡§Ç‡•§

‡§á‡§Ç‡§∏‡§æ‡§á‡§ü‡•ç‡§∏ ‡§ï‡•ã CloudTrail ‡§≤‡•â‡§ó‡•ç‡§∏ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§π‡•Ä ‡§è‡§ï ‡§π‡•Ä ‡§¨‡§ï‡•á‡§ü ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à: `BucketName/AWSLogs/AccountID/CloudTrail-Insight`

#### ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ

| CloudTrail ‡§≤‡•â‡§ó ‡§´‡§º‡§æ‡§á‡§≤ ‡§Ö‡§ñ‡§Ç‡§°‡§§‡§æ                                             | <ul><li>‡§≤‡•â‡§ó‡•ç‡§∏ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ï‡§ø‡§∏‡•Ä ‡§ñ‡§ø‡§≤‡§æ‡§´‡§º‡•Ä ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à ‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç, ‡§Ø‡§π ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç (‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§ ‡§Ø‡§æ ‡§π‡§ü‡§æ‡§è ‡§ó‡§è)</li><li><p>‡§°‡§æ‡§á‡§ú‡•á‡§∏‡•ç‡§ü ‡§´‡§º‡§æ‡§á‡§≤‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç (‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§´‡§º‡§æ‡§á‡§≤ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡•à‡§∂ ‡§¨‡§®‡§æ‡§è‡§Ç)</p><ul><li>SHA-256 ‡§π‡•à‡§∂‡§ø‡§Ç‡§ó</li><li>‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§∏‡§æ‡§á‡§®‡§ø‡§Ç‡§ó ‡§ï‡•á ‡§≤‡§ø‡§è SHA-256 with RSA</li><li>‡§Ö‡§Æ‡•á‡§ú‡§º‡§® ‡§ï‡•á ‡§∏‡•ç‡§µ‡§æ‡§Æ‡§ø‡§§‡•ç‡§µ ‡§Æ‡•á‡§Ç ‡§®‡§ø‡§ú‡•Ä ‡§ï‡•Å‡§Ç‡§ú‡•Ä</li></ul></li><li>‡§è‡§ï ‡§°‡§æ‡§á‡§ú‡•á‡§∏‡•ç‡§ü ‡§´‡§º‡§æ‡§á‡§≤ ‡§¨‡§®‡§æ‡§®‡•á ‡§Æ‡•á‡§Ç 1 ‡§ò‡§Ç‡§ü‡§æ ‡§≤‡§ó‡§§‡§æ ‡§π‡•à (‡§π‡§∞ ‡§ò‡§Ç‡§ü‡•á ‡§ï‡•Ä ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§ ‡§™‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à)</li></ul> |
| ----------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ‡§Ö‡§®‡§ß‡§ø‡§ï‡•É‡§§ ‡§™‡§π‡•Å‡§Ç‡§ö‡§® ‡§ï‡•ã ‡§∞‡•ã‡§ï‡•á‡§Ç                                                 | <ul><li><p>IAM ‡§®‡•Ä‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§î‡§∞ S3 ‡§¨‡§ï‡•á‡§ü ‡§®‡•Ä‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç</p><ul><li>‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ü‡•Ä‡§Æ ‚Äî> ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö</li><li>‡§®‡§ø‡§∞‡•Ä‡§ï‡•ç‡§∑‡§ï ‚Äî> ‡§ï‡•á‡§µ‡§≤ ‡§™‡§¢‡§º‡§®‡•á ‡§ï‡•Ä ‡§™‡§π‡•Å‡§Ç‡§ö</li></ul></li><li>‡§≤‡•â‡§ó‡•ç‡§∏ ‡§ï‡•ã ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è SSE-S3/SSE-KMS ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç</li></ul>                                                                                                                                                                     |
| ‡§≤‡•â‡§ó ‡§´‡§º‡§æ‡§á‡§≤‡•ã‡§Ç ‡§ï‡•ã ‡§π‡§ü‡§æ‡§®‡•á ‡§∏‡•á ‡§∞‡•ã‡§ï‡•á‡§Ç                                           | <ul><li>IAM ‡§î‡§∞ ‡§¨‡§ï‡•á‡§ü ‡§®‡•Ä‡§§</li></ul>                                                                                                                                                                                                                                                                                                                                                                       |
| \`\`\`bash                                                              |                                                                                                                                                                                                                                                                                                                                                                                                         |
| # Get trails info                                                       |                                                                                                                                                                                                                                                                                                                                                                                                         |
| aws cloudtrail list-trails                                              |                                                                                                                                                                                                                                                                                                                                                                                                         |
| aws cloudtrail describe-trails                                          |                                                                                                                                                                                                                                                                                                                                                                                                         |
| aws cloudtrail list-public-keys                                         |                                                                                                                                                                                                                                                                                                                                                                                                         |
| aws cloudtrail get-event-selectors --trail-name \<trail\_name>          |                                                                                                                                                                                                                                                                                                                                                                                                         |
| aws \[--region us-east-1] cloudtrail get-trail-status --name \[default] |                                                                                                                                                                                                                                                                                                                                                                                                         |

## Get insights

aws cloudtrail get-insight-selectors --trail-name \<trail\_name>

## Get data store info

aws cloudtrail list-event-data-stores aws cloudtrail list-queries --event-data-store aws cloudtrail get-query-results --event-data-store --query-id

````
### **CSV ‡§Ö‡§Ç‡§ú‡§æ‡§Æ**

CloudTrail ‡§Æ‡•á‡§Ç CVS ‡§Ö‡§Ç‡§ú‡§æ‡§Æ ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ú‡•ã ‡§Ø‡§¶‡§ø ‡§≤‡•â‡§ó‡•ç‡§∏ CSV ‡§Æ‡•á‡§Ç ‡§®‡§ø‡§∞‡•ç‡§Ø‡§æ‡§§ ‡§ï‡§ø‡§è ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ Excel ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ñ‡•ã‡§≤‡•á ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡•ã ‡§µ‡§ø‡§ö‡§æ‡§∞‡§∂‡•Ä‡§≤ ‡§ï‡•ã‡§° ‡§ï‡•ã ‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§®‡•ç‡§µ‡§ø‡§§ ‡§ï‡§∞‡•á‡§ó‡§æ‡•§\
‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§ï‡•ã‡§° ‡§è‡§ï ‡§¨‡•Å‡§∞‡§æ ‡§ü‡•ç‡§∞‡•á‡§≤ ‡§®‡§æ‡§Æ ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§∞‡•á‡§ó‡§æ ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§™‡•á‡§≤‡•ã‡§° ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à:
```python
import boto3
payload = "=cmd|'/C calc'|''"
client = boto3.client('cloudtrail')
response = client.create_trail(
Name=payload,
S3BucketName="random"
)
print(response)
````

‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è CSV Injections ‡§ï‡•Ä ‡§™‡•á‡§ú ‡§¶‡•á‡§ñ‡•á‡§Ç:

{% embed url="https://book.hacktricks.xyz/pentesting-web/formula-injection" %}

‡§á‡§∏ ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§§‡§ï‡§®‡•Ä‡§ï ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è [https://rhinosecuritylabs.com/aws/cloud-security-csv-injection-aws-cloudtrail/](https://rhinosecuritylabs.com/aws/cloud-security-csv-injection-aws-cloudtrail/)

### **‡§°‡§ø‡§ü‡•á‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§õ‡§≤‡§®‡§æ**

#### HoneyTokens **‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏**

‡§π‡§®‡•Ä‡§ü‡•ã‡§ï‡§®‡•ç‡§∏ ‡§ï‡•ã **‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•Ä ‡§®‡§ø‡§ï‡§æ‡§∏‡•Ä ‡§ï‡§æ ‡§™‡§§‡§æ ‡§≤‡§ó‡§æ‡§®‡•á** ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§®‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§ AWS ‡§ï‡•á ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§Æ‡•á‡§Ç, ‡§µ‡•á **AWS ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§π‡•à‡§Ç ‡§ú‡§ø‡§®‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§Æ‡•â‡§®‡§ø‡§ü‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à**, ‡§Ö‡§ó‡§∞ ‡§ï‡•Å‡§õ ‡§ê‡§∏‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§â‡§∏ ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ï‡§æ‡§∞‡•ç‡§∞‡§µ‡§æ‡§à ‡§ï‡•ã ‡§ü‡•ç‡§∞‡§ø‡§ó‡§∞ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§ï‡§ø‡§∏‡•Ä ‡§®‡•á ‡§â‡§∏ ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§ï‡•ã ‡§ö‡•Å‡§∞‡§æ‡§Ø‡§æ ‡§π‡•ã‡§ó‡§æ‡•§

‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø, ‡§Ø‡§π ‡§Æ‡•â‡§®‡§ø‡§ü‡§∞‡§ø‡§Ç‡§ó **CloudTrail** ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§ï‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à, ‡§î‡§∞ ‡§ï‡•Å‡§õ **AWS ‡§∏‡•á‡§µ‡§æ‡§è‡§Ç ‡§π‡•à‡§Ç ‡§ú‡•ã CloudTrail ‡§ï‡•ã ‡§≤‡•â‡§ó ‡§®‡§π‡•Ä‡§Ç ‡§≠‡•á‡§ú‡§§‡•Ä ‡§π‡•à‡§Ç** (‡§Ø‡§π‡§æ‡§Ç [‡§∏‡•Ç‡§ö‡•Ä ‡§¶‡•á‡§ñ‡•á‡§Ç](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-unsupported-aws-services.html)). ‡§á‡§® ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§ï‡•Å‡§õ **‡§§‡•ç‡§∞‡•Å‡§ü‡§ø** ‡§ï‡•á ‡§∏‡§æ‡§• **‡§â‡§§‡•ç‡§§‡§∞ ‡§¶‡•á‡§§‡•Ä ‡§π‡•à‡§Ç** ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç **‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§≠‡•Ç‡§Æ‡§ø‡§ï‡§æ ‡§ï‡§æ ARN** ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§Ö‡§ó‡§∞ ‡§ï‡•ã‡§à ‡§Ö‡§®‡§ß‡§ø‡§ï‡•É‡§§ (‡§π‡§®‡•Ä‡§ü‡•ã‡§ï‡§® ‡§ï‡•Å‡§Ç‡§ú‡•Ä) ‡§á‡§∏‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§

‡§á‡§∏ ‡§§‡§∞‡§π, ‡§è‡§ï **‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§≤‡•â‡§ó ‡§ï‡•ã ‡§ü‡•ç‡§∞‡§ø‡§ó‡§∞ ‡§ï‡§ø‡§è ‡§¨‡§ø‡§®‡§æ ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§ï‡§æ ARN ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à**‡•§ ARN ‡§Æ‡•á‡§Ç ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§ï‡•ã **AWS ‡§ñ‡§æ‡§§‡§æ ‡§Ü‡§à‡§°‡•Ä ‡§î‡§∞ ‡§®‡§æ‡§Æ** ‡§¶‡§ø‡§ñ‡§æ‡§à ‡§¶‡•á‡§§‡§æ ‡§π‡•à, ‡§á‡§∏‡§≤‡§ø‡§è ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§ï‡§Ç‡§™‡§®‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§ñ‡§æ‡§§‡•ã‡§Ç ‡§ï‡•Ä ‡§Ü‡§à‡§°‡•Ä ‡§î‡§∞ ‡§®‡§æ‡§Æ ‡§ï‡•ã ‡§™‡§π‡§ö‡§æ‡§®‡§®‡§æ ‡§Ü‡§∏‡§æ‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§á‡§∏ ‡§§‡§∞‡§π ‡§è‡§ï ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§π‡§®‡•Ä‡§ü‡•ã‡§ï‡§® ‡§ï‡•Ä ‡§™‡§π‡§ö‡§æ‡§® ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

![](<../../../../.gitbook/assets/image (65).png>)

**HoneyTokens ‡§°‡§ø‡§ü‡•á‡§ï‡•ç‡§∂‡§®**

[**Pacu**](https://github.com/RhinoSecurityLabs/pacu/blob/79cd7d58f7bff5693c6ae73b30a8455df6136cca/pacu/modules/iam\_\_detect\_honeytokens/main.py#L57) ‡§Ø‡§π ‡§ú‡§æ‡§Ç‡§ö‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§ï‡•Å‡§Ç‡§ú‡•Ä [**Canarytokens**](https://canarytokens.org/generate)**,** [**SpaceCrab**](https://bitbucket.org/asecurityteam/spacecrab/issues?status=new\&status=open)**,** [**SpaceSiren**](https://github.com/spacesiren/spacesiren)\*\* ‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§ï‡§ø‡§∏‡§ï‡§æ ‡§π‡•à:

* ‡§Ö‡§ó‡§∞ **`canarytokens.org`** ‡§≠‡•Ç‡§Æ‡§ø‡§ï‡§æ ‡§Ø‡§æ ‡§ñ‡§æ‡§§‡§æ ‡§Ü‡§à‡§°‡•Ä ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§ï‡§ü ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§Ø‡§æ ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§Æ‡•á‡§Ç **`534261010715`** ‡§™‡•ç‡§∞‡§ï‡§ü ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§
* ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§π‡§æ‡§≤ ‡§π‡•Ä ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§Ç‡§ö‡§®‡•á ‡§™‡§∞ ‡§™‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à ‡§ï‡§ø ‡§µ‡•á ‡§ñ‡§æ‡§§‡§æ **`717712589309`** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§Ö‡§¨ ‡§≠‡•Ä ‡§®‡§æ‡§Æ ‡§Æ‡•á‡§Ç **`canarytokens.com`** ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó ‡§π‡•à‡•§
* ‡§Ö‡§ó‡§∞ ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§Æ‡•á‡§Ç ‡§≠‡•Ç‡§Æ‡§ø‡§ï‡§æ ‡§Æ‡•á‡§Ç **`SpaceCrab`** ‡§™‡•ç‡§∞‡§ï‡§ü ‡§π‡•ã‡§§‡§æ ‡§π‡•à
* **SpaceSiren** ‡§â‡§ú‡•ç‡§ú‡•ç‡§µ‡§≤‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è **uuids** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à: `[a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[89aAbB][a-f0-9]{3}-[a-f0-9]{12}`
* ‡§Ö‡§ó‡§∞ **‡§®‡§æ‡§Æ ‡§Ø‡§æ‡§¶‡•É‡§ö‡•ç‡§õ‡§ø‡§ï ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§≤‡§ó‡§§‡§æ ‡§π‡•à**, ‡§§‡•ã ‡§â‡§ö‡•ç‡§ö ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ‡§è‡§Ç ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§Ø‡§π ‡§è‡§ï HoneyToken ‡§π‡•à‡•§

{% hint style="danger" %}
‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§∏‡§≠‡•Ä ‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï API ‡§ú‡§ø‡§®‡§ï‡§æ ‡§™‡§§‡§æ ‡§ö‡§≤‡§æ ‡§π‡•à ‡§ï‡§ø ‡§µ‡•á CloudTrail ‡§≤‡•â‡§ó ‡§®‡§π‡•Ä‡§Ç ‡§¨‡§®‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç, ‡§Ö‡§¨ ‡§∏‡•Å‡§ß‡§æ‡§∞‡§ø‡§§ ‡§π‡•ã ‡§ó‡§è ‡§π‡•à‡§Ç, ‡§á‡§∏‡§≤‡§ø‡§è ‡§∂‡§æ‡§Ø‡§¶ ‡§Ü‡§™‡§ï‡•ã ‡§Ö‡§™‡§®‡§æ ‡§ñ‡•Å‡§¶ ‡§ï‡§æ ‡§ñ‡•ã‡§ú‡§®‡§æ ‡§™‡§°‡§º‡•á‡§ó‡§æ...

‡§Ø‡§æ ‡§Ü‡§™ **‡§è‡§ï‡§æ‡§â‡§Ç‡§ü ‡§Ü‡§à‡§°‡•Ä** ‡§ï‡•ã **‡§ï‡•ã‡§°‡•á‡§°** ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§∏‡•á ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•à‡§∏‡§æ ‡§ï‡§ø [**‡§Ø‡§π‡§æ‡§Å ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à**](https://medium.com/@TalBeerySec/a-short-note-on-aws-key-id-f88cc4317489) ‡§î‡§∞ ‡§Ö‡§™‡§®‡•Ä Honeytokens AWS ‡§ñ‡§æ‡§§‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ñ‡§æ‡§§‡§æ ‡§Ü‡§à‡§°‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:

```python
import base64
import binascii

def AWSAccount_from_AWSKeyID(AWSKeyID):

trimmed_AWSKeyID = AWSKeyID[4:] #remove KeyID prefix
x = base64.b32decode(trimmed_AWSKeyID) #base32 decode
y = x[0:6]

z = int.from_bytes(y, byteorder='big', signed=False)
mask = int.from_bytes(binascii.unhexlify(b'7fffffffff80'), byteorder='big', signed=False)

e = (z & mask)>>7
return (e)

print ("account id:" + "{:012d}".format(AWSAccount_from_AWSKeyID("ASIAQNZGKIQY56JQ7WML")))
```
{% endhint %}

‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è [**‡§Æ‡•Ç‡§≤ ‡§∂‡•ã‡§ß**](https://rhinosecuritylabs.com/aws/aws-iam-enumeration-2-0-bypassing-cloudtrail-logging/) ‡§¶‡•á‡§ñ‡•á‡§Ç‡•§

#### ‡§§‡•Ä‡§∏‡§∞‡•á ‡§á‡§Ç‡§´‡•ç‡§∞‡§æ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ï‡•ç‡§ö‡§∞ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö‡§®‡§æ

‡§ï‡•Å‡§õ AWS ‡§∏‡•á‡§µ‡§æ‡§è‡§Ç **‡§ï‡•Å‡§õ ‡§á‡§Ç‡§´‡•ç‡§∞‡§æ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ï‡•ç‡§ö‡§∞ ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡•á‡§Ç‡§ó‡•Ä** ‡§ú‡•à‡§∏‡•á **‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏** ‡§Ø‡§æ **‡§ï‡•Å‡§¨‡§∞‡§®‡•á‡§ü‡•Ä‡§ú‡§º** ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ (EKS)‡•§ ‡§è‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ **‡§â‡§® ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡•Ä‡§ß‡•á ‡§¨‡§æ‡§§‡§ö‡•Ä‡§§ ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•ã‡§ó‡§æ** (‡§ú‡•à‡§∏‡•á ‡§ï‡•Å‡§¨‡§∞‡§®‡•á‡§ü‡•Ä‡§ú‡§º API) **‡§µ‡§π AWS API ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡•á‡§ó‡§æ**, ‡§á‡§∏‡§≤‡§ø‡§è CloudTrail ‡§á‡§∏ ‡§∏‡§Ç‡§ö‡§æ‡§∞ ‡§ï‡•ã ‡§®‡§π‡•Ä‡§Ç ‡§¶‡•á‡§ñ ‡§™‡§æ‡§è‡§ó‡§æ‡•§

‡§á‡§∏‡§≤‡§ø‡§è, ‡§è‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ú‡§ø‡§∏‡§ï‡•á ‡§™‡§æ‡§∏ EKS ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§π‡•à ‡§ú‡§ø‡§∏‡§®‡•á EKS API ‡§ï‡§æ URL ‡§ñ‡•ã‡§ú ‡§≤‡§ø‡§Ø‡§æ ‡§π‡•à, ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§ü‡•ã‡§ï‡§® ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§î‡§∞ **Cloudtrail ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§™‡§π‡§ö‡§æ‡§®‡•á ‡§ú‡§æ‡§®‡•á ‡§ï‡•á ‡§¨‡§ø‡§®‡§æ ‡§∏‡•Ä‡§ß‡•á API ‡§∏‡•á‡§µ‡§æ ‡§∏‡•á ‡§¨‡§æ‡§§‡§ö‡•Ä‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à**‡•§

‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä:

{% content-ref url="../../aws-post-exploitation/aws-eks-post-exploitation.md" %}
[aws-eks-post-exploitation.md](../../aws-post-exploitation/aws-eks-post-exploitation.md)
{% endcontent-ref %}

#### CloudTrail ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞‡•á‡§∂‡§® ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ

**‡§ü‡•ç‡§∞‡•á‡§≤‡•ç‡§∏ ‡§π‡§ü‡§æ‡§è‡§Ç**

```bash
aws cloudtrail delete-trail --name [trail-name]
```

**‡§ü‡•ç‡§∞‡•á‡§≤‡•ç‡§∏ ‡§∞‡•ã‡§ï‡•á‡§Ç**

```bash
aws cloudtrail stop-logging --name [trail-name]
```

**‡§¨‡§π‡•Å-‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§≤‡•â‡§ó‡§ø‡§Ç‡§ó ‡§Ö‡§ï‡•ç‡§∑‡§Æ ‡§ï‡§∞‡•á‡§Ç**

{% code overflow="wrap" %}
```bash
aws cloudtrail update-trail --name [trail-name] --no-is-multi-region --no-include-global-services
```
{% endcode %}

**‡§à‡§µ‡•á‡§Ç‡§ü ‡§∏‡§ø‡§≤‡•á‡§ï‡•ç‡§ü‡§∞‡•ç‡§∏ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§≤‡•â‡§ó‡§ø‡§Ç‡§ó ‡§Ö‡§ï‡•ç‡§∑‡§Æ ‡§ï‡§∞‡•á‡§Ç**

{% code overflow="wrap" %}
```bash
# Leave only the ReadOnly selector
aws cloudtrail put-event-selectors --trail-name <trail_name> --event-selectors '[{"ReadWriteType": "ReadOnly"}]' --region <region>

# Remove all selectors (stop Insights)
aws cloudtrail put-event-selectors --trail-name <trail_name> --event-selectors '[]' --region <region>
```
{% endcode %}

‡§™‡§π‡§≤‡•á ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§Æ‡•á‡§Ç, ‡§è‡§ï ‡§è‡§ï‡§≤ ‡§ò‡§ü‡§®‡§æ ‡§ö‡§Ø‡§®‡§ï‡§∞‡•ç‡§§‡§æ ‡§è‡§ï JSON ‡§è‡§∞‡•á ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§è‡§ï‡§≤ ‡§ë‡§¨‡•ç‡§ú

```bash
aws s3api put-bucket-lifecycle --bucket <bucket_name> --lifecycle-configuration '{"Rules": [{"Status": "Enabled", "Prefix": "", "Expiration": {"Days": 7}}]}' --region <region>
```

#### ‡§∏‡§æ‡§Ç‡§° ‡§¨‡§æ‡§≤‡•ç‡§ü‡•Ä ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞‡•á‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§®

* S3 ‡§¨‡§æ‡§≤‡•ç‡§ü‡•Ä ‡§ï‡•ã ‡§π‡§ü‡§æ‡§è‡§Ç
* ‡§¨‡§æ‡§≤‡•ç‡§ü‡•Ä ‡§®‡•Ä‡§§‡§ø ‡§ï‡•ã ‡§¨‡§¶‡§≤‡•á‡§Ç ‡§§‡§æ‡§ï‡§ø ‡§ï‡•ç‡§≤‡§æ‡§â‡§°‡§ü‡•ç‡§∞‡•á‡§≤ ‡§∏‡•á‡§µ‡§æ ‡§∏‡•á ‡§ï‡•ã‡§à ‡§≠‡•Ä ‡§≤‡•á‡§ñ‡§® ‡§® ‡§ï‡§∞ ‡§∏‡§ï‡•á
* S3 ‡§¨‡§æ‡§≤‡•ç‡§ü‡•Ä ‡§Æ‡•á‡§Ç ‡§ú‡•Ä‡§µ‡§®‡§ï‡§æ‡§≤ ‡§®‡•Ä‡§§‡§ø ‡§ú‡•ã‡§°‡§º‡•á‡§Ç ‡§§‡§æ‡§ï‡§ø ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü‡•ç‡§∏ ‡§π‡§ü‡§æ ‡§¶‡§ø‡§è ‡§ú‡§æ ‡§∏‡§ï‡•á‡§Ç
* ‡§ï‡•ç‡§≤‡§æ‡§â‡§°‡§ü‡•ç‡§∞‡•á‡§≤ ‡§≤‡•â‡§ó‡•ç‡§∏ ‡§ï‡•ã ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§è ‡§ó‡§è kms ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§ï‡•ã ‡§Ö‡§ï‡•ç‡§∑‡§Æ ‡§ï‡§∞‡•á‡§Ç

#### ‡§ï‡•ç‡§≤‡§æ‡§â‡§°‡§ü‡•ç‡§∞‡•á‡§≤ ‡§∞‡•à‡§Ç‡§∏‡§Æ‡§µ‡•á‡§Ø‡§∞

**S3 ‡§∞‡•à‡§Ç‡§∏‡§Æ‡§µ‡•á‡§Ø‡§∞**

‡§Ü‡§™ **‡§è‡§ï ‡§Ö‡§∏‡§Æ‡§Æ‡§ø‡§ü‡•ç‡§∞‡•Ä ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§®** ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ **‡§ï‡•ç‡§≤‡§æ‡§â‡§°‡§ü‡•ç‡§∞‡•á‡§≤ ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§â‡§∏ ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§∏‡•á ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü** ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ **‡§®‡§ø‡§ú‡•Ä ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§ï‡•ã ‡§π‡§ü‡§æ ‡§¶‡•á‡§Ç** ‡§§‡§æ‡§ï‡§ø ‡§ï‡•ç‡§≤‡§æ‡§â‡§°‡§ü‡•ç‡§∞‡•á‡§≤ ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•ã ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á‡•§\
‡§Ø‡§π ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§è‡§ï **S3-KMS ‡§∞‡•à‡§Ç‡§∏‡§Æ‡§µ‡•á‡§Ø‡§∞** ‡§π‡•à ‡§ú‡§ø‡§∏‡•á ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§ù‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à:

{% content-ref url="../../aws-post-exploitation/aws-s3-post-exploitation.md" %}
[aws-s3-post-exploitation.md](../../aws-post-exploitation/aws-s3-post-exploitation.md)
{% endcontent-ref %}

**KMS ‡§∞‡•à‡§Ç‡§∏‡§Æ‡§µ‡•á‡§Ø‡§∞**

‡§Ø‡§π ‡§™‡§ø‡§õ‡§≤‡•á ‡§π‡§Æ‡§≤‡•á ‡§ï‡•ã ‡§Ö‡§≤‡§ó ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§∏‡§¨‡§∏‡•á ‡§Ü‡§∏‡§æ‡§® ‡§§‡§∞‡•Ä‡§ï‡§æ ‡§π‡•à:

{% content-ref url="../../aws-post-exploitation/aws-kms-post-exploitation.md" %}
[aws-kms-post-exploitation.md](../../aws-post-exploitation/aws-kms-post-exploitation.md)
{% endcontent-ref %}

### **‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠**

* [https://cloudsecdocs.com/aws/services/logging/cloudtrail/#inventory](https://cloudsecdocs.com/aws/services/logging/cloudtrail/#inventory)

<details>

<summary><strong>‡§ú‡§æ‡§®‡•á‡§Ç AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§∂‡•Ç‡§®‡•ç‡§Ø ‡§∏‡•á ‡§π‡•Ä‡§∞‡•ã ‡§§‡§ï</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a> <strong>‡§ï‡•á ‡§∏‡§æ‡§•!</strong></summary>

HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§§‡§∞‡•Ä‡§ï‡•á:

* ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§Ö‡§™‡§®‡•Ä ‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡§æ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® ‡§¶‡•á‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç **HackTricks** ‡§Æ‡•á‡§Ç ‡§Ø‡§æ **HackTricks ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°** ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡•ã [**‡§∏‡§¨‡•ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§™‡•ç‡§≤‡§æ‡§®‡•ç‡§∏**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* [**‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï PEASS & HackTricks swag**](https://peass.creator-spring.com) ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç
* ‡§π‡§Æ‡§æ‡§∞‡•á ‡§µ‡§ø‡§∂‡•á‡§∑ [**NFTs**](https://opensea.io/collection/the-peass-family) ‡§ï‡§≤‡•á‡§ï‡•ç‡§∂‡§®, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ‡§ñ‡•ã‡§ú‡•á‡§Ç
* **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** üí¨ [**‡§°‡§ø‡§∏‡•ç‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ ‡§π‡§Æ‡•á‡§Ç **‡§ü‡•ç‡§µ‡§ø‡§ü‡§∞** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)\*\* ‡§™‡§∞ ‡§´‡•â‡§≤‡•ã\*\* ‡§ï‡§∞‡•á‡§Ç‡•§
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos ‡§ï‡•ã PR ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡§ï‡•á‡•§

</details>
