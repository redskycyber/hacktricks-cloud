# AWS - CloudWatch Enum

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[NFTs](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ–åœ¨**Twitter**ä¸Šå…³æ³¨æˆ‘ä»¬ ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## CloudWatch

**CloudWatch** **æ”¶é›†**ç›‘æ§å’Œè¿è¥**æ•°æ®**ï¼Œä»¥æ—¥å¿—/æŒ‡æ ‡/äº‹ä»¶çš„å½¢å¼æä¾›å¯¹AWSèµ„æºã€åº”ç”¨ç¨‹åºå’ŒæœåŠ¡çš„**ç»Ÿä¸€è§†å›¾**ã€‚\
CloudWatchæ—¥å¿—äº‹ä»¶æ¯è¡Œæœ‰**256KBçš„å¤§å°é™åˆ¶**ã€‚\
å®ƒå¯ä»¥è®¾ç½®**é«˜åˆ†è¾¨ç‡è­¦æŠ¥**ï¼Œå°†**æ—¥å¿—**å’Œ**æŒ‡æ ‡**å¹¶æ’å¯è§†åŒ–ï¼Œæ‰§è¡Œè‡ªåŠ¨æ“ä½œï¼Œè§£å†³é—®é¢˜ï¼Œå¹¶å‘ç°ä¼˜åŒ–åº”ç”¨ç¨‹åºçš„è§è§£ã€‚

ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ç›‘è§†æ¥è‡ªCloudTrailçš„æ—¥å¿—ã€‚ç›‘è§†çš„äº‹ä»¶åŒ…æ‹¬ï¼š

* å®‰å…¨ç»„å’ŒNACLçš„æ›´æ”¹
* å¯åŠ¨ã€åœæ­¢ã€é‡å¯å’Œç»ˆæ­¢EC2å®ä¾‹
* IAMå’ŒS3ä¸­å®‰å…¨ç­–ç•¥çš„æ›´æ”¹
* AWSç®¡ç†æ§åˆ¶å°ç™»å½•å°è¯•å¤±è´¥
* å¯¼è‡´æˆæƒå¤±è´¥çš„APIè°ƒç”¨
* åœ¨CloudWatchä¸­æœç´¢çš„è¿‡æ»¤å™¨ï¼š[https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/FilterAndPatternSyntax.html](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/FilterAndPatternSyntax.html)

### CloudWatchæ—¥å¿— <a href="#cloudwatch-logs" id="cloudwatch-logs"></a>

å…è®¸**èšåˆå’Œç›‘è§†**æ¥è‡ª**AWSæœåŠ¡**ï¼ˆåŒ…æ‹¬CloudTrailï¼‰å’Œ**åº”ç”¨ç¨‹åº/ç³»ç»Ÿ**çš„æ—¥å¿—ã€‚æ—¥å¿—å¯ä»¥**æ— é™æœŸå­˜å‚¨**ï¼ˆå–å†³äºæ—¥å¿—ç»„è®¾ç½®ï¼‰å¹¶ä¸”å¯ä»¥å¯¼å‡ºã€‚

**å…ƒç´ **ï¼š

| **æ—¥å¿—ç»„**            | å…·æœ‰ç›¸åŒä¿ç•™ã€ç›‘æ§å’Œè®¿é—®æ§åˆ¶è®¾ç½®çš„**æ—¥å¿—æµé›†åˆ**                                                     |
| ------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **æ—¥å¿—æµ**           | å…·æœ‰**ç›¸åŒæ¥æº**çš„**æ—¥å¿—äº‹ä»¶**åºåˆ—                                                                                                |
| **è®¢é˜…è¿‡æ»¤å™¨** | å®šä¹‰ä¸ç‰¹å®šæ—¥å¿—ç»„ä¸­äº‹ä»¶åŒ¹é…çš„**è¿‡æ»¤æ¨¡å¼**ï¼Œå°†å…¶å‘é€åˆ°Kinesis Data Firehoseæµã€Kinesisæµæˆ–Lambdaå‡½æ•° |

### CloudWatchç›‘æ§å’Œäº‹ä»¶

CloudWatch **åŸºæœ¬**æ¯5åˆ†é’Ÿèšåˆä¸€æ¬¡æ•°æ®ï¼ˆ**è¯¦ç»†**èšåˆæ¯1åˆ†é’Ÿä¸€æ¬¡ï¼‰ã€‚åœ¨èšåˆåï¼Œå®ƒä¼š**æ£€æŸ¥è­¦æŠ¥çš„é˜ˆå€¼**ï¼Œä»¥ç¡®å®šæ˜¯å¦éœ€è¦è§¦å‘è­¦æŠ¥ã€‚\
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒCloudWatchå¯ä»¥å‡†å¤‡å‘é€äº‹ä»¶å¹¶æ‰§è¡Œä¸€äº›è‡ªåŠ¨æ“ä½œï¼ˆAWS Lambdaå‡½æ•°ã€SNSä¸»é¢˜ã€SQSé˜Ÿåˆ—ã€Kinesisæµï¼‰

### ä»£ç†å®‰è£…

æ‚¨å¯ä»¥åœ¨æ‚¨çš„æœºå™¨/å®¹å™¨å†…å®‰è£…ä»£ç†ï¼Œè‡ªåŠ¨å°†æ—¥å¿—å‘é€å›CloudWatchã€‚

* **åˆ›å»º**ä¸€ä¸ª**è§’è‰²**å¹¶å°†å…¶é™„åŠ åˆ°å…·æœ‰å…è®¸CloudWatchä»å®ä¾‹æ”¶é›†æ•°æ®çš„æƒé™çš„**å®ä¾‹**ä¸Šï¼Œé™¤äº†ä¸AWSç³»ç»Ÿç®¡ç†å™¨SSMäº¤äº’çš„æƒé™ï¼ˆCloudWatchAgentAdminPolicyå’ŒAmazonEC2RoleforSSMï¼‰
* **ä¸‹è½½**å¹¶**å®‰è£…**ä»£ç†åˆ°EC2å®ä¾‹ä¸Šï¼ˆ[https://s3.amazonaws.com/amazoncloudwatch-agent/linux/amd64/latest/AmazonCloudWatchAgent.zip](https://s3.amazonaws.com/amazoncloudwatch-agent/linux/amd64/latest/AmazonCloudWatchAgent.zip)ï¼‰ã€‚æ‚¨å¯ä»¥ä»EC2å†…éƒ¨ä¸‹è½½å®ƒæˆ–ä½¿ç”¨AWS System Managerè‡ªåŠ¨å®‰è£…ï¼Œé€‰æ‹©åŒ…AWS-ConfigureAWSPackage
* **é…ç½®**å¹¶**å¯åŠ¨**CloudWatchä»£ç†

ä¸€ä¸ªæ—¥å¿—ç»„æœ‰è®¸å¤šæµã€‚ä¸€ä¸ªæµæœ‰è®¸å¤šäº‹ä»¶ã€‚åœ¨æ¯ä¸ªæµçš„å†…éƒ¨ï¼Œäº‹ä»¶ä¿è¯æŒ‰é¡ºåºæ’åˆ—ã€‚ 

## æ“ä½œ

### æšä¸¾
```bash
# Dashboards
aws cloudwatch list-dashboards
aws cloudwatch get-dashboard --dashboard-name <dashboard_name>

# Alarms
aws cloudwatch describe-alarms
aws cloudwatch describe-alarm-history
aws cloudwatch describe-alarms-for-metric --metric-name <metric_name> --namespace <namespace>
aws cloudwatch describe-alarms-for-metric --metric-name IncomingLogEvents --namespace AWS/Logs

# Anomaly Detections
aws cloudwatch describe-anomaly-detectors
aws cloudwatch describe-insight-rules

# Logs
aws logs tail "<log_group_name>" --follow
aws logs get-log-events --log-group-name "<log_group_name>" --log-stream-name "<log_stream_name>" --output text > <output_file>

# Events enumeration
aws events list-rules
aws events describe-rule --name <name>
aws events list-targets-by-rule --rule <name>
aws events list-archives
aws events describe-archive --archive-name <name>
aws events list-connections
aws events describe-connection --name <name>
aws events list-endpoints
aws events describe-endpoint --name <name>
aws events list-event-sources
aws events describe-event-source --name <name>
aws events list-replays
aws events list-api-destinations
aws events list-event-buses
```
## å‚è€ƒ

* [https://cloudsecdocs.com/aws/services/logging/cloudwatch/](https://cloudsecdocs.com/aws/services/logging/cloudwatch/#general-info)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚ 

</details>
