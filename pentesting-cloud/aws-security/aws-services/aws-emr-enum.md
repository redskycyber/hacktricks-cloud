# AWS - EMR Enum

<details>

<summary><strong>Aprende hacking en AWS de cero a h茅roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de GitHub de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## EMR

El servicio de Elastic MapReduce (EMR) de AWS, a partir de la versi贸n 4.8.0, introdujo una caracter铆stica de **configuraci贸n de seguridad** que mejora la protecci贸n de datos al permitir a los usuarios especificar ajustes de cifrado para los datos en reposo y en tr谩nsito dentro de los cl煤steres de EMR, que son grupos escalables de instancias EC2 dise帽ados para procesar frameworks de big data como Apache Hadoop y Spark.

Las caracter铆sticas clave incluyen:

- **Cifrado predeterminado del cl煤ster**: Por defecto, los datos en reposo dentro de un cl煤ster no est谩n cifrados. Sin embargo, habilitar el cifrado proporciona acceso a varias caracter铆sticas:
- **Configuraci贸n de clave unificada de Linux**: Cifra los vol煤menes de cl煤ster de EBS. Los usuarios pueden optar por el Servicio de Gesti贸n de Claves (KMS) de AWS o un proveedor de claves personalizado.
- **Cifrado HDFS de c贸digo abierto**: Ofrece dos opciones de cifrado para Hadoop:
- RPC (Llamada a Procedimiento Remoto) de Hadoop seguro, configurado para privacidad, aprovechando la Capa de Seguridad de Autenticaci贸n Simple.
- Cifrado de transferencia de bloques HDFS, configurado en verdadero, utiliza el algoritmo AES-256.

- **Cifrado en Tr谩nsito**: Se centra en asegurar los datos durante la transferencia. Las opciones incluyen:
- **Seguridad de la capa de transporte (TLS) de c贸digo abierto**: El cifrado se puede habilitar eligiendo un proveedor de certificados:
- **PEM**: Requiere la creaci贸n manual y el agrupamiento de certificados PEM en un archivo zip, referenciado desde un bucket de S3.
- **Personalizado**: Implica agregar una clase Java personalizada como proveedor de certificados que suministra artefactos de cifrado.

Una vez que se integra un proveedor de certificados TLS en la configuraci贸n de seguridad, se pueden activar las siguientes caracter铆sticas de cifrado espec铆ficas de la aplicaci贸n, que var铆an seg煤n la versi贸n de EMR:

- **Hadoop**:
- Podr铆a reducir el mezclado cifrado utilizando TLS.
- RPC de Hadoop seguro con Capa de Seguridad de Autenticaci贸n Simple y Transferencia de Bloques HDFS con AES-256 se activan con el cifrado en reposo.

- **Presto** (versi贸n de EMR 5.6.0+):
- La comunicaci贸n interna entre los nodos de Presto est谩 asegurada utilizando SSL y TLS.

- **Tez Shuffle Handler**:
- Utiliza TLS para el cifrado.

- **Spark**:
- Emplea TLS para el protocolo Akka.
- Utiliza Capa de Seguridad de Autenticaci贸n Simple y 3DES para el Servicio de Transferencia de Bloques.
- El servicio de mezclado externo est谩 asegurado con la Capa de Seguridad de Autenticaci贸n Simple.

Estas caracter铆sticas mejoran colectivamente la postura de seguridad de los cl煤steres de EMR, especialmente en lo que respecta a la protecci贸n de datos durante las fases de almacenamiento y transmisi贸n.


### Enumeraci贸n
```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Get studio URLs
```
### Escalaci贸n de Privilegios

{% content-ref url="../aws-privilege-escalation/aws-emr-privesc.md" %}
[aws-emr-privesc.md](../aws-privilege-escalation/aws-emr-privesc.md)
{% endcontent-ref %}

# Referencias
* [https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/](https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/)

<details>

<summary><strong>Aprende hacking en AWS de cero a h茅roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de GitHub** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
