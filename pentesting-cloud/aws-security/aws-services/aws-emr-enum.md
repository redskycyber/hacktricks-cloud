# AWS - Enumeraci贸n de EMR

<details>

<summary><strong>隆Apoya a HackTricks y obt茅n beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **煤ltima versi贸n de PEASS o descargar HackTricks en PDF** 隆Consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n de exclusivos [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Comparte tus trucos de hacking enviando PR a los repositorios de GitHub de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## EMR

EMR es un servicio administrado por AWS y est谩 compuesto por un **grupo de instancias EC2 altamente escalable** para procesar y ejecutar grandes marcos de datos como Apache Hadoop y Spark.

A partir de la versi贸n 4.8.0 de EMR, tenemos la capacidad de crear una **configuraci贸n de seguridad** que especifica diferentes ajustes sobre **c贸mo administrar la encriptaci贸n de sus datos dentro de sus cl煤steres**. Puede cifrar sus datos en reposo, datos en tr谩nsito o, si es necesario, ambos juntos. Lo bueno de estas configuraciones de seguridad es que en realidad no forman parte de sus cl煤steres EC2.

Un punto clave de EMR es que **por defecto, las instancias dentro de un cl煤ster no cifran los datos en reposo**. Una vez habilitadas, est谩n disponibles las siguientes caracter铆sticas.

* **Configuraci贸n unificada de claves de Linux:** Los vol煤menes del cl煤ster EBS se pueden cifrar mediante este m茅todo, en el que puede especificar AWS **KMS** como su proveedor de administraci贸n de claves, o utilizar un proveedor de claves personalizado.
* **Cifrado de HDFS de c贸digo abierto:** Esto proporciona dos opciones de cifrado de Hadoop. Secure Hadoop RPC, que se establecer铆a en privacidad y que utiliza una capa de seguridad de autenticaci贸n simple, y el cifrado de datos de la transferencia de bloques de HDFS, que se establecer铆a en verdadero para utilizar el algoritmo AES-256.

Desde una perspectiva de cifrado en tr谩nsito, podr铆a habilitar caracter铆sticas de cifrado de **seguridad de capa de transporte de c贸digo abierto** y seleccionar un tipo de proveedor de certificados que puede ser PEM, donde deber谩 crear manualmente certificados PEM, agruparlos en un archivo zip y luego hacer referencia al archivo zip en S3, o personalizado, donde agregar铆a un proveedor de certificados personalizado como una clase Java que proporciona artefactos de cifrado.

Una vez que se ha configurado el proveedor de certificados TLS en el archivo de configuraci贸n de seguridad, se pueden habilitar las siguientes caracter铆sticas de cifrado espec铆ficas de la aplicaci贸n de cifrado que variar谩n seg煤n su versi贸n de EMR.

* Hadoop podr铆a reducir el shuffle cifrado que utiliza TLS. Tanto Secure Hadoop RPC, que utiliza Simple Authentication Security Layer, como el cifrado de datos de la transferencia de bloques de HDFS, que utiliza AES-256, se activan cuando se habilita el cifrado en reposo en la configuraci贸n de seguridad.
* Presto: Cuando se utiliza la versi贸n 5.6.0 o posterior de EMR, cualquier comunicaci贸n interna entre nodos Presto utilizar谩 SSL y TLS.
* Tez Shuffle Handler utiliza TLS.
* Spark: El protocolo Akka utiliza TLS. El servicio de transferencia de bloques utiliza Simple Authentication Security Layer y 3DES. El servicio de mezcla externa utiliza Simple Authentication Security Layer.

### Enumeraci贸n

```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Obtener URLs de estudio
```

### Privesc

{% content-ref url="../aws-privilege-escalation/aws-emr-privesc.md" %}
[aws-emr-privesc.md](../aws-privilege-escalation/aws-emr-privesc.md)
{% endcontent-ref %}

<details>

<summary><strong>隆Apoya a HackTricks y obt茅n beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **煤ltima versi贸n de PEASS o descargar HackTricks en PDF** 隆Consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n de exclusivos [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Comparte tus trucos de hacking enviando PR a los repositorios de GitHub de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>