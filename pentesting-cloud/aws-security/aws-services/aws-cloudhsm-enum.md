# AWS - CloudHSM Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile AWS hacklemeyi sÄ±fÄ±rdan ileri seviyeye Ã¶ÄŸrenin!</summary>

DiÄŸer HackTricks'i destekleme yollarÄ±:

- **Åirketinizi HackTricks'te reklamÄ±nÄ±zÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
- [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
- ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)'Ä± takip edin.
- **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'lar gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>

## HSM - DonanÄ±m GÃ¼venlik ModÃ¼lÃ¼

Cloud HSM, gÃ¼venli ÅŸifreleme anahtar depolama iÃ§in FIPS 140 seviye iki onaylÄ± **donanÄ±m cihazÄ±**dÄ±r (CloudHSM bir donanÄ±m cihazÄ±dÄ±r, sanallaÅŸtÄ±rÄ±lmÄ±ÅŸ bir hizmet deÄŸildir). 5.3.13 Ã¶nceden yÃ¼klenmiÅŸ SafeNetLuna 7000 cihazÄ±dÄ±r. Ä°ki firmware sÃ¼rÃ¼mÃ¼ bulunmakta ve hangisini seÃ§eceÄŸiniz tamamen ihtiyaÃ§larÄ±nÄ±za baÄŸlÄ±dÄ±r. Bir tanesi FIPS 140-2 uyumluluÄŸu iÃ§indir ve daha yeni bir sÃ¼rÃ¼m de kullanÄ±labilir.

CloudHSM'nin olaÄŸandÄ±ÅŸÄ± Ã¶zelliÄŸi, fiziksel bir cihaz olmasÄ± ve dolayÄ±sÄ±yla **diÄŸer mÃ¼ÅŸterilerle paylaÅŸÄ±lmamasÄ±dÄ±r**, veya yaygÄ±n olarak ifade edildiÄŸi gibi Ã§ok kiracÄ±lÄ±. Bu, yalnÄ±zca sizin iÅŸ yÃ¼kleriniz iÃ§in Ã¶zel olarak sunulan tek kiracÄ±lÄ± bir cihazdÄ±r.

Genellikle, kapasite mevcut ise cihaz 15 dakika iÃ§inde kullanÄ±ma hazÄ±r hale gelir, ancak bazÄ± bÃ¶lgelerde olmayabilir.

Bu fiziksel bir cihaz olduÄŸundan, **anahtarlar cihazda depolanÄ±r**. Anahtarlar ya baÅŸka bir cihaza **replike edilmeli**, Ã§evrimdÄ±ÅŸÄ± depolamaya yedeklenmeli veya yedek bir cihaza aktarÄ±lmalÄ±dÄ±r. Bu cihaz, S3 veya KMS gibi AWS'deki baÅŸka bir hizmet tarafÄ±ndan desteklenmez.

**CloudHSM**'de, **hizmeti kendiniz Ã¶lÃ§eklendirmeniz gerekir**. Ã‡Ã¶zÃ¼mÃ¼nÃ¼z iÃ§in uygulamayÄ± seÃ§tiÄŸiniz ÅŸifreleme algoritmalarÄ±na dayanarak, ÅŸifreleme ihtiyaÃ§larÄ±nÄ±zÄ± karÅŸÄ±lamak iÃ§in yeterli sayÄ±da CloudHSM cihazÄ± saÄŸlamanÄ±z gerekir.\
Anahtar YÃ¶netimi Servisi'nin Ã¶lÃ§eklendirilmesi AWS tarafÄ±ndan gerÃ§ekleÅŸtirilir ve talebe gÃ¶re otomatik olarak Ã¶lÃ§eklenir, bu nedenle kullanÄ±mÄ±nÄ±z arttÄ±kÃ§a gereken CloudHSM cihazlarÄ±nÄ±n sayÄ±sÄ± da artabilir. Ã‡Ã¶zÃ¼mÃ¼nÃ¼zÃ¼ Ã¶lÃ§eklendirirken bunu gÃ¶z Ã¶nÃ¼nde bulundurun ve Ã§Ã¶zÃ¼mÃ¼nÃ¼z otomatik Ã¶lÃ§eklendirme Ã¶zelliÄŸine sahipse, Ã§Ã¶zÃ¼mÃ¼ze hizmet verecek yeterli sayÄ±da CloudHSM cihazÄ±nÄ±n maksimum Ã¶lÃ§eÄŸini hesaba katÄ±n.

Ã–lÃ§eklendirme gibi, **performans CloudHSM ile size baÄŸlÄ±dÄ±r**. Performans, kullanÄ±lan ÅŸifreleme algoritmasÄ±na ve verileri ÅŸifrelemek iÃ§in anahtarlarÄ± ne sÄ±klÄ±kta eriÅŸmeniz gerektiÄŸine baÄŸlÄ± olarak deÄŸiÅŸir. Anahtar yÃ¶netimi servisi performansÄ± Amazon tarafÄ±ndan yÃ¶netilir ve talep gerektirdiÄŸinde otomatik olarak Ã¶lÃ§eklenir. CloudHSM'nin performansÄ±, daha fazla cihaz ekleyerek elde edilir ve daha fazla performans gerekiyorsa ya cihazlar eklenir ya da daha hÄ±zlÄ± olan bir ÅŸifreleme yÃ¶ntemine geÃ§ilir.

Ã‡Ã¶zÃ¼mÃ¼nÃ¼z **Ã§oklu bÃ¶lge** ise, ikinci bÃ¶lgede birkaÃ§ **CloudHSM cihazÄ± eklemeli ve Ã¶zel bir VPN baÄŸlantÄ±sÄ± ile Ã§apraz bÃ¶lge baÄŸlantÄ±sÄ±nÄ± Ã§alÄ±ÅŸtÄ±rmalÄ±sÄ±nÄ±z** veya trafiÄŸin baÄŸlantÄ±nÄ±n her katmanÄ±nda her zaman korunduÄŸundan emin olmak iÃ§in baÅŸka bir yÃ¶ntem kullanmalÄ±sÄ±nÄ±z. Ã‡oklu bÃ¶lge Ã§Ã¶zÃ¼mÃ¼nÃ¼z varsa, anahtarlarÄ± **replike etmeyi ve iÅŸlettiÄŸiniz bÃ¶lgelerde ek CloudHSM cihazlarÄ± kurmayÄ± dÃ¼ÅŸÃ¼nmelisiniz**. HÄ±zlÄ±ca birden fazla bÃ¶lgeye yayÄ±lmÄ±ÅŸ altÄ± veya sekiz cihaza sahip bir senaryoya girebilirsiniz ve ÅŸifreleme anahtarlarÄ±nÄ±zÄ±n tam yedekliÄŸini saÄŸlayabilirsiniz.

**CloudHSM**, gÃ¼venli anahtar depolama iÃ§in kurumsal sÄ±nÄ±f bir hizmettir ve bir **kuruluÅŸun gÃ¼ven kÃ¶kÃ¼** olarak kullanÄ±labilir. PKI'da Ã¶zel anahtarlarÄ± ve X509 uygulamalarÄ±nda sertifika yetkilisi anahtarlarÄ±nÄ± depolayabilir. AES gibi simetrik algoritmalarÄ±nda kullanÄ±lan simetrik anahtarlarÄ± fiziksel olarak saklar ve korurken, **KMS yalnÄ±zca simetrik anahtarlarÄ± (sertifika yetkilisi olarak hareket edemez) saklar ve korur**, bu nedenle PKI ve CA anahtarlarÄ±nÄ± saklamanÄ±z gerekiyorsa bir veya birkaÃ§ CloudHSM cihazÄ± Ã§Ã¶zÃ¼mÃ¼nÃ¼z olabilir.

**CloudHSM, Anahtar YÃ¶netimi Servisinden Ã¶nemli Ã¶lÃ§Ã¼de daha pahalÄ±dÄ±r**. CloudHSM bir donanÄ±m cihazÄ± olduÄŸundan, CloudHSM cihazÄ±nÄ± saÄŸlamak iÃ§in sabit maliyetlere ve cihazÄ± Ã§alÄ±ÅŸtÄ±rmak iÃ§in saatlik bir Ã¼crete sahipsiniz. Maliyet, belirli gereksinimlerinizi karÅŸÄ±lamak iÃ§in gereken CloudHSM cihazÄ± sayÄ±sÄ±na gÃ¶re Ã§arpÄ±lÄ±r.\
AyrÄ±ca, SafeNet ProtectV yazÄ±lÄ±m paketleri gibi Ã¼Ã§Ã¼ncÃ¼ taraf yazÄ±lÄ±mlarÄ±n satÄ±n alÄ±nmasÄ±, entegrasyon sÃ¼resi ve Ã§abasÄ± gÃ¶z Ã¶nÃ¼nde bulundurulmalÄ±dÄ±r. Anahtar YÃ¶netimi Servisi, kullanÄ±m tabanlÄ± bir hizmettir ve sahip olduÄŸunuz anahtar sayÄ±sÄ±na ve giriÅŸ/Ã§Ä±kÄ±ÅŸ iÅŸlemlerine baÄŸlÄ±dÄ±r. Anahtar yÃ¶netimi, birÃ§ok AWS hizmetiyle sorunsuz entegrasyon saÄŸladÄ±ÄŸÄ±ndan, entegrasyon maliyetleri Ã¶nemli Ã¶lÃ§Ã¼de daha dÃ¼ÅŸÃ¼k olmalÄ±dÄ±r. Maliyetler, genellikle gÃ¼venlik ve uyumluluk iÃ§in kullanÄ±lan ÅŸifreleme Ã§Ã¶zÃ¼mlerinde ikincil bir faktÃ¶r olarak dÃ¼ÅŸÃ¼nÃ¼lmelidir.

**CloudHSM ile yalnÄ±zca siz anahtarlara eriÅŸebilirsiniz** ve Ã§ok fazla detaya girmeden, CloudHSM ile kendi anahtarlarÄ±nÄ±zÄ± yÃ¶netirsiniz. **KMS ile siz ve Amazon anahtarlarÄ±nÄ±zÄ± birlikte yÃ¶netirsiniz**. AWS'nin her iki Ã§Ã¶zÃ¼mde de kÃ¶tÃ¼ye kullanÄ±ma karÅŸÄ± birÃ§ok politika korumasÄ± vardÄ±r ve **her iki Ã§Ã¶zÃ¼mde de anahtarlarÄ±nÄ±za eriÅŸemez**. Temel fark, anahtar sahipliÄŸi ve yÃ¶netimi aÃ§Ä±sÄ±ndan uyumluluktur ve CloudHSM ile, bu sizin ve yalnÄ±zca sizin Ã¶zel eriÅŸiminizle yÃ¶nettiÄŸiniz bir donanÄ±m cihazÄ±dÄ±r.

### CloudHSM Ã–nerileri

1. Her zaman en az iki cihazÄ±n **farklÄ± kullanÄ±labilirlik bÃ¶lgelerinde** **HA kurulumu** ile CloudHSM daÄŸÄ±tÄ±n ve mÃ¼mkÃ¼nse Ã¼Ã§Ã¼ncÃ¼ bir cihazÄ± yerinde veya baÅŸka bir AWS bÃ¶lgesinde daÄŸÄ±tÄ±n.
2. Bir **CloudHSM**'yi **baÅŸlatÄ±rken** dikkatli olun. Bu eylem **anahtarlarÄ± yok eder**, bu nedenle anahtarlarÄ±n baÅŸka bir kopyasÄ±na sahip olun veya bu anahtarlarÄ± hiÃ§bir zaman ve asla verileri ÅŸifrelemek iÃ§in bu anahtarlara ihtiyacÄ±nÄ±z olmayacaÄŸÄ±ndan emin olun.
3. CloudHSM yalnÄ±zca belirli **firmware ve yazÄ±lÄ±m sÃ¼rÃ¼mlerini destekler**. Herhangi bir gÃ¼ncelleme yapmadan Ã¶nce, firmware'in veya yazÄ±lÄ±mÄ±n AWS tarafÄ±ndan desteklendiÄŸinden emin olun. GÃ¼ncelleme kÄ±lavuzunun anlaÅŸÄ±lmaz olduÄŸu durumlarda AWS destek ekibiyle iletiÅŸime geÃ§ebilirsiniz.
4. **AÄŸ yapÄ±landÄ±rmasÄ± asla deÄŸiÅŸtirilmemelidir.** UnutmayÄ±n, bu bir AWS veri merkezinde ve AWS, temel donanÄ±mÄ± sizin iÃ§in izliyor. Bu, donanÄ±m arÄ±zalandÄ±ÄŸÄ±nda sadece arÄ±zalÄ± donanÄ±mÄ± deÄŸiÅŸtirecekleri anlamÄ±na gelir.
5. **SysLog yÃ¶nlendirmesi kaldÄ±rÄ±lmamalÄ± veya deÄŸiÅŸtirilmemelidir.** LoglarÄ± kendi toplama aracÄ±nÄ±za yÃ¶nlendirmek iÃ§in bir SysLog yÃ¶nlendirici ekleyebilirsiniz.
6. **SNMP** yapÄ±landÄ±rmasÄ±, aÄŸ ve SysLog klasÃ¶rÃ¼yle aynÄ± temel kÄ±sÄ±tlamalara sahiptir. Bu **deÄŸiÅŸtirilmemeli veya kaldÄ±rÄ±lmamalÄ±dÄ±r**. Ek bir SNMP yapÄ±landÄ±rmasÄ± sorun deÄŸil, sadece zaten cihazda bulunanÄ± deÄŸiÅŸtirmemeniz gerektiÄŸinden emin olun.
7. AWS'den baÅŸka bir ilginÃ§ en iyi uygulama, **NTP yapÄ±landÄ±rmasÄ±nÄ± deÄŸiÅŸtirmemeniz gerektiÄŸidir**. EÄŸer deÄŸiÅŸtirirseniz ne olacaÄŸÄ± net deÄŸildir, bu nedenle Ã§Ã¶zÃ¼mÃ¼nÃ¼zÃ¼n geri kalanÄ± iÃ§in aynÄ± NTP yapÄ±landÄ±rmasÄ±nÄ± kullanmÄ±yorsanÄ±z iki zaman kaynaÄŸÄ±nÄ±z olabilir. Bu durumun farkÄ±nda olun ve CloudHSM'nin mevcut NTP kaynaÄŸÄ±yla kalmasÄ± gerektiÄŸini unutmayÄ±n.

CloudHSM iÃ§in ilk baÅŸlatma Ã¼creti, size Ã¶zel ayrÄ±lmÄ±ÅŸ donanÄ±m cihazÄ±nÄ± tahsis etmek iÃ§in 5.000 $'dÄ±r, ardÄ±ndan CloudHSM'nin Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ± iÃ§in saatlik bir Ã¼cret vardÄ±r ve ÅŸu anda iÅŸletme baÅŸÄ±na saatte 1,88 $ veya yaklaÅŸÄ±k olarak aylÄ±k 1.373 $'dÄ±r.

CloudHSM'yi kullanmanÄ±n en yaygÄ±n nedeni, dÃ¼zenleyici gereksinimleri karÅŸÄ±lamak zorunda olduÄŸunuz uyumluluk standartlarÄ±dÄ±r. **KMS, asimetrik anahtarlar iÃ§in veri desteÄŸi sunmaz. CloudHSM, asimetrik anahtarlarÄ± gÃ¼venli bir ÅŸekilde depolamanÄ±za izin verir**.

**Genel anahtar, HSM cihazÄ±na kurulum sÄ±rasÄ±nda yÃ¼klenir** bÃ¶ylece SSH aracÄ±lÄ±ÄŸÄ±yla CloudHSM Ã¶rneÄŸine eriÅŸebilirsiniz.
### Bir DonanÄ±m GÃ¼venlik ModÃ¼lÃ¼ Nedir

Bir donanÄ±m gÃ¼venlik modÃ¼lÃ¼ (HSM), kriptografik anahtarlarÄ± oluÅŸturmak, depolamak ve yÃ¶netmek ve hassas verileri korumak iÃ§in kullanÄ±lan Ã¶zel bir cihazdÄ±r. Kriptografik iÅŸlevleri sistemden fiziksel ve elektronik olarak izole ederek yÃ¼ksek dÃ¼zeyde gÃ¼venlik saÄŸlamak Ã¼zere tasarlanmÄ±ÅŸtÄ±r.

Bir HSM'nin Ã§alÄ±ÅŸma ÅŸekli, belirli model ve Ã¼reticiye baÄŸlÄ± olarak deÄŸiÅŸebilir, ancak genellikle aÅŸaÄŸÄ±daki adÄ±mlar gerÃ§ekleÅŸir:

1. **Anahtar oluÅŸturma**: HSM, gÃ¼venli rastgele sayÄ± Ã¼reteci kullanarak rastgele bir kriptografik anahtar oluÅŸturur.
2. **Anahtar depolama**: Anahtar, **yalnÄ±zca yetkili kullanÄ±cÄ±lar veya iÅŸlemler tarafÄ±ndan eriÅŸilebileceÄŸi ÅŸekilde** HSM iÃ§inde **gÃ¼venli bir ÅŸekilde depolanÄ±r**.
3. **Anahtar yÃ¶netimi**: HSM, anahtar dÃ¶ndÃ¼rme, yedekleme ve iptal gibi bir dizi anahtar yÃ¶netimi iÅŸlevi saÄŸlar.
4. **Kriptografik iÅŸlemler**: HSM, ÅŸifreleme, ÅŸifre Ã§Ã¶zme, dijital imza ve anahtar deÄŸiÅŸimi de dahil olmak Ã¼zere Ã§eÅŸitli kriptografik iÅŸlemleri gerÃ§ekleÅŸtirir. Bu iÅŸlemler, **HSM'nin gÃ¼venli ortamÄ±nda gerÃ§ekleÅŸtirilir**, bu da yetkisiz eriÅŸime ve mÃ¼dahaleye karÅŸÄ± koruma saÄŸlar.
5. **Denetim gÃ¼nlÃ¼ÄŸÃ¼**: HSM, tÃ¼m kriptografik iÅŸlemleri ve eriÅŸim giriÅŸimlerini kaydeder, bu da uyumluluk ve gÃ¼venlik denetimi amaÃ§larÄ± iÃ§in kullanÄ±labilir.

HSM'ler, gÃ¼venli Ã§evrimiÃ§i iÅŸlemler, dijital sertifikalar, gÃ¼venli iletiÅŸim ve veri ÅŸifreleme dahil olmak Ã¼zere geniÅŸ bir uygulama yelpazesinde kullanÄ±labilir. Genellikle yÃ¼ksek dÃ¼zeyde gÃ¼venlik gerektiren finans, saÄŸlÄ±k ve hÃ¼kÃ¼met gibi endÃ¼strilerde kullanÄ±lÄ±rlar.

Genel olarak, HSM'ler tarafÄ±ndan saÄŸlanan yÃ¼ksek gÃ¼venlik seviyesi, **onlardan ham anahtarlarÄ±n Ã§Ä±karÄ±lmasÄ±nÄ± Ã§ok zor hale getirir ve bunu denemek genellikle bir gÃ¼venlik ihlali olarak kabul edilir**. Bununla birlikte, belirli senaryolarda, Ã¶rneÄŸin bir anahtar kurtarma prosedÃ¼rÃ¼nde olduÄŸu gibi, **yetkili personel tarafÄ±ndan belirli amaÃ§lar iÃ§in ham bir anahtar Ã§Ä±karÄ±labilir**.

### NumaralandÄ±rma
```
TODO
```
<details>

<summary><strong>SÄ±fÄ±rdan kahraman olmaya kadar AWS hacklemeyi Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'da takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± paylaÅŸarak PR'ler gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
