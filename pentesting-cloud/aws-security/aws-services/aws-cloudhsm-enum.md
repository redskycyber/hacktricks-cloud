# AWS - CloudHSM Enum

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w GitHub.

</details>

## HSM - Modu Bezpieczestwa Sprztowego

Cloud HSM to sprztowe urzdzenie **walidowane na poziomie FIPS 140-2**, su偶ce do bezpiecznego przechowywania kluczy kryptograficznych (nale偶y zauwa偶y, 偶e CloudHSM to urzdzenie sprztowe, a nie wirtualna usuga). Jest to urzdzenie SafeNetLuna 7000 z wersj 5.3.13 preinstalowan. Istniej dwie wersje oprogramowania ukadowego, a wyb贸r zale偶y od konkretnych potrzeb. Jedna z nich jest zgodna z norm FIPS 140-2, a istnieje nowsza wersja, kt贸ra mo偶e by u偶ywana.

Nietypow cech CloudHSM jest to, 偶e jest to fizyczne urzdzenie i **nie jest wsp贸dzielone z innymi klientami**, czyli nie jest wieloosobowe. Jest to dedykowane urzdzenie dla jednego najemcy, dostpne wycznie dla Twoich obci偶e.

Zazwyczaj urzdzenie jest dostpne w cigu 15 minut, o ile jest dostpna pojemno, ale w niekt贸rych strefach mo偶e jej nie by.

Poniewa偶 jest to fizyczne urzdzenie dedykowane dla Ciebie, **klucze s przechowywane na urzdzeniu**. Klucze musz by replikowane na inne urzdzenie, zapisywane na offline storage lub eksportowane do zapasowego urzdzenia. **To urzdzenie nie jest obsugiwane** przez S3 ani 偶adn inn usug AWS, tak jak KMS.

W **CloudHSM** musisz **samodzielnie skalowa usug**. Musisz dostarczy wystarczajc liczb urzdze CloudHSM, aby obsu偶y swoje potrzeby zwizane z szyfrowaniem, w zale偶noci od algorytm贸w szyfrowania, kt贸re wybrae do implementacji w swoim rozwizaniu.\
Skalowanie usugi Key Management Service jest wykonywane przez AWS i automatycznie dostosowuje si do zapotrzebowania, wic w miar wzrostu u偶ytkowania mo偶e by wymagana wiksza liczba urzdze CloudHSM. Pamitaj o tym, skalujc swoje rozwizanie, i jeli Twoje rozwizanie ma automatyczne skalowanie, upewnij si, 偶e maksymalna skala jest uwzgldniona w wystarczajcej liczbie urzdze CloudHSM do obsugi rozwizania.

Podobnie jak skalowanie, **wydajno zale偶y od Ciebie z CloudHSM**. Wydajno zale偶y od u偶ywanego algorytmu szyfrowania i czstotliwoci dostpu lub pobierania kluczy do szyfrowania danych. Wydajno usugi zarzdzania kluczami jest obsugiwana przez Amazona i automatycznie dostosowuje si do wymaga zapotrzebowania. Wydajno CloudHSM jest osigana poprzez dodawanie kolejnych urzdze, a jeli potrzebujesz wikszej wydajnoci, musisz doda urzdzenia lub zmieni metod szyfrowania na szybszy algorytm.

Jeli Twoje rozwizanie jest **wieloregionalne**, powiniene doda kilka **urzdze CloudHSM w drugim regionie i skonfigurowa czno midzyregionow za pomoc prywatnego poczenia VPN** lub inn metod, aby zapewni ochron ruchu midzy urzdzeniem na ka偶dym poziomie poczenia. Jeli masz rozwizanie wieloregionalne, musisz zastanowi si, jak replikowa klucze i skonfigurowa dodatkowe urzdzenia CloudHSM w regionach, w kt贸rych dziaasz. Mo偶esz bardzo szybko znale藕 si w sytuacji, w kt贸rej masz sze lub osiem urzdze rozproszonych w r贸偶nych regionach, zapewniajcych pen redundancj kluczy szyfrowania.

**CloudHSM** to usuga klasy enterprise do bezpiecznego przechowywania kluczy i mo偶e by u偶ywana jako **podstawa zaufania dla przedsibiorstwa**. Mo偶e przechowywa klucze prywatne w PKI i klucze certyfikat贸w w implementacjach X509. Opr贸cz kluczy symetrycznych u偶ywanych w algorytmach symetrycznych, takich jak AES, **KMS przechowuje i fizycznie chroni tylko klucze symetryczne (nie mo偶e dziaa jako urzdzenie certyfikujce)**, wic jeli potrzebujesz przechowywa klucze PKI i CA, CloudHSM lub dwa lub trzy urzdzenia mog by Twoim rozwizaniem.

**CloudHSM jest znacznie dro偶szy ni偶 Key Management Service**. CloudHSM to urzdzenie sprztowe, wic musisz ponie koszty zwizane z dostarczeniem urzdzenia CloudHSM, a nastpnie koszt godzinowy zwizany z jego dziaaniem, kt贸ry obecnie wynosi 1,88 USD za godzin pracy, czyli okoo 1 373 USD miesicznie.

Najczstszym powodem u偶ycia CloudHSM s standardy zgodnoci, kt贸re musisz speni z przyczyn regulacyjnych. **KMS nie oferuje obsugi danych dla kluczy asymetrycznych. CloudHSM pozwala na bezpieczne przechowywanie kluczy asymetrycznych**.

**Klucz publiczny jest instalowany na urzdzeniu HSM podczas inicjalizacji**, dziki czemu mo偶na uzyska dostp do instancji CloudHSM za pomoc SSH.
### Co to jest modu zabezpiecze sprztowych (HSM)

Modu zabezpiecze sprztowych (HSM) to dedykowane urzdzenie kryptograficzne, kt贸re su偶y do generowania, przechowywania i zarzdzania kluczami kryptograficznymi oraz ochrony danych poufnych. Zosta zaprojektowany w celu zapewnienia wysokiego poziomu bezpieczestwa poprzez fizyczn i elektroniczn izolacj funkcji kryptograficznych od reszty systemu.

Spos贸b dziaania HSM mo偶e si r贸偶ni w zale偶noci od konkretnego modelu i producenta, ale og贸lnie wystpuj nastpujce kroki:

1. **Generowanie kluczy**: HSM generuje losowy klucz kryptograficzny za pomoc bezpiecznego generatora liczb losowych.
2. **Przechowywanie kluczy**: Klucz jest **przechowywany bezpiecznie wewntrz HSM, gdzie mo偶e by dostpny tylko dla upowa偶nionych u偶ytkownik贸w lub proces贸w**.
3. **Zarzdzanie kluczami**: HSM zapewnia szereg funkcji zarzdzania kluczami, w tym rotacj kluczy, tworzenie kopii zapasowych i uniewa偶nianie.
4. **Operacje kryptograficzne**: HSM wykonuje r贸偶ne operacje kryptograficzne, takie jak szyfrowanie, deszyfrowanie, cyfrowe podpisywanie i wymiana kluczy. Te operacje s **wykonywane w bezpiecznym rodowisku HSM**, kt贸re chroni przed nieautoryzowanym dostpem i manipulacj.
5. **Rejestracja audytowa**: HSM rejestruje wszystkie operacje kryptograficzne i pr贸by dostpu, co mo偶e by wykorzystane do cel贸w audytu zgodnoci i bezpieczestwa.

HSM-y mog by stosowane w r贸偶nych aplikacjach, w tym w bezpiecznych transakcjach online, certyfikatach cyfrowych, bezpiecznej komunikacji i szyfrowaniu danych. S czsto u偶ywane w bran偶ach, kt贸re wymagaj wysokiego poziomu bezpieczestwa, takich jak finanse, opieka zdrowotna i sektor publiczny.

Og贸lnie rzecz biorc, wysoki poziom bezpieczestwa zapewniany przez HSM-y sprawia, 偶e **jest bardzo trudno wydoby z nich surowe klucze, a pr贸ba tego jest czsto uwa偶ana za naruszenie bezpieczestwa**. Jednak偶e, mog wystpowa **pewne scenariusze**, w kt贸rych **upowa偶niony personel mo偶e wydoby surowy klucz** w celach specyficznych, na przykad w przypadku procedury odzyskiwania klucza.

### Wyliczanie
```
```
<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w github.

</details>
