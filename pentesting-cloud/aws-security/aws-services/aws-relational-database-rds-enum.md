# AWS - Relational Database (RDS) Enum

<details>

<summary><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong> ile AWS hackleme hakkÄ±nda sÄ±fÄ±rdan kahramana kadar Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya HackTricks'i **PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonu
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)'Ä± takip edin.
* Hacking hilelerinizi gÃ¶ndererek HackTricks ve HackTricks Cloud github depolarÄ±na PR gÃ¶ndererek **hacking hilelerinizi paylaÅŸÄ±n**.

</details>

## Temel Bilgiler

AWS tarafÄ±ndan sunulan **Ä°liÅŸkisel VeritabanÄ± Hizmeti (RDS)**, bir **iliÅŸkisel veritabanÄ±nÄ±n bulut Ã¼zerindeki** daÄŸÄ±tÄ±mÄ±nÄ±, iÅŸletimini ve Ã¶lÃ§eklendirmesini kolaylaÅŸtÄ±rmak iÃ§in tasarlanmÄ±ÅŸtÄ±r. Bu hizmet, donanÄ±m saÄŸlama, veritabanÄ± yapÄ±landÄ±rmasÄ±, yamalama ve yedekleme gibi iÅŸgÃ¼cÃ¼ yoÄŸun gÃ¶revleri otomatikleÅŸtirirken maliyet verimliliÄŸi ve Ã¶lÃ§eklenebilirlik avantajlarÄ±nÄ± sunar.

AWS RDS, MySQL, PostgreSQL, MariaDB, Oracle Database, Microsoft SQL Server ve Amazon Aurora gibi yaygÄ±n olarak kullanÄ±lan iliÅŸkisel veritabanÄ± motorlarÄ±nÄ± destekler ve hem MySQL hem de PostgreSQL iÃ§in uyumluluk saÄŸlar.

RDS'nin temel Ã¶zellikleri ÅŸunlardÄ±r:

* **VeritabanÄ± Ã¶rneklerinin yÃ¶netimi** basitleÅŸtirilmiÅŸtir.
* Okuma performansÄ±nÄ± artÄ±rmak iÃ§in **okuma kopyalarÄ±** oluÅŸturma.
* YÃ¼ksek kullanÄ±labilirlik ve otomatik geÃ§iÅŸ mekanizmalarÄ±nÄ± saÄŸlamak iÃ§in **Ã§oklu EriÅŸilebilirlik BÃ¶lgesi (AZ) daÄŸÄ±tÄ±mlarÄ±nÄ±** yapÄ±landÄ±rma.
* DiÄŸer AWS hizmetleriyle **entegrasyon**, Ã¶rneÄŸin:
* SaÄŸlam eriÅŸim kontrolÃ¼ iÃ§in AWS Kimlik ve EriÅŸim YÃ¶netimi (**IAM**).
* KapsamlÄ± izleme ve metrikler iÃ§in AWS **CloudWatch**.
* Dinlenme sÄ±rasÄ±nda ÅŸifreleme saÄŸlamak iÃ§in AWS Anahtar YÃ¶netimi Hizmeti (**KMS**).

## Kimlik Bilgileri

DB kÃ¼mesi oluÅŸturulurken ana **kullanÄ±cÄ± adÄ±** yapÄ±landÄ±rÄ±labilir (varsayÄ±lan olarak **`admin`**). Bu kullanÄ±cÄ±nÄ±n ÅŸifresini oluÅŸturmak iÃ§in ÅŸunlarÄ± yapabilirsiniz:

* Kendiniz bir **ÅŸifre belirtin**
* RDS'ye **otomatik olarak oluÅŸturmasÄ±nÄ±** sÃ¶yleyin
* RDS'nin bunu bir KMS anahtarÄ±yla ÅŸifrelenmiÅŸ olarak **AWS Secret Manager**'da yÃ¶netmesini sÃ¶yleyin

<figure><img src="../../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

### Kimlik DoÄŸrulama

3 tÃ¼r kimlik doÄŸrulama seÃ§eneÄŸi vardÄ±r, ancak **ana ÅŸifre her zaman kullanÄ±labilir**:

<figure><img src="../../../.gitbook/assets/image (19) (2).png" alt=""><figcaption></figcaption></figure>

### Genel EriÅŸim ve VPC

VarsayÄ±lan olarak veritabanlarÄ±na **genel eriÅŸim izni verilmez**, ancak **verilebilir**. Bu nedenle, varsayÄ±lan olarak yalnÄ±zca aynÄ± VPC'den gelen makineler eriÅŸebilir, seÃ§ilen **gÃ¼venlik grubu** (EC2 SG'de depolanÄ±r) buna izin veriyorsa.

Bir DB Ã¶rneÄŸini aÃ§Ä±ÄŸa Ã§Ä±karmak yerine, DB kÃ¼mesinin **Ã¶lÃ§eklenebilirliÄŸini** ve **yetenekliliÄŸini artÄ±ran** bir **RDS Proxy** oluÅŸturmak mÃ¼mkÃ¼ndÃ¼r.

AyrÄ±ca, **veritabanÄ± baÄŸlantÄ± noktasÄ± da deÄŸiÅŸtirilebilir**.

### Åifreleme

AWS yÃ¶netilen bir anahtar kullanarak ÅŸifreleme varsayÄ±lan olarak etkinleÅŸtirilir (bir CMK seÃ§ilebilir).

Åifrelemeyi etkinleÅŸtirerek, depolama, anlÄ±k gÃ¶rÃ¼ntÃ¼ler, okuma kopyalarÄ± ve yedeklemeleriniz iÃ§in **dinlenme sÄ±rasÄ±nda ÅŸifreleme** etkinleÅŸtirirsiniz. Bu ÅŸifrelemenin yÃ¶netimi iÃ§in **KMS** kullanÄ±larak bu ÅŸifrelemeyi yÃ¶netmek iÃ§in anahtarlar oluÅŸturulabilir.\
Bu dÃ¼zeyde ÅŸifrelemeyi veritabanÄ±nÄ±z oluÅŸturulduktan sonra eklemek mÃ¼mkÃ¼n deÄŸildir. **OluÅŸturulma sÄ±rasÄ±nda yapÄ±lmasÄ± gerekmektedir**.

Ancak, aÅŸaÄŸÄ±daki gibi ÅŸifrelenmemiÅŸ bir veritabanÄ±nÄ± ÅŸifrelemek iÃ§in bir **Ã§alÄ±ÅŸma yÃ¶ntemi** vardÄ±r. ÅifrelenmemiÅŸ veritabanÄ±nÄ±zÄ±n bir anlÄ±k gÃ¶rÃ¼ntÃ¼sÃ¼nÃ¼ oluÅŸturabilir, bu anlÄ±k gÃ¶rÃ¼ntÃ¼nÃ¼n ÅŸifrelenmiÅŸ bir kopyasÄ±nÄ± oluÅŸturabilir, bu ÅŸifrelenmiÅŸ anlÄ±k gÃ¶rÃ¼ntÃ¼yÃ¼ kullanarak yeni bir veritabanÄ± oluÅŸturabilir ve ardÄ±ndan veritabanÄ±nÄ±z ÅŸifrelenmiÅŸ olur.

#### Åeffaf Veri Åifreleme (TDE)

RDS'nin uygulama dÃ¼zeyindeki ÅŸifreleme yeteneklerinin yanÄ± sÄ±ra, RDS ayrÄ±ca verileri dinlenme sÄ±rasÄ±nda korumak iÃ§in **ek platform dÃ¼zeyi ÅŸifreleme mekanizmalarÄ±nÄ±** destekler. Bu, Oracle ve SQL Server iÃ§in **Åeffaf Veri Åifrelemesi (TDE)**'yi iÃ§erir. Bununla birlikte, TDE, verileri dinlenme sÄ±rasÄ±nda ÅŸifreleyerek gÃ¼venliÄŸi artÄ±rÄ±rken, veritabanÄ± performansÄ±nÄ± da **etkileyebilir**. Bu performans etkisi, Ã¶zellikle MySQL ÅŸifreleme iÅŸlevleri veya Microsoft Transact-SQL ÅŸifreleme iÅŸlevleriyle birlikte kullanÄ±ldÄ±ÄŸÄ±nda fark edilir.

TDE'yi kullanmak iÃ§in belirli Ã¶n adÄ±mlar gereklidir:

1. **SeÃ§enek Grubu Ä°liÅŸkilendirme**:

* VeritabanÄ± bir seÃ§enek grubuyla iliÅŸkilendirilmelidir. SeÃ§enek gruplarÄ±, ayarlarÄ± ve Ã¶zellikleri iÃ§eren konteynerler olarak hizmet verir, veritabanÄ± yÃ¶netimini, gÃ¼venlik geliÅŸtirmelerini de iÃ§eren ÅŸekilde kolaylaÅŸtÄ±rÄ±r.
* Bununla birlikte, seÃ§enek gruplarÄ±nÄ±n yalnÄ±zca belirli veritabanÄ± motorlarÄ± ve sÃ¼rÃ¼mleri iÃ§in mevcut olduÄŸunu unutmak Ã¶nemlidir.

2. **TDE'nin SeÃ§enek Grubuna Dahil Edilmesi**:

* Bir seÃ§enek grubuyla iliÅŸkilendirildikten sonra, Oracle Åeffaf Veri Åifreleme seÃ§eneÄŸi bu gruba dahil edilmelidir.
* TDE seÃ§eneÄŸi bir seÃ§enek grubuna eklendikten sonra, kalÄ±cÄ± bir Ã¶ÄŸe haline gelir ve kaldÄ±rÄ±lamaz.

3. **TDE Åifreleme ModlarÄ±**:

* TDE, iki farklÄ± ÅŸifreleme modu sunar:
* **TDE Tablespace Åifrelemesi**: Bu mod, tÃ¼m tablolarÄ± ÅŸifreler ve daha geniÅŸ bir veri koruma kapsamÄ± saÄŸlar.
* **TDE SÃ¼tun Åifrelemesi**: Bu mod, veritabanÄ± iÃ§indeki belirli, bireysel Ã¶ÄŸeleri ÅŸifrelemeye odaklanÄ±r ve hangi verilerin ÅŸifrelendiÄŸi konusunda daha ayrÄ±ntÄ±lÄ± kontrol saÄŸlar.

Bu Ã¶nkoÅŸullarÄ± ve TDE'nin iÅŸletimsel karmaÅŸÄ±klÄ±klarÄ±nÄ± anlamak, RDS iÃ§inde ÅŸifreleme etkin bir ÅŸekilde uygulamak ve yÃ¶netmek iÃ§in Ã¶nemlidir, bÃ¶ylece hem veri gÃ¼venliÄŸi hem de gerekli standartlara uyum saÄŸlanÄ±r.

### NumaralandÄ±rma

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### Kimlik DoÄŸrulama Gerektirmeyen EriÅŸim

{% content-ref url="../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### Ä°stek YÃ¼kseltme

{% content-ref url="../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### SaldÄ±rÄ± SonrasÄ±

{% content-ref url="../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### KalÄ±cÄ±lÄ±k

{% content-ref url="../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### SQL Enjeksiyonu

DynamoDB verilerine **SQL sÃ¶zdizimi** ile eriÅŸmenin yollarÄ± vardÄ±r, bu nedenle tipik **SQL enjeksiyonlarÄ± da mÃ¼mkÃ¼ndÃ¼r**.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahramana kadar AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± yapmak veya HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI'na**](https://github.com/sponsors/carlospolop) gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)'i **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>
