# AWS - κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤ (RDS) Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>λ¥Ό ν†µν•΄ **μ λ΅**λ¶€ν„° **νμ–΄λ΅**κΉμ§€ AWS ν•΄ν‚Ήμ„ λ°°μ°μ„Έμ”!</summary>

HackTricksλ¥Ό μ§€μ›ν•λ” λ‹¤λ¥Έ λ°©λ²•:

* **νμ‚¬λ¥Ό HackTricksμ—μ„ κ΄‘κ³ **ν•κ±°λ‚ **PDFλ΅ HackTricks λ‹¤μ΄λ΅λ“**ν•λ ¤λ©΄ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)λ¥Ό ν™•μΈν•μ„Έμ”!
* [**κ³µμ‹ PEASS & HackTricks μ¤μ™κ·Έ**](https://peass.creator-spring.com)λ¥Ό κµ¬λ§¤ν•μ„Έμ”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)λ¥Ό λ°κ²¬ν•μ„Έμ”, λ‹Ήμ‚¬μ λ…μ  [**NFTs**](https://opensea.io/collection/the-peass-family) μ»¬λ ‰μ…
* **π’¬ [Discord κ·Έλ£Ή](https://discord.gg/hRep4RUj7f)** λλ” [ν…”λ κ·Έλ¨ κ·Έλ£Ή](https://t.me/peass)μ— **κ°€μ…**ν•κ±°λ‚ **νΈμ„ν„°** π¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)λ¥Ό **ν”λ΅μ°**ν•μ„Έμ”.
* **HackTricks** λ° **HackTricks Cloud** github μ €μ¥μ†μ— PRμ„ μ μ¶ν•μ—¬ **ν•΄ν‚Ή νΈλ¦­μ„ κ³µμ **ν•μ„Έμ”.

</details>

## κΈ°λ³Έ μ •λ³΄

AWSμ—μ„ μ κ³µν•λ” **κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤ μ„λΉ„μ¤ (RDS)**λ” **ν΄λΌμ°λ“**μ—μ„ **κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤μ λ°°ν¬, μ΄μ λ° ν™•μ¥**μ„ κ°„μ†ν™”ν•κΈ° μ„ν•΄ μ„¤κ³„λμ—μµλ‹λ‹¤. μ΄ μ„λΉ„μ¤λ” ν•λ“μ›¨μ–΄ ν”„λ΅λΉ„μ €λ‹, λ°μ΄ν„°λ² μ΄μ¤ κµ¬μ„±, ν¨μΉ λ° λ°±μ—…κ³Ό κ°™μ€ λ…Έλ™ μ§‘μ•½μ μΈ μ‘μ—…μ„ μλ™ν™”ν•λ©΄μ„ **λΉ„μ© ν¨μ¨μ„±**κ³Ό **ν™•μ¥μ„±**μ μ¥μ μ„ μ κ³µν•©λ‹λ‹¤.

AWS RDSλ” MySQL, PostgreSQL, MariaDB, Oracle Database, Microsoft SQL Server λ° Amazon Auroraμ™€ κ°™μ€ λ‹¤μ–‘ν• λ„λ¦¬ μ‚¬μ©λλ” κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤ μ—”μ§„μ„ μ§€μ›ν•λ©° MySQL λ° PostgreSQL λ¨λ‘μ™€ νΈν™λ©λ‹λ‹¤.

RDSμ μ£Όμ” κΈ°λ¥μ€ λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:

* **λ°μ΄ν„°λ² μ΄μ¤ μΈμ¤ν„΄μ¤ κ΄€λ¦¬**κ°€ κ°„μ†ν™”λ©λ‹λ‹¤.
* **μ½κΈ° λ ν”λ¦¬μΉ΄**λ¥Ό μƒμ„±ν•μ—¬ μ½κΈ° μ„±λ¥μ„ ν–¥μƒμ‹ν‚µλ‹λ‹¤.
* **λ‹¤μ¤‘ κ°€μ© μμ—­ (AZ) λ°°ν¬**λ¥Ό κµ¬μ„±ν•μ—¬ κ³ κ°€μ©μ„± λ° μ¥μ•  μ΅°μΉ λ©”μ»¤λ‹μ¦μ„ λ³΄μ¥ν•©λ‹λ‹¤.
* λ‹¤λ¥Έ AWS μ„λΉ„μ¤μ™€μ **ν†µν•©**, μλ¥Ό λ“¤μ–΄:
* κ²¬κ³ ν• μ•΅μ„Έμ¤ μ μ–΄λ¥Ό μ„ν• AWS Identity and Access Management (**IAM**).
* ν¬κ΄„μ μΈ λ¨λ‹ν„°λ§ λ° λ©”νΈλ¦­μ„ μ„ν• AWS **CloudWatch**.
* μ•μ „ν• μ•”νΈν™”λ¥Ό λ³΄μ¥ν•κΈ° μ„ν• AWS Key Management Service (**KMS**).

## μκ²© μ¦λ…

DB ν΄λ¬μ¤ν„°λ¥Ό μƒμ„±ν•  λ• λ§μ¤ν„° **μ‚¬μ©μ μ΄λ¦„**μ„ κµ¬μ„±ν•  μ μμµλ‹λ‹¤ (κΈ°λ³Έκ°’μ€ **`admin`**). μ΄ μ‚¬μ©μμ μ•”νΈλ¥Ό μƒμ„±ν•λ ¤λ©΄ λ‹¤μμ„ μν–‰ν•  μ μμµλ‹λ‹¤:

* μ§μ ‘ **μ•”νΈ**λ¥Ό μ§€μ •
* RDSμ—κ² **μλ™ μƒμ„±**ν•λ„λ΅ μ§€μ‹
* KMS ν‚¤λ΅ μ•”νΈν™”λ **AWS Secret Manager**μ—μ„ κ΄€λ¦¬ν•λ„λ΅ RDSμ—κ² μ§€μ‹

<figure><img src="../../../.gitbook/assets/image (144).png" alt=""><figcaption></figcaption></figure>

### μΈμ¦

3κ°€μ§€ μ ν•μ μΈμ¦ μµμ…μ΄ μμ§€λ§ **λ§μ¤ν„° μ•”νΈλ¥Ό μ‚¬μ©ν•λ” κ²ƒμ€ ν•­μƒ ν—μ©**λ©λ‹λ‹¤:

<figure><img src="../../../.gitbook/assets/image (227).png" alt=""><figcaption></figcaption></figure>

### κ³µκ° μ•΅μ„Έμ¤ λ° VPC

κΈ°λ³Έμ μΌλ΅ λ°μ΄ν„°λ² μ΄μ¤μ—λ” **κ³µκ° μ•΅μ„Έμ¤κ°€ ν—μ©λμ§€ μ•μµλ‹λ‹¤**, κ·Έλ¬λ‚ **ν—μ©**λ  μ μμµλ‹λ‹¤. λ”°λΌμ„ κΈ°λ³Έμ μΌλ΅ λ™μΌν• VPCμ κΈ°κΈ°λ§ μ•΅μ„Έμ¤ν•  μ μμµλ‹λ‹¤. μ„ νƒν• **λ³΄μ• κ·Έλ£Ή** (EC2 SGμ— μ €μ¥λ¨)μ΄ ν—μ©ν•λ” κ²½μ°μ—λ§ μ•΅μ„Έμ¤ν•  μ μμµλ‹λ‹¤.

DB μΈμ¤ν„΄μ¤λ¥Ό λ…Έμ¶ν•λ” λ€μ‹  **RDS Proxy**λ¥Ό μƒμ„±ν•μ—¬ DB ν΄λ¬μ¤ν„°μ **ν™•μ¥μ„±** λ° **κ°€μ©μ„±**μ„ ν–¥μƒμ‹ν‚¬ μ μμµλ‹λ‹¤.

λν• **λ°μ΄ν„°λ² μ΄μ¤ ν¬νΈλ¥Ό μμ •**ν•  μλ„ μμµλ‹λ‹¤.

### μ•”νΈν™”

**μ•”νΈν™”λ” κΈ°λ³Έμ μΌλ΅ ν™μ„±ν™”**λμ–΄ μμΌλ©° AWS κ΄€λ¦¬ν• ν‚¤λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤ (λ€μ‹  CMKλ¥Ό μ„ νƒν•  μ μμ).

μ•”νΈν™”λ¥Ό ν™μ„±ν™”ν•λ©΄ **μ €μ¥μ†, μ¤λƒ…μƒ·, μ½κΈ° λ ν”λ¦¬μΉ΄ λ° λ°±μ—…μ— λ€ν• μ •μ§€ μƒνƒ μ•”νΈν™”**κ°€ ν™μ„±ν™”λ©λ‹λ‹¤. μ΄ μ•”νΈν™”λ¥Ό κ΄€λ¦¬ν•κΈ° μ„ν• ν‚¤λ” **KMS**λ¥Ό μ‚¬μ©ν•μ—¬ λ°κΈ‰ν•  μ μμµλ‹λ‹¤.\
μ΄ μμ¤€μ μ•”νΈν™”λ¥Ό λ°μ΄ν„°λ² μ΄μ¤κ°€ μƒμ„±λ ν›„μ— μ¶”κ°€ν•  μ μ—†μµλ‹λ‹¤. **λ°μ΄ν„°λ² μ΄μ¤ μƒμ„± μ¤‘**μ— μν–‰ν•΄μ•Ό ν•©λ‹λ‹¤.

κ·Έλ¬λ‚ λ‹¤μκ³Ό κ°™μ΄ **μ•”νΈν™”λμ§€ μ•μ€ λ°μ΄ν„°λ² μ΄μ¤λ¥Ό μ•”νΈν™”**ν•  μ μλ” **νν”Ό λ°©λ²•**μ΄ μμµλ‹λ‹¤. μ•”νΈν™”λμ§€ μ•μ€ λ°μ΄ν„°λ² μ΄μ¤μ μ¤λƒ…μƒ·μ„ μƒμ„±ν•κ³  ν•΄λ‹Ή μ¤λƒ…μƒ·μ μ•”νΈν™”λ μ‚¬λ³Έμ„ μƒμ„±ν• ν›„ ν•΄λ‹Ή μ•”νΈν™”λ μ¤λƒ…μƒ·μ„ μ‚¬μ©ν•μ—¬ μƒ λ°μ΄ν„°λ² μ΄μ¤λ¥Ό μƒμ„±ν•λ©΄ λ°μ΄ν„°λ² μ΄μ¤κ°€ μ•”νΈν™”λ©λ‹λ‹¤.

#### ν¬λ…ν• λ°μ΄ν„° μ•”νΈν™” (TDE)

RDSμ μ‘μ© ν”„λ΅κ·Έλ¨ μμ¤€μ—μ„ μ κ³µλλ” μ•”νΈν™” κΈ°λ¥ μ™Έμ—λ„ RDSλ” λ°μ΄ν„°λ¥Ό μ•μ „ν•κ² λ³΄νΈν•κΈ° μ„ν• **μ¶”κ°€ ν”λ«νΌ μμ¤€μ μ•”νΈν™” λ©”μ»¤λ‹μ¦**μ„ μ§€μ›ν•©λ‹λ‹¤. μ΄λ” Oracle λ° SQL Serverμ© **ν¬λ…ν• λ°μ΄ν„° μ•”νΈν™” (TDE)**λ¥Ό ν¬ν•¨ν•©λ‹λ‹¤. κ·Έλ¬λ‚ λ°μ΄ν„°λ¥Ό μ•μ „ν•κ² μ•”νΈν™”ν•μ—¬ λ³΄μ•μ„ κ°•ν™”ν•λ” TDEλ” λ°μ΄ν„°λ² μ΄μ¤ μ„±λ¥μ— **μν–¥μ„ μ¤„ μ μμ**μ„ λ…μ‹¬ν•΄μ•Ό ν•©λ‹λ‹¤. νΉν MySQL μ•”νΈν™” ν•¨μ λλ” Microsoft Transact-SQL μ•”νΈν™” ν•¨μμ™€ ν•¨κ» μ‚¬μ©ν•  λ• μ΄λ¬ν• μ„±λ¥ μν–¥μ΄ νΉν λ‘λ“λ¬μ§‘λ‹λ‹¤.

TDEλ¥Ό ν™μ©ν•λ ¤λ©΄ λ‹¤μκ³Ό κ°™μ€ μ΄κΈ° λ‹¨κ³„κ°€ ν•„μ”ν•©λ‹λ‹¤:

1. **μµμ… κ·Έλ£Ή μ—°κ²°**:
* λ°μ΄ν„°λ² μ΄μ¤λ” μµμ… κ·Έλ£Ήκ³Ό μ—°κ²°λμ–΄μ•Ό ν•©λ‹λ‹¤. μµμ… κ·Έλ£Ήμ€ λ³΄μ• ν–¥μƒμ„ ν¬ν•¨ν• λ°μ΄ν„°λ² μ΄μ¤ κ΄€λ¦¬λ¥Ό μ©μ΄ν•κ² ν•λ” μ„¤μ • λ° κΈ°λ¥μ μ»¨ν…μ΄λ„λ΅ μ‘μ©ν•©λ‹λ‹¤.
* κ·Έλ¬λ‚ μµμ… κ·Έλ£Ήμ€ νΉμ • λ°μ΄ν„°λ² μ΄μ¤ μ—”μ§„ λ° λ²„μ „μ—λ§ μ‚¬μ©ν•  μ μμμ„ μΈμ‹ν•λ” κ²ƒμ΄ μ¤‘μ”ν•©λ‹λ‹¤.
2. **μµμ… κ·Έλ£Ήμ— TDE ν¬ν•¨**:
* μµμ… κ·Έλ£Ήκ³Ό μ—°κ²°λ ν›„ Oracle Transparent Data Encryption μµμ…μ„ ν•΄λ‹Ή κ·Έλ£Ήμ— ν¬ν•¨ν•΄μ•Ό ν•©λ‹λ‹¤.
* TDE μµμ…μ΄ μµμ… κ·Έλ£Ήμ— μ¶”κ°€λλ©΄ μκµ¬μ μΈ κµ¬μ„± μ”μ†κ°€ λμ–΄ μ κ±°ν•  μ μ—†μμ„ μΈμ‹ν•λ” κ²ƒμ΄ μ¤‘μ”ν•©λ‹λ‹¤.
3. **TDE μ•”νΈν™” λ¨λ“**:
* TDEμ—λ” λ‘ κ°€μ§€ λ‹¤λ¥Έ μ•”νΈν™” λ¨λ“κ°€ μμµλ‹λ‹¤:
* **TDE ν…μ΄λΈ”μ¤νμ΄μ¤ μ•”νΈν™”**: μ΄ λ¨λ“λ” μ „μ²΄ ν…μ΄λΈ”μ„ μ•”νΈν™”ν•μ—¬ λ°μ΄ν„° λ³΄νΈ λ²”μ„λ¥Ό ν™•λ€ν•©λ‹λ‹¤.
* **TDE μ—΄ μ•”νΈν™”**: μ΄ λ¨λ“λ” λ°μ΄ν„°λ² μ΄μ¤ λ‚΄μ νΉμ • κ°λ³„ μ”μ†λ¥Ό μ•”νΈν™”ν•λ” λ° μ¤‘μ μ„ λ‘μ–΄ λ°μ΄ν„°κ°€ μ•”νΈν™”λλ” λ²”μ„λ¥Ό λ” μ„Έλ°€ν•κ² μ μ–΄ν•  μ μμµλ‹λ‹¤.

μ΄λ¬ν• μ„ ν–‰ μ΅°κ±΄κ³Ό TDEμ μ΄μμ  λ³µμ΅μ„±μ„ μ΄ν•΄ν•λ” κ²ƒμ€ RDS λ‚΄μ—μ„ μ•”νΈν™”λ¥Ό ν¨κ³Όμ μΌλ΅ κµ¬ν„ν•κ³  κ΄€λ¦¬ν•μ—¬ λ°μ΄ν„° λ³΄μ•κ³Ό ν•„μ”ν• ν‘μ¤€ μ¤€μλ¥Ό λ³΄μ¥ν•λ” λ° μ¤‘μ”ν•©λ‹λ‹¤.

### μ—΄κ±°

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
### μΈμ¦λμ§€ μ•μ€ μ•΅μ„Έμ¤

{% content-ref url="../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### κ¶ν• μƒμΉ

{% content-ref url="../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### μ‚¬ν›„ κ³µκ²©

{% content-ref url="../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### μ§€μ†μ„±

{% content-ref url="../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### SQL Injection

**SQL κµ¬λ¬Έ**μ„ μ‚¬μ©ν•μ—¬ DynamoDB λ°μ΄ν„°μ— μ•΅μ„Έμ¤ν•λ” λ°©λ²•μ΄ μμΌλ―€λ΅, μ „ν•μ μΈ **SQL μΈμ μ…λ„ κ°€λ¥**ν•©λ‹λ‹¤.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>λ¥Ό ν†µν•΄ μ λ΅λ¶€ν„° AWS ν•΄ν‚Ήμ„ μ „λ¬Έκ°€λ΅ λ°°μ°μ„Έμ”!</summary>

HackTricksλ¥Ό μ§€μ›ν•λ” λ‹¤λ¥Έ λ°©λ²•:

* **νμ‚¬λ¥Ό HackTricksμ—μ„ κ΄‘κ³ ν•κ±°λ‚ PDFλ΅ λ‹¤μ΄λ΅λ“**ν•λ ¤λ©΄ [**κµ¬λ… μ”κΈμ **](https://github.com/sponsors/carlospolop)λ¥Ό ν™•μΈν•μ„Έμ”!
* [**κ³µμ‹ PEASS & HackTricks μ¤μ™κ·Έ**](https://peass.creator-spring.com)λ¥Ό κµ¬λ§¤ν•μ„Έμ”
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)λ¥Ό λ°κ²¬ν•μ„Έμ”, λ‹Ήμ‚¬μ λ…μ  [**NFTs**](https://opensea.io/collection/the-peass-family) μ»¬λ ‰μ…
* π’¬ [**λ””μ¤μ½”λ“ κ·Έλ£Ή**](https://discord.gg/hRep4RUj7f) λλ” [**ν…”λ κ·Έλ¨ κ·Έλ£Ή**](https://t.me/peass)μ— **κ°€μ…**ν•κ±°λ‚ **νΈμ„ν„°** π¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)λ¥Ό **ν”λ΅μ°**ν•μ„Έμ”.
* **HackTricks** λ° **HackTricks Cloud** κΉƒν—λΈ μ €μ¥μ†μ— PRμ„ μ μ¶ν•μ—¬ **ν•΄ν‚Ή νΈλ¦­μ„ κ³µμ **ν•μ„Έμ”.

</details>
