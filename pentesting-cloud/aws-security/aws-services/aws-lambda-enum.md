# AWS - Lambda Enum

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* ã‚‚ã— **HackTricks ã§ä¼šç¤¾ã‚’å®£ä¼ã—ãŸã„**å ´åˆã‚„ã€**PEASS ã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚„ HackTricks ã® PDF ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼ã® PEASS & HackTricks ã‚¹ãƒ¯ãƒƒã‚°**](https://peass.creator-spring.com) ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ã‚’è¦‹ã¤ã‘ã¦ã€ç‹¬å çš„ãª [**NFT**](https://opensea.io/collection/the-peass-family) ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ¥½ã—ã¿ã¾ã—ã‚‡ã†
* ğŸ’¬ [**Discord ã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f) ã¾ãŸã¯ [**telegram ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass) ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm) ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¾ã—ã‚‡ã†ã€‚
* **HackTricks** ã¨ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ã® GitHub ãƒªãƒã‚¸ãƒˆãƒªã« **PR ã‚’æå‡º**ã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’å…±æœ‰ã—ã¾ã—ã‚‡ã†ã€‚

</details>

## Lambda

Amazon Web Services (AWS) Lambda ã¯ã€**ã‚µãƒ¼ãƒãƒ¼ã®ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã‚„ç®¡ç†ãªã—ã§ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ**ã§ãã‚‹ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒˆã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚Lambda ã¯ã€ã‚³ãƒ¼ãƒ‰ã®å®Ÿè¡Œã«å¿…è¦ãªãƒªã‚½ãƒ¼ã‚¹ã‚’è‡ªå‹•çš„ã«ç®¡ç†ã—ã€é«˜å¯ç”¨æ€§ã€ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚Lambda ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€**æ¶ˆè²»ã—ãŸè¨ˆç®—æ™‚é–“ã®ã¿ã‚’æ”¯æ‰•ã„**ã€å‰æ‰•ã„è²»ç”¨ã‚„é•·æœŸã®å¥‘ç´„ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

Lambda ã‚’å‘¼ã³å‡ºã™ã«ã¯ã€**Cloudwatch** ã‚’ä½¿ç”¨ã—ã¦é »ç¹ã«å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€**URL** ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å…¬é–‹ã—ã¦å‘¼ã³å‡ºã™ã“ã¨ã‚‚ã§ãã¾ã™ã—ã€**API Gateway** ã‚’ä»‹ã—ã¦å‘¼ã³å‡ºã™ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ã•ã‚‰ã«ã€**S3** ãƒã‚±ãƒƒãƒˆã®ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›´ã‚„ **DynamoDB** ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ›´æ–°ãªã©ã® **ã‚¤ãƒ™ãƒ³ãƒˆ**ã«åŸºã¥ã„ã¦å‘¼ã³å‡ºã™ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

Lambda ã®ã‚³ãƒ¼ãƒ‰ã¯ **`/var/task`** ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

### Lambda ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã®é‡ã¿

Lambda ã«ã¯ **è¤‡æ•°ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³** ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãã—ã¦ã€**ã‚¨ã‚¤ãƒªã‚¢ã‚¹** ã‚’ä»‹ã—ã¦ **1ã¤ä»¥ä¸Šã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³** ã‚’å…¬é–‹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚¨ã‚¤ãƒªã‚¢ã‚¹å†…ã§å…¬é–‹ã•ã‚ŒãŸå„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã® **é‡ã¿** ã«ã‚ˆã£ã¦ã€**ã©ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹ãŒå‘¼ã³å‡ºã—ã‚’å—ã‘ã‚‹ã‹ãŒæ±ºã¾ã‚Šã¾ã™**ï¼ˆä¾‹ãˆã°ã€90% - 10% ã®å‰²åˆã§ã‚ã‚‹å ´åˆãªã©ï¼‰ã€‚ã‚‚ã—ã€**ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã®ã†ã¡ã®1ã¤ãŒè„†å¼±æ€§ã‚’æŒã£ã¦ã„ã‚‹**å ´åˆã€è„†å¼±æ€§ã®ã‚ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒæ”»æ’ƒã‚’å—ã‘ã‚‹ã¾ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

![](<../../../.gitbook/assets/image (16) (1).png>)

### ãƒªã‚½ãƒ¼ã‚¹ãƒãƒªã‚·ãƒ¼

Lambda ãƒªã‚½ãƒ¼ã‚¹ãƒãƒªã‚·ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹/ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒ Lambda ã‚’å‘¼ã³å‡ºã™ãŸã‚ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€æ¬¡ã®ã‚ˆã†ãªãƒãƒªã‚·ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã€**URL çµŒç”±ã§å…¬é–‹ã•ã‚ŒãŸ Lambda ã«èª°ã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹**ã“ã¨ãŒã§ãã¾ã™ã€‚

<figure><img src="https://lh4.googleusercontent.com/4PNFKBdzr3nMrPqeKkTslgwWDKxkXMdQ1SNdv7NPHykj3GX8wODrQyXOFbjk4fxHfZ8pDm5ijWgk2Vq2EGXiPRT3TQfZf1fHycvdEKBuDxJDYos1CJeMHXSeg86ZB-Ol7CNtten6xkVFQj6AhDUEWNQJrQ=s2048" alt=""><figcaption></figcaption></figure>

ã¾ãŸã€æ¬¡ã®ã‚ˆã†ãªãƒãƒªã‚·ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã€API Gateway ã‹ã‚‰å‘¼ã³å‡ºã™ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

<figure><img src="https://lh3.googleusercontent.com/Su0JlR0wBqb-99Z4N_2-_kMlX0Xzx2n_GpZuOPW5IeXR3FYbm8OHFDM3Ora1BpXiSjHpDVUlq4yEyXwaI3nBuze6DJ-wRf2ATsCuWbq0wuBCd34E9uIpqwheE6Cc_PopviI_93O_j2ZKXc1-AJtsBoLVUw=s2048" alt=""><figcaption></figcaption></figure>

### Lambda ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·

**æ•°ç™¾ã‚‚ã®åŒæ™‚ Lambda ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**ãŒã‚ã‚‹å ´åˆã€ãã‚Œãã‚Œã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã—ã¦æ¥ç¶šã‚’é–‰ã˜ã‚‹å¿…è¦ãŒã‚ã‚‹ã¨ã€ã†ã¾ãã„ã‹ãªã„ã“ã¨ãŒã‚ã‚Šã¾ã™ï¼ˆLambda ã¯ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹ã§ã‚ã‚Šã€æ¥ç¶šã‚’ç¶­æŒã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ï¼‰ã€‚ãã®ãŸã‚ã€Lambda é–¢æ•°ãŒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ä»£ã‚ã‚Šã« RDS Proxy ã¨ã‚„ã‚Šå–ã‚Šã™ã‚‹å ´åˆã€Lambda é–¢æ•°ã«ã‚ˆã£ã¦ä½œæˆã•ã‚Œã‚‹å¤šæ•°ã®åŒæ™‚æ¥ç¶šã®ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã«å¿…è¦ãªæ¥ç¶šãƒ—ãƒ¼ãƒªãƒ³ã‚°ã‚’å‡¦ç†ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€Lambda ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯æ—¢å­˜ã®æ¥ç¶šã‚’å†åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚æ–°ã—ã„æ¥ç¶šã‚’é–¢æ•°ã®å‘¼ã³å‡ºã—ã”ã¨ã«ä½œæˆã™ã‚‹ã®ã§ã¯ãªãã€‚

### Lambda EFS ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ 

ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã€å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€**Lambda ã¯ EFS ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãƒã‚¦ãƒ³ãƒˆ**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãã®ãŸã‚ã€Lambda ã¯ãã‚Œã‹ã‚‰èª­ã¿æ›¸ãã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### Lambda ãƒ¬ã‚¤ãƒ¤ãƒ¼

Lambda ã® _ãƒ¬ã‚¤ãƒ¤ãƒ¼_ ã¯ã€è¿½åŠ ã®ã‚³ãƒ¼ãƒ‰ã‚„ãã®ä»–ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å«ã‚€ .zip ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã§ã™ã€‚ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«ã¯ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€[ã‚«ã‚¹ã‚¿ãƒ ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ](https://docs.aws.amazon.com/lambda/latest/dg/runtimes-custom.html)ã€ãƒ‡ãƒ¼ã‚¿ã€ã¾ãŸã¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

1ã¤ã®é–¢æ•°ã«ã¯æœ€å¤§ã§ **5ã¤ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼** ã‚’å«ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’é–¢æ•°ã«å«ã‚ã‚‹ã¨ã€å®Ÿè¡Œç’°å¢ƒã® `/opt` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒå±•é–‹ã•ã‚Œã¾ã™ã€‚

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ä½œæˆã—ãŸãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ AWS ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«å¯¾ã—ã¦ **ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ** ã§ã™ã€‚ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä»–ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨å…±æœ‰ã™ã‚‹ã‹ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ **ãƒ‘ãƒ–ãƒªãƒƒã‚¯** ã«ã™ã‚‹ã‹ã‚’é¸æŠã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚åˆ¥ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå…¬é–‹ã—ãŸãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’é–¢æ•°ãŒæ¶ˆè²»ã™ã‚‹å ´åˆã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå‰Šé™¤ã•ã‚ŒãŸå¾Œã‚„ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ãŒå–ã‚Šæ¶ˆã•ã‚ŒãŸå¾Œã§ã‚‚ã€é–¢æ•°ã¯ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å¼•ãç¶šãä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãŸã ã—ã€å‰Šé™¤ã•ã‚ŒãŸãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚„ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ãŒå–ã‚Šæ¶ˆã•ã‚ŒãŸãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½¿ç”¨ã—ã¦æ–°ã—ã„é–¢æ•°ã‚’ä½œæˆã—ãŸã‚Šã€é–¢æ•°ã‚’æ›´æ–°ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚

ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸé–¢æ•°ã¯ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½¿ç”¨ã—ã¾ã›ã‚“ã€‚ä»£ã‚ã‚Šã«ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹éš›ã«å¥½ã¿ã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€ãŠã‚ˆã³ãã®ä»–ã®ä¾å­˜é–¢ä¿‚ã‚’ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã—ã¾ã™ã€‚

### Lambda æ‹¡å¼µæ©Ÿèƒ½

Lambda æ‹¡å¼µæ©Ÿèƒ½ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€é–¢æ•°ã‚’æ‹¡å¼µã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãŸã¨ãˆã°ã€æ‹¡å¼µæ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦ã€é–¢æ•°ã‚’ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã€è¦³æ¸¬ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€ã‚¬ãƒãƒŠãƒ³ã‚¹ãƒ„ãƒ¼ãƒ«ã«çµ±åˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚Lambda ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ .zip ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–é–¢æ•°ã«æ‹¡å¼µæ©Ÿèƒ½ã‚’è¿½åŠ ã—ãŸã‚Šã€[ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã¨
### åˆ—æŒ™

AWS Lambdaã¯ã€ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ã§ã‚ã‚Šã€AWSã‚¯ãƒ©ã‚¦ãƒ‰ä¸Šã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚Lambdaé–¢æ•°ã¯ã€ã‚¤ãƒ™ãƒ³ãƒˆã«å¿œç­”ã—ã¦å®Ÿè¡Œã•ã‚Œã€å¿…è¦ã«å¿œã˜ã¦è‡ªå‹•çš„ã«ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚Lambdaé–¢æ•°ã®åˆ—æŒ™ã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡ã‚„ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã®ä¸€ç’°ã¨ã—ã¦é‡è¦ã§ã™ã€‚

#### Lambdaé–¢æ•°ã®åˆ—æŒ™æ–¹æ³•

1. **AWS CLIã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•**:
   - `aws lambda list-functions`ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå†…ã®ã™ã¹ã¦ã®Lambdaé–¢æ•°ã‚’ä¸€è¦§è¡¨ç¤ºã§ãã¾ã™ã€‚
   - `aws lambda get-function --function-name <function_name>`ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ç‰¹å®šã®Lambdaé–¢æ•°ã®è©³ç´°æƒ…å ±ã‚’å–å¾—ã§ãã¾ã™ã€‚

2. **AWS Management Consoleã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•**:
   - AWS Management Consoleã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã€Lambdaã‚µãƒ¼ãƒ“ã‚¹ã«ç§»å‹•ã—ã¾ã™ã€‚
   - Lambdaé–¢æ•°ã®ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚é–¢æ•°ã®è©³ç´°æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ã€é–¢æ•°åã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

3. **AWS SDKã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•**:
   - é©åˆ‡ãªAWS SDKã‚’ä½¿ç”¨ã—ã¦ã€Lambdaé–¢æ•°ã‚’åˆ—æŒ™ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã§ãã¾ã™ã€‚

#### Lambdaé–¢æ•°ã®åˆ—æŒ™ã«ã‚ˆã£ã¦å¾—ã‚‰ã‚Œã‚‹æƒ…å ±

Lambdaé–¢æ•°ã®åˆ—æŒ™ã«ã‚ˆã£ã¦ã€ä»¥ä¸‹ã®æƒ…å ±ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚

- é–¢æ•°å
- é–¢æ•°ã®ARNï¼ˆAmazon Resource Nameï¼‰
- ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ï¼ˆä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªï¼‰
- ãƒ¡ãƒ¢ãƒªã‚µã‚¤ã‚º
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š
- IAMãƒ­ãƒ¼ãƒ«
- ç’°å¢ƒå¤‰æ•°
- VPCè¨­å®š
- ã‚¤ãƒ™ãƒ³ãƒˆãƒˆãƒªã‚¬ãƒ¼

#### Lambdaé–¢æ•°ã®åˆ—æŒ™ã®ç›®çš„

Lambdaé–¢æ•°ã®åˆ—æŒ™ã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡ã‚„ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã®ä¸€ç’°ã¨ã—ã¦é‡è¦ã§ã™ã€‚åˆ—æŒ™ã«ã‚ˆã£ã¦ã€æ”»æ’ƒè€…ã¯ã‚·ã‚¹ãƒ†ãƒ å†…ã®æ½œåœ¨çš„ãªè„†å¼±æ€§ã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å•é¡Œã‚’ç‰¹å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€åˆ—æŒ™ã«ã‚ˆã£ã¦ã€é–¢æ•°ã®æ§‹æˆã‚„è¨­å®šã«é–¢ã™ã‚‹æƒ…å ±ã‚’åé›†ã—ã€æ”»æ’ƒã®ãŸã‚ã®æˆ¦ç•¥ã‚’ç«‹ã¦ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚
```bash
aws lambda get-account-settings

# List functions and get extra config info
aws lambda list-functions
aws lambda get-function --function-name <function_name>
aws lambda get-function-configuration --function-name <function_name>
aws lambda list-function-event-invoke-configs --function-name <function_name>
## Check for creds in env vars
aws lambda list-functions | jq '.Functions[].Environment'
## Download & check the source code
aws lambda get-function --function-name "LAMBDA-NAME-HERE-FROM-PREVIOUS-QUERY" --query 'Code.Location' --profile uploadcreds
wget -O lambda-function.zip url-from-previous-query

# Get Lambda URL (if any)
aws lambda list-function-url-configs --function-name <function_name>
aws lambda get-function-url-config --function-name <function_name>

# Get who has permissions to invoke the Lambda
aws lambda get-policy --function-name <function_name>

# Versions and Aliases
aws lambda list-versions-by-function --function-name <func_name>
aws lambda list-aliases --function-name <func_name>

# List layers
aws lambda list-layers
aws lambda list-layer-versions --layer-name <name>
aws lambda get-layer-version --layer-name <name> --version-number <ver>
aws lambda get-layer-version-by-arn --arn <name> #Get external ARNs

# List other metadata
aws lambda list-event-source-mappings
aws lambda list-code-signing-configs
aws lambda list-functions-by-code-signing-config --code-signing-config-arn <arn>
```
### ãƒ©ãƒ ãƒ€ã‚’å‘¼ã³å‡ºã™

#### æ‰‹å‹•
```bash
# Invoke function
aws lambda invoke --function-name FUNCTION_NAME /tmp/out
## Some functions will expect parameters, they will access them with something like:
## target_policys = event['policy_names']
## user_name = event['user_name']
aws lambda invoke --function-name <name> --cli-binary-format raw-in-base64-out --payload '{"policy_names": ["AdministratorAccess], "user_name": "sdf"}' out.txt
```
#### å…¬é–‹ã•ã‚ŒãŸURLã‚’ä»‹ã—ã¦

If you find an exposed URL for an AWS Lambda function, you can use it to gather information about the function and potentially exploit it. Here are some steps you can follow:

1. Access the exposed URL in a web browser or using a tool like cURL.
2. Look for any error messages or debug information that may reveal sensitive details about the function.
3. Check if the function allows unauthenticated access or requires authentication.
4. If authentication is required, try common credentials or perform brute-force attacks to gain access.
5. If the function allows unauthenticated access, try different HTTP methods (GET, POST, etc.) and parameters to see if you can trigger any unintended behavior.
6. Look for any exposed environment variables or sensitive information in the response.
7. If you find any vulnerabilities or sensitive information, report them to the owner of the function or the AWS security team.

Remember to always obtain proper authorization before performing any security testing or exploitation.
```bash
aws lambda list-function-url-configs --function-name <function_name> #Get lambda URL
aws lambda get-function-url-config   --function-name <function_name> #Get lambda URL
```
#### URLã‚’ä»‹ã—ã¦Lambdaé–¢æ•°ã‚’å‘¼ã³å‡ºã™

ã•ã‚ã€å®Ÿè¡Œå¯èƒ½ãªLambdaé–¢æ•°ã‚’è¦‹ã¤ã‘ã‚‹æ™‚ãŒæ¥ã¾ã—ãŸã€‚
```
aws --region us-west-2 --profile level6 lambda list-functions
```
![](<../../../.gitbook/assets/image (21) (1).png>)

"Level6"ã¨ã„ã†åå‰ã®Lambdaé–¢æ•°ãŒåˆ©ç”¨å¯èƒ½ã§ã™ã€‚ãã‚Œã‚’å‘¼ã³å‡ºã™æ–¹æ³•ã‚’è¦‹ã¤ã‘ã¾ã—ã‚‡ã†ã€‚
```bash
aws --region us-west-2 --profile level6 lambda get-policy --function-name Level6
```
![](<../../../.gitbook/assets/image (69).png>)

ä»Šã€åå‰ã¨IDã‚’çŸ¥ã£ã¦ã„ã‚‹ã®ã§ã€åå‰ã‚’å–å¾—ã§ãã¾ã™ï¼š
```bash
aws --profile level6 --region us-west-2 apigateway get-stages --rest-api-id "s33ppypa75"
```
![](<../../../.gitbook/assets/image (20).png>)

ãã—ã¦ã€é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦ãã ã•ã„ï¼ˆURLã«IDã€åå‰ã€é–¢æ•°åãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼‰ï¼š[https://s33ppypa75.execute-api.us-west-2.amazonaws.com/Prod/level6](https://s33ppypa75.execute-api.us-west-2.amazonaws.com/Prod/level6)

`URL:`**`https://<rest-api-id>.execute-api.<region>.amazonaws.com/<stageName>/<funcName>`**

#### ãã®ä»–ã®ãƒˆãƒªã‚¬ãƒ¼

Lambdaã‚’ãƒˆãƒªã‚¬ãƒ¼ã™ã‚‹ãŸã‚ã®ä»–ã®ã‚½ãƒ¼ã‚¹ã‚‚ãŸãã•ã‚“ã‚ã‚Šã¾ã™

<figure><img src="../../../.gitbook/assets/image (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

### ç‰¹æ¨©æ˜‡æ ¼

æ¬¡ã®ãƒšãƒ¼ã‚¸ã§ã¯ã€Lambdaã®æ¨©é™ã‚’æ‚ªç”¨ã—ã¦ç‰¹æ¨©ã‚’æ˜‡æ ¼ã•ã›ã‚‹æ–¹æ³•ã‚’ç¢ºèªã§ãã¾ã™ï¼š

{% content-ref url="../../aws-pentesting/aws-privilege-escalation/aws-lambda-privesc.md" %}
[aws-lambda-privesc.md](../../aws-pentesting/aws-privilege-escalation/aws-lambda-privesc.md)
{% endcontent-ref %}

### èªè¨¼ã•ã‚Œã¦ã„ãªã„ã‚¢ã‚¯ã‚»ã‚¹

{% content-ref url="../aws-unauthenticated-enum-access/aws-lambda-unauthenticated-access.md" %}
[aws-lambda-unauthenticated-access.md](../aws-unauthenticated-enum-access/aws-lambda-unauthenticated-access.md)
{% endcontent-ref %}

### æ”»æ’ƒå¾Œã®åˆ©ç”¨

{% content-ref url="../../aws-pentesting/aws-post-exploitation/aws-lambda-post-exploitation/" %}
[aws-lambda-post-exploitation](../../aws-pentesting/aws-post-exploitation/aws-lambda-post-exploitation/)
{% endcontent-ref %}

### æ°¸ç¶šåŒ–

{% content-ref url="../../aws-pentesting/aws-persistence/aws-lambda-persistence/" %}
[aws-lambda-persistence](../../aws-pentesting/aws-persistence/aws-lambda-persistence/)
{% endcontent-ref %}

## å‚è€ƒæ–‡çŒ®

* [https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-concepts.html#gettingstarted-concepts-layer](https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-concepts.html#gettingstarted-concepts-layer)

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* If you want to see your **company advertised in HackTricks** or if you want access to the **latest version of the PEASS or download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** me on **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
