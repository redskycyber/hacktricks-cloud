# AWS - Lambda KalÄ±cÄ±lÄ±ÄŸÄ±

<details>

<summary><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ± gÃ¶rmek** veya HackTricks'i **PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)'i takip edin.
* Hacking hilelerinizi [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.

</details>

## Lambda

Daha fazla bilgi iÃ§in kontrol edin:

{% content-ref url="../../../aws-security/aws-services/aws-lambda-enum.md" %}
[aws-lambda-enum.md](../../../aws-security/aws-services/aws-lambda-enum.md)
{% endcontent-ref %}

### Lambda KatmanÄ± KalÄ±cÄ±lÄ±ÄŸÄ±

Lambda yÃ¼rÃ¼tÃ¼ldÃ¼ÄŸÃ¼nde, lambda'nÄ±n **keyfi kodu yÃ¼rÃ¼tmek iÃ§in bir katmanÄ± tanÄ±tmasÄ±/arka kapÄ± oluÅŸturmasÄ± mÃ¼mkÃ¼ndÃ¼r**:

{% content-ref url="aws-lambda-layers-persistence.md" %}
[aws-lambda-layers-persistence.md](aws-lambda-layers-persistence.md)
{% endcontent-ref %}

### Lambda UzantÄ±sÄ± KalÄ±cÄ±lÄ±ÄŸÄ±

Lambda KatmanlarÄ±nÄ± kÃ¶tÃ¼ye kullanarak, lambda iÃ§inde kalÄ±cÄ±lÄ±k saÄŸlamak ve aynÄ± zamanda istekleri Ã§almak ve deÄŸiÅŸtirmek de mÃ¼mkÃ¼ndÃ¼r.

{% content-ref url="aws-abusing-lambda-extensions.md" %}
[aws-abusing-lambda-extensions.md](aws-abusing-lambda-extensions.md)
{% endcontent-ref %}

### Kaynak politikalarÄ± aracÄ±lÄ±ÄŸÄ±yla

FarklÄ± lambda eylemlerine (Ã¶rneÄŸin, Ã§aÄŸÄ±rma veya kodu gÃ¼ncelleme) dÄ±ÅŸ hesaplara eriÅŸim vermek mÃ¼mkÃ¼ndÃ¼r:

<figure><img src="../../../../.gitbook/assets/image (2) (1) (2) (2).png" alt=""><figcaption></figcaption></figure>

### SÃ¼rÃ¼mler, Takma Adlar ve AÄŸÄ±rlÄ±klar

Bir Lambda'nÄ±n **farklÄ± sÃ¼rÃ¼mleri** olabilir (her sÃ¼rÃ¼mde farklÄ± kod).\
Daha sonra, lambda'nÄ±n **farklÄ± sÃ¼rÃ¼mleriyle farklÄ± takma adlar** oluÅŸturabilir ve her birine farklÄ± aÄŸÄ±rlÄ±klar atayabilirsiniz.\
Bu ÅŸekilde bir saldÄ±rgan, **arka kapÄ±lÄ± bir sÃ¼rÃ¼m 1** ve **yalnÄ±zca meÅŸru kodu iÃ§eren bir sÃ¼rÃ¼m 2** oluÅŸturabilir ve gizli kalmak iÃ§in isteklerin yalnÄ±zca %1'inde **sÃ¼rÃ¼m 1'i yÃ¼rÃ¼tebilir**.

<figure><img src="../../../../.gitbook/assets/image (2) (2).png" alt=""><figcaption></figcaption></figure>

### SÃ¼rÃ¼m Arka KapÄ±sÄ± + API Gateway

1. Lambda'nÄ±n orijinal kodunu kopyalayÄ±n
2. Orijinal kodu **arka kapÄ± oluÅŸturacak ÅŸekilde yeni bir sÃ¼rÃ¼m oluÅŸturun** (veya sadece kÃ¶tÃ¼ amaÃ§lÄ± kodla). Bu sÃ¼rÃ¼mÃ¼ $LATEST'e yayÄ±nlayÄ±n ve daÄŸÄ±tÄ±n.
1. Kodu yÃ¼rÃ¼tmek iÃ§in lambda ile ilgili API aÄŸ geÃ§idine Ã§aÄŸrÄ± yapÄ±n
3. Orijinal kodla yeni bir sÃ¼rÃ¼m oluÅŸturun, bu sÃ¼rÃ¼mÃ¼ $LATEST'e yayÄ±nlayÄ±n ve daÄŸÄ±tÄ±n.
1. Bu, kÃ¶tÃ¼ amaÃ§lÄ± kodu Ã¶nceki bir sÃ¼rÃ¼mde gizler
4. API Gateway'e gidin ve **yeni bir POST yÃ¶ntemi oluÅŸturun** (veya baÅŸka bir yÃ¶ntem seÃ§in) ve arka kapÄ±lÄ± lambda'nÄ±n Ã§alÄ±ÅŸtÄ±rÄ±lacaÄŸÄ±: `arn:aws:lambda:us-east-1:<acc_id>:function:<func_name>:1`
1. Arnnin sonundaki :1, **fonksiyonun sÃ¼rÃ¼mÃ¼nÃ¼ belirten** (bu senaryoda sÃ¼rÃ¼m 1 arka kapÄ±lÄ± olan) bir iÅŸaret olacaktÄ±r.
5. OluÅŸturulan POST yÃ¶ntemini seÃ§in ve Eylemler'de **`API'yi YayÄ±nla`** seÃ§eneÄŸini seÃ§in.
6. Åimdi, **POST ile iÅŸlevi Ã§aÄŸÄ±rdÄ±ÄŸÄ±nÄ±zda** Arka KapÄ±nÄ±z Ã§aÄŸrÄ±lacaktÄ±r.

### Cron/Olay etkinleyici

Lambda iÅŸlevlerinin bir ÅŸey olduÄŸunda veya belirli bir sÃ¼re geÃ§tiÄŸinde Ã§alÄ±ÅŸmasÄ±nÄ± saÄŸlayabilme Ã¶zelliÄŸi, lambda'yÄ± kalÄ±cÄ±lÄ±k elde etmek ve tespit edilmekten kaÃ§Ä±nmak iÃ§in gÃ¼zel ve yaygÄ±n bir yol yapar.\
AWS'deki varlÄ±ÄŸÄ±nÄ±zÄ± daha gizli hale getirmek iÃ§in lambda oluÅŸturarak aÅŸaÄŸÄ±daki fikirlere sahip olursunuz.

* Her yeni kullanÄ±cÄ± oluÅŸturulduÄŸunda, lambda yeni bir kullanÄ±cÄ± anahtarÄ± oluÅŸturur ve bunu saldÄ±rganÄ±n yanÄ±na gÃ¶nderir.
* Her yeni rol oluÅŸturulduÄŸunda, lambda, etkilenen kullanÄ±cÄ±lara rolÃ¼ varsayÄ±lan olarak atar.
* Her yeni cloudtrail gÃ¼nlÃ¼ÄŸÃ¼ oluÅŸturulduÄŸunda, bunlarÄ± siler/deÄŸiÅŸtirir

<details>

<summary><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ± gÃ¶rmek** veya HackTricks'i **PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)'i takip edin.
* Hacking hilelerinizi [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.

</details>
