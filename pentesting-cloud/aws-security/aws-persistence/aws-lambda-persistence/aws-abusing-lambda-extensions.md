# AWS - Lambda UzantÄ±larÄ±nÄ± KÃ¶tÃ¼ye Kullanma

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) ile sÄ±fÄ±rdan kahramana kadar AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'da takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks** ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶nderin.

</details>

## Lambda UzantÄ±larÄ±

Lambda uzantÄ±larÄ±, Ã§eÅŸitli **izleme, gÃ¶zlemleme, gÃ¼venlik ve yÃ¶netim araÃ§larÄ±yla entegre olarak** iÅŸlevleri geliÅŸtirir. Bu uzantÄ±lar, [.zip arÅŸivleri kullanÄ±larak Lambda katmanlarÄ± aracÄ±lÄ±ÄŸÄ±yla eklenir](https://docs.aws.amazon.com/lambda/latest/dg/configuration-layers.html) veya [konteyner gÃ¶rÃ¼ntÃ¼ daÄŸÄ±tÄ±mlarÄ±na dahil edilir](https://aws.amazon.com/blogs/compute/working-with-lambda-layers-and-extensions-in-container-images/) ve iki modda Ã§alÄ±ÅŸÄ±r: **dahili** ve **harici**.

* **Dahili uzantÄ±lar**, **dil Ã¶zgÃ¼ Ã§evresel deÄŸiÅŸkenler** ve **kaplama betikleri** kullanarak Ã§alÄ±ÅŸma zamanÄ± iÅŸlemini birleÅŸtirir ve baÅŸlatmasÄ±nÄ± deÄŸiÅŸtirir. Bu Ã¶zelleÅŸtirme, **Java Correto 8 ve 11, Node.js 10 ve 12 ve .NET Core 3.1** gibi Ã§eÅŸitli Ã§alÄ±ÅŸma zamanlarÄ± iÃ§in geÃ§erlidir.
* **Harici uzantÄ±lar**, ayrÄ± iÅŸlemler olarak Ã§alÄ±ÅŸÄ±r ve Lambda iÅŸlevinin yaÅŸam dÃ¶ngÃ¼sÃ¼yle iÅŸletme hizalamasÄ±nÄ± korur. Bunlar, **Node.js 10 ve 12, Python 3.7 ve 3.8, Ruby 2.5 ve 2.7, Java Corretto 8 ve 11, .NET Core 3.1** ve **Ã¶zel Ã§alÄ±ÅŸma zamanlarÄ±** gibi Ã§eÅŸitli Ã§alÄ±ÅŸma zamanlarÄ±yla uyumludur.

[**Lambda uzantÄ±larÄ±nÄ±n nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ± hakkÄ±nda daha fazla bilgi iÃ§in belgelere bakÄ±n**](https://docs.aws.amazon.com/lambda/latest/dg/runtimes-extensions-api.html).

### KalÄ±cÄ±lÄ±k, Ä°stekleri Ã‡alma ve Ä°stekleri DeÄŸiÅŸtirme iÃ§in Harici UzantÄ±

Bu, bu yazÄ±da Ã¶nerilen tekniÄŸin Ã¶zeti: [https://www.clearvector.com/blog/lambda-spy/](https://www.clearvector.com/blog/lambda-spy/)

Lambda Ã§alÄ±ÅŸma zamanÄ± ortamÄ±ndaki varsayÄ±lan Linux Ã§ekirdeÄŸinin â€œ**process\_vm\_readv**â€ ve â€œ**process\_vm\_writev**â€ sistem Ã§aÄŸrÄ±larÄ±yla derlendiÄŸi ve tÃ¼m iÅŸlemlerin aynÄ± kullanÄ±cÄ± kimliÄŸiyle Ã§alÄ±ÅŸtÄ±ÄŸÄ± bulundu. **Bu, harici uzantÄ±nÄ±n tasarÄ±m gereÄŸi Rapid'in heap belleÄŸine tam okuma ve yazma eriÅŸimine sahip olduÄŸu anlamÄ±na gelir.**

AyrÄ±ca, Lambda uzantÄ±larÄ±nÄ±n **Ã§aÄŸrÄ± olaylarÄ±na abone olma** yeteneÄŸine sahip olduÄŸu, AWS'nin bu uzantÄ±lara ham verileri aÃ§Ä±klamadÄ±ÄŸÄ± bulundu. Bu, **uzantÄ±larÄ±n HTTP isteÄŸi aracÄ±lÄ±ÄŸÄ±yla iletilen hassas bilgilere eriÅŸememesini** saÄŸlar.

Init (Rapid) iÅŸlemi, Lambda uzantÄ±larÄ± baÅŸlatÄ±ldÄ±ÄŸÄ±nda ve Ã§alÄ±ÅŸma zamanÄ± kodunun yÃ¼rÃ¼tÃ¼lmesinden Ã¶nce, [http://127.0.0.1:9001](http://127.0.0.1:9001/) adresindeki tÃ¼m API isteklerini izler.

<figure><img src="../../../../.gitbook/assets/image (90).png" alt=""><figcaption><p><a href="https://www.clearvector.com/blog/content/images/size/w1000/2022/11/2022110801.rapid.default.png">https://www.clearvector.com/blog/content/images/size/w1000/2022/11/2022110801.rapid.default.png</a></p></figcaption></figure>

DeÄŸiÅŸken **`AWS_LAMBDA_RUNTIME_API`**, **Ã§ocuk Ã§alÄ±ÅŸma zamanÄ± iÅŸlemlerine** ve ek uzantÄ±lara Rapid API'nin **IP** adresini ve **port** numarasÄ±nÄ± gÃ¶sterir.

{% hint style="warning" %}
**`AWS_LAMBDA_RUNTIME_API`** Ã§evresel deÄŸiÅŸkenini bir **`port`** numarasÄ±na deÄŸiÅŸtirerek, Lambda Ã§alÄ±ÅŸma zamanÄ± iÃ§indeki tÃ¼m iÅŸlemleri (**orta adam** olarak) ele geÃ§irmek mÃ¼mkÃ¼ndÃ¼r. Bu, uzantÄ±nÄ±n Rapid Init ile aynÄ± ayrÄ±calÄ±klara sahip olmasÄ± ve sistem Ã§ekirdeÄŸinin **iÅŸlem belleÄŸini deÄŸiÅŸtirme** izin vermesi nedeniyle mÃ¼mkÃ¼ndÃ¼r.
{% endhint %}

Ã‡Ã¼nkÃ¼ **uzantÄ±lar herhangi bir Ã§alÄ±ÅŸma zamanÄ± kodundan Ã¶nce Ã§alÄ±ÅŸÄ±r**, Ã§evresel deÄŸiÅŸkeni deÄŸiÅŸtirmek Ã§alÄ±ÅŸma zamanÄ± iÅŸlemini (Ã¶rneÄŸin, Python, Java, Node, Ruby) baÅŸlatÄ±r. AyrÄ±ca, **bizimkinden sonra yÃ¼klenen uzantÄ±lar**, bu deÄŸiÅŸkene dayanan ve bizim uzantÄ±mÄ±z Ã¼zerinden yÃ¶nlendirilen uzantÄ±lar da olacaktÄ±r. Bu yapÄ±, kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±mÄ±n gÃ¼venlik Ã¶nlemlerini tamamen atlamasÄ±na veya doÄŸrudan Ã§alÄ±ÅŸma zamanÄ± ortamÄ±nda gÃ¼venlik Ã¶nlemlerini veya gÃ¼nlÃ¼kleme uzantÄ±larÄ±nÄ± atlamasÄ±na olanak tanÄ±yabilir.

<figure><img src="../../../../.gitbook/assets/image (3) (4).png" alt=""><figcaption><p><a href="https://www.clearvector.com/blog/content/images/size/w1000/2022/11/2022110801.rapid.mitm.png">https://www.clearvector.com/blog/content/images/size/w1000/2022/11/2022110801.rapid.mitm.png</a></p></figcaption></figure>

[**lambda-spy**](https://github.com/clearvector/lambda-spy) aracÄ±, bu **bellek yazma** iÅŸlemini gerÃ§ekleÅŸtirmek ve lambda isteklerinden hassas bilgileri **Ã§almak**, diÄŸer **uzantÄ± isteklerini** ve hatta **deÄŸiÅŸtirmek** iÃ§in oluÅŸturulmuÅŸtur.

## Referanslar

* [https://aws.amazon.com/blogs/compute/building-extensions-for-aws-lambda-in-preview/](https://aws.amazon.com/blogs/compute/building-extensions-for-aws-lambda-in-preview/)
* [https://www.clearvector.com/blog/lambda-spy/](https://www.clearvector.com/blog/lambda-spy/)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) ile sÄ±fÄ±rdan kahramana kadar AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek istiyorsanÄ±z** veya **HackTricks'i PDF olarak indirmek istiyorsanÄ±z** [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini alÄ±n**](https://peass.creator-spring.com)
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'da takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ±zÄ± gÃ¶ndererek HackTricks** ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶nderin.

</details>
