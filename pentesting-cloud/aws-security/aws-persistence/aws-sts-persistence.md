# AWS - STSæŒç¶šæ€§

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* ã‚‚ã— **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼ã—ãŸã„**å ´åˆã‚„ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å…¥æ‰‹ã—ãŸã„**å ´åˆã€ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ã“ã‚Œã¯ã€ç§ãŸã¡ã®ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€** [**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>

## STS

è©³ç´°ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š

{% content-ref url="../aws-services/aws-sts-enum.md" %}
[aws-sts-enum.md](../aws-services/aws-sts-enum.md)
{% endcontent-ref %}

### ãƒ­ãƒ¼ãƒ«ã®ä»®æƒ³ãƒˆãƒ¼ã‚¯ãƒ³

ä¸€æ™‚ãƒˆãƒ¼ã‚¯ãƒ³ã¯ãƒªã‚¹ãƒˆåŒ–ã§ããªã„ãŸã‚ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªä¸€æ™‚ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç¶­æŒã™ã‚‹ã“ã¨ã¯æŒç¶šæ€§ã‚’ç¶­æŒã™ã‚‹æ–¹æ³•ã§ã™ã€‚

<pre class="language-bash"><code class="lang-bash">aws sts get-session-token --duration-seconds 129600

# MFAã‚’ä½¿ç”¨ã™ã‚‹å ´åˆ
aws sts get-session-token \
--serial-number &#x3C;mfa-device-name> \
--token-code &#x3C;code-from-token>

# ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãƒ‡ãƒã‚¤ã‚¹åã¯é€šå¸¸ã€ãƒ‡ãƒã‚¤ã‚¹ã®èƒŒé¢ã«ã‚ã‚‹ç•ªå·ã§ã™ï¼ˆä¾‹ï¼šGAHT12345678ï¼‰
<strong># SMSãƒ‡ãƒã‚¤ã‚¹åã¯AWSã®ARNã§ã™ï¼ˆä¾‹ï¼šarn:aws:iam::123456789012:sms-mfa/usernameï¼‰
</strong># ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹åã¯AWSã®ARNã§ã™ï¼ˆä¾‹ï¼šarn:aws:iam::123456789012:mfa/usernameï¼‰
</code></pre>

### ãƒ­ãƒ¼ãƒ«ãƒã‚§ãƒ¼ãƒ³ã‚¸ãƒ£ã‚°ãƒªãƒ³ã‚°

[**ãƒ­ãƒ¼ãƒ«ãƒã‚§ãƒ¼ãƒ³**](https://docs.aws.amazon.com/IAM/latest/UserGuide/id\_roles\_terms-and-concepts.html#Role%20chaining)ã¯ã€ã‚¹ãƒ†ãƒ«ã‚¹ã®æŒç¶šæ€§ã‚’ç¶­æŒã™ã‚‹ãŸã‚ã«å½¹ç«‹ã¤AWSã®èªè­˜ã•ã‚ŒãŸæ©Ÿèƒ½ã§ã™ã€‚\
**ãƒ­ãƒ¼ãƒ«ã‚’ä»®å®šã—ã¦åˆ¥ã®ãƒ­ãƒ¼ãƒ«ã‚’ä»®å®šã—ã€æœ€åˆã®ãƒ­ãƒ¼ãƒ«ã‚’ä»®å®šã—ç¶šã‘ã‚‹ï¼ˆç„¡æœŸé™ï¼‰**ã“ã¨ãŒã§ãã¾ã™ã€‚

ãƒ­ãƒ¼ãƒ«ãŒä»®å®šã•ã‚Œã‚‹ã¨ã€è³‡æ ¼æƒ…å ±ã®**æœ‰åŠ¹æœŸé™ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæ›´æ–°**ã•ã‚Œã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€**2ã¤ã®ãƒ­ãƒ¼ãƒ«ãŒäº’ã„ã‚’ä»®å®šã§ãã‚‹**å ´åˆã€æ–°ã—ã„è³‡æ ¼æƒ…å ±ã‚’ç¶™ç¶šçš„ã«å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã®[**ãƒ„ãƒ¼ãƒ«**](https://github.com/hotnops/AWSRoleJuggler/)ã‚’ä½¿ç”¨ã—ã¦ã‚¸ãƒ£ã‚°ãƒªãƒ³ã‚°ã‚’ç¶šã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š
```bash
./aws_role_juggler.py -h
usage: aws_role_juggler.py [-h] [-r ROLE_LIST [ROLE_LIST ...]]

optional arguments:
-h, --help            show this help message and exit
-r ROLE_LIST [ROLE_LIST ...], --role-list ROLE_LIST [ROLE_LIST ...]
```
<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* ã‚‚ã—ã‚‚ã‚ãªãŸã®**ä¼šç¤¾ã‚’HackTricksã§åºƒå‘Šè¡¨ç¤ºã—ãŸã„**å ´åˆã‚„ã€**æœ€æ–°ç‰ˆã®PEASSã‚’å…¥æ‰‹ã—ãŸã„**å ´åˆã‚„ã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼ã®PEASSï¼†HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ã€ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter**ã§ç§ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¾ã—ã‚‡ã† ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)
* è‡ªåˆ†ã®ãƒãƒƒã‚­ãƒ³ã‚°ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>
