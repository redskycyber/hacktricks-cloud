# AWS - Api Gateway YetkilendirilmemiÅŸ Enum

<details>

<summary><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* Hacking hilelerinizi **HackTricks** ve **HackTricks Cloud** github depolarÄ±na PR gÃ¶ndererek paylaÅŸÄ±n.

</details>

### API Invoke bypass

[Attack Vectors for APIs Using AWS API Gateway Lambda Authorizers - Alexandre & Leonardo](https://www.youtube.com/watch?v=bsPKk7WDOnE) adlÄ± sunuma gÃ¶re, Lambda Yetkilendiricileri, API uÃ§ noktalarÄ±nÄ± Ã§aÄŸÄ±rmak iÃ§in izin vermek iÃ§in IAM sÃ¶zdizimini kullanarak yapÄ±landÄ±rÄ±labilir. Bu, [**belgelerden alÄ±nmÄ±ÅŸtÄ±r**](https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-control-access-using-iam-policies-to-invoke-api.html):
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Effect": "Permission",
"Action": [
"execute-api:Execution-operation"
],
"Resource": [
"arn:aws:execute-api:region:account-id:api-id/stage/METHOD_HTTP_VERB/Resource-path"
]
}
]
}
```
Ä°steklere izin vermek iÃ§in bu yÃ¶ntemin sorunu, **"\*" herhangi bir ÅŸeyi** ifade ettiÄŸi ve **daha fazla regex sÃ¶zdizimi desteklenmediÄŸi** anlamÄ±na gelir.

BazÄ± Ã¶rnekler:

* Her kullanÄ±cÄ±ya `/dashboard/user/{username}` eriÅŸimini saÄŸlamak iÃ§in `arn:aws:execute-apis:sa-east-1:accid:api-id/prod/*/dashboard/*` gibi bir kural, Ã¶rneÄŸin `/admin/dashboard/createAdmin` gibi diÄŸer rotalara da eriÅŸim izni verecektir.

{% hint style="warning" %}
**"\*" eÄŸik Ã§izgilerle geniÅŸlemeye devam etmez**, bu nedenle Ã¶rneÄŸin api-id'de "\*" kullanÄ±yorsanÄ±z, hala geÃ§erli bir sonuÃ§ ifade edildiÄŸi sÃ¼rece "herhangi bir aÅŸama" veya "herhangi bir yÃ¶ntem" de belirtebilir.\
Bu nedenle `arn:aws:execute-apis:sa-east-1:accid:*/prod/GET/dashboard/*`\
Ã–rneÄŸin `/prod/GET/dashboard/admin` yoluna test aÅŸamasÄ±nda bir post isteÄŸini doÄŸrulayabilir.
{% endhint %}

Her zaman hangi eriÅŸime izin vermek istediÄŸinizi net bir ÅŸekilde belirlemeli ve verilen izinlerle diÄŸer senaryolarÄ±n mÃ¼mkÃ¼n olup olmadÄ±ÄŸÄ±nÄ± kontrol etmelisiniz.

Daha fazla bilgi iÃ§in, [**belgelerin**](https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-control-access-using-iam-policies-to-invoke-api.html) yanÄ± sÄ±ra, [**bu resmi aws github**](https://github.com/awslabs/aws-apigateway-lambda-authorizer-blueprints/tree/master/blueprints) Ã¼zerinde yetkilendirme uygulamak iÃ§in kod bulabilirsiniz.

### IAM PolitikasÄ± Enjeksiyonu

AynÄ± [**sunumda**](https://www.youtube.com/watch?v=bsPKk7WDOnE), kodun IAM politikalarÄ±nÄ± oluÅŸturmak iÃ§in **kullanÄ±cÄ± giriÅŸi** kullandÄ±ÄŸÄ± durumda, joker karakterleri (ve diÄŸerleri "." veya belirli dizeler gibi) kÄ±sÄ±tlamalarÄ± **atlamak** amacÄ±yla iÃ§ine dahil edilebilir.

### Genel URL ÅŸablonu
```
https://{random_id}.execute-api.{region}.amazonaws.com/{user_provided}
```
<details>

<summary><strong>SÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong></a><strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* **Åirketinizi HackTricks'te reklamÄ±nÄ± gÃ¶rmek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)'Ä± **takip edin**.
* **Hacking hilelerinizi HackTricks** ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
