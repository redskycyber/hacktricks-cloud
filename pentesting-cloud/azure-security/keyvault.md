# Az - Keyvault

<details>

<summary><strong>æ”¯æŒ HackTricks å¹¶è·å¾—ç¦åˆ©ï¼</strong></summary>

* å¦‚æœæ‚¨æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Šï¼Œæˆ–è€…å¦‚æœæ‚¨æƒ³è®¿é—® PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDFï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹ PEASS å’Œ HackTricks å•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFT**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) **å’Œ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## åŸºæœ¬ä¿¡æ¯

Azure Key Vault æ˜¯ä¸€ç§ç”¨äº**å®‰å…¨å­˜å‚¨å’Œè®¿é—®æœºå¯†ä¿¡æ¯**çš„äº‘æœåŠ¡ã€‚æœºå¯†ä¿¡æ¯å¯ä»¥æ˜¯æ‚¨å¸Œæœ›**ä¸¥æ ¼æ§åˆ¶è®¿é—®æƒé™**çš„ä»»ä½•å†…å®¹ï¼Œä¾‹å¦‚ API å¯†é’¥ã€å¯†ç ã€è¯ä¹¦æˆ–åŠ å¯†å¯†é’¥ã€‚Key Vault æœåŠ¡æ”¯æŒä¸¤ç§ç±»å‹çš„å®¹å™¨ï¼šä¿é™©åº“å’Œæ‰˜ç®¡ç¡¬ä»¶å®‰å…¨æ¨¡å—ï¼ˆHSMï¼‰æ± ã€‚ä¿é™©åº“æ”¯æŒå­˜å‚¨è½¯ä»¶å’Œæ”¯æŒ HSM çš„å¯†é’¥ã€æœºå¯†ä¿¡æ¯å’Œè¯ä¹¦ã€‚æ‰˜ç®¡ HSM æ± ä»…æ”¯æŒæ”¯æŒ HSM çš„å¯†é’¥ã€‚æœ‰å…³å®Œæ•´è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…[Azure Key Vault REST API æ¦‚è¿°](https://learn.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates)ã€‚

**URL æ ¼å¼**ä¸º `https://{vault-name}.vault.azure.net/{object-type}/{object-name}/{object-version}` å…¶ä¸­ï¼š

* `vault-name` æ˜¯ä¿é™©åº“çš„å…¨å±€**å”¯ä¸€**åç§°
* `object-type` å¯ä»¥æ˜¯ "keys"ã€"secrets" æˆ– "certificates"
* `object-name` æ˜¯ä¿é™©åº“å†…å¯¹è±¡çš„**å”¯ä¸€**åç§°
* `object-version` æ˜¯ç³»ç»Ÿç”Ÿæˆçš„ï¼Œå¯é€‰ç”¨äºæŒ‡å®šå¯¹è±¡çš„**å”¯ä¸€ç‰ˆæœ¬**ã€‚

ä¸ºäº†è®¿é—®ä¿é™©åº“ä¸­å­˜å‚¨çš„æœºå¯†ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ä¸¤ç§æƒé™æ¨¡å‹ï¼š

* **ä¿é™©åº“è®¿é—®ç­–ç•¥**
* **Azure RBAC**

### è®¿é—®ç®¡ç†

å¯¹ä¿é™©åº“çš„è®¿é—®é€šè¿‡**ä¸¤ä¸ª**å¹³é¢è¿›è¡Œæ§åˆ¶ï¼š

* **ç®¡ç†å¹³é¢ï¼š**ç”¨äºç®¡ç†ä¿é™©åº“å’Œ**è®¿é—®ç­–ç•¥**ã€‚ä»…æ”¯æŒ Azure åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰ã€‚
* **æ•°æ®å¹³é¢ï¼š**ç”¨äºç®¡ç†ä¿é™©åº“ä¸­çš„**æ•°æ®**ï¼ˆå¯†é’¥ã€æœºå¯†ä¿¡æ¯å’Œè¯ä¹¦ï¼‰ã€‚æ­¤æ”¯æŒä¿é™©åº“è®¿é—®ç­–ç•¥æˆ– Azure RBACã€‚

åƒ**Contributor**è¿™æ ·çš„è§’è‰²åœ¨ç®¡ç†å¹³é¢ä¸Šå…·æœ‰ç®¡ç†è®¿é—®ç­–ç•¥çš„æƒé™ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹è®¿é—®ç­–ç•¥æ¥è®¿é—®æœºå¯†ä¿¡æ¯ã€‚

## æšä¸¾
```powershell
# Get keyvault token
curl "$IDENTITY_ENDPOINT?resource=https://vault.azure.net&api-version=2017-09-01" -H secret:$IDENTITY_HEADER

# Connect with PS AzureAD
## $token from management API
Connect-AzAccount -AccessToken $token -AccountId 2e91a4fea0f2-46ee-8214-fa2ff6aa9abc -KeyVaultAccessToken $keyvaulttoken

# List vaults
Get-AzKeyVault
# Get secrets names from the vault
Get-AzKeyVaultSecret -VaultName <vault_name>
# Get secret values
Get-AzKeyVaultSecret -VaultName <vault_name> -Name <secret_name> â€“AsPlainText
```
<details>

<summary><strong>æ”¯æŒ HackTricks å¹¶è·å¾—ç¦åˆ©ï¼</strong></summary>

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„å…¬å¸åœ¨ HackTricks ä¸­è¢«å¹¿å‘Šï¼Œæˆ–è€…å¦‚æœæ‚¨æƒ³è®¿é—®æœ€æ–°ç‰ˆæœ¬çš„ PEASS æˆ–ä¸‹è½½ HackTricks çš„ PDFï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å¾—[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
* å‘ç°æˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)æ”¶è—å“ï¼Œ[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass)ï¼Œæˆ–è€…åœ¨ **Twitter** ä¸Š **å…³æ³¨** æˆ‘ ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
