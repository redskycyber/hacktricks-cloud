# Az - Î Î¿Î»Î¹Ï„Î¹ÎºÎ­Ï‚ Î£Ï…Î½Î¸Î·ÎºÏÎ½ Î ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ / Î Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· MFA

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº Ï„Î¿Ï… AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚ Ï„Î¿Ï… HackTricks:

* Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>

## Î’Î±ÏƒÎ¹ÎºÎ­Ï‚ Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚

ÎŸÎ¹ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ­Ï‚ ÏƒÏ…Î½Î¸Î·ÎºÏÎ½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Azure ÎµÎ¯Î½Î±Î¹ ÎºÎ±Î½ÏŒÎ½ÎµÏ‚ Ï€Î¿Ï… Î¿ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ Microsoft Azure Î³Î¹Î± Ï„Î·Î½ ÎµÏ€Î¹Î²Î¿Î»Î® ÎµÎ»Î­Î³Ï‡Ï‰Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÏƒÎµ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ ÎºÎ±Î¹ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Azure Î²Î¬ÏƒÎµÎ¹ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Ï‰Î½ **ÏƒÏ…Î½Î¸Î·ÎºÏÎ½**. Î‘Ï…Ï„Î­Ï‚ Î¿Î¹ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ­Ï‚ Î²Î¿Î·Î¸Î¿ÏÎ½ Ï„Î¹Ï‚ Î¿ÏÎ³Î±Î½ÏÏƒÎµÎ¹Ï‚ Î½Î± Î±ÏƒÏ†Î±Î»Î¯ÏƒÎ¿Ï…Î½ Ï„Î¿Ï…Ï‚ Ï€ÏŒÏÎ¿Ï…Ï‚ Ï„Î¿Ï…Ï‚ ÎµÏ†Î±ÏÎ¼ÏŒÎ¶Î¿Î½Ï„Î±Ï‚ Ï„Î¿Ï…Ï‚ ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î¿Ï…Ï‚ ÎµÎ»Î­Î³Ï‡Î¿Ï…Ï‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Ï…Ï€ÏŒ Ï„Î¹Ï‚ ÎºÎ±Ï„Î¬Î»Î»Î·Î»ÎµÏ‚ ÏƒÏ…Î½Î¸Î®ÎºÎµÏ‚.\
ÎŸÎ¹ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ­Ï‚ ÏƒÏ…Î½Î¸Î·ÎºÏÎ½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Î¿Ï…ÏƒÎ¹Î±ÏƒÏ„Î¹ÎºÎ¬ **Î¿ÏÎ¯Î¶Î¿Ï…Î½** Ï„Î¿Î½ **Î Î¿Î¹Î¿Ï‚** Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ **Î¤Î¹** Î±Ï€ÏŒ **Î Î¿Ï** ÎºÎ±Î¹ **Î ÏÏ‚**.

Î Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ±Ï„Î¯Î¸ÎµÎ½Ï„Î±Î¹ Î¼ÎµÏÎ¹ÎºÎ¬ Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î±:

1. **Î Î¿Î»Î¹Ï„Î¹ÎºÎ® ÎšÎ¹Î½Î´ÏÎ½Î¿Ï… Î£ÏÎ½Î´ÎµÏƒÎ·Ï‚**: Î‘Ï…Ï„Î® Î· Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ® Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¿ÏÎ¹ÏƒÏ„ÎµÎ¯ Î³Î¹Î± Î½Î± Î±Ï€Î±Î¹Ï„ÎµÎ¯ Ï€Î¿Î»Î»Î±Ï€Î»Î®Ï‚ Ï€Î±ÏÎ¬Î³Î¿Î½Ï„Î±Ï‚ Ï„Î±Ï…Ï„Î¿Ï€Î¿Î¯Î·ÏƒÎ· (MFA) ÏŒÏ„Î±Î½ Î±Î½Î¹Ï‡Î½ÎµÏÎµÏ„Î±Î¹ ÎºÎ¯Î½Î´Ï…Î½Î¿Ï‚ ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, ÎµÎ¬Î½ Î· ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬ ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚ ÎµÎ½ÏŒÏ‚ Ï‡ÏÎ®ÏƒÏ„Î· ÎµÎ¯Î½Î±Î¹ Î±ÏƒÏ…Î½Î®Î¸Î¹ÏƒÏ„Î· ÏƒÎµ ÏƒÏ‡Î­ÏƒÎ· Î¼Îµ Ï„Î¿ ÏƒÏ…Î½Î®Î¸ÎµÏ‚ Ï€ÏÏŒÏ„Ï…Ï€ÏŒ Ï„Î¿Ï…, ÏŒÏ€Ï‰Ï‚ Î· ÏƒÏÎ½Î´ÎµÏƒÎ· Î±Ï€ÏŒ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ® Ï‡ÏÏÎ±, Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¶Î·Ï„Î®ÏƒÎµÎ¹ ÎµÏ€Î¹Ï€Î»Î­Î¿Î½ Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¯Î·ÏƒÎ·.
2. **Î Î¿Î»Î¹Ï„Î¹ÎºÎ® Î£Ï…Î¼Î¼ÏŒÏÏ†Ï‰ÏƒÎ·Ï‚ Î£Ï…ÏƒÎºÎµÏ…Î®Ï‚**: Î‘Ï…Ï„Î® Î· Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ® Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÎµÏÎ¹Î¿ÏÎ¯ÏƒÎµÎ¹ Ï„Î·Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Azure Î¼ÏŒÎ½Î¿ ÏƒÎµ ÏƒÏ…ÏƒÎºÎµÏ…Î­Ï‚ Ï€Î¿Ï… ÏƒÏ…Î¼Î¼Î¿ÏÏ†ÏÎ½Î¿Î½Ï„Î±Î¹ Î¼Îµ Ï„Î± Ï€ÏÏŒÏ„Ï…Ï€Î± Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ Ï„Î·Ï‚ Î¿ÏÎ³Î¬Î½Ï‰ÏƒÎ·Ï‚. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÏ„Î±Î¹ Î¼ÏŒÎ½Î¿ Î±Ï€ÏŒ ÏƒÏ…ÏƒÎºÎµÏ…Î­Ï‚ Ï€Î¿Ï… Î´Î¹Î±Î¸Î­Ï„Î¿Ï…Î½ ÎµÎ½Î·Î¼ÎµÏÏ‰Î¼Î­Î½Î¿ Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÏŒ Î±Î½Ï„Î¹Î¹Î¹ÎºÏÎ½ Î® ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½ Î¼Î¹Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î· Î­ÎºÎ´Î¿ÏƒÎ· Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÎ¿Ï ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚.

## Î Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÎ¹Ï‚ Î Î¿Î»Î¹Ï„Î¹ÎºÏÎ½ Î£Ï…Î½Î¸Î·ÎºÏÎ½ Î ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚

Î•Î¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î¼Î¹Î± Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ® ÏƒÏ…Î½Î¸Î®ÎºÎ·Ï‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Î½Î± **ÎµÎ»Î­Î³Ï‡ÎµÎ¹ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï€Î±ÏÎ±Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ ÎµÏÎºÎ¿Î»Î±, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ Î­Ï„ÏƒÎ¹ Ï„Î·Î½ Ï€Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· Ï„Î·Ï‚ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ®Ï‚**. ÎšÎ±Î¹ Î±Î½ Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î· Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ® ÏÏÎ¸Î¼Î¹Î¶Îµ Ï„Î¿ MFA, Î¿ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± Ï„Î·Î½ Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÎ¹.

### Î Î»Î±Ï„Ï†ÏŒÏÎ¼ÎµÏ‚ Î£Ï…ÏƒÎºÎµÏ…Î®Ï‚ - Î£Ï…Î½Î¸Î®ÎºÎ· Î£Ï…ÏƒÎºÎµÏ…Î®Ï‚

Î•Î¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Î¿ÏÎ¹ÏƒÏ„ÎµÎ¯ Î¼Î¹Î± ÏƒÏ…Î½Î¸Î®ÎºÎ· Î²Î¬ÏƒÎµÎ¹ Ï„Î·Ï‚ **Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î±Ï‚ Ï„Î·Ï‚ ÏƒÏ…ÏƒÎºÎµÏ…Î®Ï‚** (Android, iOS, Windows, macOS), Ï‰ÏƒÏ„ÏŒÏƒÎ¿, Î±Ï…Ï„ÏŒ Î²Î±ÏƒÎ¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ **user-agent** Î¿Ï€ÏŒÏ„Îµ ÎµÎ¯Î½Î±Î¹ Î±ÏÎºÎµÏ„Î¬ ÎµÏÎºÎ¿Î»Î¿ Î½Î± Ï€Î±ÏÎ±ÎºÎ±Î¼Ï†Î¸ÎµÎ¯. Î‘ÎºÏŒÎ¼Î· ÎºÎ±Î¹ **ÎµÎ¬Î½ ÏŒÎ»ÎµÏ‚ Î¿Î¹ ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚ ÎµÏ€Î¹Î²Î¬Î»Î»Î¿Ï…Î½ MFA**, ÎµÎ¬Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î­Î½Î± **user-agent Ï€Î¿Ï… Î´ÎµÎ½ Î±Î½Î±Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Î±Î¹**, Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÏ„Îµ Ï„Î¿ MFA.

### Î¤Î¿Ï€Î¿Î¸ÎµÏƒÎ¯ÎµÏ‚: Î§ÏÏÎµÏ‚, Î•ÏÏÎ¿Ï‚ IP - Î£Ï…Î½Î¸Î®ÎºÎ· Î£Ï…ÏƒÎºÎµÏ…Î®Ï‚

Î¦Ï…ÏƒÎ¹ÎºÎ¬, ÎµÎ¬Î½ Î±Ï…Ï„ÏŒ Î­Ï‡ÎµÎ¹ Î¿ÏÎ¹ÏƒÏ„ÎµÎ¯ ÏƒÏ„Î·Î½ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ® ÏƒÏ…Î½Î¸Î®ÎºÎ·Ï‚, Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î±Ï€Î»Î¬ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Î­Î½Î± **VPN** ÏƒÏ„Î·Î½ **ÎµÏ€Î¹Ï„ÏÎµÏ€ÏŒÎ¼ÎµÎ½Î· Ï‡ÏÏÎ±** Î® Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÎ¹ Î½Î± Î²ÏÎµÎ¹ Î­Î½Î±Î½ Ï„ÏÏŒÏ€Î¿ Î½Î± Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· Î±Ï€ÏŒ Î¼Î¹Î± **ÎµÏ€Î¹Ï„ÏÎµÏ€ÏŒÎ¼ÎµÎ½Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP** Î³Î¹Î± Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÎ¹ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ ÏƒÏ…Î½Î¸Î®ÎºÎµÏ‚.

### Î•Ï†Î±ÏÎ¼Î¿Î³Î­Ï‚ Î ÎµÎ»Î¬Ï„Î· Office365

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï…Ï€Î¿Î´ÎµÎ¯Î¾ÎµÏ„Îµ ÏŒÏ„Î¹ ÎµÎ¬Î½ Î¿Î¹ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ **Î­Ï‡Î¿Ï…Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Office 365 Î±Ï€ÏŒ Ï„Î¿Î½ Ï€ÎµÏÎ¹Î·Î³Î·Ï„Î®, Ï‡ÏÎµÎ¹Î¬Î¶Î¿Î½Ï„Î±Î¹ MFA**:

<figure><img src="../../../.gitbook/assets/image (129).png" alt=""><figcaption></figcaption></figure>

Î“Î¹Î± Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÏ„Îµ Î±Ï…Ï„ÏŒ, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î¿Î¹Î·Î¸ÎµÎ¯Ï„Îµ ÏŒÏ„Î¹ ÏƒÏ…Î½Î´Î­ÎµÏƒÏ„Îµ ÏƒÎµ Î¼Î¹Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î±Ï€ÏŒ Î¼Î¹Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎµÏ€Î¹Ï†Î¬Î½ÎµÎ¹Î±Ï‚ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚ (ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, ÏƒÏ„Î¿ Microsoft Teams) Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î¸Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÎ¹ Ï„Î·Î½ Ï€ÏÎ¿ÏƒÏ„Î±ÏƒÎ¯Î±:
```bash
roadrecon auth -u user@email.com -r https://outlook.office.com/ -c 1fec8e78-bce4-4aaf-ab1b-5451cc387264 --tokrns-stdout

<token>
```
ÎšÎ±Î¸ÏÏ‚ Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Microsoft Teams Î­Ï‡ÎµÎ¹ Ï€Î¿Î»Î»Î­Ï‚ Î¬Î´ÎµÎ¹ÎµÏ‚, Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·.

{% hint style="success" %}
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î¿ **ID Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÏ‰Î½ Î´Î·Î¼ÏŒÏƒÎ¹Ï‰Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³ÏÎ½** Î¼Îµ Ï€ÏÎ¿ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Î¬Î´ÎµÎ¹ÎµÏ‚ Office365 ÏƒÏ„Î· Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Ï„Î¿Ï… roadtools:

{% code overflow="wrap" %}
```sql
SELECT appId, displayName FROM ApplicationRefs WHERE publicCLient = 1 ORDER BY displayName ASC
```
{% code %}
az ad signed-in-user show --query 'deviceProfile' -o json
{% endcode %}

Then, use the obtained **PRT** token to authenticate to the target application.

### Legacy Authentication

If the target application allows **legacy authentication**, an attacker could use **legacy protocols** that don't support MFA to bypass it.

Some examples of legacy protocols are **IMAP**, **SMTP**, **POP3**, **Exchange ActiveSync**, **Remote PowerShell**, etc.

### Password Spray

If the target application allows **password spray attacks**, an attacker could try a **list of common passwords** against multiple accounts until finding a valid one.

This technique is effective when **MFA is not enforced** for all accounts or when **weak passwords** are used.

### Password Reset

If the target application allows **password reset**, an attacker could try to **reset the password** of a target account and gain access without needing MFA.

This technique is effective when **MFA is not enforced** for the password reset process.

### Phishing

Phishing attacks can be used to **trick users** into providing their credentials, including their MFA code.

By creating a **fake login page** that looks identical to the target application's login page, an attacker can capture the user's credentials and bypass MFA.

### Token Theft

If an attacker is able to **steal a user's access token**, they can use it to authenticate to the target application without needing MFA.

This can be done through techniques like **token interception**, **token replay**, or **token leak**.

### Application Permission

If an application has been granted **application permissions** to access a target application, it can bypass MFA.

This can happen if the application has been granted **delegated permissions** and the attacker is able to **compromise the application's credentials**.

### Device Registration

If a device has been registered with Azure AD, it can bypass MFA.

This can happen if the device is **trusted** and has been **registered** with Azure AD.

### User Consent

If a user has given **consent** to an application to access their data, the application can bypass MFA.

This can happen if the user has **granted consent** to an application and the attacker is able to **compromise the application's credentials**.

### Conditional Access Policies

If the target application has **conditional access policies** configured, an attacker can try to bypass them.

This can be done by finding **vulnerabilities** or **misconfigurations** in the policies, or by using **bypass techniques** like the ones mentioned above.

{% hint style="info" %}
Remember that bypassing MFA is a **serious security issue** and should not be done without proper authorization. Always follow ethical hacking guidelines and obtain proper permissions before attempting any MFA bypass techniques.
{% endhint %}
```powershell
$prtKeys = Get-AADIntuneUserPRTKeys - PfxFileName .\<uuid>.pfx -Credentials $credentials

$prtToken = New-AADIntUserPRTToken -Settings $prtKeys -GertNonce

Get-AADIntAccessTokenForAADGraph -PRTToken $prtToken

<token returned>
```
Î’ÏÎµÎ¯Ï„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Î±Ï…Ï„Î¿Ï Ï„Î¿Ï… ÎµÎ¯Î´Î¿Ï…Ï‚ ÎµÏ€Î¯Î¸ÎµÏƒÎ· ÏƒÏ„Î·Î½ Î±ÎºÏŒÎ»Î¿Ï…Î¸Î· ÏƒÎµÎ»Î¯Î´Î±:

{% content-ref url="../az-lateral-movement-cloud-on-prem/pass-the-prt.md" %}
[pass-the-prt.md](../az-lateral-movement-cloud-on-prem/pass-the-prt.md)
{% endcontent-ref %}

## Î•ÏÎ³Î±Î»ÎµÎ¯Î±

### [roadrecon](https://github.com/dirkjanm/ROADtools)

Î›Î¬Î²ÎµÏ„Îµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ­Ï‚
```bash
roadrecon plugin policies
```
### [Invoke-MFASweep](https://github.com/dafthack/MFASweep)

Î¤Î¿ MFASweep ÎµÎ¯Î½Î±Î¹ Î­Î½Î± PowerShell script Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ ÏƒÎµ Î´Î¹Î¬Ï†Î¿ÏÎµÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Ï„Î·Ï‚ Microsoft Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î­Î½Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ ÏƒÎµÏ„ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î·ÏÎ¯Ï‰Î½ ÎºÎ±Î¹ Î¸Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÎ¹ Î½Î± ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎµÎ¹ ÎµÎ¬Î½ Î· Ï€Î¿Î»Ï…Ï€Î±ÏÎ±Î³Î¿Î½Ï„Î¹ÎºÎ® Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¯Î·ÏƒÎ· (MFA) ÎµÎ¯Î½Î±Î¹ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î·. Î‘Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î¿Î½ Ï„ÏÏŒÏ€Î¿ Ï€Î¿Ï… Î­Ï‡Î¿Ï…Î½ Î´Î¹Î±Î¼Î¿ÏÏ†Ï‰Î¸ÎµÎ¯ Î¿Î¹ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ­Ï‚ ÏƒÏ…Î½Î¸Î®ÎºÎ·Ï‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÎºÎ±Î¹ Î¿Î¹ Î¬Î»Î»ÎµÏ‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Ï€Î¿Î»Ï…Ï€Î±ÏÎ±Î³Î¿Î½Ï„Î¹ÎºÎ®Ï‚ Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚, Î¼ÎµÏÎ¹ÎºÎ¬ Ï€ÏÏ‰Ï„ÏŒÎºÎ¿Î»Î»Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¼ÎµÎ¯Î½Î¿Ï…Î½ Î¼Î¿Î½Î¿Ï€Î±ÏÎ±Î³Î¿Î½Ï„Î¹ÎºÎ¬. ÎˆÏ‡ÎµÎ¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î¼Î¹Î± ÎµÏ€Î¹Ï€Î»Î­Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ Î³Î¹Î± Ï„Î¹Ï‚ Î´Î¹Î±Î¼Î¿ÏÏ†ÏÏƒÎµÎ¹Ï‚ ADFS ÎºÎ±Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÎ¹ Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ ÏƒÏ„Î¿Î½ ÎµÎ¾Ï…Ï€Î·ÏÎµÏ„Î·Ï„Î® ADFS ÏƒÏ„Î¿Î½ Ï„ÏŒÏ€Î¿ ÎµÎ³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·Ï‚.
```bash
Invoke-MFASweep -Username <username> -Password <pass>
```
### [donkeytoken](https://github.com/silverhack/donkeytoken)

Î¤Î¿ donkey token ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÏƒÏÎ½Î¿Î»Î¿ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÏÎ½ Ï€Î¿Ï… ÏƒÏ„Î¿Ï‡ÎµÏÎ¿Ï…Î½ Î½Î± Î²Î¿Î·Î¸Î®ÏƒÎ¿Ï…Î½ Ï„Î¿Ï…Ï‚ Î±ÏƒÏ†Î±Î»Î¹ÏƒÏ„Î¹ÎºÎ¿ÏÏ‚ ÏƒÏ…Î¼Î²Î¿ÏÎ»Î¿Ï…Ï‚ Ï€Î¿Ï… Ï‡ÏÎµÎ¹Î¬Î¶Î¿Î½Ï„Î±Î¹ Î½Î± ÎµÏ€Î¹ÎºÏ…ÏÏÏƒÎ¿Ï…Î½ Ï„Î¹Ï‚ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ­Ï‚ ÏƒÏ…Î½Î¸Î®ÎºÎ·Ï‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚, Î½Î± Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎ¿Ï…Î½ Ï„Î± Microsoft portals Ï€Î¿Ï… Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶Î¿Ï…Î½ Ï„Î¿ 2FA, Îº.Î»Ï€..
```powershell
Import-Module 'C:\Users\Administrador\Desktop\Azure\Modulos ps1\donkeytoken' -Force
```
**Î”Î¿ÎºÎ¹Î¼Î¬ÏƒÏ„Îµ ÎºÎ¬Î¸Îµ Ï€ÏÎ»Î·** Î³Î¹Î± Î½Î± Î´ÎµÎ¯Ï„Îµ Î±Î½ ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„Î® Î· **ÏƒÏÎ½Î´ÎµÏƒÎ· Ï‡Ï‰ÏÎ¯Ï‚ MFA**:
```powershell
Test-MFA -credential $cred -Verbose -Debug -InformationAction Continue
```
Î•Ï€ÎµÎ¹Î´Î® Ï„Î¿ **Azure portal** Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î¿, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½ Î½Î± ÏƒÏ…Î»Î»ÎµÏ‡Î¸ÎµÎ¯ Î­Î½Î± **Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÏŒ (token)** Î±Ï€ÏŒ Ï„Î¿ Ï„Î­Î»Î¿Ï‚ Ï„Î¿Ï… portal Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î·Î¸ÎµÎ¯ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÏ„Î·ÎºÎµ Î±Ï€ÏŒ Ï„Î·Î½ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· ÎµÎºÏ„Î­Î»ÎµÏƒÎ·. Î£Îµ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÏ„Î·ÎºÎµ Ï„Î¿ Sharepoint ÎºÎ±Î¹ Î¶Î·Ï„ÎµÎ¯Ï„Î±Î¹ Î­Î½Î± Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÏŒ Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î·Î¸ÎµÎ¯ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î±Ï…Ï„ÏŒ:

{% code overflow="wrap" %}
```powershell
$token = Get-DelegationTokenFromAzurePortal -credential $cred -token_type microsoft.graph -extension_type Microsoft_Intune
Read-JWTtoken -token $token.access_token
```
{% endcode %}


Î¥Ï€Î¿Î¸Î­Ï„Î¿Î½Ï„Î±Ï‚ ÏŒÏ„Î¹ Ï„Î¿ Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÏŒ Î­Ï‡ÎµÎ¹ Ï„Î·Î½ Î¬Î´ÎµÎ¹Î± Sites.Read.All (Î±Ï€ÏŒ Ï„Î¿ Sharepoint), Î±ÎºÏŒÎ¼Î± ÎºÎ¹ Î±Î½ Î´ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î­Ï‡ÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¿ Sharepoint Î±Ï€ÏŒ Ï„Î¿Î½ Î¹ÏƒÏ„ÏŒ Î»ÏŒÎ³Ï‰ Ï„Î¿Ï… MFA, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÏŒ Î³Î¹Î± Î½Î± Î­Ï‡ÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î± Î±ÏÏ‡ÎµÎ¯Î± Î¼Îµ Ï„Î¿ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¼Î­Î½Î¿ Î´Î¹Î±ÎºÏÎ¹Ï„Î¹ÎºÏŒ:
```powershell
$data = Get-SharePointFilesFromGraph -authentication $token $data[0].downloadUrl
```
## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* [https://www.youtube.com/watch?v=yOJ6yB9anZM\&t=296s](https://www.youtube.com/watch?v=yOJ6yB9anZM\&t=296s)
* [https://www.youtube.com/watch?v=xei8lAPitX8](https://www.youtube.com/watch?v=xei8lAPitX8)

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ hacking Ï„Î¿Ï… AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ HackTricks:

* Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF**, ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î Î‘ÎšÎ•Î¤Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**Ï„Î·Î½ ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± hacking tricks ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>
