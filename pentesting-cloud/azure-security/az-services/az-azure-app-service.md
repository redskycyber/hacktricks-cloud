# Az - Azure App Service & Function Apps

<details>

<summary><strong>隆Apoya a HackTricks y obt茅n beneficios!</strong></summary>

* Si quieres ver a tu **empresa anunciada en HackTricks** o si quieres acceder a la **煤ltima versi贸n de PEASS o descargar HackTricks en PDF**, 隆consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>

## Informaci贸n b谩sica del servicio de aplicaciones

_Azure App Service_ es un servicio basado en HTTP para alojar aplicaciones web, APIs REST y backends m贸viles. Puedes desarrollar en tu lenguaje favorito, ya sea .NET, .NET Core, Java, Ruby, Node.js, PHP o Python. Las aplicaciones se ejecutan y escalan f谩cilmente en entornos basados en Windows y Linux.

Cada aplicaci贸n se ejecuta dentro de un sandbox, pero el aislamiento depende de los planes de App Service.

* Las aplicaciones en los niveles Free y Shared se ejecutan en VM compartidas.
* Las aplicaciones en los niveles Standard y Premium se ejecutan en VM dedicadas.

{% hint style="warning" %}
Ten en cuenta que **ninguno** de estos aislamientos **impide** otras **vulnerabilidades web** comunes (como la carga de archivos o inyecciones). Y si se utiliza una **identidad de administraci贸n**, podr铆a comprometer sus permisos.
{% endhint %}

### Enumeraci贸n

{% tabs %}
{% tab title="az" %}
{% code overflow="wrap" %}
```bash
# List webapps
az webapp list

## Less information
az webapp list --query "[].{hostName: defaultHostName, state: state, name: name, resourcegroup: resourceGroup}"

# Get access restrictions
az webapp config access-restriction show --resource-group <res-group> -n <name>

# Remove access restrictions
az webapp config access-restriction remove --resource-group <res-group> -n <name> --rule-name <rule-name>

# Get snapshots
az webapp config snapshot list --resource-group <res-group> -n <name>

# Restore snapshot
az webapp config snapshot restore -g <res-group> -n <name> --time 2018-12-11T23:34:16.8388367

# Restart webapp
az webapp restart --name <name> --resource-group <res-group>
```
{% endcode %}
{% endtab %}

{% tab title="Az Powershell" %}
```powershell
# Get App Services and Function Apps
Get-AzWebApp
# Get only App Services
Get-AzWebApp | ?{$_.Kind -notmatch "functionapp"}
```
{% endtab %}
{% endtabs %}

#### Obtener credenciales y acceder al c贸digo de la aplicaci贸n web
```bash
# Get connection strings that could contain credentials (with DBs for example)
az webapp config connection-string list --name <name> --resource-group <res-group>
## Check how to use the DBs connection strings in the SQL page

# Get credentials to access the code and DB credentials if configured.
az webapp deployment list-publishing-profiles --resource-group <res-group> -n <name>


# Get git URL to access the code
az webapp deployment source config-local-git --resource-group <res-group> -n <name>

# Access/Modify the code via git
git clone 'https://<username>:<password>@name.scm.azurewebsites.net/repo-name.git'
## In my case the username was: $nameofthewebapp and the password some random chars
## If you change the code and do a push, the app is automatically redeployed
```
#### Acceso al contenedor Docker con la aplicaci贸n web a trav茅s de ssh:

```bash
ssh -p <port> <username>@<ip_address>
```

Reemplace `<port>` con el n煤mero de puerto SSH, `<username>` con el nombre de usuario y `<ip_address>` con la direcci贸n IP del servidor.
```bash
# Get ssh session
az webapp create-remote-connection --subscription <SUBSCRIPTION-ID> --resource-group <RG-NAME> -n <APP-SERVICE-NAME>

## If successfull you will get a message such as:
#Verifying if app is running....
#App is running. Trying to establish tunnel connection...
#Opening tunnel on port: 39895
#SSH is available { username: root, password: Docker! }

## So from that machine ssh into that port (you might need generate a new ssh session to the jump host)
ssh root@127.0.0.1 -p 39895

```
## Informaci贸n b谩sica de las aplicaciones de funciones

Azure Functions es una soluci贸n **sin servidor** que te permite escribir menos c贸digo, mantener menos infraestructura y ahorrar en costos. En lugar de preocuparte por implementar y mantener servidores, la infraestructura en la nube proporciona todos los recursos actualizados necesarios para mantener tus aplicaciones en funcionamiento.

Azure Functions se integra con Azure API Management en el portal para permitirte exponer tus funciones de activaci贸n HTTP como **API REST**. Estas API se describen utilizando una definici贸n OpenAPI.

Las **aplicaciones de funciones admiten identidades administradas**.

### Enumeraci贸n
```powershell
# Get only Function Apps
Get-AzFunctionApp
```
## Referencias

* [https://learn.microsoft.com/es-es/azure/app-service/overview](https://learn.microsoft.com/es-es/azure/app-service/overview)
* [https://learn.microsoft.com/es-es/azure/azure-functions/functions-openapi-definition](https://learn.microsoft.com/es-es/azure/azure-functions/functions-openapi-definition)

<details>

<summary><strong>隆Apoya a HackTricks y obt茅n beneficios!</strong></summary>

* Si quieres ver tu **empresa anunciada en HackTricks** o si quieres acceder a la **煤ltima versi贸n de PEASS o descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop).
* Obt茅n el [**merchandising oficial de PEASS y HackTricks**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en GitHub.

</details>
