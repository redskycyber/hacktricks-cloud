# Az - Azure App Service & Function Apps

## Az - Azure App Service & Function Apps

<details>

<summary><strong>ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

HackTricks ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricks ã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„**ã¾ãŸã¯**HackTricks ã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã‚‹
* \*\*ğŸ’¬ [Discordã‚°ãƒ«ãƒ¼ãƒ—](https://discord.gg/hRep4RUj7f)\*\*ã«å‚åŠ ã™ã‚‹ã‹ã€[telegramã‚°ãƒ«ãƒ¼ãƒ—](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**HackTricks**](https://github.com/carlospolop/hacktricks) **ã¨** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

### App Serviceã®åŸºæœ¬æƒ…å ±

[å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‹ã‚‰ï¼š](https://learn.microsoft.com/en-us/azure/app-service/overview) _Azure App Service_ ã¯ã€Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€REST APIã€ãŠã‚ˆã³ãƒ¢ãƒã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’ãƒ›ã‚¹ãƒˆã™ã‚‹ãŸã‚ã®HTTPãƒ™ãƒ¼ã‚¹ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚ãŠæ°—ã«å…¥ã‚Šã®è¨€èªã§é–‹ç™ºã§ãã¾ã™ã€‚.NETã€.NET Coreã€Javaã€Rubyã€Node.jsã€PHPã€ã¾ãŸã¯Pythonã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€WindowsãŠã‚ˆã³Linuxãƒ™ãƒ¼ã‚¹ã®ç’°å¢ƒã§ç°¡å˜ã«å®Ÿè¡ŒãŠã‚ˆã³ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã§ãã¾ã™ã€‚

å„ã‚¢ãƒ—ãƒªã¯ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹å†…ã§å®Ÿè¡Œã•ã‚Œã¾ã™ãŒã€åˆ†é›¢ã¯App Serviceãƒ—ãƒ©ãƒ³ã«ä¾å­˜ã—ã¾ã™

* FreeãŠã‚ˆã³Sharedãƒ†ã‚£ã‚¢ã®ã‚¢ãƒ—ãƒªã¯å…±æœ‰VMä¸Šã§å®Ÿè¡Œã•ã‚Œã¾ã™
* StandardãŠã‚ˆã³Premiumãƒ†ã‚£ã‚¢ã®ã‚¢ãƒ—ãƒªã¯å°‚ç”¨VMä¸Šã§å®Ÿè¡Œã•ã‚Œã¾ã™

{% hint style="warning" %}
ã“ã‚Œã‚‰ã®åˆ†é›¢ã®ã„ãšã‚Œã‚‚ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚„ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãªã©ã®ä¸€èˆ¬çš„ãª**Webè„†å¼±æ€§**ï¼ˆä¾‹ï¼šãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ï¼‰ã‚’**é˜²ãã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“**ã€‚ã¾ãŸã€**ç®¡ç†ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£**ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆã€ãã®æ¨©é™ã‚’**ä¾µå®³**ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
{% endhint %}

#### åˆ—æŒ™

{% code overflow="wrap" %}
```bash
# List webapps
az webapp list

## Less information
az webapp list --query "[].{hostName: defaultHostName, state: state, name: name, resourcegroup: resourceGroup}"

# Get access restrictions
az webapp config access-restriction show --resource-group <res-group> -n <name>

# Remove access restrictions
az webapp config access-restriction remove --resource-group <res-group> -n <name> --rule-name <rule-name>

# Get snapshots
az webapp config snapshot list --resource-group <res-group> -n <name>

# Restore snapshot
az webapp config snapshot restore -g <res-group> -n <name> --time 2018-12-11T23:34:16.8388367

# Restart webapp
az webapp restart --name <name> --resource-group <res-group>
```
{% endcode %}

```powershell
# Get App Services and Function Apps
Get-AzWebApp
# Get only App Services
Get-AzWebApp | ?{$_.Kind -notmatch "functionapp"}
```

{% code overflow="wrap" %}
```
```
{% endcode %}

\`\`\`bash #!/bin/bash

## Get all App Service and Function Apps

## Define Azure subscription ID

azure\_subscription="your\_subscription\_id"

## Log in to Azure

az login

## Select Azure subscription

az account set --subscription $azure\_subscription

## Get all App Services in the specified subscription

list\_app\_services=$(az appservice list --query "\[].{appServiceName: name, group: resourceGroup}" -o tsv)

## Iterate over each App Service

echo "$list\_app\_services" | while IFS=$'\t' read -r appServiceName group; do

## Get the type of the App Service

service\_type=$(az appservice show --name $appServiceName --resource-group $group --query "kind" -o tsv)

## Check if it is a Function App and print its name

if \[ "$service\_type" == "functionapp" ]; then echo "Function App Name: $appServiceName" fi done

````
#### è³‡æ ¼æƒ…å ±ã‚’å–å¾—ã—ã€Webã‚¢ãƒ—ãƒªã®ã‚³ãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹
```bash
# Get connection strings that could contain credentials (with DBs for example)
az webapp config connection-string list --name <name> --resource-group <res-group>
## Check how to use the DBs connection strings in the SQL page

# Get credentials to access the code and DB credentials if configured.
az webapp deployment list-publishing-profiles --resource-group <res-group> -n <name>


# Get git URL to access the code
az webapp deployment source config-local-git --resource-group <res-group> -n <name>

# Access/Modify the code via git
git clone 'https://<username>:<password>@name.scm.azurewebsites.net/repo-name.git'
## In my case the username was: $nameofthewebapp and the password some random chars
## If you change the code and do a push, the app is automatically redeployed
````

**SSHã‚’ä»‹ã—ãŸWebã‚¢ãƒ—ãƒªã®Dockerã‚³ãƒ³ãƒ†ãƒŠã¸ã®ã‚¢ã‚¯ã‚»ã‚¹:**

```bash
# Get ssh session
az webapp create-remote-connection --subscription <SUBSCRIPTION-ID> --resource-group <RG-NAME> -n <APP-SERVICE-NAME>

## If successfull you will get a message such as:
#Verifying if app is running....
#App is running. Trying to establish tunnel connection...
#Opening tunnel on port: 39895
#SSH is available { username: root, password: Docker! }

## So from that machine ssh into that port (you might need generate a new ssh session to the jump host)
ssh root@127.0.0.1 -p 39895
```

### é–¢æ•°ã‚¢ãƒ—ãƒªã®åŸºæœ¬æƒ…å ±

Azure Functionsã¯ã€**ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹**ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚ã‚Šã€å°‘ãªã„ã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¿°ã—ã€å°‘ãªã„ã‚¤ãƒ³ãƒ•ãƒ©ã‚’ç¶­æŒã—ã€ã‚³ã‚¹ãƒˆã‚’ç¯€ç´„ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚µãƒ¼ãƒãƒ¼ã®å±•é–‹ã‚„ç¶­æŒã‚’æ°—ã«ã™ã‚‹å¿…è¦ã¯ãªãã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œã«å¿…è¦ãªæœ€æ–°ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ã™ã¹ã¦æä¾›ã—ã¾ã™ã€‚

Azureãƒãƒ¼ã‚¿ãƒ«ã§ã¯ã€Azure Functionsã¨Azure API Managementã®çµ±åˆãŒå®¹æ˜“ã«è¡Œã‚ã‚Œã€**HTTPãƒˆãƒªã‚¬ãƒ¼é–¢æ•°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒREST APIã¨ã—ã¦å…¬é–‹**ã•ã‚Œã¾ã™ã€‚ã“ã®æ–¹æ³•ã§å…¬é–‹ã•ã‚Œã‚‹APIã¯ã€OpenAPIå®šç¾©ã‚’ä½¿ç”¨ã—ã¦è¨˜è¿°ã•ã‚Œã€RESTful APIã¸ã®æ¨™æº–çš„ã§è¨€èªã«ä¾å­˜ã—ãªã„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚

**é–¢æ•°ã‚¢ãƒ—ãƒªã¯ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ã‚µãƒãƒ¼ãƒˆ**ã—ã¦ã„ã¾ã™ã€‚

ã•ã‚‰ã«ã€é–¢æ•°ã‚¢ãƒ—ãƒªã«ã¯ã€"admin"ã‚„"anonymous"ãªã©ã®ç‰¹å®šã®èªè¨¼ãƒ¬ãƒ™ãƒ«ãŒå¿…è¦ãªã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚\
æ”»æ’ƒè€…ã¯ã€**åŒ¿åè¨±å¯ã•ã‚ŒãŸã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€åˆ¶é™ã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã¦æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã‚„æ©Ÿèƒ½ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã‚ˆã†ã¨ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

#### åˆ—æŒ™

```powershell
# Get only Function Apps
Get-AzFunctionApp
```

### å‚è€ƒ

* [https://learn.microsoft.com/en-in/azure/app-service/overview](https://learn.microsoft.com/en-in/azure/app-service/overview)
* [https://learn.microsoft.com/en-us/azure/azure-functions/functions-openapi-definition](https://learn.microsoft.com/en-us/azure/azure-functions/functions-openapi-definition)

<details>

<summary><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>ã‚’é€šã˜ã¦ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã¶</strong></a><strong>ï¼</strong></summary>

HackTricks ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricks ã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„** ã¾ãŸã¯ **HackTricks ã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„** å ´åˆã¯ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã€å½“ç¤¾ã®ç‹¬å çš„ãª [**NFTs**](https://opensea.io/collection/the-peass-family) ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç™ºè¦‹ã™ã‚‹
* **ğŸ’¬** [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f) ã«å‚åŠ ã™ã‚‹ã‹ã€[telegramã‚°ãƒ«ãƒ¼ãƒ—](https://t.me/peass) ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ ã§ **@hacktricks\_live** ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹ã€‚
* **HackTricks** ã¨ **HackTricks Cloud** ã® github ãƒªãƒã‚¸ãƒˆãƒªã« PR ã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚

</details>
