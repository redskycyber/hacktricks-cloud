# Az - Azure App Service & Function Apps

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* If you want to see your **company advertised in HackTricks** or if you want access to the **latest version of the PEASS or download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** me on **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## App Serviceã®åŸºæœ¬æƒ…å ±

_Azure App Service_ã¯ã€Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€REST APIã€ãŠã‚ˆã³ãƒ¢ãƒã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’ãƒ›ã‚¹ãƒˆã™ã‚‹ãŸã‚ã®HTTPãƒ™ãƒ¼ã‚¹ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚ãŠå¥½ããªè¨€èªã§é–‹ç™ºã§ãã¾ã™ã€‚.NETã€.NET Coreã€Javaã€Rubyã€Node.jsã€PHPã€ã¾ãŸã¯Pythonã§ã™ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€WindowsãŠã‚ˆã³Linuxãƒ™ãƒ¼ã‚¹ã®ç’°å¢ƒã§ç°¡å˜ã«å®Ÿè¡ŒãŠã‚ˆã³ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã§ãã¾ã™ã€‚

å„ã‚¢ãƒ—ãƒªã¯ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹å†…ã§å®Ÿè¡Œã•ã‚Œã¾ã™ãŒã€ã‚¢ãƒ—ãƒªã‚µãƒ¼ãƒ“ã‚¹ãƒ—ãƒ©ãƒ³ã«ã‚ˆã£ã¦åˆ†é›¢åº¦ãŒç•°ãªã‚Šã¾ã™ã€‚

* FreeãŠã‚ˆã³Sharedã®ãƒ†ã‚£ã‚¢ã®ã‚¢ãƒ—ãƒªã¯å…±æœ‰VMä¸Šã§å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
* StandardãŠã‚ˆã³Premiumã®ãƒ†ã‚£ã‚¢ã®ã‚¢ãƒ—ãƒªã¯å°‚ç”¨VMä¸Šã§å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

{% hint style="warning" %}
ã“ã‚Œã‚‰ã®åˆ†é›¢ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚„ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãªã©ã®ä¸€èˆ¬çš„ãªWebè„†å¼±æ€§ã‚’**é˜²ãã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“**ã€‚ã¾ãŸã€**ç®¡ç†ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£**ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆã€ãã®æ¨©é™ã‚’**ä¾µå®³ã™ã‚‹å¯èƒ½æ€§**ãŒã‚ã‚Šã¾ã™ã€‚
{% endhint %}

### åˆ—æŒ™

{% tabs %}
{% tab title="az" %}
{% code overflow="wrap" %}
```bash
# List webapps
az webapp list

## Less information
az webapp list --query "[].{hostName: defaultHostName, state: state, name: name, resourcegroup: resourceGroup}"

# Get access restrictions
az webapp config access-restriction show --resource-group <res-group> -n <name>

# Remove access restrictions
az webapp config access-restriction remove --resource-group <res-group> -n <name> --rule-name <rule-name>

# Get snapshots
az webapp config snapshot list --resource-group <res-group> -n <name>

# Restore snapshot
az webapp config snapshot restore -g <res-group> -n <name> --time 2018-12-11T23:34:16.8388367

# Restart webapp
az webapp restart --name <name> --resource-group <res-group>
```
{% endcode %}
{% endtab %}

{% tab title="Az Powershell" %}
```powershell
# Get App Services and Function Apps
Get-AzWebApp
# Get only App Services
Get-AzWebApp | ?{$_.Kind -notmatch "functionapp"}
```
{% endtab %}
{% endtabs %}

#### è³‡æ ¼æƒ…å ±ã‚’å–å¾—ã—ã€Webã‚¢ãƒ—ãƒªã®ã‚³ãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹
```bash
# Get connection strings that could contain credentials (with DBs for example)
az webapp config connection-string list --name <name> --resource-group <res-group>
## Check how to use the DBs connection strings in the SQL page

# Get credentials to access the code and DB credentials if configured.
az webapp deployment list-publishing-profiles --resource-group <res-group> -n <name>


# Get git URL to access the code
az webapp deployment source config-local-git --resource-group <res-group> -n <name>

# Access/Modify the code via git
git clone 'https://<username>:<password>@name.scm.azurewebsites.net/repo-name.git'
## In my case the username was: $nameofthewebapp and the password some random chars
## If you change the code and do a push, the app is automatically redeployed
```
#### SSHã‚’ä»‹ã—ã¦Webã‚¢ãƒ—ãƒªã®Dockerã‚³ãƒ³ãƒ†ãƒŠã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ–¹æ³•:

```bash
ssh -p <port> <username>@<ip_address>
```

Replace `<port>` with the SSH port number, `<username>` with the username, and `<ip_address>` with the IP address of the Docker container.

Dockerã‚³ãƒ³ãƒ†ãƒŠã®SSHãƒãƒ¼ãƒˆç•ªå·ã«ã¯`<port>`ã‚’ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã«ã¯`<username>`ã‚’ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«ã¯`<ip_address>`ã‚’ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚
```bash
# Get ssh session
az webapp create-remote-connection --subscription <SUBSCRIPTION-ID> --resource-group <RG-NAME> -n <APP-SERVICE-NAME>

## If successfull you will get a message such as:
#Verifying if app is running....
#App is running. Trying to establish tunnel connection...
#Opening tunnel on port: 39895
#SSH is available { username: root, password: Docker! }

## So from that machine ssh into that port (you might need generate a new ssh session to the jump host)
ssh root@127.0.0.1 -p 39895

```
## é–¢æ•°ã‚¢ãƒ—ãƒªã®åŸºæœ¬æƒ…å ±

Azure Functionsã¯ã€ã‚³ãƒ¼ãƒ‰ã‚’å°‘ãªãã—ã€ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚’å°‘ãªãã—ã€ã‚³ã‚¹ãƒˆã‚’ç¯€ç´„ã™ã‚‹ã“ã¨ãŒã§ãã‚‹**ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹**ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚ã‚µãƒ¼ãƒãƒ¼ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã«ã¤ã„ã¦å¿ƒé…ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ãŒã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œã«å¿…è¦ãªæœ€æ–°ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚

Azure Functionsã¯ã€Azure API Managementã¨çµ±åˆã•ã‚Œã¦ãŠã‚Šã€ãƒãƒ¼ã‚¿ãƒ«ã§HTTPãƒˆãƒªã‚¬ãƒ¼é–¢æ•°ã®**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’REST APIã¨ã—ã¦å…¬é–‹**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã‚‰ã®APIã¯ã€OpenAPIå®šç¾©ã‚’ä½¿ç”¨ã—ã¦è¨˜è¿°ã•ã‚Œã¾ã™ã€‚

**é–¢æ•°ã‚¢ãƒ—ãƒªã¯ã€ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚**

### åˆ—æŒ™
```powershell
# Get only Function Apps
Get-AzFunctionApp
```
## å‚è€ƒæ–‡çŒ®

* [https://learn.microsoft.com/en-in/azure/app-service/overview](https://learn.microsoft.com/en-in/azure/app-service/overview)
* [https://learn.microsoft.com/en-us/azure/azure-functions/functions-openapi-definition](https://learn.microsoft.com/en-us/azure/azure-functions/functions-openapi-definition)

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* ã‚‚ã— **HackTricks ã§ä¼šç¤¾ã‚’å®£ä¼ã—ãŸã„** ã¾ãŸã¯ **PEASS ã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã„** ã¾ãŸã¯ **HackTricks ã‚’ PDF ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„** å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼ã® PEASS & HackTricks ã‚¹ãƒ¯ãƒƒã‚°**](https://peass.creator-spring.com) ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ã‚’è¦‹ã¤ã‘ã¦ã€ç‹¬å çš„ãª [**NFTs**](https://opensea.io/collection/the-peass-family) ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†
* ğŸ’¬ [**Discord ã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f) ã¾ãŸã¯ [**telegram ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass) ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm) ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¾ã—ã‚‡ã†ã€‚
* **HackTricks** ã¨ **HackTricks Cloud** ã® github ãƒªãƒã‚¸ãƒˆãƒªã« PR ã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¾ã—ã‚‡ã†ã€‚

</details>
