# Az - Azure App Service & Function Apps

## Az - Azure Uygulama Servisi ve Fonksiyon UygulamalarÄ±

<details>

<summary><strong>htARTE (HackTricks AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ±)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)'Ä± **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

### Uygulama Servisi Temel Bilgileri

[Belgelerden:](https://learn.microsoft.com/en-us/azure/app-service/overview) _Azure Uygulama Servisi_, web uygulamalarÄ±, REST API'leri ve mobil arka uÃ§lar iÃ§in HTTP tabanlÄ± bir hizmettir. .NET, .NET Core, Java, Ruby, Node.js, PHP veya Python gibi favori dilinizde geliÅŸtirme yapabilirsiniz. Uygulamalar, hem Windows hem de Linux tabanlÄ± ortamlarda kolaylÄ±kla Ã§alÄ±ÅŸÄ±r ve Ã¶lÃ§eklenir.

Her uygulama bir kum havuzunda Ã§alÄ±ÅŸÄ±r, ancak izolasyon, Uygulama Servisi planlarÄ±na baÄŸlÄ±dÄ±r

* Ãœcretsiz ve PaylaÅŸÄ±lan seviyelerdeki uygulamalar paylaÅŸÄ±lan sanal makinelerde Ã§alÄ±ÅŸÄ±r
* Standart ve Premium seviyelerdeki uygulamalar ayrÄ±lmÄ±ÅŸ sanal makinelerde Ã§alÄ±ÅŸÄ±r

{% hint style="warning" %}
UnutmayÄ±n ki bu izolasyonlardan **hiÃ§biri**, diÄŸer yaygÄ±n **web zafiyetlerini** (dosya yÃ¼kleme veya enjeksiyon gibi) **Ã¶nlemez**. Ve bir **yÃ¶netim kimliÄŸi** kullanÄ±lÄ±yorsa, izinlerini **tehlikeye atabilir**.
{% endhint %}

#### Sorgulama

{% code overflow="wrap" %}
```bash
# List webapps
az webapp list

## Less information
az webapp list --query "[].{hostName: defaultHostName, state: state, name: name, resourcegroup: resourceGroup}"

# Get access restrictions
az webapp config access-restriction show --resource-group <res-group> -n <name>

# Remove access restrictions
az webapp config access-restriction remove --resource-group <res-group> -n <name> --rule-name <rule-name>

# Get snapshots
az webapp config snapshot list --resource-group <res-group> -n <name>

# Restore snapshot
az webapp config snapshot restore -g <res-group> -n <name> --time 2018-12-11T23:34:16.8388367

# Restart webapp
az webapp restart --name <name> --resource-group <res-group>
```
{% endcode %}

```powershell
# Get App Services and Function Apps
Get-AzWebApp
# Get only App Services
Get-AzWebApp | ?{$_.Kind -notmatch "functionapp"}
```

{% code overflow="wrap" %}
```
```
{% endcode %}

\`\`\`bash #!/bin/bash

## Get all App Service and Function Apps

## Define Azure subscription ID

azure\_subscription="your\_subscription\_id"

## Log in to Azure

az login

## Select Azure subscription

az account set --subscription $azure\_subscription

## Get all App Services in the specified subscription

list\_app\_services=$(az appservice list --query "\[].{appServiceName: name, group: resourceGroup}" -o tsv)

## Iterate over each App Service

echo "$list\_app\_services" | while IFS=$'\t' read -r appServiceName group; do

## Get the type of the App Service

service\_type=$(az appservice show --name $appServiceName --resource-group $group --query "kind" -o tsv)

## Check if it is a Function App and print its name

if \[ "$service\_type" == "functionapp" ]; then echo "Function App Name: $appServiceName" fi done

````
#### Kimlik bilgilerini elde etme ve web uygulama koduna eriÅŸim saÄŸlama

To obtain credentials and gain access to the webapp code, you can follow these steps:

1. Identify the Azure App Service you want to target.
2. Use tools like `az webapp show` or `az webapp list` to gather information about the target webapp.
3. Look for any misconfigurations or vulnerabilities that may allow you to access the webapp code or obtain credentials.
4. If the webapp is using a database, check if there are any misconfigurations or vulnerabilities that may allow you to access the database credentials.
5. Exploit any misconfigurations or vulnerabilities found to gain access to the webapp code or obtain credentials.
6. Once you have obtained the credentials, you can use them to authenticate and access the webapp code.

Remember to always follow ethical hacking practices and obtain proper authorization before attempting any penetration testing activities.
```bash
# Get connection strings that could contain credentials (with DBs for example)
az webapp config connection-string list --name <name> --resource-group <res-group>
## Check how to use the DBs connection strings in the SQL page

# Get credentials to access the code and DB credentials if configured.
az webapp deployment list-publishing-profiles --resource-group <res-group> -n <name>


# Get git URL to access the code
az webapp deployment source config-local-git --resource-group <res-group> -n <name>

# Access/Modify the code via git
git clone 'https://<username>:<password>@name.scm.azurewebsites.net/repo-name.git'
## In my case the username was: $nameofthewebapp and the password some random chars
## If you change the code and do a push, the app is automatically redeployed
````

**Web uygulamasÄ±na SSH Ã¼zerinden Docker konteynerine eriÅŸim:**

```bash
ssh -p 2222 root@<app_name>.scm.azurewebsites.net
```

Bu komutu kullanarak, Azure App Service Ã¼zerindeki Docker konteynerine SSH Ã¼zerinden eriÅŸebilirsiniz. `<app_name>` kÄ±smÄ±nÄ±, hedef web uygulamasÄ±nÄ±n adÄ±yla deÄŸiÅŸtirmeniz gerekmektedir.

```bash
# Get ssh session
az webapp create-remote-connection --subscription <SUBSCRIPTION-ID> --resource-group <RG-NAME> -n <APP-SERVICE-NAME>

## If successfull you will get a message such as:
#Verifying if app is running....
#App is running. Trying to establish tunnel connection...
#Opening tunnel on port: 39895
#SSH is available { username: root, password: Docker! }

## So from that machine ssh into that port (you might need generate a new ssh session to the jump host)
ssh root@127.0.0.1 -p 39895
```

### Function Apps Temel Bilgiler

Azure Functions, daha az kod yazmanÄ±za, daha az altyapÄ± bakmanÄ±za ve maliyetlerden tasarruf etmenize olanak saÄŸlayan bir **sunucusuz** Ã§Ã¶zÃ¼mdÃ¼r. SunucularÄ±n daÄŸÄ±tÄ±mÄ± ve bakÄ±mÄ±yla uÄŸraÅŸmak yerine, bulut altyapÄ±sÄ± uygulamalarÄ±nÄ±zÄ±n Ã§alÄ±ÅŸmasÄ±nÄ± saÄŸlamak iÃ§in gereken gÃ¼ncel kaynaklarÄ± saÄŸlar.

Azure portalÄ±nda, Azure Functions ve Azure API YÃ¶netimi arasÄ±ndaki entegrasyon, **HTTP tetikleyici iÅŸlev uÃ§ noktalarÄ±nÄ±n REST API'leri olarak aÃ§Ä±klanmasÄ±nÄ±** saÄŸlar. Bu ÅŸekilde aÃ§Ä±klanan API'ler, RESTful API'ler iÃ§in standart, dil baÄŸÄ±msÄ±z bir arayÃ¼z saÄŸlayan bir OpenAPI tanÄ±mÄ± kullanÄ±larak tanÄ±mlanÄ±r.

**Function Apps, YÃ¶netilen Kimlikleri destekler.**

AyrÄ±ca, Function App belirli bir kimlik doÄŸrulama dÃ¼zeyi gerektiren belirli uÃ§ noktalara sahip olabilir, Ã¶rneÄŸin "admin" veya "anonymous".\
Bir saldÄ±rgan, kÄ±sÄ±tlamalarÄ± atlamak ve hassas verilere veya iÅŸlevlere eriÅŸim elde etmek iÃ§in **anonim izin verilen uÃ§ noktalara** eriÅŸmeyi deneyebilir.

#### NumaralandÄ±rma

```powershell
# Get only Function Apps
Get-AzFunctionApp
```

### Referanslar

* [https://learn.microsoft.com/en-in/azure/app-service/overview](https://learn.microsoft.com/en-in/azure/app-service/overview)
* [https://learn.microsoft.com/en-us/azure/azure-functions/functions-openapi-definition](https://learn.microsoft.com/en-us/azure/azure-functions/functions-openapi-definition)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerimizden oluÅŸan PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'da takip edin**.
* Hacking hilelerinizi [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶ndererek paylaÅŸÄ±n.

</details>
