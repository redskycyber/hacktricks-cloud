# Az - AzureAD

<details>

<summary><strong>æ”¯æŒ HackTricks å¹¶è·å¾—ç¦åˆ©ï¼</strong></summary>

* å¦‚æœæ‚¨æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Šï¼Œæˆ–è€…å¦‚æœæ‚¨æƒ³è®¿é—® PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDFï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹ PEASS å’Œ HackTricks å•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFT**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) **å’Œ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

### æšä¸¾

å¯¹äºè¿™ä¸ªæšä¸¾ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ [**az cli å·¥å…·**](https://docs.microsoft.com/en-us/cli/azure/install-azure-cli)**ï¼Œ**[**AzureAD PowerShell æ¨¡å—**](https://www.powershellgallery.com/packages/AzureAD/)ï¼ˆæˆ– [**AzureAD Preview**](https://www.powershellgallery.com/packages/AzureADPreview)ï¼‰å’Œ [**Az PowerShell**](https://learn.microsoft.com/en-us/powershell/azure/install-az-ps) æ¨¡å—ã€‚

{% hint style="success" %}
åœ¨ Linux ä¸Šï¼Œæ‚¨éœ€è¦å®‰è£… PowerShell Core:
```bash
sudo apt-get update
sudo apt-get install -y wget apt-transport-https software-properties-common

# Ubuntu 20.04
wget -q https://packages.microsoft.com/config/ubuntu/20.04/packages-microsoft-prod.deb

# Update repos
sudo apt-get update
sudo add-apt-repository universe

# Install & start powershell
sudo apt-get install -y powershell
pwsh

# Az cli
curl -sL https://aka.ms/InstallAzureCLIDeb | sudo bash
```
{% tab title="az cli" %}### **è¿æ¥**

```bash
az login
```

ä½¿ç”¨æ­¤å‘½ä»¤ç™»å½•åˆ° Azure å¸æˆ·ã€‚æ‚¨å°†è¢«è¦æ±‚åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ Azure å¸æˆ·çš„å‡­æ®ã€‚

```bash
az account set --subscription <subscription_id>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®è¦ä½¿ç”¨çš„ Azure è®¢é˜…ã€‚

```bash
az ad signed-in-user show --query objectId -o tsv
```

ä½¿ç”¨æ­¤å‘½ä»¤è·å–å½“å‰å·²ç™»å½•ç”¨æˆ·çš„ Azure AD å¯¹è±¡ IDã€‚

```bash
az ad sp create-for-rbac --name <name> --role <role> --scopes <scopes> --sdk-auth
```

ä½¿ç”¨æ­¤å‘½ä»¤åˆ›å»ºç”¨äº Azure RBAC çš„æœåŠ¡ä¸»ä½“ï¼Œå¹¶ç”Ÿæˆç”¨äºèº«ä»½éªŒè¯çš„ SDK é…ç½®æ–‡ä»¶ã€‚

```bash
az ad sp create-for-rbac --name <name> --role <role> --scopes <scopes> --sdk-auth --years <years>
```

ä½¿ç”¨æ­¤å‘½ä»¤åˆ›å»ºç”¨äº Azure RBAC çš„æœåŠ¡ä¸»ä½“ï¼Œå¹¶ç”Ÿæˆç”¨äºèº«ä»½éªŒè¯çš„ SDK é…ç½®æ–‡ä»¶ï¼Œå¹¶æŒ‡å®šæœ‰æ•ˆæœŸã€‚

```bash
az ad sp credential reset --name <name> --password <password>
```

ä½¿ç”¨æ­¤å‘½ä»¤é‡ç½®æœåŠ¡ä¸»ä½“çš„å‡­æ®ã€‚

```bash
az ad sp delete --id <id>
```

ä½¿ç”¨æ­¤å‘½ä»¤åˆ é™¤æŒ‡å®šçš„æœåŠ¡ä¸»ä½“ã€‚

```bash
az ad sp list --display-name <display_name> --query "[].{name:appDisplayName, objectId:objectId}"
```

ä½¿ç”¨æ­¤å‘½ä»¤æ ¹æ®æ˜¾ç¤ºåç§°è·å–æœåŠ¡ä¸»ä½“çš„åç§°å’Œå¯¹è±¡ IDã€‚

```bash
az ad sp show --id <id>
```

ä½¿ç”¨æ­¤å‘½ä»¤è·å–æŒ‡å®šæœåŠ¡ä¸»ä½“çš„è¯¦ç»†ä¿¡æ¯ã€‚

```bash
az ad sp update --id <id> --set <property=value>
```

ä½¿ç”¨æ­¤å‘½ä»¤æ›´æ–°æŒ‡å®šæœåŠ¡ä¸»ä½“çš„å±æ€§ã€‚

```bash
az ad sp update --id <id> --add <property=value>
```

ä½¿ç”¨æ­¤å‘½ä»¤æ·»åŠ æŒ‡å®šæœåŠ¡ä¸»ä½“çš„å±æ€§ã€‚

```bash
az ad sp update --id <id> --remove <property>
```

ä½¿ç”¨æ­¤å‘½ä»¤åˆ é™¤æŒ‡å®šæœåŠ¡ä¸»ä½“çš„å±æ€§ã€‚

```bash
az ad sp update --id <id> --force-change-password-next-login
```

ä½¿ç”¨æ­¤å‘½ä»¤å¼ºåˆ¶æŒ‡å®šæœåŠ¡ä¸»ä½“åœ¨ä¸‹æ¬¡ç™»å½•æ—¶æ›´æ”¹å¯†ç ã€‚

```bash
az ad sp update --id <id> --password <password>
```

ä½¿ç”¨æ­¤å‘½ä»¤æ›´æ”¹æŒ‡å®šæœåŠ¡ä¸»ä½“çš„å¯†ç ã€‚

```bash
az ad sp update --id <id> --set keyPermissions=<permissions>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„å¯†é’¥æƒé™ã€‚

```bash
az ad sp update --id <id> --set secretPermissions=<permissions>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„å¯†é’¥æƒé™ã€‚

```bash
az ad sp update --id <id> --set oauth2Permissions=<permissions>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„ OAuth2 æƒé™ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set replyUrls=<urls>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„å›å¤ URLã€‚

```bash
az ad sp update --id <id> --set homepage=<url>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„ä¸»é¡µ URLã€‚

```bash
az ad sp update --id <id> --set identifierUris=<uris>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„æ ‡è¯†ç¬¦ URIã€‚

```bash
az ad sp update --id <id> --set appDisplayName=<name>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨æ˜¾ç¤ºåç§°ã€‚

```bash
az ad sp update --id <id> --set appOwnerTenantId=<tenant_id>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨æ‰€æœ‰è€…ç§Ÿæˆ· IDã€‚

```bash
az ad sp update --id <id> --set appRoleAssignmentRequired=<true|false>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“æ˜¯å¦éœ€è¦åº”ç”¨è§’è‰²åˆ†é…ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles>
```

ä½¿ç”¨æ­¤å‘½ä»¤è®¾ç½®æŒ‡å®šæœåŠ¡ä¸»ä½“çš„åº”ç”¨è§’è‰²ã€‚

```bash
az ad sp update --id <id> --set appRoles=<roles
```bash
az login #This will open the browser
az login -u <username> -p <password> #Specify user and password
az login --identity #Use the current machine managed identity (metadata)
az login --identity -u /subscriptions/<subscriptionId>/resourcegroups/myRG/providers/Microsoft.ManagedIdentity/userAssignedIdentities/myID #Login with user managed identity
# Login as service principal
az login --service-principal -u http://azure-cli-2016-08-05-14-31-15 -p VerySecret --tenant contoso.onmicrosoft.com #With password
az login --service-principal -u http://azure-cli-2016-08-05-14-31-15 -p ~/mycertfile.pem --tenant contoso.onmicrosoft.com #With cert

# Request access token (ARM)
az account get-access-token
# Request access token for different resource. Supported tokens: aad-graph, arm, batch, data-lake, media, ms-graph, oss-rdbms
az account get-access-token --resource-type aad-graph

# If you want to configure some defaults
az configure

# Get user logged-in already
az ad signed-in-user show

# Help
az find "vm" # Find vm commands
az vm -h # Get subdomains
az ad user list --query-examples # Get examples
```
{% endtab %}

{% tab title="Azure AD" %}
{% code overflow="wrap" %}
```powershell
Connect-AzureAD #Open browser
# Using credentials
$passwd = ConvertTo-SecureString "Welcome2022!" -AsPlainText -Force
$creds = New-Object System.Management.Automation.PSCredential ("test@corp.onmicrosoft.com", $passwd)
Connect-AzureAD -Credential $creds

# Using tokens
## AzureAD cannot request tokens, but can use AADGraph and MSGraph tokens to connect
Connect-AzureAD -AccountId test@corp.onmicrosoft.com -AadAccessToken $token
```
{% endcode %}
{% endtab %}

{% tab title="Az PowerShell" %}
```powershell
Connect-AzAccount #Open browser
# Using credentials
$passwd = ConvertTo-SecureString "Welcome2022!" -AsPlainText -Force
$creds = New-Object System.Management.Automation.PSCredential("test@corp.onmicrosoft.com", $passwd)
Connect-AzAccount -Credential $creds

# Get Access Token
(Get-AzAccessToken).Token
# Request access token to other endpoints: AadGraph, AnalysisServices, Arm, Attestation, Batch, DataLake, KeyVault, MSGraph, OperationalInsights, ResourceManager, Storage, Synapse
Get-AzAccessToken -ResourceTypeName MSGraph
(Get-AzAccessToken -Resource "https://graph.microsoft.com").Token

# Conenct with access token
Connect-AzAccount -AccountId test@corp.onmicrosoft.com -AccessToken $token
Connect-AzAccount -AccessToken $token -GraphAccessToken $graphaccesstoken -AccountId <ACCOUNT-ID>
## The -AccessToken is from management.azure.com

# Connect with Service principal/enterprise app secret
$password = ConvertTo-SecureString 'KWEFNOIRFIPMWL.--DWPNVFI._EDWWEF_ADF~SODNFBWRBIF' -AsPlainText -Force
$creds = New-Object
System.Management.Automation.PSCredential('2923847f-fca2-a420-df10-a01928bec653', $password)
Connect-AzAccount -ServicePrincipal -Credential $creds -Tenant 29sd87e56-a192-a934-bca3-0398471ab4e7d

#All the Azure AD cmdlets have the format *-AzAD*
Get-Command *azad*
#Cmdlets for other Azure resources have the format *Az*
Get-Command *az*
```
ä»¥ä¸‹æ˜¯æœ‰å…³Azure Active Directoryçš„ä¸€äº›å¸¸è§å®‰å…¨é—®é¢˜å’Œæ”»å‡»æŠ€æœ¯ã€‚

## 1. ç”¨æˆ·å¯†ç æ³„éœ²

### æè¿°

ç”¨æˆ·å¯†ç æ³„éœ²æ˜¯æŒ‡ç”¨æˆ·çš„ç™»å½•å‡­æ®ï¼ˆç”¨æˆ·åå’Œå¯†ç ï¼‰è¢«æœªç»æˆæƒçš„äººå‘˜è·å–çš„æƒ…å†µã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…è·å–å¯¹ç”¨æˆ·å¸æˆ·çš„è®¿é—®æƒé™ï¼Œå¹¶å¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

### é˜²å¾¡æªæ–½

- å¼ºåˆ¶ç”¨æˆ·ä½¿ç”¨å¼ºå¯†ç ï¼Œå¹¶å®šæœŸæ›´æ”¹å¯†ç ã€‚
- å¯ç”¨å¤šå› ç´ èº«ä»½éªŒè¯ï¼ˆMFAï¼‰ä»¥æä¾›é¢å¤–çš„å®‰å…¨å±‚ã€‚
- ç›‘æ§å’Œæ£€æµ‹å¼‚å¸¸ç™»å½•æ´»åŠ¨ï¼Œå¹¶åŠæ—¶é‡‡å–æªæ–½ã€‚

## 2. èº«ä»½æ¬ºéª—

### æè¿°

èº«ä»½æ¬ºéª—æ˜¯æŒ‡æ”»å‡»è€…å†’å……åˆæ³•ç”¨æˆ·æˆ–å®ä½“ï¼Œä»¥è·å–å¯¹ç³»ç»Ÿæˆ–èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯èƒ½é€šè¿‡é’“é±¼æ”»å‡»ã€ç¤¾äº¤å·¥ç¨‹æˆ–ä½¿ç”¨è¢«ç›—çš„å‡­æ®å®ç°ã€‚

### é˜²å¾¡æªæ–½

- æä¾›å‘˜å·¥åŸ¹è®­ï¼Œä»¥å¢å¼ºå¯¹é’“é±¼æ”»å‡»å’Œç¤¾äº¤å·¥ç¨‹çš„è¯†åˆ«èƒ½åŠ›ã€‚
- å®æ–½å¼ºèº«ä»½éªŒè¯æªæ–½ï¼Œå¦‚MFAæˆ–å•ä¸€ç™»å½•ï¼ˆSSOï¼‰ã€‚
- å®šæœŸå®¡æŸ¥å’Œæ›´æ–°ç”¨æˆ·æƒé™ã€‚

## 3. ä»¤ç‰Œæ³„éœ²

### æè¿°

ä»¤ç‰Œæ³„éœ²æ˜¯æŒ‡æ”»å‡»è€…è·å–åˆ°æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œï¼Œä»è€Œèƒ½å¤Ÿå†’å……åˆæ³•ç”¨æˆ·è®¿é—®ç³»ç»Ÿæˆ–èµ„æºã€‚è¿™å¯èƒ½æ˜¯ç”±äºä¸æ­£ç¡®çš„é…ç½®ã€æ¼æ´æˆ–æ¶æ„è½¯ä»¶å¯¼è‡´çš„ã€‚

### é˜²å¾¡æªæ–½

- å®šæœŸå®¡æŸ¥å’Œæ›´æ–°åº”ç”¨ç¨‹åºçš„è®¿é—®ä»¤ç‰Œã€‚
- å®æ–½è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæœŸé™å’Œè®¿é—®èŒƒå›´é™åˆ¶ã€‚
- ç›‘æ§å’Œæ£€æµ‹å¼‚å¸¸çš„ä»¤ç‰Œä½¿ç”¨æ´»åŠ¨ã€‚

## 4. æƒé™æå‡

### æè¿°

æƒé™æå‡æ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡è·å–æ›´é«˜æƒé™çº§åˆ«ï¼Œä»è€Œèƒ½å¤Ÿè®¿é—®ç³»ç»Ÿæˆ–èµ„æºä¸­çš„æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œç‰¹æƒæ“ä½œã€‚

### é˜²å¾¡æªæ–½

- å®æ–½æœ€å°æƒé™åŸåˆ™ï¼Œä»…ä¸ºç”¨æˆ·åˆ†é…æ‰€éœ€çš„æœ€ä½æƒé™ã€‚
- å®šæœŸå®¡æŸ¥å’Œæ›´æ–°ç”¨æˆ·æƒé™ã€‚
- ç›‘æ§å’Œæ£€æµ‹å¼‚å¸¸çš„æƒé™æå‡æ´»åŠ¨ã€‚

## 5. æ•°æ®æ³„éœ²

### æè¿°

æ•°æ®æ³„éœ²æ˜¯æŒ‡æœªç»æˆæƒçš„æŠ«éœ²æˆ–æ³„éœ²æ•æ„Ÿæ•°æ®çš„æƒ…å†µã€‚è¿™å¯èƒ½æ˜¯ç”±äºé…ç½®é”™è¯¯ã€æ¼æ´æˆ–æ¶æ„è¡Œä¸ºå¯¼è‡´çš„ã€‚

### é˜²å¾¡æªæ–½

- å®šæœŸå®¡æŸ¥å’Œæ›´æ–°æ•°æ®è®¿é—®æƒé™ã€‚
- å®æ–½æ•°æ®åˆ†ç±»å’ŒåŠ å¯†æªæ–½ã€‚
- ç›‘æ§å’Œæ£€æµ‹å¼‚å¸¸çš„æ•°æ®è®¿é—®æ´»åŠ¨ã€‚

## 6. APIæ»¥ç”¨

### æè¿°

APIæ»¥ç”¨æ˜¯æŒ‡æ”»å‡»è€…åˆ©ç”¨APIçš„æ¼æ´æˆ–ä¸å®‰å…¨é…ç½®ï¼Œæ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œæˆ–è®¿é—®æ•æ„Ÿæ•°æ®ã€‚

### é˜²å¾¡æªæ–½

- å®šæœŸå®¡æŸ¥å’Œæ›´æ–°APIçš„è®¿é—®æƒé™ã€‚
- å®æ–½APIè®¿é—®æ§åˆ¶å’Œèº«ä»½éªŒè¯æªæ–½ã€‚
- ç›‘æ§å’Œæ£€æµ‹å¼‚å¸¸çš„APIæ´»åŠ¨ã€‚

## 7. ä¸å®‰å…¨çš„é…ç½®

### æè¿°

ä¸å®‰å…¨çš„é…ç½®æ˜¯æŒ‡ç³»ç»Ÿæˆ–èµ„æºçš„é…ç½®å­˜åœ¨æ¼æ´æˆ–ä¸å®‰å…¨è®¾ç½®ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®æˆ–æ•°æ®æ³„éœ²ã€‚

### é˜²å¾¡æªæ–½

- å®šæœŸå®¡æŸ¥å’Œæ›´æ–°ç³»ç»Ÿæˆ–èµ„æºçš„é…ç½®ã€‚
- å®æ–½å®‰å…¨æœ€ä½³å®è·µå’Œå»ºè®®ã€‚
- ç›‘æ§å’Œæ£€æµ‹å¼‚å¸¸çš„é…ç½®æ›´æ”¹ã€‚

## 8. æ¼æ´åˆ©ç”¨

### æè¿°

æ¼æ´åˆ©ç”¨æ˜¯æŒ‡æ”»å‡»è€…åˆ©ç”¨ç³»ç»Ÿæˆ–åº”ç”¨ç¨‹åºä¸­çš„å·²çŸ¥æˆ–æœªçŸ¥æ¼æ´ï¼Œæ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œæˆ–è·å–æ•æ„Ÿä¿¡æ¯ã€‚

### é˜²å¾¡æªæ–½

- å®šæœŸæ›´æ–°ç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºï¼Œä»¥ä¿®å¤å·²çŸ¥æ¼æ´ã€‚
- å®æ–½æ¼æ´æ‰«æå’Œæ¼æ´ç®¡ç†æµç¨‹ã€‚
- ç›‘æ§å’Œæ£€æµ‹å¼‚å¸¸çš„æ¼æ´åˆ©ç”¨æ´»åŠ¨ã€‚

## 9. DDOSæ”»å‡»

### æè¿°

DDOSï¼ˆåˆ†å¸ƒå¼æ‹’ç»æœåŠ¡ï¼‰æ”»å‡»æ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡å ç”¨ç³»ç»Ÿèµ„æºæˆ–ç½‘ç»œå¸¦å®½ï¼Œä½¿ç³»ç»Ÿæ— æ³•æ­£å¸¸æä¾›æœåŠ¡ã€‚

### é˜²å¾¡æªæ–½

- å®æ–½DDOSé˜²æŠ¤æªæ–½ï¼Œå¦‚æµé‡åˆ†æå’Œè¿‡æ»¤ã€‚
- ç›‘æ§å’Œæ£€æµ‹å¼‚å¸¸çš„ç½‘ç»œæµé‡ã€‚
- å‡†å¤‡åº”æ€¥å“åº”è®¡åˆ’ï¼Œä»¥åº”å¯¹DDOSæ”»å‡»ã€‚

## 10. ç¤¾äº¤å·¥ç¨‹

### æè¿°

ç¤¾äº¤å·¥ç¨‹æ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡æ¬ºéª—ã€æ“çºµæˆ–è¯±å¯¼äººå‘˜ï¼Œä»¥è·å–æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

### é˜²å¾¡æªæ–½

- æä¾›å‘˜å·¥åŸ¹è®­ï¼Œä»¥å¢å¼ºå¯¹ç¤¾äº¤å·¥ç¨‹æ”»å‡»çš„è¯†åˆ«èƒ½åŠ›ã€‚
- å®æ–½å®‰å…¨æ„è¯†åŸ¹è®­å’Œç­–ç•¥ã€‚
- ç›‘æ§å’Œæ£€æµ‹å¼‚å¸¸çš„ç”¨æˆ·è¡Œä¸ºã€‚

{% endcode %}
{% endtab %}
```powershell
#Using management
$Token = 'eyJ0eXAi..'
# List subscriptions
$URI = 'https://management.azure.com/subscriptions?api-version=2020-01-01'
$RequestParams = @{
Method  = 'GET'
Uri     = $URI
Headers = @{
'Authorization' = "Bearer $Token"
}
}
(Invoke-RestMethod @RequestParams).value

# Using graph
Invoke-WebRequest -Uri "https://graph.windows.net/myorganization/users?api-version=1.6" -Headers @{Authorization="Bearer {0}" -f $Token}
```
{% endcode %}
{% endtab %}

{% tab title="åŸå§‹æ“ä½œç³»ç»Ÿ" %}
{% code overflow="wrap" %}
```bash
# Request tokens to access endpoints
# ARM
curl "$IDENTITY_ENDPOINT?resource=https://management.azure.com&api-version=2017-09-01" -H secret:$IDENTITY_HEADER

# Vault
curl "$IDENTITY_ENDPOINT?resource=https://vault.azure.net&api-version=2017-09-01" -H secret:$IDENTITY_HEADER
```
{% code %}
{% endcode %}
{% endtab %}
{% endtabs %}

å½“æ‚¨ä½¿ç”¨ä»»ä½•ç¨‹åºé€šè¿‡CLIç™»å½•åˆ°Azureæ—¶ï¼Œæ‚¨ä½¿ç”¨çš„æ˜¯å±äºMicrosoftçš„ç§Ÿæˆ·çš„Azureåº”ç”¨ç¨‹åºã€‚è¿™äº›åº”ç”¨ç¨‹åºï¼Œå°±åƒæ‚¨å¯ä»¥åœ¨æ‚¨çš„å¸æˆ·ä¸­åˆ›å»ºçš„åº”ç”¨ç¨‹åºä¸€æ ·ï¼Œéƒ½æœ‰ä¸€ä¸ªå®¢æˆ·ç«¯IDã€‚æ‚¨æ— æ³•åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°æ‰€æœ‰è¿™äº›åº”ç”¨ç¨‹åºçš„â€œå…è®¸åº”ç”¨ç¨‹åºåˆ—è¡¨â€ï¼Œä½†å®ƒä»¬é»˜è®¤æ˜¯å…è®¸çš„ã€‚

ä¾‹å¦‚ï¼Œä¸€ä¸ªä½¿ç”¨å®¢æˆ·ç«¯IDä¸º`1950a258-227b-4e31-a9cf-717495945fc2`çš„åº”ç”¨ç¨‹åºçš„powershellè„šæœ¬è¿›è¡Œèº«ä»½éªŒè¯ã€‚å³ä½¿è¯¥åº”ç”¨ç¨‹åºåœ¨æ§åˆ¶å°ä¸­ä¸å¯è§ï¼Œç³»ç»Ÿç®¡ç†å‘˜ä¹Ÿå¯ä»¥é˜»æ­¢ç”¨æˆ·ä½¿ç”¨é€šè¿‡è¯¥åº”ç”¨ç¨‹åºè¿æ¥çš„å·¥å…·è¿›è¡Œè®¿é—®ã€‚

ç„¶è€Œï¼Œè¿˜æœ‰å…¶ä»–å®¢æˆ·ç«¯IDçš„åº”ç”¨ç¨‹åºå°†å…è®¸æ‚¨è¿æ¥åˆ°Azureï¼š
```powershell
# The important part is the ClientId, which identifies the application to login inside Azure

$token = Invoke-Authorize -Credential $credential `
-ClientId '1dfb5f98-f363-4b0f-b63a-8d20ada1e62d' `
-Scope 'Files.Read.All openid profile Sites.Read.All User.Read email' `
-Redirect_Uri "https://graphtryit-staging.azurewebsites.net/" `
-Verbose -Debug `
-InformationAction Continue

$token = Invoke-Authorize -Credential $credential `
-ClientId '65611c08-af8c-46fc-ad20-1888eb1b70d9' `
-Scope 'openid profile Sites.Read.All User.Read email' `
-Redirect_Uri "chrome-extension://imjekgehfljppdblckcmjggcoboemlah" `
-Verbose -Debug `
-InformationAction Continue

$token = Invoke-Authorize -Credential $credential `
-ClientId 'd3ce4cf8-6810-442d-b42e-375e14710095' `
-Scope 'openid' `
-Redirect_Uri "https://graphexplorer.azurewebsites.net/" `
-Verbose -Debug `
-InformationAction Continue
```
### ç”¨æˆ·

{% tabs %}
{% tab title="az cli" %}
```bash
# Enumerate users
az ad user list --output table
az ad user list --query "[].userPrincipalName"
# Get info of 1 user
az ad user show --id "test@corp.onmicrosoft.com"
# Search "admin" users
az ad user list --query "[].displayName" | findstr /i "admin"
az ad user list --query "[?contains(displayName,'admin')].displayName"
# Search attributes containing the word "password"
az ad user list | findstr /i "password" | findstr /v "null,"
# All users from AzureAD
az ad user list --query "[].{osi:onPremisesSecurityIdentifier,upn:userPrincipalName}[?osi==null]"
az ad user list --query "[?onPremisesSecurityIdentifier==null].displayName"
# All users synced from on-prem
az ad user list --query "[].{osi:onPremisesSecurityIdentifier,upn:userPrincipalName}[?osi!=null]"
az ad user list --query "[?onPremisesSecurityIdentifier!=null].displayName"
# Get groups where the user is a member
az ad user get-member-groups --id <email>
# Get roles assigned to the user
az role assignment list --include-groups --include-classic-administrators true --assignee <email>
```
{% endtab %}

{% tab title="Azure AD" %}Azure ADï¼ˆAzure Active Directoryï¼‰æ˜¯å¾®è½¯æä¾›çš„äº‘èº«ä»½éªŒè¯å’ŒæˆæƒæœåŠ¡ã€‚å®ƒç”¨äºç®¡ç†ç”¨æˆ·ã€ç»„ç»‡å’Œåº”ç”¨ç¨‹åºçš„èº«ä»½éªŒè¯å’Œè®¿é—®æ§åˆ¶ã€‚Azure AD æä¾›äº†ä¸€ç§é›†ä¸­å¼çš„èº«ä»½éªŒè¯å’Œæˆæƒè§£å†³æ–¹æ¡ˆï¼Œå¯ç”¨äºä¿æŠ¤ Azure äº‘æœåŠ¡å’Œå…¶ä»– SaaS åº”ç”¨ç¨‹åºã€‚

## Azure AD åŸºæœ¬æ¦‚å¿µ

ä»¥ä¸‹æ˜¯ Azure AD çš„ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼š

- **ç§Ÿæˆ·ï¼ˆTenantï¼‰**ï¼šAzure AD çš„é¡¶çº§ç»„ç»‡å•ä½ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå…¬å¸ã€å­¦æ ¡æˆ–æ”¿åºœæœºæ„ã€‚æ¯ä¸ªç§Ÿæˆ·éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼ˆç§Ÿæˆ· IDï¼‰ã€‚
- **ç›®å½•ï¼ˆDirectoryï¼‰**ï¼šæ¯ä¸ªç§Ÿæˆ·éƒ½åŒ…å«ä¸€ä¸ªç›®å½•ï¼Œç”¨äºå­˜å‚¨å’Œç®¡ç†ç”¨æˆ·ã€ç»„ç»‡å’Œåº”ç”¨ç¨‹åºçš„ä¿¡æ¯ã€‚
- **ç”¨æˆ·ï¼ˆUserï¼‰**ï¼šç§Ÿæˆ·ä¸­çš„ä¸ªäººç”¨æˆ·ï¼Œå¯ä»¥é€šè¿‡ç”¨æˆ·åå’Œå¯†ç æˆ–å…¶ä»–èº«ä»½éªŒè¯æ–¹æ³•è¿›è¡Œèº«ä»½éªŒè¯ã€‚
- **ç»„ï¼ˆGroupï¼‰**ï¼šä¸€ç»„ç”¨æˆ·çš„é›†åˆï¼Œå¯ä»¥æ–¹ä¾¿åœ°ç®¡ç†å’Œæˆæƒè®¿é—®æƒé™ã€‚
- **åº”ç”¨ç¨‹åºï¼ˆApplicationï¼‰**ï¼šåœ¨ Azure AD ä¸­æ³¨å†Œçš„åº”ç”¨ç¨‹åºï¼Œå¯ä»¥æ˜¯æœ¬åœ°åº”ç”¨ç¨‹åºã€Web åº”ç”¨ç¨‹åºæˆ–å…¶ä»– SaaS åº”ç”¨ç¨‹åºã€‚
- **æœåŠ¡ä¸»ä½“ï¼ˆService Principalï¼‰**ï¼šä»£è¡¨åº”ç”¨ç¨‹åºæˆ–æœåŠ¡çš„èº«ä»½éªŒè¯å®ä½“ï¼Œç”¨äºè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

## Azure AD å®‰å…¨æ€§

Azure AD æä¾›äº†å¤šç§å®‰å…¨åŠŸèƒ½å’Œæ§åˆ¶æªæ–½ï¼Œä»¥ä¿æŠ¤ç”¨æˆ·å’Œç»„ç»‡çš„èº«ä»½éªŒè¯å’Œè®¿é—®æ§åˆ¶ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ Azure AD å®‰å…¨æ€§åŠŸèƒ½ï¼š

- **å¤šå› ç´ èº«ä»½éªŒè¯ï¼ˆMFAï¼‰**ï¼šè¦æ±‚ç”¨æˆ·åœ¨ç™»å½•æ—¶æä¾›å¤šä¸ªèº«ä»½éªŒè¯å› ç´ ï¼Œä»¥å¢åŠ èº«ä»½éªŒè¯çš„å®‰å…¨æ€§ã€‚
- **æ¡ä»¶è®¿é—®ï¼ˆConditional Accessï¼‰**ï¼šæ ¹æ®ç”¨æˆ·ã€è®¾å¤‡ã€ä½ç½®ç­‰æ¡ä»¶å¯¹è®¿é—®è¿›è¡Œæ§åˆ¶ï¼Œä»¥ç¡®ä¿åªæœ‰ç»è¿‡æˆæƒçš„ç”¨æˆ·å¯ä»¥è®¿é—®èµ„æºã€‚
- **å¯†ç ç­–ç•¥ï¼ˆPassword Policyï¼‰**ï¼šå®šä¹‰å¯†ç çš„å¤æ‚æ€§è¦æ±‚å’Œè¿‡æœŸç­–ç•¥ï¼Œä»¥å¢åŠ å¯†ç çš„å®‰å…¨æ€§ã€‚
- **å®‰å…¨æŠ¥å‘Šï¼ˆSecurity Reportsï¼‰**ï¼šæä¾›æœ‰å…³èº«ä»½éªŒè¯å’Œè®¿é—®æ´»åŠ¨çš„è¯¦ç»†æŠ¥å‘Šå’Œåˆ†æï¼Œä»¥ä¾¿åŠæ—¶æ£€æµ‹å’Œå“åº”å®‰å…¨äº‹ä»¶ã€‚

## Azure AD æ¼æ´åˆ©ç”¨

åœ¨è¿›è¡Œ Azure AD æ¸—é€æµ‹è¯•æ—¶ï¼Œå¯ä»¥åˆ©ç”¨ä»¥ä¸‹æ¼æ´å’ŒæŠ€æœ¯æ¥è·å–æœªæˆæƒè®¿é—®ã€ææƒæˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ï¼š

- **å¯†ç å–·æ´’ï¼ˆPassword Sprayingï¼‰**ï¼šå°è¯•ä½¿ç”¨å¸¸è§å¯†ç å¯¹å¤šä¸ªç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä»¥çŒœæµ‹æ­£ç¡®çš„å¯†ç ã€‚
- **æš´åŠ›ç ´è§£ï¼ˆBrute Forceï¼‰**ï¼šå°è¯•ä½¿ç”¨æ‰€æœ‰å¯èƒ½çš„å¯†ç ç»„åˆå¯¹å•ä¸ªç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä»¥çŒœæµ‹æ­£ç¡®çš„å¯†ç ã€‚
- **ä»¤ç‰Œçªƒå–ï¼ˆToken Theftï¼‰**ï¼šé€šè¿‡åŠ«æŒç”¨æˆ·çš„èº«ä»½éªŒè¯ä»¤ç‰Œï¼Œè·å–å¯¹ Azure AD èµ„æºçš„æœªæˆæƒè®¿é—®ã€‚
- **SSO æ¼æ´ï¼ˆSSO Vulnerabilitiesï¼‰**ï¼šåˆ©ç”¨å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰é…ç½®é”™è¯¯æˆ–æ¼æ´ï¼Œè·å–å¯¹å…¶ä»– SaaS åº”ç”¨ç¨‹åºçš„æœªæˆæƒè®¿é—®ã€‚
- **åº”ç”¨ç¨‹åºæ¼æ´ï¼ˆApplication Vulnerabilitiesï¼‰**ï¼šåˆ©ç”¨æ³¨å†Œåœ¨ Azure AD ä¸­çš„åº”ç”¨ç¨‹åºçš„æ¼æ´ï¼Œè·å–å¯¹èµ„æºçš„æœªæˆæƒè®¿é—®ã€‚

## Azure AD å®‰å…¨å»ºè®®

ä»¥ä¸‹æ˜¯ä¸€äº›ä¿æŠ¤ Azure AD å®‰å…¨æ€§çš„æœ€ä½³å®è·µï¼š

- **å¯ç”¨å¤šå› ç´ èº«ä»½éªŒè¯ï¼ˆMFAï¼‰**ï¼šä¸ºæ‰€æœ‰ç”¨æˆ·å¯ç”¨ MFAï¼Œä»¥å¢åŠ èº«ä»½éªŒè¯çš„å®‰å…¨æ€§ã€‚
- **é™åˆ¶ç®¡ç†å‘˜æƒé™**ï¼šä»…æˆäºˆå¿…è¦çš„ç®¡ç†å‘˜æƒé™ï¼Œå¹¶å®šæœŸå®¡æŸ¥å’Œæ›´æ–°æƒé™ã€‚
- **ç›‘æ§å’ŒæŠ¥å‘Š**ï¼šå®šæœŸç›‘æ§å’Œå®¡æŸ¥ Azure AD çš„å®‰å…¨æŠ¥å‘Šï¼ŒåŠæ—¶æ£€æµ‹å’Œå“åº”å®‰å…¨äº‹ä»¶ã€‚
- **æ›´æ–°åº”ç”¨ç¨‹åº**ï¼šå®šæœŸæ›´æ–°å’Œä¿®è¡¥æ³¨å†Œåœ¨ Azure AD ä¸­çš„åº”ç”¨ç¨‹åºï¼Œä»¥ä¿®å¤å·²çŸ¥çš„æ¼æ´ã€‚
- **æ•™è‚²å’ŒåŸ¹è®­**ï¼šä¸ºç”¨æˆ·æä¾›æœ‰å…³å®‰å…¨æœ€ä½³å®è·µå’Œå¨èƒæ„è¯†çš„æ•™è‚²å’ŒåŸ¹è®­ã€‚

## å‚è€ƒèµ„æ–™

- [Azure AD å®˜æ–¹æ–‡æ¡£](https://docs.microsoft.com/azure/active-directory/)
- [Azure AD å®‰å…¨æœ€ä½³å®è·µ](https://docs.microsoft.com/azure/active-directory/fundamentals/best-practices-security-and-compliance)
```powershell
# Enumerate Users
Get-AzureADUser -All $true
Get-AzureADUser -All $true | select UserPrincipalName
# Get info of 1 user
Get-AzureADUser -ObjectId test@corp.onmicrosoft.com | fl
# Search "admin" users
Get-AzureADUser -SearchString "admin" #Search admin at the begining of DisplayName or userPrincipalName
Get-AzureADUser -All $true |?{$_.Displayname -match "admin"} #Search "admin" word in DisplayName
# Get all attributes of a user
Get-AzureADUser -ObjectId test@defcorphq.onmicrosoft.com|%{$_.PSObject.Properties.Name}
# Search attributes containing the word "password"
Get-AzureADUser -All $true |%{$Properties = $_;$Properties.PSObject.Properties.Name | % {if ($Properties.$_ -match 'password') {"$($Properties.UserPrincipalName) - $_ - $($Properties.$_)"}}}
# All users from AzureAD# All users from AzureAD
Get-AzureADUser -All $true | ?{$_.OnPremisesSecurityIdentifier -eq $null}
# All users synced from on-prem
Get-AzureADUser -All $true | ?{$_.OnPremisesSecurityIdentifier -ne $null}
# Objects created by a/any user
Get-AzureADUser [-ObjectId <email>] | Get-AzureADUserCreatedObject
# Devices owned by a user
Get-AzureADUserOwnedDevice -ObjectId test@corp.onmicrosoft.com
# Objects owned by a specific user
Get-AzureADUserOwnedObject -ObjectId test@corp.onmicrosoft.com
# Get groups & roles where the user is a member
Get-AzureADUserMembership -ObjectId 'test@corp.onmicrosoft.com'
# Get devices owned by a user
Get-AzureADUserOwnedDevice -ObjectId test@corp.onmicrosoft.com
# Get devices registered by a user
Get-AzureADUserRegisteredDevice -ObjectId test@defcorphq.onmicrosoft.com
# Apps where a user has a role (role not shown)
Get-AzureADUser -ObjectId roygcain@defcorphq.onmicrosoft.com | Get-AzureADUserAppRoleAssignment | fl *
# Get Administrative Units of a user
$userObj = Get-AzureADUser -Filter "UserPrincipalName eq 'bill@example.com'"
Get-AzureADMSAdministrativeUnit | where { Get-AzureADMSAdministrativeUnitMember -Id $_.Id | where { $_.Id -eq $userObj.ObjectId } }
```
{% tab title="Az PowerShell" %}

Azure Active Directory (Azure AD) æ˜¯ Azure ä¸­çš„èº«ä»½éªŒè¯å’Œè®¿é—®ç®¡ç†æœåŠ¡ã€‚å®ƒå…è®¸ç»„ç»‡ç®¡ç†ç”¨æˆ·ã€ç»„å’Œåº”ç”¨ç¨‹åºï¼Œå¹¶æ§åˆ¶å¯¹ Azure èµ„æºçš„è®¿é—®æƒé™ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ Azure AD PowerShell å‘½ä»¤ï¼š

- `Connect-AzureAD`ï¼šè¿æ¥åˆ° Azure ADã€‚
- `Get-AzureADUser`ï¼šè·å– Azure AD ä¸­çš„ç”¨æˆ·ã€‚
- `Get-AzureADGroup`ï¼šè·å– Azure AD ä¸­çš„ç»„ã€‚
- `Get-AzureADApplication`ï¼šè·å– Azure AD ä¸­çš„åº”ç”¨ç¨‹åºã€‚
- `New-AzureADUser`ï¼šåˆ›å»ºæ–°çš„ Azure AD ç”¨æˆ·ã€‚
- `New-AzureADGroup`ï¼šåˆ›å»ºæ–°çš„ Azure AD ç»„ã€‚
- `New-AzureADApplication`ï¼šåˆ›å»ºæ–°çš„ Azure AD åº”ç”¨ç¨‹åºã€‚
- `Set-AzureADUser`ï¼šæ›´æ–° Azure AD ç”¨æˆ·çš„å±æ€§ã€‚
- `Set-AzureADGroup`ï¼šæ›´æ–° Azure AD ç»„çš„å±æ€§ã€‚
- `Set-AzureADApplication`ï¼šæ›´æ–° Azure AD åº”ç”¨ç¨‹åºçš„å±æ€§ã€‚
- `Remove-AzureADUser`ï¼šåˆ é™¤ Azure AD ç”¨æˆ·ã€‚
- `Remove-AzureADGroup`ï¼šåˆ é™¤ Azure AD ç»„ã€‚
- `Remove-AzureADApplication`ï¼šåˆ é™¤ Azure AD åº”ç”¨ç¨‹åºã€‚

ä½¿ç”¨è¿™äº›å‘½ä»¤ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œå„ç§ Azure AD ç›¸å…³çš„æ“ä½œï¼Œå¦‚åˆ›å»ºã€æ›´æ–°å’Œåˆ é™¤ç”¨æˆ·ã€ç»„å’Œåº”ç”¨ç¨‹åºã€‚

{% endtab %}
```powershell
# Enumerate users
Get-AzADUser
# Get details of a user
Get-AzADUser -UserPrincipalName test@defcorphq.onmicrosoft.com
# Search user by string
Get-AzADUser -SearchString "admin" #Search at the beginnig of DisplayName
Get-AzADUser | ?{$_.Displayname -match "admin"}
# Get roles assigned to a user
Get-AzRoleAssignment -SignInName test@corp.onmicrosoft.com
```
{% endtab %}
{% endtabs %}

#### æ›´æ”¹ç”¨æˆ·å¯†ç 

{% code overflow="wrap" %}
```powershell
$password = "ThisIsTheNewPassword.!123" | ConvertTo- SecureString -AsPlainText â€“Force

(Get-AzureADUser -All $true | ?{$_.UserPrincipalName -eq "victim@corp.onmicrosoft.com"}).ObjectId | Set- AzureADUserPassword -Password $password â€“Verbose
```
{% tabs %}
{% tab title="az cli" %}

### ç»„

#### åˆ—å‡ºæ‰€æœ‰ç»„

```bash
az ad group list --query '[].{displayName:displayName, objectId:objectId}'
```

#### è·å–ç»„çš„è¯¦ç»†ä¿¡æ¯

```bash
az ad group show --group <group_object_id>
```

#### åˆ›å»ºç»„

```bash
az ad group create --display-name <group_display_name> --mail-nickname <group_mail_nickname>
```

#### æ›´æ–°ç»„

```bash
az ad group update --group <group_object_id> --display-name <new_group_display_name>
```

#### åˆ é™¤ç»„

```bash
az ad group delete --group <group_object_id>
```

#### å°†ç”¨æˆ·æ·»åŠ åˆ°ç»„

```bash
az ad group member add --group <group_object_id> --member-id <user_object_id>
```

#### ä»ç»„ä¸­åˆ é™¤ç”¨æˆ·

```bash
az ad group member remove --group <group_object_id> --member-id <user_object_id>
```

#### åˆ—å‡ºç»„çš„æˆå‘˜

```bash
az ad group member list --group <group_object_id> --query '[].{displayName:displayName, objectId:objectId}'
```

#### åˆ—å‡ºç”¨æˆ·æ‰€å±çš„ç»„

```bash
az ad user get-member-groups --upn-or-object-id <user_upn_or_object_id> --query '[].{displayName:displayName, objectId:objectId}'
```

#### åˆ—å‡ºç»„çš„æ‰€æœ‰è€…

```bash
az ad group owner list --group <group_object_id> --query '[].{displayName:displayName, objectId:objectId}'
```

#### å°†ç”¨æˆ·æ·»åŠ ä¸ºç»„çš„æ‰€æœ‰è€…

```bash
az ad group owner add --group <group_object_id> --owner-object-id <user_object_id>
```

#### ä»ç»„ä¸­åˆ é™¤æ‰€æœ‰è€…

```bash
az ad group owner remove --group <group_object_id> --owner-object-id <user_object_id>
```

{% endtab %}
{% endtabs %}
```powershell
# Enumerate groups
az ad group list
az ad group list --query "[].[displayName]" -o table
# Get info of 1 group
az ad group show --group <group>
# Get "admin" groups
az ad group list --query "[].displayName" | findstr /i "admin"
az ad group list --query "[?contains(displayName,'admin')].displayName"
# All groups from AzureAD
az ad group list --query "[].{osi:onPremisesSecurityIdentifier,displayName:displayName,description:description}[?osi==null]"
az ad group list --query "[?onPremisesSecurityIdentifier==null].displayName"
# All groups synced from on-prem
az ad group list --query "[].{osi:onPremisesSecurityIdentifier,displayName:displayName,description:description}[?osi!=null]"
az ad group list --query "[?onPremisesSecurityIdentifier!=null].displayName"
# Get members of group
az ad group member list --group <group> --query "[].userPrincipalName" -o table
# Check if member of group
az ad group member check --group "VM Admins" --member-id <id>
# Get which groups a group is member of
az ad group get-member-groups -g "VM Admins"
# Get Apps where a group has a role (role not shown)
Get-AzureADGroup -ObjectId <id> | Get-AzureADGroupAppRoleAssignment | fl *
```
{% tab title="Azure AD" %}Azure ADï¼ˆAzure Active Directoryï¼‰æ˜¯å¾®è½¯æä¾›çš„äº‘èº«ä»½éªŒè¯å’Œè®¿é—®ç®¡ç†æœåŠ¡ã€‚å®ƒç”¨äºç®¡ç†ç”¨æˆ·ã€ç»„ç»‡å’Œåº”ç”¨ç¨‹åºçš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚Azure AD æä¾›äº†ä¸€ç³»åˆ—åŠŸèƒ½ï¼ŒåŒ…æ‹¬å•ä¸€ç™»å½•ã€å¤šå› ç´ èº«ä»½éªŒè¯ã€è®¿é—®æ§åˆ¶å’Œèº«ä»½éªŒè¯æ—¥å¿—è®°å½•ç­‰ã€‚

## Azure AD æ¼æ´åˆ©ç”¨

### 1. Azure AD æ³¨å†Œåº”ç”¨ç¨‹åº

æ”»å‡»è€…å¯ä»¥æ³¨å†Œä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œä»¥è·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ Azure é—¨æˆ·ã€Azure CLI æˆ– Azure AD Graph API æ¥å®Œæˆã€‚

### 2. OAuth 2.0 æˆæƒä»£ç æµ

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ OAuth 2.0 æˆæƒä»£ç æµæ¥è·å–ç”¨æˆ·çš„è®¿é—®ä»¤ç‰Œã€‚è¿™å¯ä»¥é€šè¿‡ä¼ªé€ æˆæƒè¯·æ±‚ã€é‡å®šå‘ URI å’Œè®¿é—®ä»¤ç‰Œçªƒå–ç­‰æ–¹å¼æ¥å®ç°ã€‚

### 3. è·¨ç«™ç‚¹è„šæœ¬ï¼ˆXSSï¼‰

æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ Azure AD ç™»å½•é¡µé¢æ³¨å…¥æ¶æ„è„šæœ¬æ¥å®æ–½è·¨ç«™ç‚¹è„šæœ¬æ”»å‡»ã€‚è¿™å¯ä»¥å¯¼è‡´ç”¨æˆ·çš„å‡­æ®è¢«çªƒå–æˆ–ä¼šè¯åŠ«æŒã€‚

### 4. å¯†ç å–·å°„

æ”»å‡»è€…å¯ä»¥ä½¿ç”¨å¯†ç å–·å°„æŠ€æœ¯æ¥å°è¯•çŒœæµ‹ç”¨æˆ·çš„å¯†ç ã€‚è¿™å¯ä»¥é€šè¿‡è‡ªåŠ¨åŒ–å·¥å…·æˆ–è„šæœ¬æ¥å®ç°ã€‚

### 5. æš´åŠ›ç ´è§£

æ”»å‡»è€…å¯ä»¥ä½¿ç”¨æš´åŠ›ç ´è§£æŠ€æœ¯æ¥å°è¯•çŒœæµ‹ç”¨æˆ·çš„å¯†ç ã€‚è¿™å¯ä»¥é€šè¿‡è‡ªåŠ¨åŒ–å·¥å…·æˆ–è„šæœ¬æ¥å®ç°ã€‚

### 6. èº«ä»½éªŒè¯æ¼æ´

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨èº«ä»½éªŒè¯æ¼æ´æ¥ç»•è¿‡èº«ä»½éªŒè¯æœºåˆ¶ï¼Œè·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä¼ªé€ èº«ä»½éªŒè¯è¯·æ±‚ã€ç»•è¿‡å¤šå› ç´ èº«ä»½éªŒè¯æˆ–åˆ©ç”¨èº«ä»½éªŒè¯åè®®çš„å¼±ç‚¹æ¥å®ç°ã€‚

### 7. ä»¤ç‰Œçªƒå–

æ”»å‡»è€…å¯ä»¥é€šè¿‡çªƒå–ç”¨æˆ·çš„è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡æ‹¦æˆªç½‘ç»œæµé‡ã€ä½¿ç”¨æ¶æ„è½¯ä»¶æˆ–åˆ©ç”¨æ“ä½œç³»ç»Ÿçš„æ¼æ´æ¥å®ç°ã€‚

### 8. ä»¤ç‰Œç»­è®¢

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œç»­è®¢åŠŸèƒ½æ¥å»¶é•¿è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæœŸã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ä»¤ç‰Œçš„è¿‡æœŸæ—¶é—´æˆ–ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæ¥å®ç°ã€‚

### 9. ä»¤ç‰Œç¯¡æ”¹

æ”»å‡»è€…å¯ä»¥ç¯¡æ”¹ç”¨æˆ·çš„è®¿é—®ä»¤ç‰Œï¼Œä»¥è·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ä»¤ç‰Œçš„å†…å®¹æˆ–ç­¾åæ¥å®ç°ã€‚

### 10. ä»¤ç‰Œæ³„éœ²

æ”»å‡»è€…å¯ä»¥é€šè¿‡æ³„éœ²è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡åœ¨ä»£ç ã€é…ç½®æ–‡ä»¶æˆ–æ—¥å¿—ä¸­ä¸æ­£ç¡®åœ°å¤„ç†è®¿é—®ä»¤ç‰Œæ¥å®ç°ã€‚

### 11. ä»¤ç‰Œåˆ·æ–°

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œåˆ·æ–°åŠŸèƒ½æ¥è·å–æ–°çš„è®¿é—®ä»¤ç‰Œã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæˆ–ä¼ªé€ åˆ·æ–°ä»¤ç‰Œæ¥å®ç°ã€‚

### 12. ä»¤ç‰Œæ’¤é”€

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œæ’¤é”€åŠŸèƒ½æ¥æ’¤é”€è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæ€§ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨æ’¤é”€ä»¤ç‰Œæˆ–ä¼ªé€ æ’¤é”€ä»¤ç‰Œæ¥å®ç°ã€‚

### 13. ä»¤ç‰ŒåŠ«æŒ

æ”»å‡»è€…å¯ä»¥åŠ«æŒç”¨æˆ·çš„è®¿é—®ä»¤ç‰Œï¼Œä»¥è·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡æ‹¦æˆªç½‘ç»œæµé‡ã€ä½¿ç”¨æ¶æ„è½¯ä»¶æˆ–åˆ©ç”¨æ“ä½œç³»ç»Ÿçš„æ¼æ´æ¥å®ç°ã€‚

### 14. ä»¤ç‰Œä¼ªé€ 

æ”»å‡»è€…å¯ä»¥ä¼ªé€ è®¿é—®ä»¤ç‰Œï¼Œä»¥è·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä¼ªé€ ä»¤ç‰Œçš„å†…å®¹æˆ–ç­¾åæ¥å®ç°ã€‚

### 15. ä»¤ç‰Œç»‘å®š

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œç»‘å®šåŠŸèƒ½æ¥é™åˆ¶è®¿é—®ä»¤ç‰Œçš„ä½¿ç”¨èŒƒå›´ã€‚è¿™å¯ä»¥é€šè¿‡å°†è®¿é—®ä»¤ç‰Œä¸ç‰¹å®šè®¾å¤‡ã€IP åœ°å€æˆ–ç”¨æˆ·ç»‘å®šæ¥å®ç°ã€‚

### 16. ä»¤ç‰ŒéªŒè¯

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰ŒéªŒè¯åŠŸèƒ½æ¥éªŒè¯è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæ€§ã€‚è¿™å¯ä»¥é€šè¿‡ä¼ªé€ ä»¤ç‰Œçš„ç­¾åæˆ–ç¯¡æ”¹ä»¤ç‰Œçš„å†…å®¹æ¥å®ç°ã€‚

### 17. ä»¤ç‰Œè¿‡æœŸ

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œè¿‡æœŸåŠŸèƒ½æ¥é™åˆ¶è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæœŸã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ä»¤ç‰Œçš„è¿‡æœŸæ—¶é—´æˆ–ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæ¥å®ç°ã€‚

### 18. ä»¤ç‰Œæ›´æ–°

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œæ›´æ–°åŠŸèƒ½æ¥æ›´æ–°è®¿é—®ä»¤ç‰Œçš„å†…å®¹ã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ä»¤ç‰Œçš„å†…å®¹æˆ–ç­¾åæ¥å®ç°ã€‚

### 19. ä»¤ç‰Œæ’¤é”€åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œæ’¤é”€åˆ—è¡¨æ¥æ’¤é”€è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæ€§ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨æ’¤é”€ä»¤ç‰Œæˆ–ä¼ªé€ æ’¤é”€ä»¤ç‰Œæ¥å®ç°ã€‚

### 20. ä»¤ç‰Œåˆ·æ–°åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œåˆ·æ–°åˆ—è¡¨æ¥è·å–æ–°çš„è®¿é—®ä»¤ç‰Œã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæˆ–ä¼ªé€ åˆ·æ–°ä»¤ç‰Œæ¥å®ç°ã€‚

### 21. ä»¤ç‰ŒåŠ«æŒåˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åŠ«æŒç”¨æˆ·çš„è®¿é—®ä»¤ç‰Œï¼Œä»¥è·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡æ‹¦æˆªç½‘ç»œæµé‡ã€ä½¿ç”¨æ¶æ„è½¯ä»¶æˆ–åˆ©ç”¨æ“ä½œç³»ç»Ÿçš„æ¼æ´æ¥å®ç°ã€‚

### 22. ä»¤ç‰Œä¼ªé€ åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥ä¼ªé€ è®¿é—®ä»¤ç‰Œï¼Œä»¥è·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä¼ªé€ ä»¤ç‰Œçš„å†…å®¹æˆ–ç­¾åæ¥å®ç°ã€‚

### 23. ä»¤ç‰Œç»‘å®šåˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œç»‘å®šåˆ—è¡¨æ¥é™åˆ¶è®¿é—®ä»¤ç‰Œçš„ä½¿ç”¨èŒƒå›´ã€‚è¿™å¯ä»¥é€šè¿‡å°†è®¿é—®ä»¤ç‰Œä¸ç‰¹å®šè®¾å¤‡ã€IP åœ°å€æˆ–ç”¨æˆ·ç»‘å®šæ¥å®ç°ã€‚

### 24. ä»¤ç‰ŒéªŒè¯åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰ŒéªŒè¯åˆ—è¡¨æ¥éªŒè¯è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæ€§ã€‚è¿™å¯ä»¥é€šè¿‡ä¼ªé€ ä»¤ç‰Œçš„ç­¾åæˆ–ç¯¡æ”¹ä»¤ç‰Œçš„å†…å®¹æ¥å®ç°ã€‚

### 25. ä»¤ç‰Œè¿‡æœŸåˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œè¿‡æœŸåˆ—è¡¨æ¥é™åˆ¶è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæœŸã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ä»¤ç‰Œçš„è¿‡æœŸæ—¶é—´æˆ–ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæ¥å®ç°ã€‚

### 26. ä»¤ç‰Œæ›´æ–°åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œæ›´æ–°åˆ—è¡¨æ¥æ›´æ–°è®¿é—®ä»¤ç‰Œçš„å†…å®¹ã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ä»¤ç‰Œçš„å†…å®¹æˆ–ç­¾åæ¥å®ç°ã€‚

### 27. ä»¤ç‰Œæ’¤é”€åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œæ’¤é”€åˆ—è¡¨æ¥æ’¤é”€è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæ€§ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨æ’¤é”€ä»¤ç‰Œæˆ–ä¼ªé€ æ’¤é”€ä»¤ç‰Œæ¥å®ç°ã€‚

### 28. ä»¤ç‰Œåˆ·æ–°åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œåˆ·æ–°åˆ—è¡¨æ¥è·å–æ–°çš„è®¿é—®ä»¤ç‰Œã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæˆ–ä¼ªé€ åˆ·æ–°ä»¤ç‰Œæ¥å®ç°ã€‚

### 29. ä»¤ç‰ŒåŠ«æŒåˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åŠ«æŒç”¨æˆ·çš„è®¿é—®ä»¤ç‰Œï¼Œä»¥è·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡æ‹¦æˆªç½‘ç»œæµé‡ã€ä½¿ç”¨æ¶æ„è½¯ä»¶æˆ–åˆ©ç”¨æ“ä½œç³»ç»Ÿçš„æ¼æ´æ¥å®ç°ã€‚

### 30. ä»¤ç‰Œä¼ªé€ åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥ä¼ªé€ è®¿é—®ä»¤ç‰Œï¼Œä»¥è·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä¼ªé€ ä»¤ç‰Œçš„å†…å®¹æˆ–ç­¾åæ¥å®ç°ã€‚

### 31. ä»¤ç‰Œç»‘å®šåˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œç»‘å®šåˆ—è¡¨æ¥é™åˆ¶è®¿é—®ä»¤ç‰Œçš„ä½¿ç”¨èŒƒå›´ã€‚è¿™å¯ä»¥é€šè¿‡å°†è®¿é—®ä»¤ç‰Œä¸ç‰¹å®šè®¾å¤‡ã€IP åœ°å€æˆ–ç”¨æˆ·ç»‘å®šæ¥å®ç°ã€‚

### 32. ä»¤ç‰ŒéªŒè¯åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰ŒéªŒè¯åˆ—è¡¨æ¥éªŒè¯è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæ€§ã€‚è¿™å¯ä»¥é€šè¿‡ä¼ªé€ ä»¤ç‰Œçš„ç­¾åæˆ–ç¯¡æ”¹ä»¤ç‰Œçš„å†…å®¹æ¥å®ç°ã€‚

### 33. ä»¤ç‰Œè¿‡æœŸåˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œè¿‡æœŸåˆ—è¡¨æ¥é™åˆ¶è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæœŸã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ä»¤ç‰Œçš„è¿‡æœŸæ—¶é—´æˆ–ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæ¥å®ç°ã€‚

### 34. ä»¤ç‰Œæ›´æ–°åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œæ›´æ–°åˆ—è¡¨æ¥æ›´æ–°è®¿é—®ä»¤ç‰Œçš„å†…å®¹ã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ä»¤ç‰Œçš„å†…å®¹æˆ–ç­¾åæ¥å®ç°ã€‚

### 35. ä»¤ç‰Œæ’¤é”€åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œæ’¤é”€åˆ—è¡¨æ¥æ’¤é”€è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæ€§ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨æ’¤é”€ä»¤ç‰Œæˆ–ä¼ªé€ æ’¤é”€ä»¤ç‰Œæ¥å®ç°ã€‚

### 36. ä»¤ç‰Œåˆ·æ–°åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œåˆ·æ–°åˆ—è¡¨æ¥è·å–æ–°çš„è®¿é—®ä»¤ç‰Œã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæˆ–ä¼ªé€ åˆ·æ–°ä»¤ç‰Œæ¥å®ç°ã€‚

### 37. ä»¤ç‰ŒåŠ«æŒåˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åŠ«æŒç”¨æˆ·çš„è®¿é—®ä»¤ç‰Œï¼Œä»¥è·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡æ‹¦æˆªç½‘ç»œæµé‡ã€ä½¿ç”¨æ¶æ„è½¯ä»¶æˆ–åˆ©ç”¨æ“ä½œç³»ç»Ÿçš„æ¼æ´æ¥å®ç°ã€‚

### 38. ä»¤ç‰Œä¼ªé€ åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥ä¼ªé€ è®¿é—®ä»¤ç‰Œï¼Œä»¥è·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä¼ªé€ ä»¤ç‰Œçš„å†…å®¹æˆ–ç­¾åæ¥å®ç°ã€‚

### 39. ä»¤ç‰Œç»‘å®šåˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œç»‘å®šåˆ—è¡¨æ¥é™åˆ¶è®¿é—®ä»¤ç‰Œçš„ä½¿ç”¨èŒƒå›´ã€‚è¿™å¯ä»¥é€šè¿‡å°†è®¿é—®ä»¤ç‰Œä¸ç‰¹å®šè®¾å¤‡ã€IP åœ°å€æˆ–ç”¨æˆ·ç»‘å®šæ¥å®ç°ã€‚

### 40. ä»¤ç‰ŒéªŒè¯åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰ŒéªŒè¯åˆ—è¡¨æ¥éªŒè¯è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæ€§ã€‚è¿™å¯ä»¥é€šè¿‡ä¼ªé€ ä»¤ç‰Œçš„ç­¾åæˆ–ç¯¡æ”¹ä»¤ç‰Œçš„å†…å®¹æ¥å®ç°ã€‚

### 41. ä»¤ç‰Œè¿‡æœŸåˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œè¿‡æœŸåˆ—è¡¨æ¥é™åˆ¶è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæœŸã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ä»¤ç‰Œçš„è¿‡æœŸæ—¶é—´æˆ–ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæ¥å®ç°ã€‚

### 42. ä»¤ç‰Œæ›´æ–°åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œæ›´æ–°åˆ—è¡¨æ¥æ›´æ–°è®¿é—®ä»¤ç‰Œçš„å†…å®¹ã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ä»¤ç‰Œçš„å†…å®¹æˆ–ç­¾åæ¥å®ç°ã€‚

### 43. ä»¤ç‰Œæ’¤é”€åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œæ’¤é”€åˆ—è¡¨æ¥æ’¤é”€è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæ€§ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨æ’¤é”€ä»¤ç‰Œæˆ–ä¼ªé€ æ’¤é”€ä»¤ç‰Œæ¥å®ç°ã€‚

### 44. ä»¤ç‰Œåˆ·æ–°åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œåˆ·æ–°åˆ—è¡¨æ¥è·å–æ–°çš„è®¿é—®ä»¤ç‰Œã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæˆ–ä¼ªé€ åˆ·æ–°ä»¤ç‰Œæ¥å®ç°ã€‚

### 45. ä»¤ç‰ŒåŠ«æŒåˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åŠ«æŒç”¨æˆ·çš„è®¿é—®ä»¤ç‰Œï¼Œä»¥è·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡æ‹¦æˆªç½‘ç»œæµé‡ã€ä½¿ç”¨æ¶æ„è½¯ä»¶æˆ–åˆ©ç”¨æ“ä½œç³»ç»Ÿçš„æ¼æ´æ¥å®ç°ã€‚

### 46. ä»¤ç‰Œä¼ªé€ åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥ä¼ªé€ è®¿é—®ä»¤ç‰Œï¼Œä»¥è·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä¼ªé€ ä»¤ç‰Œçš„å†…å®¹æˆ–ç­¾åæ¥å®ç°ã€‚

### 47. ä»¤ç‰Œç»‘å®šåˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œç»‘å®šåˆ—è¡¨æ¥é™åˆ¶è®¿é—®ä»¤ç‰Œçš„ä½¿ç”¨èŒƒå›´ã€‚è¿™å¯ä»¥é€šè¿‡å°†è®¿é—®ä»¤ç‰Œä¸ç‰¹å®šè®¾å¤‡ã€IP åœ°å€æˆ–ç”¨æˆ·ç»‘å®šæ¥å®ç°ã€‚

### 48. ä»¤ç‰ŒéªŒè¯åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰ŒéªŒè¯åˆ—è¡¨æ¥éªŒè¯è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæ€§ã€‚è¿™å¯ä»¥é€šè¿‡ä¼ªé€ ä»¤ç‰Œçš„ç­¾åæˆ–ç¯¡æ”¹ä»¤ç‰Œçš„å†…å®¹æ¥å®ç°ã€‚

### 49. ä»¤ç‰Œè¿‡æœŸåˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œè¿‡æœŸåˆ—è¡¨æ¥é™åˆ¶è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæœŸã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ä»¤ç‰Œçš„è¿‡æœŸæ—¶é—´æˆ–ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæ¥å®ç°ã€‚

### 50. ä»¤ç‰Œæ›´æ–°åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œæ›´æ–°åˆ—è¡¨æ¥æ›´æ–°è®¿é—®ä»¤ç‰Œçš„å†…å®¹ã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ä»¤ç‰Œçš„å†…å®¹æˆ–ç­¾åæ¥å®ç°ã€‚

### 51. ä»¤ç‰Œæ’¤é”€åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œæ’¤é”€åˆ—è¡¨æ¥æ’¤é”€è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæ€§ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨æ’¤é”€ä»¤ç‰Œæˆ–ä¼ªé€ æ’¤é”€ä»¤ç‰Œæ¥å®ç°ã€‚

### 52. ä»¤ç‰Œåˆ·æ–°åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œåˆ·æ–°åˆ—è¡¨æ¥è·å–æ–°çš„è®¿é—®ä»¤ç‰Œã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæˆ–ä¼ªé€ åˆ·æ–°ä»¤ç‰Œæ¥å®ç°ã€‚

### 53. ä»¤ç‰ŒåŠ«æŒåˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åŠ«æŒç”¨æˆ·çš„è®¿é—®ä»¤ç‰Œï¼Œä»¥è·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡æ‹¦æˆªç½‘ç»œæµé‡ã€ä½¿ç”¨æ¶æ„è½¯ä»¶æˆ–åˆ©ç”¨æ“ä½œç³»ç»Ÿçš„æ¼æ´æ¥å®ç°ã€‚

### 54. ä»¤ç‰Œä¼ªé€ åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥ä¼ªé€ è®¿é—®ä»¤ç‰Œï¼Œä»¥è·å–å¯¹ Azure AD çš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä¼ªé€ ä»¤ç‰Œçš„å†…å®¹æˆ–ç­¾åæ¥å®ç°ã€‚

### 55. ä»¤ç‰Œç»‘å®šåˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œç»‘å®šåˆ—è¡¨æ¥é™åˆ¶è®¿é—®ä»¤ç‰Œçš„ä½¿ç”¨èŒƒå›´ã€‚è¿™å¯ä»¥é€šè¿‡å°†è®¿é—®ä»¤ç‰Œä¸ç‰¹å®šè®¾å¤‡ã€IP åœ°å€æˆ–ç”¨æˆ·ç»‘å®šæ¥å®ç°ã€‚

### 56. ä»¤ç‰ŒéªŒè¯åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰ŒéªŒè¯åˆ—è¡¨æ¥éªŒè¯è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæ€§ã€‚è¿™å¯ä»¥é€šè¿‡ä¼ªé€ ä»¤ç‰Œçš„ç­¾åæˆ–ç¯¡æ”¹ä»¤ç‰Œçš„å†…å®¹æ¥å®ç°ã€‚

### 57. ä»¤ç‰Œè¿‡æœŸåˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œè¿‡æœŸåˆ—è¡¨æ¥é™åˆ¶è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæœŸã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ä»¤ç‰Œçš„è¿‡æœŸæ—¶é—´æˆ–ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæ¥å®ç°ã€‚

### 58. ä»¤ç‰Œæ›´æ–°åˆ—è¡¨

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä»¤ç‰Œæ›´æ–°åˆ—è¡¨æ¥æ›´æ–°è®¿é—®ä»¤ç‰Œçš„å†…å®¹ã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ä»¤
```powershell
# Enumerate Groups
Get-AzureADGroup -All $true
# Get info of 1 group
Get-AzADGroup -DisplayName <resource_group_name> | fl
# Get "admin" groups
Get-AzureADGroup -SearchString "admin" | fl #Groups starting by "admin"
Get-AzureADGroup -All $true |?{$_.Displayname -match "admin"} #Groups with the word "admin"
# Get groups allowing dynamic membership
Get-AzureADMSGroup | ?{$_.GroupTypes -eq 'DynamicMembership'}
# All groups that are from Azure AD
Get-AzureADGroup -All $true | ?{$_.OnPremisesSecurityIdentifier -eq $null}
# All groups that are synced from on-prem (note that security groups are not synced)
Get-AzureADGroup -All $true | ?{$_.OnPremisesSecurityIdentifier -ne $null}
# Get members of a group
Get-AzureADGroupMember -ObjectId <group_id>
# Get roles of group
Get-AzureADMSGroup -SearchString "Contoso_Helpdesk_Administrators" #Get group id
Get-AzureADMSRoleAssignment -Filter "principalId eq '69584002-b4d1-4055-9c94-320542efd653'"
# Get Administrative Units of a group
$groupObj = Get-AzureADGroup -Filter "displayname eq 'TestGroup'"
Get-AzureADMSAdministrativeUnit | where { Get-AzureADMSAdministrativeUnitMember -Id $_.Id | where {$_.Id -eq $groupObj.ObjectId} }
```
{% tab title="Az PowerShell" %}

Azure Active Directory (Azure AD) æ˜¯ Azure ä¸­çš„èº«ä»½éªŒè¯å’Œè®¿é—®ç®¡ç†æœåŠ¡ã€‚å®ƒå…è®¸ç»„ç»‡ç®¡ç†ç”¨æˆ·ã€ç»„å’Œåº”ç”¨ç¨‹åºï¼Œå¹¶æ§åˆ¶å¯¹ Azure èµ„æºçš„è®¿é—®æƒé™ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ Azure AD PowerShell å‘½ä»¤ï¼š

- `Connect-AzureAD`ï¼šè¿æ¥åˆ° Azure ADã€‚
- `Get-AzureADUser`ï¼šè·å– Azure AD ä¸­çš„ç”¨æˆ·ã€‚
- `Get-AzureADGroup`ï¼šè·å– Azure AD ä¸­çš„ç»„ã€‚
- `Get-AzureADApplication`ï¼šè·å– Azure AD ä¸­çš„åº”ç”¨ç¨‹åºã€‚
- `New-AzureADUser`ï¼šåˆ›å»ºæ–°çš„ Azure AD ç”¨æˆ·ã€‚
- `New-AzureADGroup`ï¼šåˆ›å»ºæ–°çš„ Azure AD ç»„ã€‚
- `New-AzureADApplication`ï¼šåˆ›å»ºæ–°çš„ Azure AD åº”ç”¨ç¨‹åºã€‚
- `Set-AzureADUser`ï¼šæ›´æ–° Azure AD ç”¨æˆ·çš„å±æ€§ã€‚
- `Set-AzureADGroup`ï¼šæ›´æ–° Azure AD ç»„çš„å±æ€§ã€‚
- `Set-AzureADApplication`ï¼šæ›´æ–° Azure AD åº”ç”¨ç¨‹åºçš„å±æ€§ã€‚
- `Remove-AzureADUser`ï¼šåˆ é™¤ Azure AD ç”¨æˆ·ã€‚
- `Remove-AzureADGroup`ï¼šåˆ é™¤ Azure AD ç»„ã€‚
- `Remove-AzureADApplication`ï¼šåˆ é™¤ Azure AD åº”ç”¨ç¨‹åºã€‚

ä½¿ç”¨è¿™äº›å‘½ä»¤ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œå„ç§ Azure AD ç›¸å…³çš„æ“ä½œï¼Œå¦‚åˆ›å»ºã€æ›´æ–°å’Œåˆ é™¤ç”¨æˆ·ã€ç»„å’Œåº”ç”¨ç¨‹åºã€‚

{% endtab %}
```powershell
# Get all groups
Get-AzADGroup
# Get details of a group
Get-AzADGroup -ObjectId <id>
# Search group by string
Get-AzADGroup -SearchString "admin" | fl * #Search at the beginnig of DisplayName
Get-AzADGroup |?{$_.Displayname -match "admin"}
# Get members of group
Get-AzADGroupMember -GroupDisplayName <resource_group_name>
# Get roles of group
Get-AzRoleAssignment -ResourceGroupName <resource_group_name>
```
{% endtab %}
{% endtabs %}

#### å°†ç”¨æˆ·æ·»åŠ åˆ°ç»„ä¸­

ç»„çš„æ‰€æœ‰è€…å¯ä»¥å°†æ–°ç”¨æˆ·æ·»åŠ åˆ°ç»„ä¸­

{% code overflow="wrap" %}
```powershell
Add-AzureADGroupMember -ObjectId <group_id> -RefObjectId <user_id> -Verbose
```
{% endcode %}

### æœåŠ¡ä¸»ä½“

{% hint style="info" %}
è¯·æ³¨æ„ï¼ŒPowerShellæœ¯è¯­ä¸­çš„**æœåŠ¡ä¸»ä½“**åœ¨Azureé—¨æˆ·ï¼ˆWebï¼‰ä¸­è¢«ç§°ä¸º**ä¼ä¸šåº”ç”¨ç¨‹åº**ã€‚
{% endhint %}

{% tabs %}
{% tab title="az cli" %}
```bash
# Get Service Principals
az ad sp list --all
az ad sp list --all --query "[].[displayName]" -o table
# Get details of one SP
az ad sp show --id 00000000-0000-0000-0000-000000000000
# Search SP by string
az ad sp list --all --query "[?contains(displayName,'app')].displayName"
# Get owner of service principal
az ad sp owner list --id <id> --query "[].[displayName]" -o table
# Get service principals owned by the current user
az ad sp list --show-mine
# List apps that have password credentials
az ad sp list --all --query "[?passwordCredentials != null].displayName"
# List apps that have key credentials (use of certificate authentication)
az ad sp list -all --query "[?keyCredentials != null].displayName"
```
{% endtab %}

{% tab title="Azure AD" %}Azure ADï¼ˆAzure Active Directoryï¼‰æ˜¯Azureäº‘å¹³å°ä¸Šçš„èº«ä»½éªŒè¯å’Œè®¿é—®ç®¡ç†æœåŠ¡ã€‚å®ƒå…è®¸ç»„ç»‡é›†ä¸­ç®¡ç†ç”¨æˆ·èº«ä»½å’Œè®¿é—®æƒé™ï¼Œå¹¶æä¾›å•ç‚¹ç™»å½•å’Œå¤šå› ç´ èº«ä»½éªŒè¯ç­‰åŠŸèƒ½ã€‚

## Azure ADçš„å®‰å…¨é—®é¢˜

### 1. ç”¨æˆ·å¯†ç ç­–ç•¥

- å¯†ç å¤æ‚æ€§è¦æ±‚ï¼šå¯†ç æ˜¯å¦éœ€è¦åŒ…å«ç‰¹æ®Šå­—ç¬¦ã€æ•°å­—å’Œå¤§å†™å­—æ¯ç­‰ã€‚
- å¯†ç è¿‡æœŸç­–ç•¥ï¼šå¯†ç æ˜¯å¦éœ€è¦å®šæœŸæ›´æ”¹ã€‚
- å¯†ç é‡ç”¨ç­–ç•¥ï¼šæ˜¯å¦å…è®¸ç”¨æˆ·åœ¨ä¸€æ®µæ—¶é—´å†…é‡å¤ä½¿ç”¨ä¹‹å‰çš„å¯†ç ã€‚

### 2. å¤šå› ç´ èº«ä»½éªŒè¯

- æ˜¯å¦å¯ç”¨äº†å¤šå› ç´ èº«ä»½éªŒè¯æ¥å¢åŠ ç”¨æˆ·ç™»å½•çš„å®‰å…¨æ€§ã€‚

### 3. æƒé™åˆ†é…

- æ˜¯å¦å­˜åœ¨è¿‡å¤šçš„ç®¡ç†å‘˜è´¦æˆ·ã€‚
- æ˜¯å¦å­˜åœ¨æœªä½¿ç”¨çš„ç®¡ç†å‘˜è´¦æˆ·ã€‚
- æ˜¯å¦å­˜åœ¨æƒé™è¿‡å¤§çš„ç”¨æˆ·è´¦æˆ·ã€‚

### 4. å®‰å…¨æ—¥å¿—

- æ˜¯å¦å¯ç”¨äº†Azure ADçš„å®‰å…¨æ—¥å¿—åŠŸèƒ½ã€‚
- æ˜¯å¦ç›‘æ§å¹¶åˆ†æå®‰å…¨æ—¥å¿—ä»¥æ£€æµ‹æ½œåœ¨çš„å®‰å…¨äº‹ä»¶ã€‚

### 5. åº”ç”¨ç¨‹åºé›†æˆ

- æ˜¯å¦å­˜åœ¨æœªç»æˆæƒçš„åº”ç”¨ç¨‹åºé›†æˆã€‚
- æ˜¯å¦å­˜åœ¨å·²åœç”¨ä½†ä»ç„¶å…·æœ‰è®¿é—®æƒé™çš„åº”ç”¨ç¨‹åºã€‚

### 6. å¯†é’¥å’Œè¯ä¹¦ç®¡ç†

- æ˜¯å¦å­˜åœ¨è¿‡æœŸæˆ–å¼±å¯†é’¥å’Œè¯ä¹¦ã€‚
- æ˜¯å¦å­˜åœ¨æœªåŠ å¯†çš„å¯†é’¥å’Œè¯ä¹¦ã€‚

### 7. èº«ä»½éªŒè¯åè®®

- æ˜¯å¦ä½¿ç”¨äº†å®‰å…¨çš„èº«ä»½éªŒè¯åè®®ï¼Œå¦‚SAMLã€OAuthç­‰ã€‚

### 8. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 9. èº«ä»½éªŒè¯æ³„éœ²

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 10. èº«ä»½éªŒè¯åŠ«æŒ

- æ˜¯å¦å­˜åœ¨å¯èƒ½è¢«æ”»å‡»è€…åŠ«æŒèº«ä»½éªŒè¯ä¼šè¯çš„æ¼æ´ã€‚

### 11. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 12. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 13. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 14. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 15. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 16. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 17. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 18. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 19. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 20. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 21. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 22. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 23. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 24. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 25. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 26. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 27. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 28. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 29. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 30. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 31. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 32. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 33. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 34. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 35. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 36. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 37. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 38. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 39. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 40. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 41. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 42. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 43. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 44. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 45. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 46. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 47. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 48. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 49. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 50. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 51. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 52. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 53. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 54. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 55. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 56. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 57. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 58. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 59. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 60. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 61. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 62. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 63. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 64. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 65. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 66. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 67. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 68. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 69. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 70. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 71. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 72. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 73. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 74. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 75. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 76. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 77. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 78. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 79. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 80. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 81. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 82. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 83. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 84. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 85. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 86. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 87. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 88. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 89. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 90. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 91. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 92. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 93. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 94. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 95. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 96. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚

### 97. èº«ä»½éªŒè¯é”™è¯¯å¤„ç†

- æ˜¯å¦å­˜åœ¨å¯èƒ½å¯¼è‡´èº«ä»½éªŒè¯é”™è¯¯ä¿¡æ¯æ³„éœ²çš„æ¼æ´ã€‚

### 98. èº«ä»½éªŒè¯ç»•è¿‡

- æ˜¯å¦å­˜åœ¨å¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ã€‚

### 99. èº«ä»½éªŒè¯ç»ˆç»“ç‚¹

- æ˜¯å¦å­˜åœ¨æœªå—ä¿æŠ¤çš„èº«ä»½éªŒè¯ç»ˆç»“ç‚¹ã€‚

### 100. èº«ä»½éªŒè¯ç¼“å­˜

- æ˜¯å¦å­˜åœ¨æœªæ­£ç¡®ç®¡ç†çš„èº«ä»½éªŒè¯ç¼“å­˜ã€‚{% endtab %}
```powershell
# Get Service Principals
Get-AzureADServicePrincipal -All $true
# Get details about a SP
Get-AzureADServicePrincipal -ObjectId <id> | fl *
# Get SP by string name or Id
Get-AzureADServicePrincipal -All $true | ?{$_.DisplayName -match "app"} | fl
Get-AzureADServicePrincipal -All $true | ?{$_.AppId -match "103947652-1234-5834-103846517389"}
# Get owner of SP
Get-AzureADServicePrincipal -ObjectId <id> | Get-AzureADServicePrincipalOwner |fl *
# Get objects owned by a SP
Get-AzureADServicePrincipal -ObjectId <id> | Get-AzureADServicePrincipalOwnedObject
# Get objects created by a SP
Get-AzureADServicePrincipal -ObjectId <id> | Get-AzureADServicePrincipalCreatedObject
# Get groups where the SP is a member
Get-AzureADServicePrincipal | Get-AzureADServicePrincipalMembership
Get-AzureADServicePrincipal -ObjectId <id> | Get-AzureADServicePrincipalMembership |fl *
```
{% tab title="Az PowerShell" %}

## Az PowerShell

### Azure AD

#### Enumerate Azure AD Users

To enumerate Azure AD users using Az PowerShell, you can use the `Get-AzADUser` cmdlet. This cmdlet retrieves all the users in the Azure AD tenant.

```powershell
Get-AzADUser
```

#### Enumerate Azure AD Groups

To enumerate Azure AD groups using Az PowerShell, you can use the `Get-AzADGroup` cmdlet. This cmdlet retrieves all the groups in the Azure AD tenant.

```powershell
Get-AzADGroup
```

#### Enumerate Azure AD Applications

To enumerate Azure AD applications using Az PowerShell, you can use the `Get-AzADApplication` cmdlet. This cmdlet retrieves all the applications in the Azure AD tenant.

```powershell
Get-AzADApplication
```

#### Enumerate Azure AD Service Principals

To enumerate Azure AD service principals using Az PowerShell, you can use the `Get-AzADServicePrincipal` cmdlet. This cmdlet retrieves all the service principals in the Azure AD tenant.

```powershell
Get-AzADServicePrincipal
```

#### Enumerate Azure AD Roles

To enumerate Azure AD roles using Az PowerShell, you can use the `Get-AzADRoleDefinition` cmdlet. This cmdlet retrieves all the role definitions in the Azure AD tenant.

```powershell
Get-AzADRoleDefinition
```

#### Enumerate Azure AD Role Assignments

To enumerate Azure AD role assignments using Az PowerShell, you can use the `Get-AzADRoleAssignment` cmdlet. This cmdlet retrieves all the role assignments in the Azure AD tenant.

```powershell
Get-AzADRoleAssignment
```

#### Enumerate Azure AD Directory Roles

To enumerate Azure AD directory roles using Az PowerShell, you can use the `Get-AzADDirectoryRole` cmdlet. This cmdlet retrieves all the directory roles in the Azure AD tenant.

```powershell
Get-AzADDirectoryRole
```

#### Enumerate Azure AD Directory Role Members

To enumerate Azure AD directory role members using Az PowerShell, you can use the `Get-AzADDirectoryRoleMember` cmdlet. This cmdlet retrieves all the members of a directory role in the Azure AD tenant.

```powershell
Get-AzADDirectoryRoleMember -ObjectId <DirectoryRoleObjectId>
```

Replace `<DirectoryRoleObjectId>` with the object ID of the directory role you want to enumerate.

#### Enumerate Azure AD Directory Role Assignments

To enumerate Azure AD directory role assignments using Az PowerShell, you can use the `Get-AzADDirectoryRoleAssignment` cmdlet. This cmdlet retrieves all the directory role assignments in the Azure AD tenant.

```powershell
Get-AzADDirectoryRoleAssignment
```

#### Enumerate Azure AD Group Members

To enumerate Azure AD group members using Az PowerShell, you can use the `Get-AzADGroupMember` cmdlet. This cmdlet retrieves all the members of a group in the Azure AD tenant.

```powershell
Get-AzADGroupMember -ObjectId <GroupObjectId>
```

Replace `<GroupObjectId>` with the object ID of the group you want to enumerate.

#### Enumerate Azure AD Group Owners

To enumerate Azure AD group owners using Az PowerShell, you can use the `Get-AzADGroupOwner` cmdlet. This cmdlet retrieves all the owners of a group in the Azure AD tenant.

```powershell
Get-AzADGroupOwner -ObjectId <GroupObjectId>
```

Replace `<GroupObjectId>` with the object ID of the group you want to enumerate.

#### Enumerate Azure AD Group Membership

To enumerate Azure AD group membership using Az PowerShell, you can use the `Get-AzADGroupMembership` cmdlet. This cmdlet retrieves all the groups a user is a member of in the Azure AD tenant.

```powershell
Get-AzADGroupMembership -ObjectId <UserObjectId>
```

Replace `<UserObjectId>` with the object ID of the user you want to enumerate.

#### Enumerate Azure AD Group Settings

To enumerate Azure AD group settings using Az PowerShell, you can use the `Get-AzADGroupSetting` cmdlet. This cmdlet retrieves all the settings of a group in the Azure AD tenant.

```powershell
Get-AzADGroupSetting -ObjectId <GroupObjectId>
```

Replace `<GroupObjectId>` with the object ID of the group you want to enumerate.

#### Enumerate Azure AD Group External Members

To enumerate Azure AD group external members using Az PowerShell, you can use the `Get-AzADGroupExternalMember` cmdlet. This cmdlet retrieves all the external members of a group in the Azure AD tenant.

```powershell
Get-AzADGroupExternalMember -ObjectId <GroupObjectId>
```

Replace `<GroupObjectId>` with the object ID of the group you want to enumerate.

#### Enumerate Azure AD Group App Role Assignments

To enumerate Azure AD group app role assignments using Az PowerShell, you can use the `Get-AzADGroupAppRoleAssignment` cmdlet. This cmdlet retrieves all the app role assignments for a group in the Azure AD tenant.

```powershell
Get-AzADGroupAppRoleAssignment -ObjectId <GroupObjectId>
```

Replace `<GroupObjectId>` with the object ID of the group you want to enumerate.

#### Enumerate Azure AD Group Membership Claims

To enumerate Azure AD group membership claims using Az PowerShell, you can use the `Get-AzADGroupMembershipClaim` cmdlet. This cmdlet retrieves all the group membership claims for a user in the Azure AD tenant.

```powershell
Get-AzADGroupMembershipClaim -ObjectId <UserObjectId>
```

Replace `<UserObjectId>` with the object ID of the user you want to enumerate.

#### Enumerate Azure AD Group Membership Transitive

To enumerate Azure AD group membership transitive using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitive` cmdlet. This cmdlet retrieves all the groups a user is a member of, including transitive group memberships, in the Azure AD tenant.

```powershell
Get-AzADGroupMembershipTransitive -ObjectId <UserObjectId>
```

Replace `<UserObjectId>` with the object ID of the user you want to enumerate.

#### Enumerate Azure AD Group Membership Transitive Claims

To enumerate Azure AD group membership transitive claims using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitiveClaim` cmdlet. This cmdlet retrieves all the group membership claims for a user, including transitive group memberships, in the Azure AD tenant.

```powershell
Get-AzADGroupMembershipTransitiveClaim -ObjectId <UserObjectId>
```

Replace `<UserObjectId>` with the object ID of the user you want to enumerate.

#### Enumerate Azure AD Group Membership Transitive Recursive

To enumerate Azure AD group membership transitive recursive using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitiveRecursive` cmdlet. This cmdlet retrieves all the groups a user is a member of, including transitive group memberships recursively, in the Azure AD tenant.

```powershell
Get-AzADGroupMembershipTransitiveRecursive -ObjectId <UserObjectId>
```

Replace `<UserObjectId>` with the object ID of the user you want to enumerate.

#### Enumerate Azure AD Group Membership Transitive Recursive Claims

To enumerate Azure AD group membership transitive recursive claims using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitiveRecursiveClaim` cmdlet. This cmdlet retrieves all the group membership claims for a user, including transitive group memberships recursively, in the Azure AD tenant.

```powershell
Get-AzADGroupMembershipTransitiveRecursiveClaim -ObjectId <UserObjectId>
```

Replace `<UserObjectId>` with the object ID of the user you want to enumerate.

#### Enumerate Azure AD Group Membership Transitive Recursive Direct

To enumerate Azure AD group membership transitive recursive direct using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitiveRecursiveDirect` cmdlet. This cmdlet retrieves all the groups a user is a direct member of, including transitive group memberships recursively, in the Azure AD tenant.

```powershell
Get-AzADGroupMembershipTransitiveRecursiveDirect -ObjectId <UserObjectId>
```

Replace `<UserObjectId>` with the object ID of the user you want to enumerate.

#### Enumerate Azure AD Group Membership Transitive Recursive Direct Claims

To enumerate Azure AD group membership transitive recursive direct claims using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitiveRecursiveDirectClaim` cmdlet. This cmdlet retrieves all the group membership claims for a user, including transitive group memberships recursively, in the Azure AD tenant.

```powershell
Get-AzADGroupMembershipTransitiveRecursiveDirectClaim -ObjectId <UserObjectId>
```

Replace `<UserObjectId>` with the object ID of the user you want to enumerate.

#### Enumerate Azure AD Group Membership Transitive Recursive Direct Upn

To enumerate Azure AD group membership transitive recursive direct UPN using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitiveRecursiveDirectUpn` cmdlet. This cmdlet retrieves all the groups a user is a direct member of, including transitive group memberships recursively, using the user principal name (UPN) in the Azure AD tenant.

```powershell
Get-AzADGroupMembershipTransitiveRecursiveDirectUpn -UserPrincipalName <UserPrincipalName>
```

Replace `<UserPrincipalName>` with the user principal name (UPN) of the user you want to enumerate.

#### Enumerate Azure AD Group Membership Transitive Recursive Direct Upn Claims

To enumerate Azure AD group membership transitive recursive direct UPN claims using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaim` cmdlet. This cmdlet retrieves all the group membership claims for a user, including transitive group memberships recursively, using the user principal name (UPN) in the Azure AD tenant.

```powershell
Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaim -UserPrincipalName <UserPrincipalName>
```

Replace `<UserPrincipalName>` with the user principal name (UPN) of the user you want to enumerate.

#### Enumerate Azure AD Group Membership Transitive Recursive Direct Upn Claims All

To enumerate Azure AD group membership transitive recursive direct UPN claims all using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAll` cmdlet. This cmdlet retrieves all the group membership claims for all users, including transitive group memberships recursively, using the user principal name (UPN) in the Azure AD tenant.

```powershell
Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAll
```

#### Enumerate Azure AD Group Membership Transitive Recursive Direct Upn Claims All Filter

To enumerate Azure AD group membership transitive recursive direct UPN claims all filter using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAllFilter` cmdlet. This cmdlet retrieves all the group membership claims for all users, including transitive group memberships recursively, using the user principal name (UPN) in the Azure AD tenant, filtered by a specific condition.

```powershell
Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAllFilter -Filter <Filter>
```

Replace `<Filter>` with the filter condition you want to apply.

#### Enumerate Azure AD Group Membership Transitive Recursive Direct Upn Claims All Filter Claims

To enumerate Azure AD group membership transitive recursive direct UPN claims all filter claims using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAllFilterClaim` cmdlet. This cmdlet retrieves all the group membership claims for all users, including transitive group memberships recursively, using the user principal name (UPN) in the Azure AD tenant, filtered by a specific condition, and returns only the specified claims.

```powershell
Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAllFilterClaim -Filter <Filter> -Claim <Claim>
```

Replace `<Filter>` with the filter condition you want to apply, and `<Claim>` with the claim you want to retrieve.

#### Enumerate Azure AD Group Membership Transitive Recursive Direct Upn Claims All Filter Claims Value

To enumerate Azure AD group membership transitive recursive direct UPN claims all filter claims value using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAllFilterClaimValue` cmdlet. This cmdlet retrieves all the group membership claims for all users, including transitive group memberships recursively, using the user principal name (UPN) in the Azure AD tenant, filtered by a specific condition, and returns only the specified claims and their values.

```powershell
Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAllFilterClaimValue -Filter <Filter> -Claim <Claim>
```

Replace `<Filter>` with the filter condition you want to apply, and `<Claim>` with the claim you want to retrieve.

#### Enumerate Azure AD Group Membership Transitive Recursive Direct Upn Claims All Filter Claims Value Filter

To enumerate Azure AD group membership transitive recursive direct UPN claims all filter claims value filter using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAllFilterClaimValueFilter` cmdlet. This cmdlet retrieves all the group membership claims for all users, including transitive group memberships recursively, using the user principal name (UPN) in the Azure AD tenant, filtered by a specific condition, and returns only the specified claims and their values, filtered by another condition.

```powershell
Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAllFilterClaimValueFilter -Filter <Filter> -Claim <Claim> -ValueFilter <ValueFilter>
```

Replace `<Filter>` with the filter condition you want to apply, `<Claim>` with the claim you want to retrieve, and `<ValueFilter>` with the value filter condition you want to apply.

#### Enumerate Azure AD Group Membership Transitive Recursive Direct Upn Claims All Filter Claims Value Filter Claims

To enumerate Azure AD group membership transitive recursive direct UPN claims all filter claims value filter claims using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAllFilterClaimValueFilterClaim` cmdlet. This cmdlet retrieves all the group membership claims for all users, including transitive group memberships recursively, using the user principal name (UPN) in the Azure AD tenant, filtered by a specific condition, and returns only the specified claims and their values, filtered by another condition, and returns only the specified claims.

```powershell
Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAllFilterClaimValueFilterClaim -Filter <Filter> -Claim <Claim> -ValueFilter <ValueFilter> -ClaimToRetrieve <ClaimToRetrieve>
```

Replace `<Filter>` with the filter condition you want to apply, `<Claim>` with the claim you want to retrieve, `<ValueFilter>` with the value filter condition you want to apply, and `<ClaimToRetrieve>` with the claim you want to retrieve.

#### Enumerate Azure AD Group Membership Transitive Recursive Direct Upn Claims All Filter Claims Value Filter Claims Value

To enumerate Azure AD group membership transitive recursive direct UPN claims all filter claims value filter claims value using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAllFilterClaimValueFilterClaimValue` cmdlet. This cmdlet retrieves all the group membership claims for all users, including transitive group memberships recursively, using the user principal name (UPN) in the Azure AD tenant, filtered by a specific condition, and returns only the specified claims and their values, filtered by another condition, and returns only the specified claims and their values.

```powershell
Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAllFilterClaimValueFilterClaimValue -Filter <Filter> -Claim <Claim> -ValueFilter <ValueFilter> -ClaimToRetrieve <ClaimToRetrieve> -ValueToRetrieve <ValueToRetrieve>
```

Replace `<Filter>` with the filter condition you want to apply, `<Claim>` with the claim you want to retrieve, `<ValueFilter>` with the value filter condition you want to apply, `<ClaimToRetrieve>` with the claim you want to retrieve, and `<ValueToRetrieve>` with the value you want to retrieve.

#### Enumerate Azure AD Group Membership Transitive Recursive Direct Upn Claims All Filter Claims Value Filter Claims Value Filter

To enumerate Azure AD group membership transitive recursive direct UPN claims all filter claims value filter claims value filter using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAllFilterClaimValueFilterClaimValueFilter` cmdlet. This cmdlet retrieves all the group membership claims for all users, including transitive group memberships recursively, using the user principal name (UPN) in the Azure AD tenant, filtered by a specific condition, and returns only the specified claims and their values, filtered by another condition, and returns only the specified claims and their values, filtered by another condition.

```powershell
Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAllFilterClaimValueFilterClaimValueFilter -Filter <Filter> -Claim <Claim> -ValueFilter <ValueFilter> -ClaimToRetrieve <ClaimToRetrieve> -ValueToRetrieve <ValueToRetrieve> -FilterToApply <FilterToApply>
```

Replace `<Filter>` with the filter condition you want to apply, `<Claim>` with the claim you want to retrieve, `<ValueFilter>` with the value filter condition you want to apply, `<ClaimToRetrieve>` with the claim you want to retrieve, `<ValueToRetrieve>` with the value you want to retrieve, and `<FilterToApply>` with the filter condition you want to apply.

#### Enumerate Azure AD Group Membership Transitive Recursive Direct Upn Claims All Filter Claims Value Filter Claims Value Filter Claims

To enumerate Azure AD group membership transitive recursive direct UPN claims all filter claims value filter claims value filter claims using Az PowerShell, you can use the `Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAllFilterClaimValueFilterClaimValueFilterClaim` cmdlet. This cmdlet retrieves all the group membership claims for all users, including transitive group memberships recursively, using the user principal name (UPN) in the Azure AD tenant, filtered by a specific condition, and returns only the specified claims and their values, filtered by another condition, and returns only the specified claims and their values, filtered by another condition, and returns only the specified claims.

```powershell
Get-AzADGroupMembershipTransitiveRecursiveDirectUpnClaimAllFilterClaimValueFilterClaimValueFilterClaim -Filter <Filter> -Claim <Claim
```powershell
# Get SPs
Get-AzADServicePrincipal
# Get info of 1 SP
Get-AzADServicePrincipal -ObjectId <id>
# Search SP by string
Get-AzADServicePrincipal | ?{$_.DisplayName -match "app"}
# Get roles of a SP
Get-AzRoleAssignment -ServicePrincipalName <String>
```
ä»¥ä¸‹æ˜¯æœ‰å…³é»‘å®¢æŠ€æœ¯çš„ä¹¦ç±å†…å®¹ã€‚ä»¥ä¸‹å†…å®¹æ¥è‡ªæ–‡ä»¶/hive/hacktricks-cloud/pentesting-cloud/azure-security/az-services/az-azuread.mdã€‚å°†ç›¸å…³çš„è‹±æ–‡æ–‡æœ¬ç¿»è¯‘æˆä¸­æ–‡ï¼Œå¹¶ä¿æŒå®Œå…¨ç›¸åŒçš„markdownå’Œhtmlè¯­æ³•ã€‚ä¸è¦ç¿»è¯‘ä»£ç ã€é»‘å®¢æŠ€æœ¯åç§°ã€é»‘å®¢æœ¯è¯­ã€äº‘/SaaSå¹³å°åç§°ï¼ˆå¦‚Workspaceã€awsã€gcp...ï¼‰ã€æ³„æ¼ã€æ¸—é€æµ‹è¯•å’Œmarkdownæ ‡ç­¾ã€‚æ­¤å¤–ï¼Œè¯·ä¸è¦æ·»åŠ ä»»ä½•é¢å¤–çš„å†…å®¹ï¼Œåªéœ€ç¿»è¯‘å’Œmarkdownè¯­æ³•å³å¯ã€‚
```powershell
$Token = 'eyJ0eX..'
$URI = 'https://graph.microsoft.com/v1.0/applications'
$RequestParams = @{
Method  = 'GET'
Uri     = $URI
Headers = @{
'Authorization' = "Bearer $Token"
}
}
(Invoke-RestMethod @RequestParams).value
```
{% endtab %}
{% endtabs %}

{% hint style="warning" %}
æœåŠ¡ä¸»ä½“çš„æ‰€æœ‰è€…å¯ä»¥æ›´æ”¹å…¶å¯†ç ã€‚
{% endhint %}

<details>

<summary>åˆ—å‡ºå¹¶å°è¯•åœ¨æ¯ä¸ªä¼ä¸šåº”ç”¨ç¨‹åºä¸Šæ·»åŠ å®¢æˆ·ç«¯å¯†é’¥</summary>
```powershell
# Just call Add-AzADAppSecret
Function Add-AzADAppSecret
{
<#
.SYNOPSIS
Add client secret to the applications.

.PARAMETER GraphToken
Pass the Graph API Token

.EXAMPLE
PS C:\> Add-AzADAppSecret -GraphToken 'eyJ0eX..'

.LINK
https://docs.microsoft.com/en-us/graph/api/application-list?view=graph-rest-1.0&tabs=http
https://docs.microsoft.com/en-us/graph/api/application-addpassword?view=graph-rest-1.0&tabs=http
#>

[CmdletBinding()]
param(
[Parameter(Mandatory=$True)]
[String]
$GraphToken = $null
)

$AppList = $null
$AppPassword = $null

# List All the Applications

$Params = @{
"URI"     = "https://graph.microsoft.com/v1.0/applications"
"Method"  = "GET"
"Headers" = @{
"Content-Type"  = "application/json"
"Authorization" = "Bearer $GraphToken"
}
}

try
{
$AppList = Invoke-RestMethod @Params -UseBasicParsing
}
catch
{
}

# Add Password in the Application

if($AppList -ne $null)
{
[System.Collections.ArrayList]$Details = @()

foreach($App in $AppList.value)
{
$ID = $App.ID
$psobj = New-Object PSObject

$Params = @{
"URI"     = "https://graph.microsoft.com/v1.0/applications/$ID/addPassword"
"Method"  = "POST"
"Headers" = @{
"Content-Type"  = "application/json"
"Authorization" = "Bearer $GraphToken"
}
}

$Body = @{
"passwordCredential"= @{
"displayName" = "Password"
}
}

try
{
$AppPassword = Invoke-RestMethod @Params -UseBasicParsing -Body ($Body | ConvertTo-Json)
Add-Member -InputObject $psobj -NotePropertyName "Object ID" -NotePropertyValue $ID
Add-Member -InputObject $psobj -NotePropertyName "App ID" -NotePropertyValue $App.appId
Add-Member -InputObject $psobj -NotePropertyName "App Name" -NotePropertyValue $App.displayName
Add-Member -InputObject $psobj -NotePropertyName "Key ID" -NotePropertyValue $AppPassword.keyId
Add-Member -InputObject $psobj -NotePropertyName "Secret" -NotePropertyValue $AppPassword.secretText
$Details.Add($psobj) | Out-Null
}
catch
{
Write-Output "Failed to add new client secret to '$($App.displayName)' Application."
}
}
if($Details -ne $null)
{
Write-Output ""
Write-Output "Client secret added to : "
Write-Output $Details | fl *
}
}
else
{
Write-Output "Failed to Enumerate the Applications."
}
}
```
</details>

### è§’è‰²

{% tabs %}
{% tab title="az cli" %}
```bash
# Get roles
az role definition list
# Get assigned roles
az role assignment list --all --query "[].roleDefinitionName"
az role assignment list --all | jq '.[] | .roleDefinitionName,.scope'
# Get info of 1 role
az role definition list --name "AzureML Registry User"
# Get only custom roles
az role definition list --custom-role-only
# Get only roles assigned to the resource group indicated
az role definition list --resource-group <resource_group>
# Get only roles assigned to the indicated scope
az role definition list --scope <scope>
# Get all the principals a role is assigned to
az role assignment list --all --query "[].{principalName:principalName,principalType:principalType,resourceGroup:resourceGroup,roleDefinitionName:roleDefinitionName}[?roleDefinitionName=='<ROLE_NAME>']"
```
{% endtab %}

{% tab title="Azure AD" %}Azure ADï¼ˆAzure Active Directoryï¼‰æ˜¯Azureäº‘å¹³å°ä¸Šçš„èº«ä»½éªŒè¯å’Œè®¿é—®ç®¡ç†æœåŠ¡ã€‚å®ƒå…è®¸ç»„ç»‡é›†ä¸­ç®¡ç†ç”¨æˆ·èº«ä»½å’Œè®¿é—®æƒé™ï¼Œå¹¶æä¾›å•ç‚¹ç™»å½•å’Œå¤šå› ç´ èº«ä»½éªŒè¯ç­‰åŠŸèƒ½ã€‚

## Azure ADæ”»å‡»æŠ€æœ¯

### 1. ç”¨æˆ·æšä¸¾

æ”»å‡»è€…å¯ä»¥ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥æšä¸¾ç›®æ ‡ç»„ç»‡ä¸­çš„ç”¨æˆ·ã€‚è¿™å¯ä»¥é€šè¿‡å°è¯•ä¸åŒçš„ç”¨æˆ·åå’Œè§‚å¯Ÿè¿”å›çš„é”™è¯¯æ¶ˆæ¯æ¥å®ç°ã€‚

### 2. å¯†ç å–·å°„

å¯†ç å–·å°„æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…å°è¯•ä½¿ç”¨å¸¸è§çš„å¯†ç åˆ—è¡¨å¯¹ç›®æ ‡ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 3. èº«ä»½éªŒè¯ç»•è¿‡

æ”»å‡»è€…å¯ä»¥å°è¯•ç»•è¿‡Azure ADçš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä»¥è·å–æœªç»æˆæƒçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 4. ä»¤ç‰ŒåŠ«æŒ

ä»¤ç‰ŒåŠ«æŒæ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡è·å–æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 5. ä»¤ç‰Œæ³„éœ²

ä»¤ç‰Œæ³„éœ²æ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡å„ç§æ–¹å¼è·å–åˆ°æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œï¼Œä»è€Œè·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 6. ä»¤ç‰Œé‡æ”¾

ä»¤ç‰Œé‡æ”¾æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡é‡æ”¾æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 7. ä»¤ç‰Œç¯¡æ”¹

ä»¤ç‰Œç¯¡æ”¹æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡ç¯¡æ”¹æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 8. ä»¤ç‰Œåˆ·æ–°

ä»¤ç‰Œåˆ·æ–°æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡åˆ·æ–°æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥å»¶é•¿å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 9. ä»¤ç‰Œæ’¤é”€

ä»¤ç‰Œæ’¤é”€æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡æ’¤é”€æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥å‰¥å¤ºå¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 10. ä»¤ç‰Œè¿‡æœŸ

ä»¤ç‰Œè¿‡æœŸæ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡ä½¿ç”¨å·²è¿‡æœŸçš„è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 11. ä»¤ç‰Œæ‹’ç»

ä»¤ç‰Œæ‹’ç»æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡æ‹’ç»æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥å‰¥å¤ºå¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 12. ä»¤ç‰Œä¼ªé€ 

ä»¤ç‰Œä¼ªé€ æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡ä¼ªé€ æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 13. ä»¤ç‰ŒåŠ«æŒ

ä»¤ç‰ŒåŠ«æŒæ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡è·å–æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 14. ä»¤ç‰Œæ³„éœ²

ä»¤ç‰Œæ³„éœ²æ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡å„ç§æ–¹å¼è·å–åˆ°æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œï¼Œä»è€Œè·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 15. ä»¤ç‰Œé‡æ”¾

ä»¤ç‰Œé‡æ”¾æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡é‡æ”¾æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 16. ä»¤ç‰Œç¯¡æ”¹

ä»¤ç‰Œç¯¡æ”¹æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡ç¯¡æ”¹æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 17. ä»¤ç‰Œåˆ·æ–°

ä»¤ç‰Œåˆ·æ–°æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡åˆ·æ–°æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥å»¶é•¿å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 18. ä»¤ç‰Œæ’¤é”€

ä»¤ç‰Œæ’¤é”€æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡æ’¤é”€æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥å‰¥å¤ºå¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 19. ä»¤ç‰Œè¿‡æœŸ

ä»¤ç‰Œè¿‡æœŸæ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡ä½¿ç”¨å·²è¿‡æœŸçš„è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 20. ä»¤ç‰Œæ‹’ç»

ä»¤ç‰Œæ‹’ç»æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡æ‹’ç»æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥å‰¥å¤ºå¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 21. ä»¤ç‰Œä¼ªé€ 

ä»¤ç‰Œä¼ªé€ æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡ä¼ªé€ æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 22. ä»¤ç‰ŒåŠ«æŒ

ä»¤ç‰ŒåŠ«æŒæ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡è·å–æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 23. ä»¤ç‰Œæ³„éœ²

ä»¤ç‰Œæ³„éœ²æ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡å„ç§æ–¹å¼è·å–åˆ°æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œï¼Œä»è€Œè·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 24. ä»¤ç‰Œé‡æ”¾

ä»¤ç‰Œé‡æ”¾æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡é‡æ”¾æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 25. ä»¤ç‰Œç¯¡æ”¹

ä»¤ç‰Œç¯¡æ”¹æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡ç¯¡æ”¹æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 26. ä»¤ç‰Œåˆ·æ–°

ä»¤ç‰Œåˆ·æ–°æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡åˆ·æ–°æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥å»¶é•¿å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 27. ä»¤ç‰Œæ’¤é”€

ä»¤ç‰Œæ’¤é”€æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡æ’¤é”€æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥å‰¥å¤ºå¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 28. ä»¤ç‰Œè¿‡æœŸ

ä»¤ç‰Œè¿‡æœŸæ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡ä½¿ç”¨å·²è¿‡æœŸçš„è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 29. ä»¤ç‰Œæ‹’ç»

ä»¤ç‰Œæ‹’ç»æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡æ‹’ç»æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥å‰¥å¤ºå¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚

### 30. ä»¤ç‰Œä¼ªé€ 

ä»¤ç‰Œä¼ªé€ æ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡ä¼ªé€ æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œæ¥è·å–å¯¹ç›®æ ‡èµ„æºçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨Azure AD Graph APIæˆ–Microsoft Graph APIæ¥å®ç°ã€‚{% endtab %}
```powershell
# Get all available role templates
Get-AzureADDirectoryroleTemplate
# Get enabled roles (Assigned roles)
Get-AzureADDirectoryRole
Get-AzureADDirectoryRole -ObjectId <roleID> #Get info about the role
# Get custom roles - use AzureAdPreview
Get-AzureADMSRoleDefinition | ?{$_.IsBuiltin -eq $False} | select DisplayName
# Users assigned a role (Global Administrator)
Get-AzureADDirectoryRole -Filter "DisplayName eq 'Global Administrator'" | Get-AzureADDirectoryRoleMember
Get-AzureADDirectoryRole -ObjectId <id> | fl
# Roles of the Administrative Unit (who has permissions over the administrative unit and its members)
Get-AzureADMSScopedRoleMembership -Id <id> | fl *
```
{% tab title="Az PowerShell" %}

Azure Active Directory (Azure AD) æ˜¯ Azure ä¸­çš„èº«ä»½éªŒè¯å’Œè®¿é—®ç®¡ç†æœåŠ¡ã€‚å®ƒå…è®¸ç»„ç»‡ç®¡ç†ç”¨æˆ·ã€ç»„å’Œåº”ç”¨ç¨‹åºï¼Œå¹¶æ§åˆ¶å¯¹ Azure èµ„æºçš„è®¿é—®æƒé™ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ Azure AD PowerShell å‘½ä»¤ï¼š

- `Connect-AzureAD`ï¼šè¿æ¥åˆ° Azure ADã€‚
- `Get-AzureADUser`ï¼šè·å– Azure AD ä¸­çš„ç”¨æˆ·ã€‚
- `Get-AzureADGroup`ï¼šè·å– Azure AD ä¸­çš„ç»„ã€‚
- `Get-AzureADApplication`ï¼šè·å– Azure AD ä¸­çš„åº”ç”¨ç¨‹åºã€‚
- `New-AzureADUser`ï¼šåˆ›å»ºæ–°çš„ Azure AD ç”¨æˆ·ã€‚
- `New-AzureADGroup`ï¼šåˆ›å»ºæ–°çš„ Azure AD ç»„ã€‚
- `New-AzureADApplication`ï¼šåˆ›å»ºæ–°çš„ Azure AD åº”ç”¨ç¨‹åºã€‚
- `Set-AzureADUser`ï¼šæ›´æ–° Azure AD ç”¨æˆ·çš„å±æ€§ã€‚
- `Set-AzureADGroup`ï¼šæ›´æ–° Azure AD ç»„çš„å±æ€§ã€‚
- `Set-AzureADApplication`ï¼šæ›´æ–° Azure AD åº”ç”¨ç¨‹åºçš„å±æ€§ã€‚
- `Remove-AzureADUser`ï¼šåˆ é™¤ Azure AD ç”¨æˆ·ã€‚
- `Remove-AzureADGroup`ï¼šåˆ é™¤ Azure AD ç»„ã€‚
- `Remove-AzureADApplication`ï¼šåˆ é™¤ Azure AD åº”ç”¨ç¨‹åºã€‚

ä½¿ç”¨è¿™äº›å‘½ä»¤ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œå„ç§ Azure AD ç›¸å…³çš„æ“ä½œï¼Œå¦‚åˆ›å»ºã€æ›´æ–°å’Œåˆ é™¤ç”¨æˆ·ã€ç»„å’Œåº”ç”¨ç¨‹åºã€‚

{% endtab %}
```powershell
# Get role assignments on the subscription
Get-AzRoleDefinition
# Get Role definition
Get-AzRoleDefinition -Name "Virtual Machine Command Executor"
# Get roles of a user or resource
Get-AzRoleAssignment -SignInName test@corp.onmicrosoft.com
Get-AzRoleAssignment -Scope /subscriptions/<subscription-id>/resourceGroups/<res_group_name>/providers/Microsoft.Compute/virtualMachines/<vm_name>
```
ä»¥ä¸‹æ˜¯æœ‰å…³é»‘å®¢æŠ€æœ¯çš„ä¹¦ç±å†…å®¹ã€‚ä»¥ä¸‹å†…å®¹æ¥è‡ªæ–‡ä»¶/hive/hacktricks-cloud/pentesting-cloud/azure-security/az-services/az-azuread.mdã€‚å°†ç›¸å…³çš„è‹±æ–‡æ–‡æœ¬ç¿»è¯‘æˆä¸­æ–‡ï¼Œå¹¶ä¿æŒå®Œå…¨ç›¸åŒçš„markdownå’Œhtmlè¯­æ³•ã€‚ä¸è¦ç¿»è¯‘ä»£ç ã€é»‘å®¢æŠ€æœ¯åç§°ã€é»‘å®¢æœ¯è¯­ã€äº‘/SaaSå¹³å°åç§°ï¼ˆå¦‚Workspaceã€awsã€gcp...ï¼‰ã€æ³„æ¼ä¸€è¯ã€æ¸—é€æµ‹è¯•å’Œmarkdownæ ‡ç­¾ã€‚æ­¤å¤–ï¼Œè¯·ä¸è¦æ·»åŠ ä»»ä½•é¢å¤–çš„å†…å®¹ï¼Œåªéœ€ç¿»è¯‘å’Œmarkdownè¯­æ³•å³å¯ã€‚
```powershell
# Get permissions over a resource using ARM directly
$Token = (Get-AzAccessToken).Token
$URI = 'https://management.azure.com/subscriptions/b413826f-108d-4049-8c11-d52d5d388768/resourceGroups/Research/providers/Microsoft.Compute/virtualMachines/infradminsrv/providers/Microsoft.Authorization/permissions?api-version=2015-07-01'
$RequestParams = @{
Method = 'GET'
Uri = $URI
Headers = @{
'Authorization' = "Bearer $Token"
}
}
(Invoke-RestMethod @RequestParams).value
```
{% tabs %}
{% tab title="az cli" %}

### è®¾å¤‡

```plaintext
# åˆ—å‡ºæ‰€æœ‰è®¾å¤‡
az ad device list

# æ ¹æ®è®¾å¤‡IDè·å–è®¾å¤‡è¯¦ç»†ä¿¡æ¯
az ad device show --id <device_id>

# æ ¹æ®è®¾å¤‡åç§°è·å–è®¾å¤‡è¯¦ç»†ä¿¡æ¯
az ad device show --display-name <device_name>

# æ ¹æ®è®¾å¤‡IDåˆ é™¤è®¾å¤‡
az ad device delete --id <device_id>

# æ ¹æ®è®¾å¤‡åç§°åˆ é™¤è®¾å¤‡
az ad device delete --display-name <device_name>
```

{% endtab %}
{% endtabs %}
```bash
# If you know how to do this send a PR!
```
{% tab title="Azure AD" %}Azure ADï¼ˆAzure Active Directoryï¼‰æ˜¯å¾®è½¯æä¾›çš„äº‘èº«ä»½éªŒè¯å’ŒæˆæƒæœåŠ¡ã€‚å®ƒç”¨äºç®¡ç†ç”¨æˆ·èº«ä»½ã€è®¿é—®æƒé™å’Œåº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¸Azure ADç›¸å…³çš„å®‰å…¨æ³¨æ„äº‹é¡¹å’ŒæŠ€å·§ã€‚
```powershell
# Enumerate Devices
Get-AzureADDevice -All $true | fl *
# List all the active devices (and not the stale devices)
Get-AzureADDevice -All $true | ?{$_.ApproximateLastLogonTimeStamp -ne $null}
# Get owners of all devices
Get-AzureADDevice -All $true | Get-AzureADDeviceRegisteredOwner
Get-AzureADDevice -All $true | %{if($user=Get-AzureADDeviceRegisteredOwner -ObjectId $_.ObjectID){$_;$user.UserPrincipalName;"`n"}}
# Registred users of all the devices
Get-AzureADDevice -All $true | Get-AzureADDeviceRegisteredUser
Get-AzureADDevice -All $true | %{if($user=Get-AzureADDeviceRegisteredUser -ObjectId $_.ObjectID){$_;$user.UserPrincipalName;"`n"}}
# Get dives managed using Intune
Get-AzureADDevice -All $true | ?{$_.IsCompliant -eq "True"}
# Get devices owned by a user
Get-AzureADUserOwnedDevice -ObjectId test@corp.onmicrosoft.com
# Get Administrative Units of a device
Get-AzureADMSAdministrativeUnit | where { Get-AzureADMSAdministrativeUnitMember -ObjectId $_.ObjectId | where {$_.ObjectId -eq $deviceObjId} }
```
{% endtab %}
{% endtabs %}

{% hint style="warning" %}
å¦‚æœè®¾å¤‡ï¼ˆVMï¼‰æ˜¯**AzureADåŠ å…¥çš„**ï¼ŒAzureADçš„ç”¨æˆ·å°†èƒ½å¤Ÿ**ç™»å½•**ã€‚\
æ­¤å¤–ï¼Œå¦‚æœç™»å½•çš„ç”¨æˆ·æ˜¯è®¾å¤‡çš„**æ‰€æœ‰è€…**ï¼Œä»–å°†æˆä¸º**æœ¬åœ°ç®¡ç†å‘˜**ã€‚
{% endhint %}

### åº”ç”¨ç¨‹åº

{% hint style="info" %}
**åº”ç”¨ç¨‹åº**æ˜¯é—¨æˆ·ä¸­çš„**åº”ç”¨æ³¨å†Œ**ï¼ˆè€Œä¸æ˜¯ä¼ä¸šåº”ç”¨ç¨‹åºï¼‰ã€‚\
ä½†æ˜¯ï¼Œæ¯ä¸ªåº”ç”¨æ³¨å†Œå°†åˆ›å»ºä¸€ä¸ªå…·æœ‰ç›¸åŒåç§°çš„**ä¼ä¸šåº”ç”¨ç¨‹åº**ï¼ˆ**æœåŠ¡ä¸»ä½“**ï¼‰ã€‚\
æ­¤å¤–ï¼Œå¦‚æœåº”ç”¨ç¨‹åºæ˜¯**å¤šç§Ÿæˆ·åº”ç”¨ç¨‹åº**ï¼Œå°†åœ¨**è¯¥ç§Ÿæˆ·**ä¸­åˆ›å»º**å¦ä¸€ä¸ª**å…·æœ‰ç›¸åŒåç§°çš„ä¼ä¸šåº”ç”¨ç¨‹åºï¼ˆ**æœåŠ¡ä¸»ä½“**ï¼‰ã€‚
{% endhint %}

ç”Ÿæˆåº”ç”¨ç¨‹åºæ—¶ä¼šèµ‹äºˆä¸¤ç§ç±»å‹çš„æƒé™ï¼š

* èµ‹äºˆ**æœåŠ¡ä¸»ä½“**çš„**æƒé™**
* **åº”ç”¨ç¨‹åº**å¯ä»¥æ‹¥æœ‰å¹¶ä»£è¡¨**ç”¨æˆ·**ä½¿ç”¨çš„**æƒé™**ã€‚

{% tabs %}
{% tab title="az cli" %}
```bash
# List Apps
az ad app list
az ad app list --query "[].[displayName]" -o table
# Get info of 1 App
az ad app show --id 00000000-0000-0000-0000-000000000000
# Search App by string
az ad app list --query "[?contains(displayName,'app')].displayName"
# Get the owner of an application
az ad app owner list --id <id> --query "[].[displayName]" -o table
# List all the apps with an application password
az ad app list --query "[?passwordCredentials != null].displayName"
# List apps that have key credentials (use of certificate authentication)
az ad app list --query "[?keyCredentials != null].displayName"
```
{% tab title="Azure AD" %}Azure ADï¼ˆAzure Active Directoryï¼‰æ˜¯å¾®è½¯æä¾›çš„äº‘èº«ä»½éªŒè¯å’ŒæˆæƒæœåŠ¡ã€‚å®ƒç”¨äºç®¡ç†ç”¨æˆ·èº«ä»½ã€è®¿é—®æƒé™å’Œåº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¸Azure ADç›¸å…³çš„å®‰å…¨æ³¨æ„äº‹é¡¹å’ŒæŠ€å·§ã€‚
```powershell
# List all registered applications
Get-AzureADApplication -All $true
# Get details of an application
Get-AzureADApplication -ObjectId <id>  | fl *
# List all the apps with an application password
Get-AzureADApplication -All $true | %{if(Get-AzureADApplicationPasswordCredential -ObjectID $_.ObjectID){$_}}
# Get owner of an application
Get-AzureADApplication -ObjectId <id> | Get-AzureADApplicationOwner |fl *
```
{% tab title="Az PowerShell" %}

## Az PowerShell

### Azure AD

#### Enumerate Azure AD Users

To enumerate Azure AD users using Az PowerShell, you can use the `Get-AzADUser` cmdlet. This cmdlet retrieves all the users in the Azure AD tenant.

```powershell
Get-AzADUser
```

#### Enumerate Azure AD Groups

To enumerate Azure AD groups using Az PowerShell, you can use the `Get-AzADGroup` cmdlet. This cmdlet retrieves all the groups in the Azure AD tenant.

```powershell
Get-AzADGroup
```

#### Enumerate Azure AD Applications

To enumerate Azure AD applications using Az PowerShell, you can use the `Get-AzADApplication` cmdlet. This cmdlet retrieves all the applications in the Azure AD tenant.

```powershell
Get-AzADApplication
```

#### Enumerate Azure AD Service Principals

To enumerate Azure AD service principals using Az PowerShell, you can use the `Get-AzADServicePrincipal` cmdlet. This cmdlet retrieves all the service principals in the Azure AD tenant.

```powershell
Get-AzADServicePrincipal
```

#### Enumerate Azure AD Roles

To enumerate Azure AD roles using Az PowerShell, you can use the `Get-AzADRoleDefinition` cmdlet. This cmdlet retrieves all the role definitions in the Azure AD tenant.

```powershell
Get-AzADRoleDefinition
```

#### Enumerate Azure AD Role Assignments

To enumerate Azure AD role assignments using Az PowerShell, you can use the `Get-AzADRoleAssignment` cmdlet. This cmdlet retrieves all the role assignments in the Azure AD tenant.

```powershell
Get-AzADRoleAssignment
```

#### Enumerate Azure AD Directory Roles

To enumerate Azure AD directory roles using Az PowerShell, you can use the `Get-AzADDirectoryRole` cmdlet. This cmdlet retrieves all the directory roles in the Azure AD tenant.

```powershell
Get-AzADDirectoryRole
```

#### Enumerate Azure AD Directory Role Members

To enumerate Azure AD directory role members using Az PowerShell, you can use the `Get-AzADDirectoryRoleMember` cmdlet. This cmdlet retrieves all the members of a directory role in the Azure AD tenant.

```powershell
Get-AzADDirectoryRoleMember -ObjectId <DirectoryRoleObjectId>
```

Replace `<DirectoryRoleObjectId>` with the object ID of the directory role you want to enumerate.

#### Enumerate Azure AD Directory Role Assignments

To enumerate Azure AD directory role assignments using Az PowerShell, you can use the `Get-AzADDirectoryRoleAssignment` cmdlet. This cmdlet retrieves all the directory role assignments in the Azure AD tenant.

```powershell
Get-AzADDirectoryRoleAssignment
```

#### Enumerate Azure AD Directory Role Templates

To enumerate Azure AD directory role templates using Az PowerShell, you can use the `Get-AzADDirectoryRoleTemplate` cmdlet. This cmdlet retrieves all the directory role templates in the Azure AD tenant.

```powershell
Get-AzADDirectoryRoleTemplate
```

#### Enumerate Azure AD Domain Services

To enumerate Azure AD domain services using Az PowerShell, you can use the `Get-AzADDomainService` cmdlet. This cmdlet retrieves all the domain services in the Azure AD tenant.

```powershell
Get-AzADDomainService
```

#### Enumerate Azure AD B2C Tenants

To enumerate Azure AD B2C tenants using Az PowerShell, you can use the `Get-AzADB2CTenant` cmdlet. This cmdlet retrieves all the B2C tenants in the Azure AD tenant.

```powershell
Get-AzADB2CTenant
```

#### Enumerate Azure AD B2C User Flows

To enumerate Azure AD B2C user flows using Az PowerShell, you can use the `Get-AzADB2CUserFlow` cmdlet. This cmdlet retrieves all the user flows in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlow
```

#### Enumerate Azure AD B2C Identity Providers

To enumerate Azure AD B2C identity providers using Az PowerShell, you can use the `Get-AzADB2CIdentityProvider` cmdlet. This cmdlet retrieves all the identity providers in the Azure AD B2C tenant.

```powershell
Get-AzADB2CIdentityProvider
```

#### Enumerate Azure AD B2C Custom Policies

To enumerate Azure AD B2C custom policies using Az PowerShell, you can use the `Get-AzADB2CCustomPolicy` cmdlet. This cmdlet retrieves all the custom policies in the Azure AD B2C tenant.

```powershell
Get-AzADB2CCustomPolicy
```

#### Enumerate Azure AD B2C User Attributes

To enumerate Azure AD B2C user attributes using Az PowerShell, you can use the `Get-AzADB2CUserAttribute` cmdlet. This cmdlet retrieves all the user attributes in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserAttribute
```

#### Enumerate Azure AD B2C User Attribute Values

To enumerate Azure AD B2C user attribute values using Az PowerShell, you can use the `Get-AzADB2CUserAttributeValue` cmdlet. This cmdlet retrieves all the user attribute values in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserAttributeValue
```

#### Enumerate Azure AD B2C User Flows Policies

To enumerate Azure AD B2C user flows policies using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicy` cmdlet. This cmdlet retrieves all the user flows policies in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicy
```

#### Enumerate Azure AD B2C User Flows Policy Keys

To enumerate Azure AD B2C user flows policy keys using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKey` cmdlet. This cmdlet retrieves all the user flows policy keys in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKey
```

#### Enumerate Azure AD B2C User Flows Policy Key Values

To enumerate Azure AD B2C user flows policy key values using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyValue` cmdlet. This cmdlet retrieves all the user flows policy key values in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyValue
```

#### Enumerate Azure AD B2C User Flows Policy Key Credentials

To enumerate Azure AD B2C user flows policy key credentials using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredential` cmdlet. This cmdlet retrieves all the user flows policy key credentials in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredential
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Values

To enumerate Azure AD B2C user flows policy key credential values using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialValue` cmdlet. This cmdlet retrieves all the user flows policy key credential values in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialValue
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signatures

To enumerate Azure AD B2C user flows policy key credential signatures using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignature` cmdlet. This cmdlet retrieves all the user flows policy key credential signatures in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignature
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Values

To enumerate Azure AD B2C user flows policy key credential signature values using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureValue` cmdlet. This cmdlet retrieves all the user flows policy key credential signature values in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureValue
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificates

To enumerate Azure AD B2C user flows policy key credential signature certificates using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificate` cmdlet. This cmdlet retrieves all the user flows policy key credential signature certificates in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificate
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Values

To enumerate Azure AD B2C user flows policy key credential signature certificate values using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateValue` cmdlet. This cmdlet retrieves all the user flows policy key credential signature certificate values in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateValue
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Thumbprints

To enumerate Azure AD B2C user flows policy key credential signature certificate thumbprints using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprint` cmdlet. This cmdlet retrieves all the user flows policy key credential signature certificate thumbprints in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprint
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Thumbprint Values

To enumerate Azure AD B2C user flows policy key credential signature certificate thumbprint values using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintValue` cmdlet. This cmdlet retrieves all the user flows policy key credential signature certificate thumbprint values in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintValue
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Thumbprint Hashes

To enumerate Azure AD B2C user flows policy key credential signature certificate thumbprint hashes using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHash` cmdlet. This cmdlet retrieves all the user flows policy key credential signature certificate thumbprint hashes in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHash
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Thumbprint Hash Values

To enumerate Azure AD B2C user flows policy key credential signature certificate thumbprint hash values using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashValue` cmdlet. This cmdlet retrieves all the user flows policy key credential signature certificate thumbprint hash values in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashValue
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Thumbprint Hash Algorithm

To enumerate Azure AD B2C user flows policy key credential signature certificate thumbprint hash algorithm using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithm` cmdlet. This cmdlet retrieves the user flows policy key credential signature certificate thumbprint hash algorithm in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithm
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Thumbprint Hash Algorithm Values

To enumerate Azure AD B2C user flows policy key credential signature certificate thumbprint hash algorithm values using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmValue` cmdlet. This cmdlet retrieves all the user flows policy key credential signature certificate thumbprint hash algorithm values in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmValue
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Thumbprint Hash Algorithm OID

To enumerate Azure AD B2C user flows policy key credential signature certificate thumbprint hash algorithm OID using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOID` cmdlet. This cmdlet retrieves the user flows policy key credential signature certificate thumbprint hash algorithm OID in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOID
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Thumbprint Hash Algorithm OID Values

To enumerate Azure AD B2C user flows policy key credential signature certificate thumbprint hash algorithm OID values using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOIDValue` cmdlet. This cmdlet retrieves all the user flows policy key credential signature certificate thumbprint hash algorithm OID values in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOIDValue
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Thumbprint Hash Algorithm OID Name

To enumerate Azure AD B2C user flows policy key credential signature certificate thumbprint hash algorithm OID name using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOIDName` cmdlet. This cmdlet retrieves the user flows policy key credential signature certificate thumbprint hash algorithm OID name in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOIDName
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Thumbprint Hash Algorithm OID Name Values

To enumerate Azure AD B2C user flows policy key credential signature certificate thumbprint hash algorithm OID name values using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOIDNameValue` cmdlet. This cmdlet retrieves all the user flows policy key credential signature certificate thumbprint hash algorithm OID name values in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOIDNameValue
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Thumbprint Hash Algorithm OID Name Display Names

To enumerate Azure AD B2C user flows policy key credential signature certificate thumbprint hash algorithm OID name display names using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOIDNameDisplayName` cmdlet. This cmdlet retrieves the user flows policy key credential signature certificate thumbprint hash algorithm OID name display names in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOIDNameDisplayName
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Thumbprint Hash Algorithm OID Name Display Name Values

To enumerate Azure AD B2C user flows policy key credential signature certificate thumbprint hash algorithm OID name display name values using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOIDNameDisplayNameValue` cmdlet. This cmdlet retrieves all the user flows policy key credential signature certificate thumbprint hash algorithm OID name display name values in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOIDNameDisplayNameValue
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Thumbprint Hash Algorithm OID Name Display Name Translations

To enumerate Azure AD B2C user flows policy key credential signature certificate thumbprint hash algorithm OID name display name translations using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOIDNameDisplayNameTranslation` cmdlet. This cmdlet retrieves the user flows policy key credential signature certificate thumbprint hash algorithm OID name display name translations in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOIDNameDisplayNameTranslation
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Thumbprint Hash Algorithm OID Name Display Name Translation Values

To enumerate Azure AD B2C user flows policy key credential signature certificate thumbprint hash algorithm OID name display name translation values using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOIDNameDisplayNameTranslationValue` cmdlet. This cmdlet retrieves all the user flows policy key credential signature certificate thumbprint hash algorithm OID name display name translation values in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOIDNameDisplayNameTranslationValue
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Thumbprint Hash Algorithm OID Name Display Name Translation Language

To enumerate Azure AD B2C user flows policy key credential signature certificate thumbprint hash algorithm OID name display name translation language using Az PowerShell, you can use the `Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOIDNameDisplayNameTranslationLanguage` cmdlet. This cmdlet retrieves the user flows policy key credential signature certificate thumbprint hash algorithm OID name display name translation language in the Azure AD B2C tenant.

```powershell
Get-AzADB2CUserFlowPolicyKeyCredentialSignatureCertificateThumbprintHashAlgorithmOIDNameDisplayNameTranslationLanguage
```

#### Enumerate Azure AD B2C User Flows Policy Key Credential Signature Certificate Thumbprint Hash Algorithm
```powershell
# Get Apps
Get-AzADApplication
# Get details of one App
Get-AzADApplication -ObjectId <id>
# Get App searching by string
Get-AzADApplication | ?{$_.DisplayName -match "app"}
# Get Apps with password
Get-AzADAppCredential
```
{% endtab %}
{% endtabs %}

{% hint style="warning" %}
å…·æœ‰**`AppRoleAssignment.ReadWrite`**æƒé™çš„åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡æˆäºˆè‡ªèº«è§’è‰²æ¥**å‡çº§ä¸ºå…¨å±€ç®¡ç†å‘˜**ã€‚\
æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·[**æŸ¥çœ‹æ­¤é“¾æ¥**](https://posts.specterops.io/azure-privilege-escalation-via-azure-api-permissions-abuse-74aee1006f48)ã€‚
{% endhint %}

{% hint style="info" %}
åº”ç”¨ç¨‹åºåœ¨è¯·æ±‚ä»¤ç‰Œæ—¶ç”¨äºè¯æ˜å…¶èº«ä»½çš„ç§˜å¯†å­—ç¬¦ä¸²æ˜¯åº”ç”¨ç¨‹åºå¯†ç ã€‚\
å› æ­¤ï¼Œå¦‚æœæ‰¾åˆ°æ­¤**å¯†ç **ï¼Œæ‚¨å¯ä»¥ä½œä¸º**ç§Ÿæˆ·å†…çš„æœåŠ¡ä¸»ä½“**è®¿é—®ã€‚\
è¯·æ³¨æ„ï¼Œæ­¤å¯†ç ä»…åœ¨ç”Ÿæˆæ—¶å¯è§ï¼ˆæ‚¨å¯ä»¥æ›´æ”¹å®ƒï¼Œä½†æ— æ³•å†æ¬¡è·å–å®ƒï¼‰ã€‚\
**åº”ç”¨ç¨‹åºçš„æ‰€æœ‰è€…**å¯ä»¥ä¸ºå…¶**æ·»åŠ å¯†ç **ï¼ˆä»¥ä¾¿å¯ä»¥å†’å……å®ƒï¼‰ã€‚\
ä»¥è¿™äº›æœåŠ¡ä¸»ä½“çš„èº«ä»½ç™»å½•**ä¸ä¼šè¢«æ ‡è®°ä¸ºé£é™©**ï¼Œå¹¶ä¸”å®ƒä»¬**ä¸ä¼šæœ‰å¤šé‡èº«ä»½éªŒè¯**ã€‚
{% endhint %}

### ç®¡ç†å•å…ƒ

å®ƒç”¨äºæ›´å¥½åœ°ç®¡ç†ç”¨æˆ·ã€‚

ç®¡ç†å•å…ƒ**å°†è§’è‰²çš„æƒé™é™åˆ¶ä¸ºæ‚¨å®šä¹‰çš„ç»„ç»‡çš„ä»»ä½•éƒ¨åˆ†**ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç®¡ç†å•å…ƒå°†[Helpdesk Administrator](https://learn.microsoft.com/en-us/azure/active-directory/roles/permissions-reference#helpdesk-administrator)è§’è‰²å§”æ´¾ç»™åŒºåŸŸæ”¯æŒä¸“å‘˜ï¼Œä»¥ä¾¿ä»–ä»¬ä»…èƒ½ç®¡ç†å…¶æ”¯æŒçš„åŒºåŸŸä¸­çš„ç”¨æˆ·ã€‚

å› æ­¤ï¼Œæ‚¨å¯ä»¥å°†è§’è‰²åˆ†é…ç»™ç®¡ç†å•å…ƒï¼Œå¹¶ä¸”å…¶æˆå‘˜å°†å…·æœ‰è¿™äº›è§’è‰²ã€‚

{% tabs %}
{% tab title="az cli" %}
```
```
{% endtab %}

{% tab title="AzureAD" %}
```powershell
# Get Administrative Units
Get-AzureADMSAdministrativeUnit
Get-AzureADMSAdministrativeUnit -Id <id>
# Get ID of admin unit by string
$adminUnitObj = Get-AzureADMSAdministrativeUnit -Filter "displayname eq 'Test administrative unit 2'"
# List the users, groups, and devices affected by the administrative unit
Get-AzureADMSAdministrativeUnitMember -Id <id>
# Get the roles users have over the members of the AU
Get-AzureADMSScopedRoleMembership -Id <id> | fl #Get role ID and role members
```
{% endtab %}
{% endtabs %}

### å‚è€ƒèµ„æ–™

* [https://learn.microsoft.com/en-us/azure/active-directory/roles/administrative-units](https://learn.microsoft.com/en-us/azure/active-directory/roles/administrative-units)

<details>

<summary><strong>æ”¯æŒ HackTricks å¹¶è·å¾—ç¦åˆ©ï¼</strong></summary>

* å¦‚æœæ‚¨æƒ³åœ¨ HackTricks ä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Šï¼Œæˆ–è€…å¦‚æœæ‚¨æƒ³è®¿é—® PEASS çš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½ HackTricks çš„ PDFï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹ PEASS å’Œ HackTricks å•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFT**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) **å’Œ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
