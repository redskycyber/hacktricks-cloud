# Az - Azure Netwerk

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>

## Basiese Inligting

Netwerke binne Azure funksioneer as 'n integrale deel van sy wolkrekenplatform en maak die **verbindings en kommunikasie tussen verskillende Azure-dienste en hulpbronne** moontlik. Die netwerkargitektuur in Azure is ontwerp om hoogs skaalbaar, veilig en aanpasbaar te wees.

In sy kern bied Azure 'n **virtuele netwerk (VNet)** wat gebruikers in staat stel om **ge√Øsoleerde netwerke** binne die Azure-wolk te skep. Binne hierdie VNets kan hulpbronne soos virtuele masjiene, toepassings en databasisse veilig gehuisves en bestuur word. Die netwerk in Azure ondersteun beide die kommunikasie binne die wolk (tussen Azure-dienste) en die verbinding met eksterne netwerke en die internet.

**Veiligheid** is 'n kritieke aspek van Azure-netwerke, met verskeie hulpmiddels en dienste beskikbaar vir die beskerming van data, die bestuur van toegang en die versekering van nakoming. Hierdie veiligheidsmaatre√´ls sluit in **brandmuure**, **netwerksekuriteitsgroepe** en **enkripsie**-vermo√´ns, wat 'n ho√´ vlak van beheer oor verkeer en toegang moontlik maak.

Oor die algemeen is Azure se netwerkkapasiteite ontwerp om buigsaamheid te bied, sodat gebruikers 'n netwerkomgewing kan skep wat voldoen aan hul spesifieke toepassing- en werkladingbehoeftes, terwyl daar 'n sterk klem op veiligheid en betroubaarheid gehandhaaf word.

## Virtuele Netwerk (VNET) & Subnetwerke

'n VNet in Azure is in wese 'n voorstelling van jou eie netwerk in die wolk. Dit is 'n **logiese isolasie van die Azure-wolk wat aan jou intekening toegewys is**. 'n VNet stel jou in staat om virtuele privaatnetwerke (VPNs) in Azure te voorsien en te bestuur en kan gebruik word om verskillende soorte Azure-hulpbronne, soos Virtuele Masjiene (VM's), databasisse en toepassingsdienste, te huisves en te **bestuur**.

VNets bied jou **volle beheer oor jou netwerkinstellings**, insluitend **IP-adresreeks**, subnet-skepping, roetetabelle en netwerkgateways.

'n **Subnet** is 'n **reeks IP-adresse in jou VNet**. Jy kan 'n VNet in meerdere subnets verdeel vir organisasie en veiligheid. Elke subnet in 'n VNet kan gebruik word om hulpbronne te isoleer en te groepeer volgens jou netwerk- en toepassingsargitektuur.

Verder stel subnets jou in staat om jou VNet in een of meer sub-netwerke te **segmenteer**, wat 'n reeks IP-adresse bied wat hulpbronne kan gebruik.

### **Voorbeeld**

* Stel jy het 'n VNet genaamd `MyVNet` met 'n IP-adresreeks van `10.0.0.0/16`. Jy kan 'n subnet binne hierdie VNet skep, s√™ `Subnet-1`, met 'n IP-adresreeks van `10.0.0.0/24` vir die huisves van jou webbedieners. 'n Ander subnet, `Subnet-2` met 'n reeks van `10.0.1.0/24`, kan gebruik word vir jou databasisbedieners. Hierdie segmentering maak doeltreffende bestuur en sekuriteitsbeheer binne die netwerk moontlik.

### Enumerasie

Om al die VNets en subnets in 'n Azure-rekening te lys, kan jy die Azure Command-Line Interface (CLI) gebruik. Hier is die stappe:

{% code overflow="wrap" %}
```bash
# List VNets
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List subnets of a VNet
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, addressPrefix:addressPrefix}" -o table
```
{% endcode %}

## Netwerk Sekuriteitsgroepe (NSG)

In Azure dien 'n **Netwerk Sekuriteitsgroep (NSG)** die prim√™re funksie om netwerkverkeer te filter na en vanaf Azure-bronne binne 'n Azure Virtuele Netwerk (VNet). Dit bevat 'n stel **sekuriteitsre√´ls** wat noukeurig die vloei van netwerkverkeer bepaal.

Belangrike aspekte van NSG sluit in:

- **Verkeersbeheer**: Elke NSG bevat re√´ls wat instrumenteel is om inkomende en uitgaande netwerkverkeer wat verband hou met verskillende Azure-bronne, te permitteer of te belemmer.
- **Re√´lkomponente**: Die re√´ls binne 'n NSG is baie spesifiek en filter verkeer op kriteria soos bron-/bestemmings-IP-adres, poort en protokol. Hierdie spesifisiteit maak dit moontlik om netwerkverkeer fynbestuur te bestuur.
- **Sekuriteitsverbetering**: Deur te verseker dat slegs geautoriseerde verkeer jou Azure-bronne kan betree of verlaat, speel NSGs 'n belangrike rol in die versterking van die sekuriteitsposisie van jou netwerkinfrastruktuur.


### **Voorbeeld**

* Stel jou het 'n NSG genaamd `MyNSG` wat toegepas word op 'n subnet of 'n spesifieke virtuele masjien binne jou VNet. Jy kan re√´ls soos die volgende skep:
* 'n Inkomende re√´l wat HTTP-verkeer (poort 80) vanaf enige bron na jou webbedieners toelaat.
* 'n Uitgaande re√´l wat slegs SQL-verkeer (poort 1433) na 'n spesifieke bestemmings-IP-adresreeks toelaat.

### Enumerasie

{% code overflow="wrap" %}
```bash
# List NSGs
az network nsg list --query "[].{name:name, location:location}" -o table

# Get NSG rules
az network nsg rule list --nsg-name <NSGName> --resource-group <ResourceGroupName> --query "[].{name:name, priority:priority, direction:direction, access:access, protocol:protocol, sourceAddressPrefix:sourceAddressPrefix, destinationAddressPrefix:destinationAddressPrefix, sourcePortRange:sourcePortRange, destinationPortRange:destinationPortRange}" -o table
```
{% endcode %}

## Azure Firewall

Azure Firewall is 'n bestuurde, wolkgebaseerde **netwerksekuriteitsdiens wat jou Azure Virtuele Netwerkbronne beskerm**. Dit is 'n volledig staatlike firewall as 'n diens met ingeboude ho√´ beskikbaarheid en skaalbaarheidseienskappe.

Azure Firewall bied **meer gevorderde** funksies as **NSGs**, insluitend **toepassingsvlakfiltrering**, netwerkvlakfiltrering, dreigingsintelligensie-gebaseerde filtrering en integrasie met Azure Monitor vir logboekhouding en analise.\
Dit kan uitgaande, inkomende, spoke-to-spoke, VPN- en ExpressRoute-verkeer filter. **Firewall-re√´ls kan geskep word op grond van FQDN (Fully Qualified Domain Name), IP-adresse en poorte**.

### Verskille tussen Azure Firewall en NSGs&#x20;

1. **Omvang:**
* **NSG:** Werk op subnet- of netwerkinterfacevlak. Dit is bedoel om basiese filtrering van inkomende en uitgaande verkeer van netwerkinterfaces (NIC), VM's of subnets te bied.
* **Azure Firewall:** Werk op VNet-vlak en bied 'n bre√´r omvang van beskerming. Dit is ontwerp om jou virtuele netwerkbronne te beveilig en die vloei van verkeer in en uit die VNet te bestuur.
2. **Vermo√´ns:**
* **NSG:** Bied basiese filtreringsvermo√´ns gebaseer op IP-adres, poort en protokol. Dit ondersteun nie gevorderde funksies soos toepassingsvlak-inspeksie of dreigingsintelligensie nie.
* **Azure Firewall:** Bied gevorderde funksies soos toepassingsvlak (Laag 7) verkeersfiltrering, dreigingsintelligensie-gebaseerde filtrering, netwerkverkeersfiltrering en meer. Dit ondersteun ook verskeie openbare IP-adresse.
3. **Gebruiksscenario's:**
* **NSG:** Ideaal vir basiese netwerkvlak-verkeersfiltrering.
* **Azure Firewall:** Geskik vir meer komplekse filtreringsscenario's waar toepassingsvlakbeheer, logboekhouding en dreigingsintelligensie benodig word.
4. **Bestuur en monitering:**
* **NSG:** Bied basiese logboekhouding en integrasie met Azure Monitor.
* **Azure Firewall:** Verskaf gevorderde logboekhouding en analitiese vermo√´ns deur middel van Azure Monitor, wat noodsaaklik is vir die begrip van die aard en patroon van die verkeer.

### Enumerasie

{% code overflow="wrap" %}
```bash
# List Azure Firewalls
az network firewall list --query "[].{name:name, location:location, subnet:subnet, publicIp:publicIp}" -o table

# Get network rules of a firewall
az network firewall network-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get application rules of a firewall
az network firewall application-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get nat rules of a firewall
az network firewall nat-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table
```
{% endcode %}

## Netwerk Virtuele Toestel (NVT)

'n Netwerk Virtuele Toestel (**NVT**) in Azure is 'n virtuele toestel wat **netwerkfunksies binne 'n virtuele netwerk uitvoer**. NVT's word tipies gebruik vir netwerkfunksies wat **nie outomaties beskikbaar is** in Azure nie, of wanneer meer aanpassing vereis word. Dit is in wese **VM's wat netwerktoepassings of -dienste uitvoer**, soos brandmuure, WAN-optimaliseerders of vragbalanseerders.

NVT's word gebruik vir komplekse roetes, **sekuriteit**, en **netwerkverkeerbestuur**-take. Dit kan uitgeplaas word vanaf die Azure **Markplek**, waar baie derde-party-leweransiers hul toestelle gereed maak vir integrasie in Azure-omgewings.

### **Voorbeeld**

* 'n Organisasie kan 'n NVT in Azure uitplaas om 'n **aangepaste brandmuuroplossing** te skep. Hierdie NVT kan 'n **derde-party-brandmuurprogrammatuur** uitvoer, wat gevorderde funksies soos indringingsopsporing, pakketsinspeksie of VPN-konnektiwiteit bied. Die NVT kan gekonfigureer word om verkeer wat daardeur beweeg te ondersoek en te filtreer, om te verseker dat verbeterde sekuriteitsmaatre√´ls volgens die organisasie se beleid in plek is.

### **Opsomming**

{% code overflow="wrap" %}
```bash
# Usually NVAs are named or tagged in a way to distinguish them from other VMs
az vm list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# For a specific VM identified as an NVA, list its network interfaces
az vm nic list --vm-name <VMName> --resource-group <ResourceGroupName> --query "[].{id:id}" -o table
```
## Azure Roete Tabelle & Gebruiker Gedefinieerde Roetes (UDR)

**Azure Roete Tabelle** is 'n funksie binne Microsoft Azure wat die **beheer van netwerkverkeer roetes binne Azure Virtuele Netwerke (VNets)** moontlik maak. Dit definieer in wese hoe **pakkies** tussen subnette binne VNets, tussen VNets, of na eksterne netwerke **gestuur** word. Elke roete tabel bevat 'n stel re√´ls, bekend as roetes, wat spesifiseer hoe pakkies geroeteer moet word op grond van hul bestemmings-IP-adresse.

**Gebruiker Gedefinieerde Roetes (UDR)** in Azure is **aangepaste roetes wat jy binne Azure Roete Tabelle skep** om die **vloei van netwerkverkeer** binne en tussen Azure Virtuele Netwerke (VNets) en na eksterne verbindinge te beheer. UDR's gee jou die buigsaamheid om netwerkverkeer te rig volgens jou spesifieke vereistes, en oorskryf Azure se verstek roete besluite.

Hierdie roetes is veral nuttig vir scenario's waar jy verkeer **deur 'n virtuele toestel wil roeteer**, 'n spesifieke roete wil afdwing vir sekuriteit of beleidsnakoming, of wil integreer met plaaslike netwerke.

### **Voorbeeld**

* Stel jy het 'n Netwerk Virtuele Toestel (NVA) ge√Ømplementeer om verkeer tussen subnette binne 'n VNet te ondersoek. Jy kan 'n UDR skep wat al die verkeer van die een subnet na die ander subnet deur die NVA stuur. Hierdie UDR verseker dat die NVA die verkeer vir sekuriteitsdoeleindes ondersoek voordat dit sy bestemming bereik.

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# List Route Tables
az network route-table list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List UDRs for a table
az network route-table route list --route-table-name <RouteTableName> --resource-group <ResourceGroupName> --query "[].{name:name, addressPrefix:addressPrefix, nextHopType:nextHopType, nextHopIpAddress:nextHopIpAddress}" -o table
```
{% endcode %}

## Azure Privaat Skakel

Azure Privaat Skakel is 'n diens in Azure wat **privaat toegang tot Azure-dienste moontlik maak** deur te verseker dat **verkeer tussen jou Azure virtuele netwerk (VNet) en die diens heeltemal binne Microsoft se Azure ruggraatnetwerk plaasvind**. Dit bring die diens effektief in jou VNet in. Hierdie opset verbeter sekuriteit deur die data nie aan die openbare internet bloot te stel nie.

Privaat Skakel kan gebruik word met verskeie Azure-dienste, soos Azure Storage, Azure SQL-databasis, en aangepaste dienste wat gedeel word via Privaat Skakel. Dit bied 'n veilige manier om dienste van binne jou eie VNet te verbruik, of selfs vanuit verskillende Azure intekeninge.

{% hint style="danger" %}
NSGs is nie van toepassing op privaat eindpunte nie, wat duidelik beteken dat die assosiasie van 'n NSG met 'n subnet wat die Privaat Skakel bevat, geen effek sal h√™ nie.
{% endhint %}

### **Voorbeeld**

* Neem 'n scenario waar jy 'n **Azure SQL-databasis het wat jy veilig vanuit jou VNet wil benader**. Normaalweg mag dit beteken dat jy die openbare internet moet deursteek. Met Privaat Skakel kan jy 'n **privaat eindpunt in jou VNet skep** wat direk met die Azure SQL-databasisdiens verbind. Hierdie eindpunt laat die databasis voorkom asof dit deel is van jou eie VNet, toeganklik via 'n privaat IP-adres, en verseker dus veilige en private toegang.

### **Opsomming**

{% code overflow="wrap" %}
```bash
# List Private Link Services
z network private-link-service list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List Private Endpoints
az network private-endpoint list --query "[].{name:name, location:location, resourceGroup:resourceGroup, privateLinkServiceConnections:privateLinkServiceConnections}" -o table
```
{% endcode %}

## Azure Diens Eindpunte

Azure Diens Eindpunte brei jou virtuele netwerk se privaat adresruimte en die identiteit van jou VNet uit na Azure dienste oor 'n direkte verbinding. Deur diens eindpunte in te skakel, kan **hulpbronne in jou VNet veilig verbind met Azure dienste**, soos Azure Storage en Azure SQL Database, deur gebruik te maak van Azure se ruggraatnetwerk. Dit verseker dat die **verkeer van die VNet na die Azure-diens binne die Azure-netwerk bly**, wat 'n veiliger en betroubaarder pad bied.

### **Voorbeeld**

* Byvoorbeeld, 'n **Azure Storage**-rekening is standaard toeganklik oor die openbare internet. Deur 'n **diens eindpunt vir Azure Storage binne jou VNet in te skakel**, kan jy verseker dat slegs verkeer van jou VNet toegang tot die stoorrekening het. Die stoorrekening se vuurmuur kan dan gekonfigureer word om slegs verkeer van jou VNet te aanvaar.

### **Opsomming**

{% code overflow="wrap" %}
```bash
# List Virtual Networks with Service Endpoints
az network vnet list --query "[].{name:name, location:location, serviceEndpoints:serviceEndpoints}" -o table

# List Subnets with Service Endpoints
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, serviceEndpoints:serviceEndpoints}" -o table
```
{% endcode %}

### Verskille tussen Diens-eindpunte en Privaat Skakels

Microsoft beveel aan om Privaat Skakels te gebruik in die [**dokumentasie**](https://learn.microsoft.com/en-us/azure/virtual-network/vnet-integration-for-azure-services#compare-private-endpoints-and-service-endpoints):\


<figure><img src="../../../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

**Diens-eindpunte:**

* Verkeer vanaf jou VNet na die Azure-diens reis oor die Microsoft Azure ruggraatnetwerk en omseil die openbare internet.
* Die eindpunt is 'n direkte verbinding na die Azure-diens en verskaf nie 'n privaat IP vir die diens binne die VNet nie.
* Die diens self is steeds toeganklik via sy openbare eindpunt van buite jou VNet, tensy jy die diens se vuurmuur configureer om sulke verkeer te blokkeer.
* Dit is 'n een-tot-een-verhouding tussen die subnet en die Azure-diens.
* Goedkoper as Privaat Skakels.

**Privaat Skakels:**

* Privaat Skakel karteer Azure-diens na jou VNet via 'n privaat eindpunt, wat 'n netwerkinterface met 'n privaat IP-adres binne jou VNet is.
* Die Azure-diens word benader deur hierdie privaat IP-adres te gebruik, sodat dit lyk asof dit deel is van jou netwerk.
* Dienste wat via Privaat Skakel gekoppel is, kan slegs vanuit jou VNet of gekoppelde netwerke benader word; daar is geen openbare internettoegang tot die diens nie.
* Dit maak 'n veilige verbinding na Azure-diens of jou eie dienste wat in Azure gehuisves word, asook 'n verbinding na dienste wat deur ander gedeel word.
* Dit bied meer fynkorrelige toegangsbeheer via 'n privaat eindpunt in jou VNet, in teenstelling met bre√´r toegangsbeheer op subnetvlak met diens-eindpunte.

Opsommend, terwyl beide Diens-eindpunte en Privaat Skakels veilige konnektiwiteit na Azure-diens verskaf, **bied Privaat Skakels 'n ho√´r vlak van isolasie en sekuriteit deur te verseker dat dienste privaat benader word sonder om dit aan die openbare internet bloot te stel**. Diens-eindpunte is egter makliker om op te stel vir algemene gevalle waar eenvoudige, veilige toegang tot Azure-diens benodig word sonder die behoefte aan 'n privaat IP in die VNet.

## Azure Front Door (AFD) & AFD WAF

**Azure Front Door** is 'n skaalbare en veilige toegangspunt vir **vinnige aflewering** van jou globale webtoepassings. Dit **kombineer** verskeie dienste soos globale **balansering van vragte, versnelling van webwerwe, SSL-ontlasting en Web Application Firewall (WAF)**-vermo√´ns in 'n enkele diens. Azure Front Door bied intelligente roetebepaling gebaseer op die **nabygele√´ randlokasie vir die gebruiker**, wat optimale prestasie en betroubaarheid verseker. Daarbenewens bied dit URL-gebaseerde roetebepaling, gasheer van meervoudige webwerwe, sessie-affiniteit en toepassingslaag-sekuriteit.

**Azure Front Door WAF** is ontwerp om webtoepassings te **beskerm teen webgebaseerde aanvalle** sonder om die agterkantse kode te wysig. Dit sluit aanpasbare re√´ls en bestuurde re√´lreeks in om te beskerm teen bedreigings soos SQL-injeksie, kruisskripsing en ander algemene aanvalle.

### **Voorbeeld**

* Stel jou het 'n w√™reldwyd verspreide toepassing met gebruikers regoor die w√™reld. Jy kan Azure Front Door gebruik om gebruikersversoeke te **roeteer na die naaste streekse data-sentrum** wat jou toepassing huisves, en sodoende latentie te verminder, gebruikerservaring te verbeter en dit te **beskerm teen webaanvalle met die WAF-vermo√´ns**. As 'n spesifieke streek afbreek ervaar, kan Azure Front Door outomaties verkeer na die volgende beste lokasie omroeteer, wat ho√´ beskikbaarheid verseker.

### Enumerasie

{% code overflow="wrap" %}
```bash
# List Azure Front Door Instances
az network front-door list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List Front Door WAF Policies
az network front-door waf-policy list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table
```
{% endcode %}

## Azure Aansoekpoort en Azure Aansoekpoort WAF

Azure Aansoekpoort is 'n **webverkeer-lasbalanser** wat jou in staat stel om verkeer na jou **webtoepassings** te bestuur. Dit bied **Laag 7 lasbalansering, SSL-terminasie, en webtoepassingsmuur (WAF) vermo√´ns** in die Toepassingsafleweringskontroleerder (ADC) as 'n diens. Sleutelkenmerke sluit URL-gebaseerde roetes, koekie-gebaseerde sessie-affiniteit, en veilige sokkellaag (SSL) aflaai, wat noodsaaklik is vir toepassings wat komplekse lasbalanseringsvermo√´ns soos globale roetes en pad-gebaseerde roetes vereis.

### Voorbeeld

* Neem 'n scenario waar jy 'n e-handelswebwerf het wat verskeie subdomeine vir verskillende funksies insluit, soos gebruikersrekeninge en betalingsverwerking. Azure Aansoekpoort kan **verkeer na die toepaslike webbedieners roeteer op grond van die URL-pad**. Byvoorbeeld, verkeer na `voorbeeld.com/rekeninge` kan na die gebruikersrekeninge-diens gerig word, en verkeer na `voorbeeld.com/betaal` kan na die betalingsverwerkingsdiens gerig word.\
En **beskerm jou webwerf teen aanvalle deur die WAF-vermo√´ns te gebruik.**

### **Opname**

{% code overflow="wrap" %}
```bash
# List the Web Application Firewall configurations for your Application Gateways
az network application-gateway waf-config list --gateway-name <AppGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, firewallMode:firewallMode, ruleSetType:ruleSetType, ruleSetVersion:ruleSetVersion}" -o table
```
{% endcode %}

## Azure Hub, Spoke & VNet Peering

**VNet Peering** is 'n netwerkfunksie in Azure wat dit **moontlik maak om verskillende Virtuele Netwerke (VNets) direk en naadloos te koppel**. Deur middel van VNet-peering kan hulpbronne in een VNet kommunikeer met hulpbronne in 'n ander VNet deur gebruik te maak van private IP-adresse, **asof hulle in dieselfde netwerk is**.\
**VNet-peering kan ook gebruik word met 'n on-prem-netwerke** deur 'n site-to-site VPN of Azure ExpressRoute op te stel.

**Azure Hub en Spoke** is 'n netwerk-topologie wat in Azure gebruik word om netwerkverkeer te bestuur en te organiseer. **Die "hub" is 'n sentrale punt wat verkeer tussen verskillende "spokes" beheer en roeteer**. Die hub bevat tipies gedeelde dienste soos netwerk virtuele toestelle (NVAs), Azure VPN Gateway, Azure Firewall of Azure Bastion. Die **"spokes" is VNets wat werklaste huisves en met die hub verbind deur gebruik te maak van VNet-peering**, wat hulle in staat stel om die gedeelde dienste binne die hub te benut. Hierdie model bevorder 'n skoon netwerkopset, verminder kompleksiteit deur gemeenskaplike dienste wat deur verskeie werklaste oor verskillende VNets gebruik kan word, te sentraliseer.

{% hint style="danger" %}
**VNET-koppeling is nie-transitief in Azure nie**, wat beteken dat as spoke 1 met spoke 2 verbind is en spoke 2 met spoke 3 verbind is, kan spoke 1 nie direk met spoke 3 praat nie.
{% endhint %}

### Voorbeelde

* Stel jou 'n maatskappy voor met afsonderlike departemente soos Verkope, HR en Ontwikkeling, **elk met sy eie VNet (die spokes)**. Hierdie VNets **benodig toegang tot gedeelde hulpbronne** soos 'n sentrale databasis, 'n firewall en 'n internethek, wat almal in **'n ander VNet (die hub)** gele√´ is. Deur die gebruik van die Hub en Spoke-model kan elke departement **veilig verbind met die gedeelde hulpbronne deur die hub VNet sonder om daardie hulpbronne aan die openbare internet bloot te stel** of 'n komplekse netwerkstruktuur met talle verbindinge te skep.

### Enumerasie

{% code overflow="wrap" %}
```bash
# List all VNets in your subscription
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List VNet peering connections for a given VNet
az network vnet peering list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, peeringState:peeringState, remoteVnetId:remoteVnetId}" -o table

# List Shared Resources (e.g., Azure Firewall) in the Hub
az network firewall list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table
```
{% endcode %}

## Site-to-Site VPN

'n Site-to-Site VPN in Azure stel jou in staat om **jou on-premises netwerk te koppel aan jou Azure Virtual Network (VNet)**, wat beteken dat hulpbronne soos VMs binne Azure kan voorkom asof hulle op jou plaaslike netwerk is. Hierdie verbinding word tot stand gebring deur 'n **VPN-hek wat verkeer tussen die twee netwerke versleutel**.

### **Voorbeeld**

* 'n Besigheid met sy hoofkantoor in New York het 'n on-premises data sentrum wat veilig moet koppel aan sy VNet in Azure, waar sy gevirtualiseerde werklaste gehuisves word. Deur 'n **Site-to-Site VPN op te stel, kan die maatskappy verseker dat versleutelde konnektiwiteit tussen die on-premises bedieners en die Azure VMs** daar is, wat beteken dat hulpbronne veilig oor beide omgewings toeganklik is asof hulle in dieselfde plaaslike netwerk is.

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# List VPN Gateways
az network vnet-gateway list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List VPN Connections
az network vpn-connection list --gateway-name <VpnGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, connectionType:connectionType, connectionStatus:connectionStatus}" -o table
```
## Azure ExpressRoute

Azure ExpressRoute is 'n diens wat 'n **privaat, toegewyde, ho√´-spoed verbinding tussen jou on-premises infrastruktuur en Azure data sentrums** voorsien. Hierdie verbinding word deur 'n konnektiwiteitsverskaffer gemaak, wat die openbare internet omseil en meer betroubaarheid, vinniger spoed, laer latensie en ho√´r veiligheid as tipiese internetverbindinge bied.

### **Voorbeeld**

* 'n Multinasionale korporasie vereis 'n **konstante en betroubare verbinding met sy Azure dienste as gevolg van die ho√´ volume van data** en die behoefte aan ho√´ deurset. Die maatskappy kies vir Azure ExpressRoute om sy on-premises data sentrum direk met Azure te verbind, wat grootskaalse data-oordragte, soos daaglikse rugsteun en werklike tyd data-analise, met verbeterde privaatheid en spoed fasiliteer.

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# List ExpressRoute Circuits
az network express-route list --query "[].{name:name, location:location, resourceGroup:resourceGroup, serviceProviderName:serviceProviderName, peeringLocation:peeringLocation}" -o table
```
{% endcode %}

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
