# Az - ì„œë¹„ìŠ¤

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼** **íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **Hacking íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´ PRì„** [**HackTricks**](https://github.com/carlospolop/hacktricks) **ë°** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github ì €ì¥ì†Œì— ì œì¶œ**í•˜ì„¸ìš”.

</details>

## í¬í„¸

**Microsoft í¬í„¸ ëª©ë¡ì€** [**https://msportals.io/**](https://msportals.io/)ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Raw ìš”ì²­

#### Powershellì„ í†µí•œ Azure API

**IDENTITY\_HEADER** ë° **IDENTITY\_ENDPOINT**ì—ì„œ **access\_token**ì„ ê°€ì ¸ì˜µë‹ˆë‹¤: `system('curl "$IDENTITY_ENDPOINT?resource=https://management.azure.com/&api-version=2017-09-01" -H secret:$IDENTITY_HEADER');`.

ê·¸ëŸ° ë‹¤ìŒ Azure REST APIë¥¼ ì¿¼ë¦¬í•˜ì—¬ **êµ¬ë… ID** ë° ê¸°íƒ€ ì •ë³´ë¥¼ ì–»ìŠµë‹ˆë‹¤.
```powershell
$Token = 'eyJ0eX..'
$URI = 'https://management.azure.com/subscriptions?api-version=2020-01-01'
# $URI = 'https://graph.microsoft.com/v1.0/applications'
$RequestParams = @{
Method = 'GET'
Uri = $URI
Headers = @{
'Authorization' = "Bearer $Token"
}
}
(Invoke-RestMethod @RequestParams).value

# List resources and check for runCommand privileges
$URI = 'https://management.azure.com/subscriptions/b413826f-108d-4049-8c11-d52d5d388768/resources?api-version=2020-10-01'
$URI = 'https://management.azure.com/subscriptions/b413826f-108d-4049-8c11-d52d5d388768/resourceGroups/<RG-NAME>/providers/Microsoft.Compute/virtualMachines/<RESOURCE/providers/Microsoft.Authorization/permissions?apiversion=2015-07-01'
```
#### Azure APIë¥¼ ì‚¬ìš©í•˜ëŠ” Python ë²„ì „

To interact with Azure services using Python, you can make use of the Azure SDK for Python. This SDK provides a set of libraries and tools that allow you to easily access and manage various Azure services programmatically.

To get started, you will need to install the Azure SDK for Python. You can do this by running the following command:

```bash
pip install azure
```

Once the SDK is installed, you can import the necessary modules in your Python script to interact with Azure services. For example, to work with Azure Blob Storage, you can import the `azure.storage.blob` module:

```python
from azure.storage.blob import BlobServiceClient
```

You will also need to authenticate your Python script to access your Azure resources. This can be done by providing your Azure subscription credentials or by using Azure Active Directory (AAD) authentication.

To authenticate using your Azure subscription credentials, you can use the `DefaultAzureCredential` class from the `azure.identity` module:

```python
from azure.identity import DefaultAzureCredential

credential = DefaultAzureCredential()
```

Alternatively, you can authenticate using Azure Active Directory (AAD) authentication. This requires registering an application in Azure AD and obtaining a client ID and client secret. You can then use the `ClientSecretCredential` class from the `azure.identity` module:

```python
from azure.identity import ClientSecretCredential

tenant_id = "<your-tenant-id>"
client_id = "<your-client-id>"
client_secret = "<your-client-secret>"

credential = ClientSecretCredential(tenant_id, client_id, client_secret)
```

Once you have authenticated, you can create an instance of the Azure service client and start interacting with the service. For example, to create a BlobServiceClient instance for Azure Blob Storage, you can use the following code:

```python
blob_service_client = BlobServiceClient(account_url="<your-account-url>", credential=credential)
```

You can then use the methods provided by the Azure service client to perform various operations on the service. For example, to upload a file to Azure Blob Storage, you can use the `upload_blob` method:

```python
with open("<path-to-file>", "rb") as data:
    blob_service_client.upload_blob("<container-name>", "<blob-name>", data)
```

This is just a basic example of how to interact with Azure services using Python. The Azure SDK for Python provides a wide range of functionalities and features for working with different Azure services. You can refer to the official documentation for more information on how to use the SDK and its capabilities.
```python
IDENTITY_ENDPOINT = os.environ['IDENTITY_ENDPOINT']
IDENTITY_HEADER = os.environ['IDENTITY_HEADER']

print("[+] Management API")
cmd = 'curl "%s?resource=https://management.azure.com/&api-version=2017-09-01" -H secret:%s' % (IDENTITY_ENDPOINT, IDENTITY_HEADER)
val = os.popen(cmd).read()
print("Access Token: "+json.loads(val)["access_token"])
print("ClientID/AccountID: "+json.loads(val)["client_id"])

print("\r\n[+] Graph API")
cmd = 'curl "%s?resource=https://graph.microsoft.com/&api-version=2017-09-01" -H secret:%s' % (IDENTITY_ENDPOINT, IDENTITY_HEADER)
val = os.popen(cmd).read()
print(json.loads(val)["access_token"])
print("ClientID/AccountID: "+json.loads(val)["client_id"])
```
ë˜ëŠ” Python í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ:
```python
import logging, os
import azure.functions as func

def main(req: func.HttpRequest) -> func.HttpResponse:
logging.info('Python HTTP trigger function processed a request.')
IDENTITY_ENDPOINT = os.environ['IDENTITY_ENDPOINT']
IDENTITY_HEADER = os.environ['IDENTITY_HEADER']
cmd = 'curl "%s?resource=https://management.azure.com&apiversion=2017-09-01" -H secret:%s' % (IDENTITY_ENDPOINT, IDENTITY_HEADER)
val = os.popen(cmd).read()
return func.HttpResponse(val, status_code=200)
```
## ì„œë¹„ìŠ¤ ëª©ë¡

**ì´ ì„¹ì…˜ì˜ í˜ì´ì§€ëŠ” Azure ì„œë¹„ìŠ¤ë³„ë¡œ ì •ë ¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì—ì„œ ê° ì„œë¹„ìŠ¤ì— ëŒ€í•œ ì •ë³´(ì‘ë™ ë°©ì‹ ë° ê¸°ëŠ¥)ì™€ ê° ì„œë¹„ìŠ¤ë¥¼ ì—´ê±°í•˜ëŠ” ë°©ë²•ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.**

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ì„ í†µí•´ ì œë¡œë¶€í„° ì˜ì›…ì´ ë˜ê¸°ê¹Œì§€ AWS í•´í‚¹ì„ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

HackTricksë¥¼ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•:

* **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ë ¤ë©´ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **Hacking íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì„¸ìš”.

</details>
