# Az - ä¼ é€’Cookie

<details>

<summary><strong>æ”¯æŒHackTrickså¹¶è·å¾—ç¦åˆ©ï¼</strong></summary>

* å¦‚æœæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Šï¼Œæˆ–è€…å¦‚æœæ‚¨æƒ³è®¿é—®PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFç‰ˆæœ¬çš„HackTricksï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFT**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) **å’Œ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## ä¸ºä»€ä¹ˆä½¿ç”¨Cookieï¼Ÿ

æµè§ˆå™¨çš„**cookie**æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æœºåˆ¶ï¼Œå¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯å’Œå¤šå› ç´ è®¤è¯ï¼ˆMFAï¼‰ã€‚å› ä¸ºç”¨æˆ·å·²ç»åœ¨åº”ç”¨ç¨‹åºä¸­è¿›è¡Œäº†èº«ä»½éªŒè¯ï¼Œä¼šè¯**cookie**å¯ä»¥ç›´æ¥ç”¨äºä»¥è¯¥ç”¨æˆ·çš„èº«ä»½è®¿é—®æ•°æ®ï¼Œè€Œæ— éœ€é‡æ–°è¿›è¡Œèº«ä»½éªŒè¯ã€‚

æ‚¨å¯ä»¥åœ¨ä»¥ä¸‹ä½ç½®æ‰¾åˆ°**æµè§ˆå™¨cookieçš„ä½ç½®**ï¼š

{% embed url="https://book.hacktricks.xyz/generic-methodologies-and-resources/basic-forensic-methodology/specific-software-file-type-tricks/browser-artifacts?q=browse#google-chrome" %}

## æ”»å‡»

å…·æœ‰æŒ‘æˆ˜æ€§çš„éƒ¨åˆ†æ˜¯ï¼Œè¿™äº›**cookieæ˜¯åŠ å¯†çš„**ï¼Œä½¿ç”¨Microsoftæ•°æ®ä¿æŠ¤APIï¼ˆ**DPAPI**ï¼‰ä¸º**ç”¨æˆ·**åŠ å¯†ã€‚è¿™æ˜¯ä½¿ç”¨ä¸æ‰€å±ç”¨æˆ·ç›¸å…³çš„åŠ å¯†[å¯†é’¥](https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/dpapi-extracting-passwords)è¿›è¡ŒåŠ å¯†çš„ã€‚æ‚¨å¯ä»¥åœ¨ä»¥ä¸‹ä½ç½®æ‰¾åˆ°æœ‰å…³æ­¤çš„æ›´å¤šä¿¡æ¯ï¼š

{% embed url="https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/dpapi-extracting-passwords" %}

ä½¿ç”¨Mimikatzï¼Œæˆ‘å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æå–ç”¨æˆ·çš„cookieï¼Œå³ä½¿å®ƒä»¬æ˜¯åŠ å¯†çš„ï¼š
```bash
mimikatz.exe privilege::debug log "dpapi::chrome /in:%localappdata%\google\chrome\USERDA~1\default\cookies /unprotect" exit
```
<figure><img src="../../../.gitbook/assets/image (8) (3).png" alt=""><figcaption></figcaption></figure>

å¯¹äºAzureï¼Œæˆ‘ä»¬å…³å¿ƒçš„æ˜¯åŒ…æ‹¬**`ESTSAUTH`**ã€**`ESTSAUTHPERSISTENT`**å’Œ**`ESTSAUTHLIGHT`**åœ¨å†…çš„èº«ä»½éªŒè¯cookieã€‚ä½ å¯ä»¥çœ‹åˆ°è¿™äº›cookieæ˜¯å­˜åœ¨çš„ï¼Œå› ä¸ºç”¨æˆ·æœ€è¿‘åœ¨Azureä¸Šæ´»åŠ¨è¿‡ï¼š

<figure><img src="../../../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

åªéœ€å¯¼èˆªåˆ°login.microsoftonline.comå¹¶æ·»åŠ cookie **`ESTSAUTHPERSISTENT`**ï¼ˆç”±â€œä¿æŒç™»å½•çŠ¶æ€â€é€‰é¡¹ç”Ÿæˆï¼‰æˆ–**`ESTSAUTH`**ã€‚ç„¶åä½ å°†è¢«è®¤è¯ã€‚

## å‚è€ƒèµ„æ–™

* [https://stealthbits.com/blog/bypassing-mfa-with-pass-the-cookie/](https://stealthbits.com/blog/bypassing-mfa-with-pass-the-cookie/)

<details>

<summary><strong>æ”¯æŒHackTrickså¹¶è·å¾—ç¦åˆ©ï¼</strong></summary>

* å¦‚æœä½ æƒ³çœ‹åˆ°ä½ çš„**å…¬å¸åœ¨HackTricksä¸­è¢«å¹¿å‘Š**ï¼Œæˆ–è€…å¦‚æœä½ æƒ³è®¿é—®**PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å¾—[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFT**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘åœ¨**Twitter**ä¸Šçš„ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) **å’Œ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **githubä»“åº“æäº¤PRæ¥åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§ã€‚**

</details>
