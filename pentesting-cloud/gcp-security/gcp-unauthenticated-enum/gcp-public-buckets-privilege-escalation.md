# GCP - ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒã‚±ãƒƒãƒˆæ¨©é™æ˜‡æ ¼

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)ã§AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricksã«ã‚ãªãŸã®ä¼šç¤¾ã‚’åºƒå‘Šã—ãŸã„**ã€ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã«**å‚åŠ ã™ã‚‹**ã‹ã€[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹**ã€‚
* [**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’å…±æœ‰ã™ã‚‹ã€‚

</details>

## ãƒã‚±ãƒƒãƒˆæ¨©é™æ˜‡æ ¼

ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ãŒâ€œallUsersâ€ã¾ãŸã¯â€œallAuthenticatedUsersâ€ã«**ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã¸ã®æ›¸ãè¾¼ã¿**ï¼ˆ**storage.buckets.setIamPolicy**æ¨©é™ï¼‰ã‚’è¨±å¯ã—ã¦ã„ã‚‹å ´åˆã€èª°ã§ã‚‚ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã‚’å¤‰æ›´ã—ã¦è‡ªåˆ†è‡ªèº«ã«å®Œå…¨ãªã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’ä»˜ä¸ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### æ¨©é™ã®ç¢ºèª

ãƒã‚±ãƒƒãƒˆã«å¯¾ã™ã‚‹æ¨©é™ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•ã¯2ã¤ã‚ã‚Šã¾ã™ã€‚1ã¤ç›®ã¯ã€`https://www.googleapis.com/storage/v1/b/BUCKET_NAME/iam`ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹ã‹ã€`gsutil iam get gs://BUCKET_NAME`ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§æ¨©é™ã‚’å°‹ã­ã‚‹æ–¹æ³•ã§ã™ã€‚

ã—ã‹ã—ã€ã‚ãªãŸã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆ"allUsers"ã¾ãŸã¯"allAuthenticatedUsers"ã«å±ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼‰ãŒãƒã‚±ãƒƒãƒˆã®iamãƒãƒªã‚·ãƒ¼ã‚’èª­ã‚€æ¨©é™ï¼ˆstorage.buckets.getIamPolicyï¼‰ã‚’æŒã£ã¦ã„ãªã„å ´åˆã€ãã‚Œã¯æ©Ÿèƒ½ã—ã¾ã›ã‚“ã€‚

å¸¸ã«æ©Ÿèƒ½ã™ã‚‹ã‚‚ã†ä¸€ã¤ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€æŒ‡å®šã•ã‚ŒãŸæ¨©é™ã‚’æŒã£ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€ãƒã‚±ãƒƒãƒˆã®testPermissionsã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™ã€‚ä¾‹ãˆã°ã€æ¬¡ã®URLã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ï¼š`https://www.googleapis.com/storage/v1/b/BUCKET_NAME/iam/testPermissions?permissions=storage.buckets.delete&permissions=storage.buckets.get&permissions=storage.buckets.getIamPolicy&permissions=storage.buckets.setIamPolicy&permissions=storage.buckets.update&permissions=storage.objects.create&permissions=storage.objects.delete&permissions=storage.objects.get&permissions=storage.objects.list&permissions=storage.objects.update`

### æ˜‡æ ¼

Google Storageã®CLIãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã‚ã‚‹â€œgsutilâ€ã‚’ä½¿ç”¨ã—ã¦ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã€â€œallAuthenticatedUsersâ€ã«â€œStorage Adminâ€ãƒ­ãƒ¼ãƒ«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’ä»˜ä¸ã—ã€ãƒã‚±ãƒƒãƒˆã«ä»˜ä¸ã•ã‚ŒãŸæ¨©é™ã‚’**æ˜‡æ ¼**ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š
```
gsutil iam ch group:allAuthenticatedUsers:admin gs://BUCKET_NAME
```
LegacyBucketOwnerã‹ã‚‰Storage Adminã¸ã®æ¨©é™æ˜‡æ ¼ã®ä¸»ãªé­…åŠ›ã®ä¸€ã¤ã¯ã€ã€Œstorage.buckets.deleteã€æ¨©é™ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã“ã¨ã§ã™ã€‚ç†è«–çš„ã«ã¯ã€**æ¨©é™ã‚’æ˜‡æ ¼ã—ãŸå¾Œã«ãƒã‚±ãƒƒãƒˆã‚’å‰Šé™¤ã—ã€ãã®åå‰ã‚’ç›—ã‚€ãŸã‚ã«è‡ªåˆ†ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒã‚±ãƒƒãƒˆã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™**ã€‚

## å‚è€ƒæ–‡çŒ®

* [https://rhinosecuritylabs.com/gcp/google-cloud-platform-gcp-bucket-enumeration/](https://rhinosecuritylabs.com/gcp/google-cloud-platform-gcp-bucket-enumeration/)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)ã§</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§ã®AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã¶</strong></a><strong>ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricksã«ã‚ãªãŸã®ä¼šç¤¾ã‚’åºƒå‘Šã—ãŸã„**ã€ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã‚„[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ ã™ã‚‹**ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)ã§**ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹**ã€‚
* **HackTricks**ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’**å…±æœ‰ã™ã‚‹**ã€‚

</details>
