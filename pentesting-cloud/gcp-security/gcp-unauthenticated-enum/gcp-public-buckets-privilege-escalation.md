# GCP - å…¬å…±å­˜å‚¨æ¡¶æƒé™æå‡

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸º</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨å¸Œæœ›åœ¨**HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Š**æˆ–**ä»¥PDFæ ¼å¼ä¸‹è½½HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTsç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## å­˜å‚¨æ¡¶æƒé™æå‡

å¦‚æœå­˜å‚¨æ¡¶ç­–ç•¥å…è®¸â€œallUsersâ€æˆ–â€œallAuthenticatedUsersâ€ **å†™å…¥ä»–ä»¬çš„å­˜å‚¨æ¡¶ç­–ç•¥**ï¼ˆå³**storage.buckets.setIamPolicy**æƒé™ï¼‰ï¼Œé‚£ä¹ˆä»»ä½•äººéƒ½å¯ä»¥ä¿®æ”¹å­˜å‚¨æ¡¶ç­–ç•¥å¹¶æˆäºˆè‡ªå·±å®Œå…¨è®¿é—®æƒé™ã€‚

### æ£€æŸ¥æƒé™

æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥æ£€æŸ¥å¯¹å­˜å‚¨æ¡¶çš„æƒé™ã€‚ç¬¬ä¸€ç§æ˜¯é€šè¿‡å‘ `https://www.googleapis.com/storage/v1/b/BUCKET_NAME/iam` å‘å‡ºè¯·æ±‚æˆ–è¿è¡Œ `gsutil iam get gs://BUCKET_NAME` æ¥è¯·æ±‚å®ƒä»¬ã€‚

ç„¶è€Œï¼Œå¦‚æœæ‚¨çš„ç”¨æˆ·ï¼ˆå¯èƒ½å±äºallUsersæˆ–allAuthenticatedUsersï¼‰æ²¡æœ‰æƒé™è¯»å–å­˜å‚¨æ¡¶çš„iamç­–ç•¥ï¼ˆstorage.buckets.getIamPolicyï¼‰ï¼Œé‚£ä¹ˆè¿™å°†ä¸èµ·ä½œç”¨ã€‚

å¦ä¸€ä¸ªæ€»æ˜¯æœ‰æ•ˆçš„é€‰é¡¹æ˜¯ä½¿ç”¨å­˜å‚¨æ¡¶çš„testPermissionsç«¯ç‚¹æ¥ç¡®å®šæ‚¨æ˜¯å¦æ‹¥æœ‰æŒ‡å®šçš„æƒé™ï¼Œä¾‹å¦‚è®¿é—®ï¼š`https://www.googleapis.com/storage/v1/b/BUCKET_NAME/iam/testPermissions?permissions=storage.buckets.delete&permissions=storage.buckets.get&permissions=storage.buckets.getIamPolicy&permissions=storage.buckets.setIamPolicy&permissions=storage.buckets.update&permissions=storage.objects.create&permissions=storage.objects.delete&permissions=storage.objects.get&permissions=storage.objects.list&permissions=storage.objects.update`

### æƒé™æå‡

ä½¿ç”¨â€œgsutilâ€ Google Storage CLIç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°†â€œallAuthenticatedUsersâ€è®¿é—®æƒé™æå‡ä¸ºâ€œStorage Adminâ€è§’è‰²ï¼Œä»è€Œ**æå‡æˆ‘ä»¬è¢«æˆäºˆçš„å­˜å‚¨æ¡¶æƒé™**ï¼š
```
gsutil iam ch group:allAuthenticatedUsers:admin gs://BUCKET_NAME
```
ä»LegacyBucketOwnerå‡çº§åˆ°Storage Adminçš„ä¸»è¦å¸å¼•åŠ›ä¹‹ä¸€æ˜¯èƒ½å¤Ÿä½¿ç”¨â€œstorage.buckets.deleteâ€æƒé™ã€‚ç†è®ºä¸Šï¼Œä½ å¯ä»¥åœ¨æå‡æƒé™å**åˆ é™¤å­˜å‚¨æ¡¶ï¼Œç„¶ååœ¨ä½ è‡ªå·±çš„è´¦æˆ·ä¸­åˆ›å»ºåŒåå­˜å‚¨æ¡¶ä»¥çªƒå–åç§°**ã€‚

## å‚è€ƒèµ„æ–™

* [https://rhinosecuritylabs.com/gcp/google-cloud-platform-gcp-bucket-enumeration/](https://rhinosecuritylabs.com/gcp/google-cloud-platform-gcp-bucket-enumeration/)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸º</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœä½ æƒ³åœ¨HackTricksä¸Šçœ‹åˆ°ä½ çš„**å…¬å¸å¹¿å‘Š**æˆ–è€…**ä¸‹è½½HackTricksçš„PDFç‰ˆæœ¬**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså•†å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬ç‹¬å®¶çš„[**NFTç³»åˆ—**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Š**å…³æ³¨**æˆ‘ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥**åˆ†äº«ä½ çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
