# GCP - ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒã‚±ãƒƒãƒˆã®ç‰¹æ¨©ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

<details>

<summary><strong>ãƒãƒƒã‚¯ãƒˆãƒªãƒƒã‚¯ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ç‰¹å…¸ã‚’å¾—ã‚‹ï¼</strong></summary>

* ã‚‚ã— **HackTricks ã§ä¼šç¤¾ã‚’å®£ä¼ã—ãŸã„**å ´åˆã‚„ã€**PEASS ã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¦‹ãŸã„**å ´åˆã‚„ã€HackTricks ã‚’ **PDF ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼ã® PEASS & HackTricks ã‚¹ãƒ¯ãƒƒã‚°**](https://peass.creator-spring.com) ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ã‚’è¦‹ã¤ã‘ã¦ã€ç‹¬å çš„ãª [**NFT**](https://opensea.io/collection/the-peass-family) ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†
* ğŸ’¬ [**Discord ã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f) ã¾ãŸã¯ [**telegram ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass) ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm) ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¾ã—ã‚‡ã†ã€‚
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€PR ã‚’** [**HackTricks**](https://github.com/carlospolop/hacktricks) **ã¨** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **ã® GitHub ãƒªãƒã‚¸ãƒˆãƒªã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

## ãƒã‚±ãƒƒãƒˆã®ç‰¹æ¨©ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

ã‚‚ã—ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ãŒã€ŒallUsersã€ã¾ãŸã¯ã€ŒallAuthenticatedUsersã€ã«å¯¾ã—ã¦ã€Œãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã®æ›¸ãè¾¼ã¿ã€ï¼ˆ**storage.buckets.setIamPolicy** æ¨©é™ï¼‰ã‚’è¨±å¯ã—ã¦ã„ã‚‹å ´åˆã€èª°ã§ã‚‚ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ã‚’å¤‰æ›´ã—ã€è‡ªåˆ†è‡ªèº«ã«å®Œå…¨ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’ä»˜ä¸ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### æ¨©é™ã®ç¢ºèª

ãƒã‚±ãƒƒãƒˆã®æ¨©é™ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•ã¯2ã¤ã‚ã‚Šã¾ã™ã€‚æœ€åˆã®æ–¹æ³•ã¯ã€`https://www.googleapis.com/storage/v1/b/BUCKET_NAME/iam` ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã‹ã€`gsutil iam get gs://BUCKET_NAME` ã‚’å®Ÿè¡Œã—ã¦æ¨©é™ã‚’è¦æ±‚ã™ã‚‹ã“ã¨ã§ã™ã€‚

ãŸã ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆãŠãã‚‰ã allUsers ã¾ãŸã¯ allAuthenticatedUsers ã«æ‰€å±ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ï¼‰ãŒãƒã‚±ãƒƒãƒˆã® iam ãƒãƒªã‚·ãƒ¼ã‚’èª­ã¿å–ã‚‹æ¨©é™ï¼ˆstorage.buckets.getIamPolicyï¼‰ã‚’æŒã£ã¦ã„ãªã„å ´åˆã€ã“ã‚Œã¯æ©Ÿèƒ½ã—ã¾ã›ã‚“ã€‚

å¸¸ã«æ©Ÿèƒ½ã™ã‚‹ã‚‚ã†ä¸€ã¤ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€ãƒã‚±ãƒƒãƒˆã® testPermissions ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦æŒ‡å®šã•ã‚ŒãŸæ¨©é™ã‚’æŒã£ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã§ã™ã€‚ãŸã¨ãˆã°ã€æ¬¡ã®ã‚ˆã†ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ï¼š`https://www.googleapis.com/storage/v1/b/BUCKET_NAME/iam/testPermissions?permissions=storage.buckets.delete&permissions=storage.buckets.get&permissions=storage.buckets.getIamPolicy&permissions=storage.buckets.setIamPolicy&permissions=storage.buckets.update&permissions=storage.objects.create&permissions=storage.objects.delete&permissions=storage.objects.get&permissions=storage.objects.list&permissions=storage.objects.update`

### ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

ã€Œgsutilã€Google Storage CLI ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½¿ç”¨ã—ã¦ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ã€ŒallAuthenticatedUsersã€ã«ã€ŒStorage Adminã€ãƒ­ãƒ¼ãƒ«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’ä»˜ä¸ã—ã€ã—ãŸãŒã£ã¦ã€ãƒã‚±ãƒƒãƒˆã«ä»˜ä¸ã•ã‚ŒãŸç‰¹æ¨©ã‚’ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š
```
gsutil iam ch group:allAuthenticatedUsers:admin gs://BUCKET_NAME
```
LegacyBucketOwnerã‹ã‚‰Storage Adminã«æ˜‡æ ¼ã™ã‚‹ã“ã¨ã®ä¸»ãªé­…åŠ›ã¯ã€ã€Œstorage.buckets.deleteã€ç‰¹æ¨©ã‚’ä½¿ç”¨ã§ãã‚‹ã“ã¨ã§ã™ã€‚ç†è«–ä¸Šã€ç‰¹æ¨©ã‚’æ˜‡æ ¼ã•ã›ãŸå¾Œã«ãƒã‚±ãƒƒãƒˆã‚’å‰Šé™¤ã—ã€è‡ªåˆ†ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒã‚±ãƒƒãƒˆã‚’ä½œæˆã—ã¦åå‰ã‚’ç›—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚

## å‚è€ƒæ–‡çŒ®

* [https://rhinosecuritylabs.com/gcp/google-cloud-platform-gcp-bucket-enumeration/](https://rhinosecuritylabs.com/gcp/google-cloud-platform-gcp-bucket-enumeration/)

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

* ã‚‚ã—ã‚‚ã‚ãªãŸã®**ä¼šç¤¾ã‚’HackTricksã§å®£ä¼ã—ãŸã„**å ´åˆã‚„ã€**æœ€æ–°ç‰ˆã®PEASSã‚„HackTricksã®PDFã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼ã®PEASSï¼†HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ã€ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter**ã§ç§ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)
* **HackTricks**ã¨**HackTricks Cloud**ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¾ã—ã‚‡ã†ã€‚

</details>
