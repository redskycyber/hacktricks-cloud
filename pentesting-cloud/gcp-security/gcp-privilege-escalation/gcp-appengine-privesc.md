# GCP - AppEngine Privesc

<details>

<summary><strong>Nau캜ite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi na캜ini podr코ke HackTricks-u:

* Ako 쬰lite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvani캜ni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), na코u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## App Engine

Za vi코e informacija o App Engine-u pogledajte:

{% content-ref url="../gcp-services/gcp-app-engine-enum.md" %}
[gcp-app-engine-enum.md](../gcp-services/gcp-app-engine-enum.md)
{% endcontent-ref %}

### `appengine.applications.get`, `appengine.instances.get`, `appengine.instances.list`, `appengine.operations.get`, `appengine.operations.list`, `appengine.services.get`, `appengine.services.list`, `appengine.versions.create`, `appengine.versions.get`, `appengine.versions.list`, `cloudbuild.builds.get`,`iam.serviceAccounts.actAs`, `resourcemanager.projects.get`, `storage.objects.create`, `storage.objects.list`

To su potrebne dozvole za **implementaciju aplikacije kori코캖enjem `gcloud` cli-a**. Mo쬯a se **`get`** i **`list`** mogu **izbe캖i**.

Mo쬰te prona캖i primere Python koda na [https://github.com/GoogleCloudPlatform/python-docs-samples/tree/main/appengine](https://github.com/GoogleCloudPlatform/python-docs-samples/tree/main/appengine)

Podrazumevano, ime usluge aplikacije 캖e biti **`default`**, i mo쬰 postojati samo 1 instanca sa istim imenom.\
Da biste promenili to i kreirali drugu aplikaciju, u **`app.yaml`**, promenite vrednost klju캜a na ne코to poput **`service: my-second-app`**
```bash
cd python-docs-samples/appengine/flexible/hello_world
gcloud app deploy #Upload and start application inside the folder
```
Sa캜ekajte barem 10-15 minuta, ako ne uspe, pozovite **ponovno izvr코avanje jo코 nekoliko puta** i sa캜ekajte nekoliko minuta.

{% hint style="info" %}
**Mogu캖e je nazna캜iti Servisni nalog koji 캖e se koristiti**, ali se podrazumevano koristi podrazumevani SA za App Engine.
{% endhint %}

URL aplikacije je ne코to poput `https://<ime-projekta>.oa.r.appspot.com/` ili `https://<ime-servisa>-dot-<ime-projekta>.oa.r.appspot.com`

### `appengine.instances.enableDebug`, `appengine.instances.get`, `appengine.instances.list`, `appengine.operations.get`, `appengine.services.get`, `appengine.services.list`, `appengine.versions.get`, `appengine.versions.list`, `compute.projects.get`

Sa ovim dozvolama, mogu캖e je **prijaviti se putem ssh na instance App Engine** tipa **fleksibilne** (ne standardne). Neki od dozvola **`list`** i **`get`** **mo쬯a nisu zaista potrebni**.
```bash
gcloud app instances ssh --service <app-name> --version <version-id> <ID>
```
### `appengine.applications.update`, `appengine.operations.get`

Mislim da ovo samo menja pozadinski SA koji 캖e Google koristiti za postavljanje aplikacija, tako da ne mislim da mo쬰te zloupotrebiti ovo da biste ukrali nalog za usluge.

{% code overflow="wrap" %}
```bash
gcloud app update --service-account=<sa_email>
```
{% endcode %}

### `appengine.versions.getFileContents`, `appengine.versions.update`

Nisam siguran kako koristiti ove dozvole ili da li su korisne (napomena da kada promenite kod, nova verzija se kreira pa ne znam da li mo쬰te jednostavno a쬿rirati kod ili IAM ulogu jednog, ali pretpostavljam da biste trebali mo캖i, mo쬯a menjaju캖i kod unutar bucket-a??).

### Pristup za pisanje preko bucket-a

캛ak i sa pristupom za pisanje preko bucket-a gde se nalazi izvorni kod **NIJE BILO mogu캖e izvr코iti proizvoljni kod modifikuju캖i izvorni kod i `manifest.json`**.\
Mo쬯a ako pratite bucket i otkrijete trenutak kada se kreira nova verzija i kada se izvorni kod i manifest otpremaju, mo쬯a biste mogli da ih promenite tako da nova verzija koristi one sa zadnjim vratima??

Izgleda da su slojevi kontejnera tako캠e sme코teni u bucket-u, mo쬯a ih menjaju캖i?
