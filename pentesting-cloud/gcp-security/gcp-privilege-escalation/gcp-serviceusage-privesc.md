# GCP - Serviceusageç‰¹æƒå‡çº§

<details>

<summary><strong>æ”¯æŒHackTrickså¹¶è·å¾—ç¦åˆ©ï¼</strong></summary>

* å¦‚æœæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„å…¬å¸å¹¿å‘Šï¼Œæˆ–è€…å¦‚æœæ‚¨æƒ³è®¿é—®PEASSçš„æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFç‰ˆæœ¬çš„HackTricksï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFT**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) **å’Œ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

</details>

## serviceusage

ä»¥ä¸‹æƒé™å¯¹äºåˆ›å»ºå’Œçªƒå–APIå¯†é’¥éå¸¸æœ‰ç”¨ï¼Œä¸æ˜¯æ¥è‡ªæ–‡æ¡£çš„å†…å®¹ï¼š_APIå¯†é’¥æ˜¯ä¸€ä¸ªç®€å•çš„åŠ å¯†å­—ç¬¦ä¸²ï¼Œ**ç”¨äºæ ‡è¯†åº”ç”¨ç¨‹åºè€Œæ²¡æœ‰ä»»ä½•ä¸»ä½“**ã€‚å®ƒä»¬ç”¨äºåŒ¿åè®¿é—®**å…¬å…±æ•°æ®**ï¼Œå¹¶ç”¨äºå°†APIè¯·æ±‚ä¸æ‚¨çš„é¡¹ç›®å…³è”ä»¥è¿›è¡Œé…é¢å’Œ**è®¡è´¹**ã€‚_

å› æ­¤ï¼Œä½¿ç”¨APIå¯†é’¥å¯ä»¥è®©å…¬å¸ä¸ºæ‚¨ä½¿ç”¨APIä»˜è´¹ï¼Œä½†æ‚¨å°†æ— æ³•æå‡ç‰¹æƒã€‚

### `serviceusage.apiKeys.create`

è¿˜æœ‰ä¸€ç§ä¸GCP APIè¿›è¡Œèº«ä»½éªŒè¯çš„æ–¹æ³•ç§°ä¸ºAPIå¯†é’¥ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä»¬æ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å¯ä»¥è®¿é—®å®ƒä»¬æ‰€åœ¨çš„æ•´ä¸ªGCPé¡¹ç›®ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€äº‹å®ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„APIå¯†é’¥ï¼Œè¯¥å¯†é’¥å¯èƒ½æ¯”æˆ‘ä»¬è‡ªå·±çš„ç”¨æˆ·å…·æœ‰æ›´å¤šçš„ç‰¹æƒã€‚è¿™æ²¡æœ‰å®˜æ–¹çš„APIï¼Œå› æ­¤éœ€è¦å‘_https://apikeys.clients6.google.com/_ï¼ˆæˆ–_https://apikeys.googleapis.com/_ï¼‰å‘é€è‡ªå®šä¹‰HTTPè¯·æ±‚ã€‚è¿™æ˜¯é€šè¿‡åœ¨æµè§ˆGCP Webæ§åˆ¶å°æ—¶ç›‘è§†HTTPè¯·æ±‚å’Œå“åº”æ¥å‘ç°çš„ã€‚æœ‰å…³ä¸APIå¯†é’¥ç›¸å…³çš„é™åˆ¶çš„æ–‡æ¡£ï¼Œè¯·è®¿é—®[æ­¤é“¾æ¥](https://cloud.google.com/docs/authentication/api-keys)ã€‚

ä¸‹å›¾æ˜¾ç¤ºäº†å¦‚ä½•åœ¨Webæ§åˆ¶å°ä¸­åˆ›å»ºAPIå¯†é’¥ã€‚

![](https://rhinosecuritylabs.com/wp-content/uploads/2020/04/image6-1.png)

é€šè¿‡å‘ç°çš„æœªè®°å½•çš„APIï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡APIæœ¬èº«åˆ›å»ºAPIå¯†é’¥ã€‚

ä¸Šé¢çš„æˆªå›¾æ˜¾ç¤ºäº†å‘é€POSTè¯·æ±‚ä»¥æ£€ç´¢é¡¹ç›®çš„æ–°APIå¯†é’¥ã€‚

æ­¤æ–¹æ³•çš„åˆ©ç”¨è„šæœ¬å¯ä»¥åœ¨[æ­¤å¤„](https://github.com/RhinoSecurityLabs/GCP-IAM-Privilege-Escalation/blob/master/ExploitScripts/serviceusage.apiKeys.create.py)æ‰¾åˆ°ã€‚

### `serviceusage.apiKeys.list`

è¿˜å‘ç°äº†å¦ä¸€ä¸ªæœªè®°å½•çš„APIï¼Œç”¨äºåˆ—å‡ºå·²åˆ›å»ºçš„APIå¯†é’¥ï¼ˆè¿™ä¹Ÿå¯ä»¥åœ¨Webæ§åˆ¶å°ä¸­å®Œæˆï¼‰ã€‚å› ä¸ºåœ¨åˆ›å»ºAPIå¯†é’¥åä»ç„¶å¯ä»¥çœ‹åˆ°å…¶å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è·å–é¡¹ç›®ä¸­çš„æ‰€æœ‰APIå¯†é’¥ã€‚

![](https://rhinosecuritylabs.com/wp-content/uploads/2020/04/image4-1.png)

ä¸Šé¢çš„æˆªå›¾æ˜¾ç¤ºäº†è¯·æ±‚ä¸ä¹‹å‰å®Œå…¨ç›¸åŒï¼Œåªæ˜¯å°†POSTè¯·æ±‚æ›´æ”¹ä¸ºGETè¯·æ±‚ã€‚è¿™åªæ˜¾ç¤ºäº†ä¸€ä¸ªå¯†é’¥ï¼Œä½†å¦‚æœé¡¹ç›®ä¸­æœ‰å…¶ä»–å¯†é’¥ï¼Œå®ƒä»¬ä¹Ÿä¼šè¢«åˆ—å‡ºã€‚

æ­¤æ–¹æ³•çš„åˆ©ç”¨è„šæœ¬å¯ä»¥åœ¨[æ­¤å¤„](https://github.com/RhinoSecurityLabs/GCP-IAM-Privilege-Escalation/blob/master/ExploitScripts/serviceusage.apiKeys.list.py)æ‰¾åˆ°ã€‚

<details>

<summary><strong>æ”¯æŒHackTrickså¹¶è·å¾—ç¦åˆ©ï¼</strong></summary>

æ‚¨åœ¨**ç½‘ç»œå®‰å…¨å…¬å¸**å·¥ä½œå—ï¼Ÿæ‚¨æƒ³åœ¨HackTricksä¸­çœ‹åˆ°æ‚¨çš„**å…¬å¸å¹¿å‘Š**å—ï¼Ÿæˆ–è€…æ‚¨æƒ³è·å¾—PEASSçš„**æœ€æ–°ç‰ˆæœ¬æˆ–ä¸‹è½½PDFç‰ˆæœ¬çš„HackTricks**å—ï¼Ÿè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼

å‘ç°[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFT**](https://opensea.io/collection/the-peass-family)æ”¶è—å“

è·å–[**å®˜æ–¹PEASSå’ŒHackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)

**åŠ å…¥** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘çš„ **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/carlospolopm)**.**

**é€šè¿‡å‘** [**hacktricks githubä»“åº“**](https://github.com/carlospolop/hacktricks) **æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚**

**.**

</details>
