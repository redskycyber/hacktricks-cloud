# GCP - Serviceusage Privesc

<details>

<summary><strong>AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶ã«ã¯</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricksã«ã‚ãªãŸã®ä¼šç¤¾ã‚’åºƒå‘Šã—ãŸã„**ã€ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã«**å‚åŠ ã™ã‚‹**ã‹ã€[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹**ã€‚
* **HackTricks**ã®[**GitHubãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’å…±æœ‰ã™ã‚‹ã€‚

</details>

## serviceusage

ä»¥ä¸‹ã®æ¨©é™ã¯APIã‚­ãƒ¼ã‚’ä½œæˆã—ã€ç›—ã‚€ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‹ã‚‰ã®ã“ã®æ³¨è¨˜ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼š_APIã‚­ãƒ¼ã¯ã€**ä»»æ„ã®ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«ãªã—ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è­˜åˆ¥ã™ã‚‹**å˜ç´”ãªæš—å·åŒ–ã•ã‚ŒãŸæ–‡å­—åˆ—ã§ã™ã€‚**å…¬é–‹ãƒ‡ãƒ¼ã‚¿ã«åŒ¿åã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹**ãŸã‚ã«å½¹ç«‹ã¡ã€APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚¯ã‚©ãƒ¼ã‚¿ã¨**èª²é‡‘**ã®ãŸã‚ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«**é–¢é€£ä»˜ã‘ã‚‹**ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚_

ã—ãŸãŒã£ã¦ã€APIã‚­ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€APIã®ä½¿ç”¨æ–™é‡‘ã‚’ãã®ä¼šç¤¾ã«æ”¯æ‰•ã‚ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ãŒã€æ¨©é™ã‚’æ˜‡æ ¼ã•ã›ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚

ä»–ã®æ¨©é™ã¨APIã‚­ãƒ¼ã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•ã‚’å­¦ã¶ã«ã¯ã€ä»¥ä¸‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼š

{% content-ref url="gcp-apikeys-privesc.md" %}
[gcp-apikeys-privesc.md](gcp-apikeys-privesc.md)
{% endcontent-ref %}

### `serviceusage.apiKeys.create`

æ–‡æ›¸åŒ–ã•ã‚Œã¦ã„ãªã„APIãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã€‚ã“ã‚Œã‚’ä½¿ç”¨ã—ã¦**APIã‚­ãƒ¼ã‚’ä½œæˆ**ã§ãã¾ã™ï¼š

{% code overflow="wrap" %}
```bash
curl -XPOST "https://apikeys.clients6.google.com/v1/projects/<project-uniq-name>/apiKeys?access_token=$(gcloud auth print-access-token)"
```
{% endcode %}

### `serviceusage.apiKeys.list`

æ—¢ã«ä½œæˆã•ã‚ŒãŸAPIã‚­ãƒ¼ã‚’ãƒªã‚¹ãƒˆã™ã‚‹ãŸã‚ã®æ–‡æ›¸åŒ–ã•ã‚Œã¦ã„ãªã„APIãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸï¼ˆAPIã‚­ãƒ¼ã¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«è¡¨ç¤ºã•ã‚Œã¾ã™ï¼‰ï¼š

{% code overflow="wrap" %}
```bash
curl "https://apikeys.clients6.google.com/v1/projects/<project-uniq-name>/apiKeys?access_token=$(gcloud auth print-access-token)"
```
{% endcode %}

### **`serviceusage.services.enable`** , **`serviceusage.services.use`**

ã“ã‚Œã‚‰ã®æ¨©é™ã‚’æŒã¤æ”»æ’ƒè€…ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§æ–°ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ã‚’æœ‰åŠ¹ã«ã—ã¦ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€**æ”»æ’ƒè€…ãŒWorkspaceã®æƒ…å ±ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã‚ˆã†ã¨ã™ã‚‹ãŸã‚ã«adminã‚„cloudidentityã®ã‚ˆã†ãªã‚µãƒ¼ãƒ“ã‚¹ã‚’æœ‰åŠ¹ã«ã™ã‚‹**ã€ã¾ãŸã¯ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’æœ‰åŠ¹ã«ã—ã¦èˆˆå‘³æ·±ã„ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

## **å‚è€ƒæ–‡çŒ®**

* [https://rhinosecuritylabs.com/cloud-security/privilege-escalation-google-cloud-platform-part-2/](https://rhinosecuritylabs.com/cloud-security/privilege-escalation-google-cloud-platform-part-2/)

<details>

<summary><strong>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã—ã€ç‰¹å…¸ã‚’å¾—ã‚‹ï¼</strong></summary>

**ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼šç¤¾**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ**HackTricksã§ã‚ãªãŸã®ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

[**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¦ãã ã•ã„ã€‚ç§ãŸã¡ã®ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

[**å…¬å¼ã®PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

**[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã‚„[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ ã™ã‚‹ã‹ã€**Twitter**ã§ç§ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/carlospolopm)**ã€‚**

**ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€**[**hacktricks githubãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/carlospolop/hacktricks)ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

**ã€‚**

</details>
