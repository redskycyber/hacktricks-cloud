# GCP - Wyszukiwanie artefakt贸w

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** mnie na **Twitterze**  [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)
* &#x20;repozytoria github.

</details>

## Podstawowe informacje

Google Cloud Artifact Registry to w peni zarzdzana usuga, kt贸ra umo偶liwia **zarzdzanie, przechowywanie i zabezpieczanie artefakt贸w oprogramowania**. Jest to w zasadzie repozytorium do **przechowywania zale偶noci budowania**, takich jak obrazy **Docker**, pakiety **Maven**, paczki npm i inne rodzaje artefakt贸w. Jest **powszechnie u偶ywane w potokach CI/CD** do przechowywania i wersjonowania artefakt贸w produkowanych podczas procesu tworzenia oprogramowania.

G贸wne cechy Artifact Registry to:

1. **Jednolite repozytorium**: Obsuguje **wiele rodzaj贸w artefakt贸w**, umo偶liwiajc posiadanie jednego repozytorium dla obraz贸w Docker, pakiet贸w jzykowych (takich jak Maven dla Javy, npm dla Node.js) i innych rodzaj贸w artefakt贸w, zapewniajc jednolite kontrol dostpu i jednolite widoki wszystkich artefakt贸w.
2. **W peni zarzdzane**: Jako usuga zarzdzana, zajmuje si infrastruktur, skalowaniem i zabezpieczeniami, zmniejszajc nakad konserwacji dla u偶ytkownik贸w.
3. **Precyzyjna kontrola dostpu**: Integruje si z zarzdzaniem to偶samoci i dostpem (IAM) w Google Cloud, umo偶liwiajc okrelenie, kto mo偶e uzyska dostp, przesya lub pobiera artefakty z repozytori贸w.
4. **Replikacja geograficzna**: Obsuguje replikacj artefakt贸w w wielu regionach, poprawiajc prdko pobierania i zapewniajc dostpno.
5. **Integracja z usugami Google Cloud**: Dziaa bezproblemowo z **innymi usugami GCP, takimi jak Cloud Build, Kubernetes Engine i Compute Engine**, co czyni go wygodnym wyborem dla zespo贸w ju偶 pracujcych w ekosystemie Google Cloud.
6. **Bezpieczestwo**: Oferuje funkcje takie jak **skanowanie podatnoci i analiza kontener贸w**, aby zapewni, 偶e przechowywane artefakty s bezpieczne i wolne od znanych problem贸w zwizanych z bezpieczestwem.

### Formaty i tryby

Podczas tworzenia nowego repozytorium mo偶na **wybra format/typ** repozytorium spor贸d kilku opcji, takich jak Docker, Maven, npm, Python... oraz tryb, kt贸ry zazwyczaj mo偶e by jednym z tych trzech:

* **Standardowe repozytorium**: Tryb domylny do **przechowywania wasnych artefakt贸w** (takich jak obrazy Docker, pakiety Maven) bezporednio w GCP. Jest bezpieczne, skalowalne i dobrze integruje si z ekosystemem Google Cloud.
* **Repozytorium zdalne** (jeli dostpne): Dziaa jako proxy do **buforowania artefakt贸w z zewntrznych**, publicznych repozytori贸w. Pomaga zapobiega problemom wynikajcym z zmian w zale偶nociach w g贸r strumienia i redukuje op贸藕nienia poprzez buforowanie czsto u偶ywanych artefakt贸w.
* **Repozytorium wirtualne** (jeli dostpne): Zapewnia **jednolite interfejsy dostpu do wielu (standardowych lub zdalnych) repozytori贸w** za pomoc jednego punktu kocowego, upraszczajc konfiguracj po stronie klienta i zarzdzanie dostpem do artefakt贸w rozproszonych w r贸偶nych repozytoriach.
* W przypadku repozytorium wirtualnego bdziesz musia **wybra repozytoria i nada im priorytet** (repozytorium o najwy偶szym priorytecie bdzie u偶ywane).
* Mo偶esz **miesza zdalne i standardowe** repozytoria w jednym **wirtualnym**, jeli **priorytet** dla **zdalnego** jest **wy偶szy** ni偶 dla standardowego, **u偶ywane bd paczki z repozytorium zdalnego (np. PyPi)**. Mo偶e to prowadzi do **konfuzji zale偶noci**.

Nale偶y zauwa偶y, 偶e w **zdalnej wersji Docker** mo偶na poda nazw u偶ytkownika i token dostpu do Docker Hub. **Token jest nastpnie przechowywany w Secret Managerze**.

### Szyfrowanie

Jak mo偶na si spodziewa, domylnie u偶ywany jest zarzdzany przez Google klucz, ale mo偶na wskaza klucz zarzdzany przez klienta (CMEK).

### Polityki czyszczenia

* **Usu artefakty:** Artefakty zostan **usunite zgodnie z kryteriami polityki czyszczenia**.
* **Symulacja:** (Domylna) Artefakty **nie zostan usunite**. Polityki czyszczenia zostan ocenione, a testowe zdarzenia usuwania zostan wysane do Cloud Audit Logging.

### Skanowanie podatnoci

Mo偶liwe jest wczenie **skanera podatnoci**, kt贸ry sprawdzi podatnoci wewntrz **obraz贸w kontener贸w**.

### Wyliczanie
```bash
# Get repositories
gcloud artifacts repositories list
gcloud artifacts repositories describe --location <location> <repo-name>
gcloud artifacts versions list --repository=<repo-name> -location <location> --package <package-name>

# Get settings of a repository (example using python but could be other)
gcloud artifacts print-settings python --repository <repo-name> --location <location>

# Get docker images
gcloud artifacts docker images list us-central1-docker.pkg.dev/<proj-name>/<repo-name>

# Get packages (like python and others...)
gcloud artifacts packages list --repository <repo-name> --location <location>

# Get SBOMB artifacts
gcloud artifacts sbom list

# Get vulnerabilities (docker images)
gcloud artifacts vulnerabilities list us-east1-docker.pkg.dev/project123/repository123/someimage@sha256:49765698074d6d7baa82f
gcloud artifacts docker images list-vulnerabilities projects/<proj-name>/locations/<location>/scans/<scan-uuid>
```
### Eskalacja uprawnie

{% content-ref url="../gcp-privilege-escalation/gcp-artifact-registry-privesc.md" %}
[gcp-artifact-registry-privesc.md](../gcp-privilege-escalation/gcp-artifact-registry-privesc.md)
{% endcontent-ref %}

### Nieuwierzytelniony dostp

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-artifact-registry-unauthenticated-enum.md" %}
[gcp-artifact-registry-unauthenticated-enum.md](../gcp-unaunthenticated-enum-and-access/gcp-artifact-registry-unauthenticated-enum.md)
{% endcontent-ref %}

### Po eksploatacji

{% content-ref url="../gcp-post-exploitation/gcp-artifact-registry-post-exploitation.md" %}
[gcp-artifact-registry-post-exploitation.md](../gcp-post-exploitation/gcp-artifact-registry-post-exploitation.md)
{% endcontent-ref %}

### Trwao

{% content-ref url="../gcp-persistence/gcp-artifact-registry-persistence.md" %}
[gcp-artifact-registry-persistence.md](../gcp-persistence/gcp-artifact-registry-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** mnie na **Twitterze**  [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
