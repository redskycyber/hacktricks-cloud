# GCP - Pub/Sub

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) ã‚’ä½¿ã£ã¦ AWS ãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶</strong></summary>

HackTricks ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricks ã«ã‚ãªãŸã®ä¼šç¤¾ã‚’åºƒå‘Šã—ãŸã„**ã€ã¾ãŸã¯ **HackTricks ã‚’ PDF ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼ã® PEASS & HackTricks ã‚°ãƒƒã‚º**](https://peass.creator-spring.com) ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª [**NFT**](https://opensea.io/collection/the-peass-family) ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹
* ğŸ’¬ [**Discord ã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f) ã«**å‚åŠ ã™ã‚‹**ã‹ã€[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass) ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm) ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹**ã€‚
* **HackTricks** ã® GitHub ãƒªãƒã‚¸ãƒˆãƒª [**HackTricks**](https://github.com/carlospolop/hacktricks) ã¨ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ã« PR ã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’å…±æœ‰ã™ã‚‹ã€‚

</details>

## Pub/Sub <a href="#reviewing-cloud-pubsub" id="reviewing-cloud-pubsub"></a>

Google [**Cloud Pub/Sub**](https://cloud.google.com/pubsub/) ã¯ã€ç‹¬ç«‹ã—ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡Œãæ¥ã•ã›ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚åŸºæœ¬çš„ã«ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€å—ä¿¡ã‚’è¡Œã†ãŸã‚ã«**è³¼èª­**ã™ã‚‹**ãƒˆãƒ”ãƒƒã‚¯**ãŒã‚ã‚Šã¾ã™ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯å†…å®¹ã¨ã„ãã¤ã‹ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ï¼‰ã€‚

**ãƒˆãƒ”ãƒƒã‚¯ã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé€ä¿¡ã•ã‚Œã‚‹ã‚­ãƒ¥ãƒ¼**ã§ã‚ã‚Šã€**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³**ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ**ãƒˆãƒ”ãƒƒã‚¯å†…ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**ã§ã™ã€‚ãƒˆãƒ”ãƒƒã‚¯ã”ã¨ã«**1ã¤ä»¥ä¸Šã®ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³**ãŒå­˜åœ¨ã—ã€ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã«ã¯3ç¨®é¡ãŒã‚ã‚Šã¾ã™ï¼š

* **Pull**: ã“ã®ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ—ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
* **Push**: URL ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒæŒ‡å®šã•ã‚Œã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ç›´ã¡ã«ãã“ã«é€ä¿¡ã•ã‚Œã¾ã™ã€‚
* **Big query table**: Push ã¨åŒæ§˜ã§ã™ãŒã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ Big query ãƒ†ãƒ¼ãƒ–ãƒ«å†…ã«è¨­å®šã—ã¾ã™ã€‚

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**ã§ã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯**7æ—¥é–“ä¿æŒã•ã‚Œã¾ã™**ãŒã€ã“ã®æ™‚é–“ã¯**æœ€å¤§31æ—¥ã¾ã§å»¶é•·å¯èƒ½**ã§ã™ã€‚ã¾ãŸã€10ç§’ä»¥å†…ã«**ACKã•ã‚Œãªã„å ´åˆ**ã¯ã‚­ãƒ¥ãƒ¼ã«æˆ»ã‚Šã¾ã™ã€‚

ãƒˆãƒ”ãƒƒã‚¯ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§**Google ç®¡ç†ã®æš—å·åŒ–ã‚­ãƒ¼**ã‚’ä½¿ç”¨ã—ã¦æš—å·åŒ–ã•ã‚Œã¾ã™ã€‚ã—ã‹ã—ã€KMS ã®**CMEK**ï¼ˆCustomer Managed Encryption Keyï¼‰ã‚‚é¸æŠã§ãã¾ã™ã€‚

**ãƒ‡ãƒƒãƒ‰ãƒ¬ã‚¿ãƒ¼**: ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã¯**æœ€å¤§é…ä¿¡è©¦è¡Œå›æ•°**ã‚’è¨­å®šã§ãã¾ã™ã€‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé…ä¿¡ã§ããªã„å ´åˆã€**æŒ‡å®šã•ã‚ŒãŸãƒ‡ãƒƒãƒ‰ãƒ¬ã‚¿ãƒ¼ãƒˆãƒ”ãƒƒã‚¯ã«å†å…¬é–‹ã•ã‚Œã¾ã™**ã€‚

### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ã‚¹ã‚­ãƒ¼ãƒ

ãƒˆãƒ”ãƒƒã‚¯ã«ã¯**ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã€ãã“ã«ã¯ã‚ˆã‚Šå¤šãã®**å¤ã„æ©Ÿå¯†æƒ…å ±**ãŒè¦‹ã¤ã‹ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¯ã€å–å¾—ã•ã‚ŒãŸæ™‚ç‚¹ã®**æœªACKã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**ã¨ãã®å¾Œã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿æŒã—ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯1é€±é–“ç”Ÿå­˜ã—ã¾ã™ã€‚

ãƒˆãƒ”ãƒƒã‚¯ã‚’ä½œæˆã™ã‚‹éš›ã«ã€**ãƒˆãƒ”ãƒƒã‚¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚¹ã‚­ãƒ¼ãƒã«å¾“ã†å¿…è¦ãŒã‚ã‚‹**ã¨æŒ‡å®šã§ãã¾ã™ã€‚

### åˆ—æŒ™
```bash
# Get a list of topics in the project
gcloud pubsub topics list
gcloud pubsub topics describe <topic>
gcloud pubsub topics list-subscriptions <topic>
gcloud pubsub topics get-iam-policy <topic>

# Get a list of subscriptions across all topics
gcloud pubsub subscriptions list
gcloud pubsub subscriptions describe <subscription>
gcloud pubsub subscriptions get-iam-policy <subscription>

# Get list of schemas
gcloud pubsub schemas list
gcloud pubsub schemas describe <snapshot>

# Get list of snapshots
gcloud pubsub snapshots list
gcloud pubsub snapshots describe <snapshot>
```
### ãƒã‚¹ãƒˆã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆ

{% code overflow="wrap" %}
```bash
# Publish a message in a topic
gcloud pubsub topics publish <topic_name> --message "Hello!"

# This will retrive a non ACKed message (and won't ACK it)
gcloud pubsub subscriptions create my_subscription --topic <topic_name>
gcloud pubsub subscriptions pull <FULL SUBSCRIPTION NAME>

# Crete push subscription and recieve all the messages instantly in your web server
gcloud pubsub subscriptions create <subscription name> --topic <topic name> --push-endpoint <URL to push to>
```
{% endcode %}

## Pub/Sub Lite

[**Pub/Sub Lite**](https://cloud.google.com/pubsub/docs/choosing-pubsub-or-lite)ã¯ã€**ã‚¾ãƒ¼ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**ã‚’æŒã¤ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚Pub/Sub Liteã®ã‚³ã‚¹ãƒˆã¯Pub/Subã®**ä¸€éƒ¨**ã§ã‚ã‚Šã€ä½ã‚³ã‚¹ãƒˆãŒä¸»è¦ãªè€ƒæ…®äº‹é …ã§ã‚ã‚‹**é«˜ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°**ï¼ˆç§’é–“æœ€å¤§1000ä¸‡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚„ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å‹ã‚·ã‚¹ãƒ†ãƒ ã«é©ã—ã¦ã„ã¾ã™ã€‚

PubSub Liteã«ã¯**ãƒˆãƒ”ãƒƒã‚¯**ã¨**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³**ãŒã‚ã‚Šã¾ã™ãŒã€**ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**ã‚„**ã‚¹ã‚­ãƒ¼ãƒ**ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ä»¥ä¸‹ã®æ©Ÿèƒ½ãŒã‚ã‚Šã¾ã™ï¼š

* **ãƒªã‚¶ãƒ™ãƒ¼ã‚·ãƒ§ãƒ³**: Pub/Sub Liteãƒªã‚¶ãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç‰¹å®šã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®å®¹é‡ã‚’äºˆç´„ã™ã‚‹æ©Ÿèƒ½ã§ã™ã€‚
* **ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**: Pub/Sub Liteã®ç®¡ç†ã¨é‹ç”¨ã«é–¢ã‚ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚„ã‚¿ã‚¹ã‚¯ã‚’æŒ‡ã—ã¾ã™ã€‚

### åˆ—æŒ™
```bash
# lite-topics
gcloud pubsub lite-topics list
gcloud pubsub lite-topics describe <topic>
gcloud pubsub lite-topics list-subscriptions <topic>

# lite-subscriptions
gcloud pubsub lite-subscriptions list
gcloud pubsub lite-subscriptions describe <subscription>

# lite-reservations
gcloud pubsub lite-reservations list
gcloud pubsub lite-reservations describe <topic>
gcloud pubsub lite-reservations list-topics <topic>

# lite-operations
gcloud pubsub lite-operations list
gcloud pubsub lite-operations describe <topic>
```
<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)ã§ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§ã®AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã¶</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricksã«ã‚ãªãŸã®ä¼šç¤¾ã‚’åºƒå‘Šã—ãŸã„å ´åˆ**ã‚„**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„å ´åˆ**ã¯ã€[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã‚„[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ ã™ã‚‹**ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)ã§**ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹**ã€‚
* [**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’**å…±æœ‰ã™ã‚‹**ã€‚

</details>
