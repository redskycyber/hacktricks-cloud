# GCP - Depolama Enumerasyonu

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya HackTricks'i **PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzdaki Ã¶zel [**NFT'leri**](https://opensea.io/collection/the-peass-family) keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

## Depolama

Google Cloud Platform (GCP) Depolama, yapÄ±landÄ±rÄ±lmamÄ±ÅŸ veriler iÃ§in **yÃ¼ksek dayanÄ±klÄ±lÄ±ÄŸa ve kullanÄ±labilirliÄŸe sahip bulut tabanlÄ± bir depolama Ã§Ã¶zÃ¼mÃ¼** saÄŸlar. Standart, Nearline, Coldline ve Archive olmak Ã¼zere performans, kullanÄ±labilirlik ve maliyet temelinde Ã§eÅŸitli depolama sÄ±nÄ±flarÄ± sunar. GCP Depolama, verileri etkili bir ÅŸekilde yÃ¶netmek ve gÃ¼vence altÄ±na almak iÃ§in **yaÅŸam dÃ¶ngÃ¼sÃ¼ politikalarÄ±, sÃ¼rÃ¼mleme ve eriÅŸim kontrolÃ¼** gibi geliÅŸmiÅŸ Ã¶zellikler de sunar.

Kova bir bÃ¶lgede, 2 bÃ¶lgede veya **Ã§oklu bÃ¶lgede (varsayÄ±lan olarak)** depolanabilir.

### Depolama TÃ¼rleri

* **Standart Depolama**: Bu, sÄ±k eriÅŸilen verilere **yÃ¼ksek performanslÄ±, dÃ¼ÅŸÃ¼k gecikmeli eriÅŸim** sunan varsayÄ±lan depolama seÃ§eneÄŸidir. Web sitesi iÃ§eriÄŸi sunma, medya akÄ±ÅŸÄ± ve veri analitiÄŸi boru hatlarÄ± barÄ±ndÄ±rma gibi geniÅŸ bir kullanÄ±m durumu iÃ§in uygundur.
* **Nearline Depolama**: Bu depolama sÄ±nÄ±fÄ±, Standart Depolama'ya gÃ¶re **daha dÃ¼ÅŸÃ¼k depolama maliyetleri** ve **biraz daha yÃ¼ksek eriÅŸim maliyetleri** sunar. En az 30 gÃ¼nlÃ¼k bir depolama sÃ¼resiyle seyrek eriÅŸilen veriler iÃ§in optimize edilmiÅŸtir. Yedekleme ve arÅŸivleme amaÃ§larÄ± iÃ§in uygundur.
* **Coldline Depolama**: Bu depolama sÄ±nÄ±fÄ±, **seyrek eriÅŸilen verilerin uzun sÃ¼reli depolanmasÄ±** iÃ§in optimize edilmiÅŸtir ve en az 90 gÃ¼nlÃ¼k bir depolama sÃ¼resine sahiptir. Nearline Depolama'ya gÃ¶re **daha dÃ¼ÅŸÃ¼k depolama maliyetleri**, ancak **daha yÃ¼ksek eriÅŸim maliyetleri** sunar.
* **Archive Depolama**: Bu depolama sÄ±nÄ±fÄ±, **Ã§ok seyrek eriÅŸilen soÄŸuk veriler** iÃ§in tasarlanmÄ±ÅŸ olup, en az 365 gÃ¼nlÃ¼k bir depolama sÃ¼resine sahiptir. TÃ¼m GCP depolama seÃ§eneklerinin **en dÃ¼ÅŸÃ¼k depolama maliyetlerini** sunar, ancak **en yÃ¼ksek eriÅŸim maliyetleri** ile birlikte gelir. Uyumluluk veya dÃ¼zenleyici gereksinimler nedeniyle uzun sÃ¼reli veri saklama iÃ§in uygundur.
* **Otomatik SÄ±nÄ±flandÄ±rma**: Veriye ne kadar eriÅŸeceÄŸinizi **bilmiyorsanÄ±z**, Otomatik SÄ±nÄ±flandÄ±rmayÄ± seÃ§ebilir ve GCP, maliyetleri en aza indirmek iÃ§in **otomatik olarak depolama tÃ¼rÃ¼nÃ¼ deÄŸiÅŸtirir**.

### EriÅŸim KontrolÃ¼

**VarsayÄ±lan olarak**, eriÅŸimi **IAM** aracÄ±lÄ±ÄŸÄ±yla kontrol etmek **Ã¶nerilir**, ancak **ACL'leri etkinleÅŸtirmek de mÃ¼mkÃ¼ndÃ¼r**.\
YalnÄ±zca IAM kullanmayÄ± seÃ§erseniz (varsayÄ±lan olarak) ve **90 gÃ¼n geÃ§erse**, kovada **ACL'leri etkinleÅŸtiremezsiniz**.

### SÃ¼rÃ¼mleme

SÃ¼rÃ¼mleme etkinleÅŸtirilebilir, bu durumda **kova iÃ§indeki eski sÃ¼rÃ¼mler kaydedilir**. **Saklamak istediÄŸiniz sÃ¼rÃ¼m sayÄ±sÄ±nÄ±** ve hatta **eski sÃ¼rÃ¼mlerin (eski sÃ¼rÃ¼mler) ne kadar sÃ¼reyle yaÅŸayacaÄŸÄ±nÄ±** yapÄ±landÄ±rmanÄ±z mÃ¼mkÃ¼ndÃ¼r. Ã–nerilen, **Standart tÃ¼r iÃ§in 7 gÃ¼n**'dÃ¼r.

**Eski bir sÃ¼rÃ¼mÃ¼n meta verileri saklanÄ±r**. DahasÄ±, **eski sÃ¼rÃ¼mlerin ACL'leri de saklanÄ±r**, bu nedenle eski sÃ¼rÃ¼mler mevcut sÃ¼rÃ¼mden farklÄ± ACL'lere sahip olabilir.

Daha fazlasÄ±nÄ± [**belgelerde**](https://cloud.google.com/storage/docs/object-versioning) Ã¶ÄŸrenin.

### Saklama PolitikasÄ±

Kovadaki Nesnelerin **silinmesini ne kadar sÃ¼reyle yasaklamak istediÄŸinizi** belirtin (en azÄ±ndan uyumluluk iÃ§in Ã§ok kullanÄ±ÅŸlÄ±).\
**SÃ¼rÃ¼mleme veya saklama politikasÄ±ndan yalnÄ±zca biri aynÄ± anda etkinleÅŸtirilebilir**.

### Åifreleme

VarsayÄ±lan olarak, nesneler **Google tarafÄ±ndan yÃ¶netilen anahtarlar kullanÄ±larak ÅŸifrelenir**, ancak aynÄ± zamanda bir **KMS anahtarÄ±** da kullanabilirsiniz.

### Genel EriÅŸim

**Harici kullanÄ±cÄ±lara** (GCP'ye giriÅŸ yapmÄ±ÅŸ veya yapmamÄ±ÅŸ) **kova iÃ§eriÄŸine eriÅŸim** vermek mÃ¼mkÃ¼ndÃ¼r. \
Bir kova oluÅŸturulduÄŸunda, kovanÄ±n **genel olarak aÃ§Ä±ÄŸa Ã§Ä±karÄ±lma seÃ§eneÄŸi devre dÄ±ÅŸÄ± bÄ±rakÄ±lmÄ±ÅŸ** olacaktÄ±r, ancak yeterli izinlerle deÄŸiÅŸtirilebilir.

Bir kovaya eriÅŸmek iÃ§in bir URL'nin **biÃ§imi** **`https://storage.googleapis.com/<bucket-name>` veya `https://<bucket_name>.storage.googleapis.com`**'dur (her ikisi de geÃ§erlidir).

### HMAC AnahtarlarÄ±

Bir HMAC anahtarÄ±, bir hizmet hesabÄ± veya Cloud Storage'da bir kullanÄ±cÄ± hesabÄ±yla iliÅŸkilendirilebilen bir tÃ¼r _kimlik bilgisidir_. Bir HMAC anahtarÄ±, Cloud Storage'a yapÄ±lan isteklere dahil edilen _imzalarÄ±_ oluÅŸturmak iÃ§in kullanÄ±lÄ±r. Ä°mzalar, bir **belirli isteÄŸin kullanÄ±cÄ± veya hizmet hesabÄ± tarafÄ±ndan yetkilendirildiÄŸini gÃ¶sterir**.

HMAC anahtarlarÄ±nÄ±n iki temel parÃ§asÄ± vardÄ±r, bir _eriÅŸim kimliÄŸi_ ve bir _gizli_.

*   **EriÅŸim KimliÄŸi**: Bir hizmet veya kullanÄ±cÄ± hesabÄ±na baÄŸlÄ± olan alfasayÄ±sal bir dizedir. Bir hizmet hesabÄ±na baÄŸlandÄ±ÄŸÄ±nda, dize 61 karakter uzunluÄŸundadÄ±r ve bir kullanÄ±cÄ± hesabÄ±na baÄŸlandÄ±ÄŸÄ±nda, dize 24 karakter uzunluÄŸundadÄ±r. AÅŸaÄŸÄ±da bir eriÅŸim kimliÄŸi Ã¶rneÄŸi gÃ¶sterilmektedir:

`GOOGTS7C7FUP3AIRVJTE2BCDKINBTES3HC2GY5CBFJDCQ2SYHV6A6XXVTJFSA`
*   **Gizli**: Bir 40 karakterlik Base-64 kodlanmÄ±ÅŸ dizedir ve belirli bir eriÅŸim kimliÄŸiyle iliÅŸkilidir. Gizli, yalnÄ±zca sizin ve Cloud Storage tarafÄ±ndan bilinen bir Ã¶nceden paylaÅŸÄ±lmÄ±ÅŸ anahtardÄ±r. Kimlik doÄŸrulama sÃ¼recinin bir parÃ§asÄ± olarak imzalar oluÅŸturmak iÃ§in gizliyi kullanÄ±rsÄ±nÄ±z. AÅŸaÄŸÄ±da bir gizli Ã¶rneÄŸi gÃ¶sterilmektedir:

`bGoa+V7g/yqDXvKRqq+JTFn4uQZbPiQJo4pf9RzJ`

**EriÅŸim kimliÄŸi ve gizli, bir HMAC anahtarÄ±nÄ± benzersiz bir ÅŸekilde tanÄ±mlar**, ancak gizli, imzalar oluÅŸturmak iÃ§in kullanÄ±ldÄ±ÄŸÄ± iÃ§in Ã§ok daha hassas bilgidir.

### Enumerasyon
```bash
# List all storage buckets in project
gsutil ls

# Get each bucket configuration (protections, CLs, times, configs...)
gsutil ls -L

# List contents of a specific bucket
gsutil ls gs://bucket-name/
gsutil ls -r gs://bucket-name/ # Recursive
gsutil ls -a gs://bucket-name/ # Get ALL versions of objects

# Cat the context of a file without copying it locally
gsutil cat 'gs://bucket-name/folder/object'
gsutil cat 'gs://bucket-name/folder/object#<num>' # cat specific version

# Copy an object from the bucket to your local storage for review
gsutil cp gs://bucket-name/folder/object ~/

# List using a raw OAuth token
## Useful because "CLOUDSDK_AUTH_ACCESS_TOKEN" and "gcloud config set auth/access_token_file" doesn't work with gsutil
curl -H "Authorization: Bearer $TOKEN" "https://storage.googleapis.com/storage/v1/b/<storage-name>/o"
# Download file content from bucket
curl -H "Authorization: Bearer $TOKEN" "https://storage.googleapis.com/storage/v1/b/supportstorage-58249/o/flag.txt?alt=media" --output -

# Enumerate HMAC keys
gsutil hmac list
```
EÄŸer kovalarÄ± listelerken izin reddedildi hatasÄ± alÄ±rsanÄ±z, iÃ§eriÄŸe hala eriÅŸiminiz olabilir. Bu yÃ¼zden, kovalarÄ±n adlandÄ±rma kuralÄ±nÄ± bildiÄŸiniz iÃ§in olasÄ± adlar listesi oluÅŸturabilir ve bunlara eriÅŸmeyi deneyebilirsiniz:
```bash
for i in $(cat wordlist.txt); do gsutil ls -r gs://"$i"; done
```
### Yetki YÃ¼kseltme

AÅŸaÄŸÄ±daki sayfada, **yetki yÃ¼kseltmek iÃ§in depolama izinlerini kÃ¶tÃ¼ye kullanma** yÃ¶ntemlerini kontrol edebilirsiniz:

{% content-ref url="../gcp-privilege-escalation/gcp-storage-privesc.md" %}
[gcp-storage-privesc.md](../gcp-privilege-escalation/gcp-storage-privesc.md)
{% endcontent-ref %}

### Kimlik DoÄŸrulamasÄ±z Sorgulama

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-storage-unauthenticated-enum/" %}
[gcp-storage-unauthenticated-enum](../gcp-unaunthenticated-enum-and-access/gcp-storage-unauthenticated-enum/)
{% endcontent-ref %}

### SaldÄ±rÄ± SonrasÄ±

{% content-ref url="../gcp-post-exploitation/gcp-storage-post-exploitation.md" %}
[gcp-storage-post-exploitation.md](../gcp-post-exploitation/gcp-storage-post-exploitation.md)
{% endcontent-ref %}

### KalÄ±cÄ±lÄ±k

{% content-ref url="../gcp-persistence/gcp-storage-persistence.md" %}
[gcp-storage-persistence.md](../gcp-persistence/gcp-storage-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya HackTricks'i **PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>
