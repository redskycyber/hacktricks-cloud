# GCP - рд▓реЙрдЧрд┐рдВрдЧ рдЗрдирдо

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> рдХреЗ рд╕рд╛рде рд╕реАрдЦреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ!</summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА рдХрдВрдкрдиреА **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореЗрд░рд╛** рдЯреНрд╡рд┐рдЯрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

рдпрд╣ рд╕реЗрд╡рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдХрд┐ рд╡реЗ GCP рд╕реЗ **рд▓реЙрдЧ рдбреЗрдЯрд╛ рдФрд░ рдШрдЯрдирд╛рдПрдВ** рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд, рдЦреЛрдЬреЗрдВ, рд╡рд┐рд╢реНрд▓реЗрд╖рдг, рдореЙрдирд┐рдЯрд░ рдФрд░ рдЕрд▓рд░реНрдЯ рдХрд░реЗрдВред

рдХреНрд▓рд╛рдЙрдб рд▓реЙрдЧрд┐рдВрдЧ рдХреЛ рдЕрдиреНрдп GCP рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдПрдХреАрдХреГрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рдЖрдкрдХреЗ рд╕рднреА GCP рд╕рдВрд╕рд╛рдзрдиреЛрдВ рд╕реЗ рд▓реЙрдЧ рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдХреЗрдВрджреНрд░реАрдХреГрдд рднрдВрдбрд╛рд░рдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдпрд╣ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╡рд┐рднрд┐рдиреНрди GCP рд╕реЗрд╡рд╛рдУрдВ рд╕реЗ рд▓реЙрдЧ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рддрд╛ рд╣реИ** рдЬреИрд╕реЗ рдХрд┐ App Engine, Compute Engine, рдФрд░ Cloud Functionsред рдЖрдк Cloud Logging рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ on-premises рдпрд╛ рдЕрдиреНрдп рдХреНрд▓рд╛рдЙрдбреНрд╕ рдкрд░ рдЪрд▓ рд░рд╣реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рдХреЗ рд▓рд┐рдП Cloud Logging рдПрдЬреЗрдВрдЯ рдпрд╛ API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред

рдореБрдЦреНрдп рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ:

* **рд▓реЙрдЧ рдбреЗрдЯрд╛ рдХреЗрдВрджреНрд░реАрдХрд░рдг:** рд╡рд┐рднрд┐рдиреНрди рд╕реНрд░реЛрддреЛрдВ рд╕реЗ рд▓реЙрдЧ рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░реЗрдВ, рдЖрдкрдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рдФрд░ рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдХрд╛ рдПрдХ рд╕рдордЧреНрд░ рджреГрд╢реНрдп рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ред
* **рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд▓реЙрдЧ рдкреНрд░рдмрдВрдзрди:** рддреНрд╡рд░рд┐рдд рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рд▓реЙрдЧ рдХреЛ рд░рд┐рдпрд▓ рдЯрд╛рдЗрдо рдореЗрдВ рд╕реНрдЯреНрд░реАрдо рдХрд░реЗрдВред
* **рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдбреЗрдЯрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг:** рдмрдбрд╝реЗ рдорд╛рддреНрд░рд╛ рдореЗрдВ рд▓реЙрдЧ рдбреЗрдЯрд╛ рдХреЛ рддреЗрдЬреА рд╕реЗ рдЫрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдиреНрдирдд рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рдФрд░ рдЦреЛрдЬ рдХреНрд╖рдорддрд╛рдПрдБ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **BigQuery рдХреЗ рд╕рд╛рде рдПрдХреАрдХрд░рдг:** рд╡рд┐рд╕реНрддреГрдд рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдФрд░ рдХреНрд╡реЗрд░реА рдХреЗ рд▓рд┐рдП рд▓реЙрдЧ рдХреЛ BigQuery рдореЗрдВ рдирд┐рд░реНрдпрд╛рдд рдХрд░реЗрдВред
* **рд▓реЙрдЧ-рдЖрдзрд╛рд░рд┐рдд рдореАрдЯреНрд░рд┐рдХреНрд╕:** рдЕрд▓рд░реНрдЯрд┐рдВрдЧ рдФрд░ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рд▓реЙрдЧ рдбреЗрдЯрд╛ рд╕реЗ рдХрд╕реНрдЯрдо рдореАрдЯреНрд░рд┐рдХреНрд╕ рдмрдирд╛рдПрдВред

### рд▓реЙрдЧ рдлреНрд▓реЛ

<figure><img src="../../../.gitbook/assets/image (1) (1).png" alt=""><figcaption><p><a href="https://betterstack.com/community/guides/logging/gcp-logging/">https://betterstack.com/community/guides/logging/gcp-logging/</a></p></figcaption></figure>

рдореВрд▓ рд░реВрдк рд╕реЗ рд╕рд┐рдВрдХреНрд╕ рдФрд░ рд▓реЙрдЧ рдЖрдзрд╛рд░рд┐рдд рдореАрдЯреНрд░рд┐рдХреНрд╕ рдпрд╣ рддрдп рдХрд░реЗрдВрдЧреЗ рдХрд┐ рдПрдХ рд▓реЙрдЧ рдХреЛ рдХрд╣рд╛рдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПред

### GCP рд▓реЙрдЧрд┐рдВрдЧ рджреНрд╡рд╛рд░рд╛ рд╕рдорд░реНрдерд┐рдд рд╡рд┐рдиреНрдпрд╛рд╕

рдХреНрд▓рд╛рдЙрдб рд▓реЙрдЧрд┐рдВрдЧ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рд╕рдВрдЪрд╛рд▓рдирд┐рдХ рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рд░реВрдк рд╕реЗ рд╡рд┐рдиреНрдпрд╛рд╕рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

1. **рд▓реЙрдЧ рдмрдХреЗрдЯреНрд╕ (рд╡реЗрдм рдореЗрдВ рд▓реЙрдЧ рд╕рдВрдЧреНрд░рд╣рдг):** Cloud Logging рдореЗрдВ рдмрдХреЗрдЯреНрд╕ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ рддрд╛рдХрд┐ **рд▓реЙрдЧ рд░рд┐рдЯреЗрдВрд╢рди** рдХреЛ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░реЗрдВ, рдЬрд┐рд╕рд╕реЗ рдЖрдкрдХреЗ рд▓реЙрдЧ рдПрдВрдЯреНрд░реА рдХрд┐рддрдиреЗ рд╕рдордп рддрдХ рд░рдЦреЗ рдЬрд╛рдПрдВ рдЗрд╕ рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рдорд┐рд▓реЗред
* рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдмрдХреЗрдЯреНрд╕ `_Default` рдФрд░ `_Required` рдмрдирд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ (рдПрдХ рд╡рд╣ рд╣реИ рдЬреЛ рджреВрд╕рд░рд╛ рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рд╣реИ)ред
*   **\_Required** рд╣реИ:

{% code overflow="wrap" %}
```bash
LOG_ID("cloudaudit.googleapis.com/activity") OR LOG_ID("externalaudit.googleapis.com/activity") OR LOG_ID("cloudaudit.googleapis.com/system_event") OR LOG_ID("externalaudit.googleapis.com/system_event") OR LOG_ID("cloudaudit.googleapis.com/access_transparency") OR LOG_ID("externalaudit.googleapis.com/access_transparency")
```
{% endcode %}
* рдбреЗрдЯрд╛ рдХреА **рд░рд┐рдЯреЗрдВрд╢рди рдЕрд╡рдзрд┐** рдмрдХреЗрдЯ рдкреНрд░рддрд┐ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХреА рдЧрдИ рд╣реИ рдФрд░ рдЗрд╕реЗ **рдХрдо рд╕реЗ рдХрдо 1 рджрд┐рди** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рд╣рд╛рд▓рд╛рдВрдХрд┐ **\_Required рдХреА рд░рд┐рдЯреЗрдВрд╢рди рдЕрд╡рдзрд┐ 400 рджрд┐рди** рд╣реИ рдФрд░ рдЗрд╕реЗ рд╕рдВрд╢реЛрдзрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд▓реЙрдЧ рдмрдХреЗрдЯреНрд╕ **рдХреНрд▓рд╛рдЙрдб рд╕реНрдЯреЛрд░реЗрдЬ рдореЗрдВ рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрддреЗ рд╣реИрдВред**
2. **рд▓реЙрдЧ рд╕рд┐рдВрдХреНрд╕ (рд╡реЗрдм рдореЗрдВ рд▓реЙрдЧ рд░рд╛рдЙрдЯрд░):** рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд▓реЙрдЧ рдПрдВрдЯреНрд░реАрдЬрд╝ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рдЧрдВрддрд╡реНрдпреЛрдВ рдЬреИрд╕реЗ Pub/Sub, BigQuery, рдпрд╛ Cloud Storage рдореЗрдВ **рдирд┐рд░реНрдпрд╛рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд┐рдВрдХреНрд╕ рдмрдирд╛рдПрдВ**ред
* **рдбрд┐рдлрд╝реЙрд▓реНрдЯ** рд░реВрдк рд╕реЗ рд╕рд┐рдВрдХреНрд╕ `_Default` рдФрд░ `_Required` рдХреЗ рд▓рд┐рдП рдмрдирд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ:
* ```bash
_Required  logging.googleapis.com/projects/<proj-name>/locations/global/buckets/_Required  LOG_ID("cloudaudit.googleapis.com/activity") OR LOG_ID("externalaudit.googleapis.com/activity") OR LOG_ID("cloudaudit.googleapis.com/system_event") OR LOG_ID("externalaudit.googleapis.com/system_event") OR LOG_ID("cloudaudit.googleapis.com/access_transparency") OR LOG_ID("externalaudit.googleapis.com/access_transparency")
_Default   logging.googleapis.com/projects/<proj-name>/locations/global/buckets/_Default   NOT LOG_ID("cloudaudit.googleapis.com/activity") AND NOT LOG_ID("externalaudit.googleapis.com/activity") AND NOT LOG_ID("cloudaudit.googleapis.com/system_event") AND NOT LOG_ID("externalaudit.googleapis.com/system_event") AND NOT LOG_ID("cloudaudit.googleapis.com/access_transparency") AND NOT LOG_ID("externalaudit.googleapis.com/access_transparency")
```
* **рдЕрдкрд╡рд░реНрдЬрди рдлрд╝рд┐рд▓реНрдЯрд░:** рд╡рд┐рд╢рд┐рд╖реНрдЯ рд▓реЙрдЧ рдПрдВрдЯреНрд░реАрдЬрд╝ рдХреЛ рдЗрдВрдЬреЗрд╕реНрдЯ рди рд╣реЛрдиреЗ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП **рдЕрдкрд╡рд░реНрдЬрди рд╕реЗрдЯ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ**, рдЬрд┐рд╕рд╕реЗ рд▓рд╛рдЧрдд рдмрдЪрд╛рдИ рдЬрд╛ рд╕рдХреЗ рдФрд░ рдЕрдирд╛рд╡рд╢реНрдпрдХ рд╢реЛрд░ рдХреЛ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред
3. **рд▓реЙрдЧ-рдЖрдзрд╛рд░рд┐рдд рдореАрдЯреНрд░рд┐рдХреНрд╕:** рд▓реЙрдЧ рдХреА рд╕рд╛рдордЧреНрд░реА рдкрд░ рдЖрдзрд╛рд░рд┐рдд **рдХрд╕реНрдЯрдо рдореАрдЯреНрд░рд┐рдХреНрд╕** рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ, рдЬрд┐рд╕рд╕реЗ рд▓реЙрдЧ рдбреЗрдЯрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрд▓рд░реНрдЯрд┐рдВрдЧ рдФрд░ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рдХреА рдЬрд╛ рд╕рдХреЗред
4. **рд▓реЙрдЧ рд╡реНрдпреВ:** рд▓реЙрдЧ рдмрдХреЗрдЯреНрд╕ рдХреЗ рднреАрддрд░ рд▓реЙрдЧ рдХреМрди рджреЗрдЦ рд╕рдХрддрд╛ рд╣реИ рдЗрд╕ рдкрд░ рдЙрдиреНрдирдд рдФрд░ **рд╡рд┐рд╕реНрддреГрдд рдирд┐рдпрдВрддреНрд░рдг** рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред&#x20;
* рдХреНрд▓рд╛рдЙрдб рд▓реЙрдЧрд┐рдВрдЧ **рд╣рд░ рдмрдХреЗрдЯ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ `_AllLogs` рд╡реНрдпреВ рдмрдирд╛рддрд╛ рд╣реИ**, рдЬреЛ рд╕рднреА рд▓реЙрдЧ рджрд┐рдЦрд╛рддрд╛ рд╣реИред рдХреНрд▓рд╛рдЙрдб рд▓реЙрдЧрд┐рдВрдЧ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдмрдХреЗрдЯ рдХреЗ рд▓рд┐рдП `_Default` рдирд╛рдордХ рдПрдХ рд╡реНрдпреВ рднреА рдмрдирд╛рддрд╛ рд╣реИред `_Default` рдмрдХреЗрдЯ рдХреЗ рд▓рд┐рдП `_Default` рд╡реНрдпреВ рд╕рднреА рд▓реЙрдЧ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХреЗрд╡рд▓ рдбреЗрдЯрд╛ рдПрдХреНрд╕реЗрд╕ рдСрдбрд┐рдЯ рд▓реЙрдЧреНрд╕ рдХреЛ рдЫреЛрдбрд╝рдХрд░ред `_AllLogs` рдФрд░ `_Default` рд╡реНрдпреВ рд╕рдВрдкрд╛рджрди рдпреЛрдЧреНрдп рдирд╣реАрдВ рд╣реИрдВред



рдПрдХ рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓ рдХреЛ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд▓реЙрдЧ рд╡реНрдпреВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдЬреИрд╕реЗ рдХрд┐ рдПрдХ IAM рдиреАрддрд┐ рдХреЗ рд╕рд╛рде:
```json
{
"bindings": [
{
"members": [
"user:username@gmail.com"
],
"role": "roles/logging.viewAccessor",
"condition": {
"title": "Bucket reader condition example",
"description": "Grants logging.viewAccessor role to user username@gmail.com for the VIEW_ID log view.",
"expression":
"resource.name == \"projects/PROJECT_ID/locations/LOCATION/buckets/BUCKET_NAME/views/VIEW_ID\""
}
}
],
"etag": "BwWd_6eERR4=",
"version": 3
}
```
### рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд▓реЙрдЧ

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **рдПрдбрдорд┐рди рд▓реЗрдЦрди** рдХреНрд░рд┐рдпрд╛рдПрдБ (рдЬрд┐рдиреНрд╣реЗрдВ рдПрдбрдорд┐рди рдЧрддрд┐рд╡рд┐рдзрд┐ рдСрдбрд┐рдЯ рд▓реЙрдЧ рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ) рд▓реЙрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ (рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдпрд╛ рд╡рд┐рдиреНрдпрд╛рд╕ рд╕реВрдЪрдирд╛ рд▓рд┐рдЦреЗрдВ) рдФрд░ **рдЕрдХреНрд╖рдо рдХрд┐рдП рдирд╣реАрдВ рдЬрд╛ рд╕рдХрддреЗ**ред

рдЙрд╕рдХреЗ рдмрд╛рдж, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдбреЗрдЯрд╛ рдПрдХреНрд╕реЗрд╕ рдСрдбрд┐рдЯ рд▓реЙрдЧ** рдХреЛ рд╕рдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдпреЗ **рдПрдбрдорд┐рди рдкрдврд╝реЗрдВ, рдбреЗрдЯрд╛ рд▓реЗрдЦреЗрдВ рдФрд░ рдбреЗрдЯрд╛ рд▓реЗрдЦреЗрдВ** рд╣реИрдВред

рдЖрдк рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓реЙрдЧ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: [https://cloud.google.com/iam/docs/audit-logging](https://cloud.google.com/iam/docs/audit-logging)

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **`GetIamPolicy`** рдХреНрд░рд┐рдпрд╛рдПрдБ рдФрд░ рдЕрдиреНрдп рдкрдврд╝рдиреЗ рд╡рд╛рд▓реА рдХреНрд░рд┐рдпрд╛рдПрдБ **рд▓реЙрдЧ рдирд╣реАрдВ рдХреА рдЬрд╛ рд░рд╣реА рд╣реИрдВ**ред рдЗрд╕рд▓рд┐рдП, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬреЛ рдкрд░реНрдпрд╛рд╡рд░рдг рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд░рд╣рд╛ рд╣реИ, рдЙрд╕реЗ рдкрдХрдбрд╝рд╛ рдирд╣реАрдВ рдЬрд╛рдПрдЧрд╛ рдЕрдЧрд░ рд╕рд┐рд╕реНрдЯрдо рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдиреЗ рдЕрдзрд┐рдХ рд▓реЙрдЧ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреА рд╡рд┐рдиреНрдпрд╛рд╕ рдирд╣реАрдВ рдХрд┐рдпрд╛ред

рдХреЙрдиреНрд╕реЛрд▓ рдореЗрдВ рдЕрдзрд┐рдХ рд▓реЙрдЧ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд┐рд╕реНрдЯрдо рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреЛ [https://console.cloud.google.com/iam-admin/audit](https://console.cloud.google.com/iam-admin/audit) рдЬрд╛рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдпрд╣рд╛рдБ 2 рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ:

* **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡рд┐рдиреНрдпрд╛рд╕**: рдПрдХ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡рд┐рдиреНрдпрд╛рд╕ рдмрдирд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдФрд░ рд╕рднреА рдПрдбрдорд┐рди рдкрдврд╝реЗрдВ рдФрд░/рдпрд╛ рдбреЗрдЯрд╛ рдкрдврд╝реЗрдВ рдФрд░/рдпрд╛ рдбреЗрдЯрд╛ рд▓реЗрдЦ рд▓реЙрдЧ рдФрд░ рдЫреВрдЯ рд╡рд╛рд▓реЗ рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓ рдЬреЛрдбрд╝рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ:

<figure><img src="../../../.gitbook/assets/image (149).png" alt=""><figcaption></figcaption></figure>

* **рд╕реЗрд╡рд╛рдПрдВ рдЪреБрдиреЗрдВ**: рдпрд╛ рдмрд╕ **рд╕реЗрд╡рд╛рдПрдВ рдЪреБрдиреЗрдВ** рдЬрд┐рдирдХреЗ рд▓реЙрдЧ рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдФрд░ рд▓реЙрдЧ рдХреЗ рдкреНрд░рдХрд╛рд░ рдФрд░ рдЙрд╕ рд╡рд┐рд╢реЗрд╖ рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдЫреВрдЯ рд╡рд╛рд▓реЗ рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓ рдХреЛ рдЪреБрдиреЗрдВред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХреЗрд╡рд▓ рд╡реЗ рд▓реЙрдЧ рдЙрддреНрдкрдиреНрди рдХрд┐рдП рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдЕрдзрд┐рдХ рд▓реЙрдЧ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рд╕реЗ рд▓рд╛рдЧрдд рдмрдврд╝ рдЬрд╛рдПрдЧреАред

### рдЧрдгрдирд╛

`gcloud` рдХрдорд╛рдВрдб-рд▓рд╛рдЗрди рдЯреВрд▓ GCP рдкрд╛рд░рд┐рд╕реНрдерд┐рддрд┐рдХреА рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ, рдЬреЛ рдЖрдкрдХреЛ рдЕрдкрдиреЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдФрд░ рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдпрд╣рд╛рдБ рдпрд╣рд╛рдБ рдЖрдк `gcloud` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдкрдиреА рд▓реЙрдЧрд┐рдВрдЧ рд╡рд┐рдиреНрдпрд╛рд╕ рдФрд░ рдПрдХреНрд╕реЗрд╕ рд▓реЙрдЧреНрд╕ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
```bash
# List buckets
gcloud logging buckets list
gcloud logging buckets describe <bucket-name> --location <location>

# List log entries: only logs that contain log entries are listed.
gcloud logging logs list

# Get log metrics
gcloud logging metrics list
gcloud logging metrics describe <metric-name>

# Get log sinks
gcloud logging sinks list
gcloud logging sinks describe <sink-name>

# Get log views
gcloud logging views list --bucket <bucket> --location global
gcloud logging views describe --bucket <bucket> --location global <view-id> # view-id is usually the same as the bucket name

# Get log links
gcloud logging links list --bucket _Default --location global
gcloud logging links describe <link-id> --bucket _Default --location global
```
{% endcode %}

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **`cloudresourcemanager`** рдХреА рд▓реЙрдЧ рдЬрд╛рдВрдЪреЗрдВ (рдЬрд┐рд╕реЗ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ BF рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ): [https://console.cloud.google.com/logs/query;query=protoPayload.serviceName%3D%22cloudresourcemanager.googleapis.com%22;summaryFields=:false:32:beginning;cursorTimestamp=2024-01-20T00:07:14.482809Z;startTime=2024-01-01T11:12:26.062Z;endTime=2024-02-02T17:12:26.062Z?authuser=2\&project=digital-bonfire-410512](https://console.cloud.google.com/logs/query;query=protoPayload.serviceName%3D%22cloudresourcemanager.googleapis.com%22;summaryFields=:false:32:beginning;cursorTimestamp=2024-01-20T00:07:14.482809Z;startTime=2024-01-01T11:12:26.062Z;endTime=2024-02-02T17:12:26.062Z?authuser=2\&project=digital-bonfire-410512)

**`testIamPermissions`** рдХреА рдХреЛрдИ рд▓реЙрдЧ рдирд╣реАрдВ рд╣реИ:

<figure><img src="../../../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

### рдкреЛрд╕реНрдЯ рдПрдХреНрд╕рдкреНрд▓реЛрдЗрдЯреЗрд╢рди

{% content-ref url="../gcp-post-exploitation/gcp-logging-post-exploitation.md" %}
[gcp-logging-post-exploitation.md](../gcp-post-exploitation/gcp-logging-post-exploitation.md)
{% endcontent-ref %}

### рд╕реНрдерд┐рд░рддрд╛

{% content-ref url="../gcp-persistence/gcp-logging-persistence.md" %}
[gcp-logging-persistence.md](../gcp-persistence/gcp-logging-persistence.md)
{% endcontent-ref %}

## рд╕рдВрджрд░реНрдн

* [https://cloud.google.com/logging/docs/logs-views#gcloud](https://cloud.google.com/logging/docs/logs-views#gcloud)
* [https://betterstack.com/community/guides/logging/gcp-logging/](https://betterstack.com/community/guides/logging/gcp-logging/)

<details>

<summary><strong>рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** PRs рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **HackTricks** рдФрд░ **HackTricks Cloud** github repos рдореЗрдВ рдЬрдорд╛ рдХрд░рдХреЗред

</details>
