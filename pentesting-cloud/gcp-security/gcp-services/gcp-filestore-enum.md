# GCP - Filestore Enum

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili me **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Osnovne informacije

Google Cloud Filestore je opisan kao **upravljana usluga za skladiÅ¡tenje fajlova** prilagoÄ‘ena aplikacijama koje zahtevaju i **interfejs fajl sistema i deljeni fajl sistem za podatke**. Ova usluga se istiÄe pruÅ¾anjem visokoperformantnih deljenih fajlova, koji se mogu integrisati sa raznim GCP uslugama. Njegova korisnost dolazi do izraÅ¾aja u scenarijima gde su tradicionalni interfejsi i semantika fajl sistema kljuÄni, kao Å¡to su obrada medija, upravljanje sadrÅ¾ajem i bekapovanje baza podataka.

MoÅ¾ete razmiÅ¡ljati o ovome kao o bilo kojem drugom **NFS** **deljenom repozitorijumu dokumenata** - potencijalnom izvoru osetljivih informacija.

### Veze

Prilikom kreiranja Filestore instance moguÄ‡e je **izabrati mreÅ¾u preko koje Ä‡e biti dostupna**.

Osim toga, **podrazumevano Ä‡e svi klijenti na izabranoj VPC mreÅ¾i i regionu moÄ‡i da joj pristupe**, meÄ‘utim, moguÄ‡e je **ograniÄiti pristup i po IP adresi** ili opsegu i naznaÄiti privilegiju pristupa (Admin, Admin Viewer, Editor, Viewer) koju Ä‡e klijent dobiti **u zavisnosti od IP adrese**.

TakoÄ‘e, moÅ¾e biti dostupna putem **Private Service Access Connection-a**:

* OdreÄ‘eni su po VPC mreÅ¾i i mogu se koristiti sa svim upravljanim uslugama kao Å¡to su Memorystore, Tensorflow i SQL.
* IzmeÄ‘u vaÅ¡e VPC mreÅ¾e i mreÅ¾e koju poseduje Google koristeÄ‡i VPC peering, omoguÄ‡avajuÄ‡i vaÅ¡im instancama i uslugama da komuniciraju iskljuÄivo **koristeÄ‡i interne IP adrese**.
* Kreiraju izolovan projekat za vas sa strane proizvoÄ‘aÄa usluge, Å¡to znaÄi da ga ne delite sa drugim korisnicima. BiÄ‡ete naplaÄ‡eni samo za resurse koje obezbedite.
* VPC peering Ä‡e uvesti nove rute u vaÅ¡u VPC

### Bekapovi

MoguÄ‡e je kreirati **bekapove deljenih fajlova**. Oni se mogu kasnije **obnoviti na izvornom** novom Fileshare instancom ili na **novim instancama**.

### Enkripcija

Podrazumevano Ä‡e se koristiti **Google-om upravljani kljuÄ za enkripciju** podataka, ali moguÄ‡e je izabrati **korisniÄki upravljani kljuÄ za enkripciju (CMEK)**.

### Enumeracija

Ako pronaÄ‘ete dostupan filestore u projektu, moÅ¾ete ga **montirati** unutar kompromitovane Compute Instance. Koristite sledeÄ‡u komandu da biste videli da li postoji neki.

{% code overflow="wrap" %}
```bash
# Instances
gcloud filestore instances list # Check the IP address
gcloud filestore instances describe --zone <zone> <name> # Check IP and access restrictions

# Backups
gcloud filestore backups list
gcloud filestore backups describe --region <region> <backup>

# Search for NFS shares in a VPC subnet
sudo nmap -n -T5 -Pn -p 2049 --min-parallelism 100 --min-rate 1000 --open 10.99.160.2/20
```
{% endcode %}

{% hint style="danger" %}
Imajte na umu da bi usluga filestore mogla biti u **potpuno novoj podmreÅ¾i koja je kreirana za nju** (unutar privatne veze za pristup usluzi, koja je **VPC peer**).\
Stoga moÅ¾da Ä‡ete morati **izlistati VPC peere** kako biste takoÄ‘e pokrenuli nmap nad tim mreÅ¾nim opsezima.

{% code overflow="wrap" %}
```bash
# Get peerings
gcloud compute networks peerings list
# Get routes imported from a peering
gcloud compute networks peerings list-routes <peering-name> --network=<network-name> --region=<region> --direction=INCOMING
```
{% endcode %}
{% endhint %}

### Eskalacija privilegija i post eksploatacija

Nema naÄina da se eskaliraju privilegije u GCP direktno zloupotrebljavajuÄ‡i ovu uslugu, ali koriÅ¡Ä‡enjem nekih **trikova post eksploatacije moguÄ‡e je dobiti pristup podacima** i moÅ¾da pronaÄ‡i neke akreditive za eskalaciju privilegija:

{% content-ref url="../gcp-post-exploitation/gcp-filestore-post-exploitation.md" %}
[gcp-filestore-post-exploitation.md](../gcp-post-exploitation/gcp-filestore-post-exploitation.md)
{% endcontent-ref %}

### Upornost

{% content-ref url="../gcp-persistence/gcp-filestore-persistence.md" %}
[gcp-filestore-persistence.md](../gcp-persistence/gcp-filestore-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini da podrÅ¾ite HackTricks:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili me **pratite** na **Twitter-u** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
