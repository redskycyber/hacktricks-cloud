# GCP - Filestore Enum

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** ğŸ’¬ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** my op **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Deel jou hacking-truuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>

## Basiese Inligting

Google Cloud Filestore word beskryf as 'n **bestuurde lÃªerstoor-diens** wat geskik is vir toepassings wat beide 'n **lÃªerstelsel-koppelvlak en 'n gedeelde lÃªerstelsel vir data** benodig. Hierdie diens blink uit deur hoÃ« prestasie lÃªer-aandele aan te bied wat geÃ¯ntegreer kan word met verskeie GCP-dienste. Dit is nuttig in scenario's waar tradisionele lÃªerstelsel-koppelvlakke en semantiek belangrik is, soos by mediaverwerking, inhoudsbestuur en die rugsteun van databasisse.

Jy kan hierdie diens beskou as enige ander **NFS** **gedeelde dokumenterepositorium -** 'n potensiÃ«le bron van sensitiewe inligting.

### Verbindings

Wanneer jy 'n Filestore-instantie skep, is dit moontlik om die **netwerk waarop dit toeganklik sal wees te kies**.

Verder, **standaard sal alle kliÃ«nte op die gekose VPC-netwerk en -streek toegang daartoe hÃª**, maar dit is moontlik om die toegang ook te **beperk deur IP-adres** of reeks en die toegangsreg (Admin, Admin Viewer, Editor, Viewer) aan te dui wat die kliÃ«nt gaan kry **afhangende van die IP-adres**.

Dit kan ook toeganklik wees via 'n **Private Service Access Connection:**

* Is per VPC-netwerk en kan gebruik word vir alle bestuurde dienste soos Memorystore, Tensorflow en SQL.
* Is **tussen jou VPC-netwerk en 'n netwerk wat deur Google besit word deur middel van 'n VPC-peering**, wat jou instansies en dienste in staat stel om eksklusief te kommunikeer deur **gebruik te maak van interne IP-adresse**.
* Skep 'n geÃ¯soleerde projek vir jou aan die diensverskaffer-kant, wat beteken dat geen ander kliÃ«nte dit deel nie. Jy sal slegs gefaktureer word vir die hulpbronne wat jy voorsien.
* Die VPC-peering sal nuwe roetes na jou VPC invoer

### Rugsteun

Dit is moontlik om **rugsteun van die lÃªer-aandele te skep**. Hierdie kan later **herstel word in die oorspronklike** nuwe Fileshare-instantie of in **nuwes**.

### Versleuteling

Standaard sal 'n **deur Google bestuurde versleutelingssleutel** gebruik word om die data te versleutel, maar dit is moontlik om 'n **deur die kliÃ«nt bestuurde versleutelingssleutel (CMEK)** te kies.

### Enumerasie

As jy 'n beskikbare filestore in die projek vind, kan jy dit **aankoppel** van binne jou gekompromitteerde Rekeninstansie. Gebruik die volgende opdrag om te sien of enige bestaan.

{% code overflow="wrap" %}
```bash
# Instances
gcloud filestore instances list # Check the IP address
gcloud filestore instances describe --zone <zone> <name> # Check IP and access restrictions

# Backups
gcloud filestore backups list
gcloud filestore backups describe --region <region> <backup>

# Search for NFS shares in a VPC subnet
sudo nmap -n -T5 -Pn -p 2049 --min-parallelism 100 --min-rate 1000 --open 10.99.160.2/20
```
{% endcode %}

{% hint style="danger" %}
Let daarop dat 'n filestore-diens dalk in 'n heeltemal nuwe subnet geskep is vir dit (binne 'n Private Service Access Connection, wat 'n VPC-peer is).\
Jy mag dus nodig hÃª om VPC-peers op te som om ook nmap oor daardie netwerkomvang te laat loop.

{% code overflow="wrap" %}
```bash
# Get peerings
gcloud compute networks peerings list
# Get routes imported from a peering
gcloud compute networks peerings list-routes <peering-name> --network=<network-name> --region=<region> --direction=INCOMING
```
{% endcode %}
{% endhint %}

### Voorregverhoging en Post Exploitation

Daar is nie direkte maniere om voorregte in GCP te verhoog deur hierdie diens te misbruik nie, maar deur van sommige **Post Exploitation truuks gebruik te maak, is dit moontlik om toegang tot die data te verkry** en miskien kan jy enkele geloofsbriewe vind om voorregte te verhoog:

{% content-ref url="../gcp-post-exploitation/gcp-filestore-post-exploitation.md" %}
[gcp-filestore-post-exploitation.md](../gcp-post-exploitation/gcp-filestore-post-exploitation.md)
{% endcontent-ref %}

### Volharding

{% content-ref url="../gcp-persistence/gcp-filestore-persistence.md" %}
[gcp-filestore-persistence.md](../gcp-persistence/gcp-filestore-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** ğŸ’¬ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** my op **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Deel jou hacking truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
