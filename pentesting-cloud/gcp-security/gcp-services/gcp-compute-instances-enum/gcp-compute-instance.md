# GCP - Compute-Instanzen

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>

## Grundlegende Informationen

Google Cloud Compute-Instanzen sind **anpassbare virtuelle Maschinen in der Google-Cloudinfrastruktur**, die skalierbare und bedarfsgesteuerte Rechenleistung f√ºr eine Vielzahl von Anwendungen bieten. Sie bieten Funktionen wie globale Bereitstellung, persistente Speicherung, flexible Betriebssystemoptionen sowie starke Netzwerk- und Sicherheitsintegrationen, was sie zu einer vielseitigen Wahl f√ºr das Hosting von Websites, die Verarbeitung von Daten und die effiziente Ausf√ºhrung von Anwendungen in der Cloud macht.

### Vertrauliche VM

Vertrauliche VMs verwenden **hardwarebasierte Sicherheitsfunktionen**, die von den neuesten AMD EPYC-Prozessoren angeboten werden, darunter Speicherverschl√ºsselung und sichere verschl√ºsselte Virtualisierung. Diese Funktionen erm√∂glichen es der VM, die in ihr verarbeiteten und gespeicherten Daten selbst vor dem Host-Betriebssystem und dem Hypervisor zu sch√ºtzen.

Um eine vertrauliche VM auszuf√ºhren, m√ºssen m√∂glicherweise Dinge wie der **Typ** der **Maschine**, das Netzwerk **Interface** und das **Boot-Disk-Image** ge√§ndert werden.

### Festplatte & Festplattenverschl√ºsselung

Es ist m√∂glich, die **Festplatte auszuw√§hlen**, die verwendet werden soll, oder eine neue zu **erstellen**. Wenn Sie eine neue ausw√§hlen, k√∂nnen Sie:

* Die **Gr√∂√üe** der Festplatte ausw√§hlen
* Das **Betriebssystem** ausw√§hlen
* Angeben, ob die Festplatte beim L√∂schen der Instanz gel√∂scht werden soll
* **Verschl√ºsselung**: Standardm√§√üig wird ein **von Google verwalteter Schl√ºssel** verwendet, aber Sie k√∂nnen auch einen Schl√ºssel aus KMS ausw√§hlen oder einen **rohen Schl√ºssel zur Verwendung** angeben.

### Container bereitstellen

Es ist m√∂glich, einen **Container** innerhalb der virtuellen Maschine bereitzustellen.\
Es ist m√∂glich, das **Image** zu konfigurieren, den **Befehl** festzulegen, der darin ausgef√ºhrt werden soll, **Argumente** festzulegen, ein **Volume** zu mounten und **Umgebungsvariablen** (empfindliche Informationen?) zu konfigurieren sowie mehrere Optionen f√ºr diesen Container zu konfigurieren, z. B. als **privilegiert** ausf√ºhren, stdin und Pseudo-TTY.

### Dienstkonto

Standardm√§√üig wird das **Standarddienstkonto f√ºr Compute Engine** verwendet. Die E-Mail dieses SA lautet beispielsweise: `<proj-num>-compute@developer.gserviceaccount.com`\
Dieses Dienstkonto hat die **Editor-Rolle √ºber das gesamte Projekt (hohe Berechtigungen).**

Und die **Standardzugriffsberechtigungen** sind wie folgt:

* **https://www.googleapis.com/auth/devstorage.read\_only** -- Lesezugriff auf Eimer :)
* https://www.googleapis.com/auth/logging.write
* https://www.googleapis.com/auth/monitoring.write
* https://www.googleapis.com/auth/servicecontrol
* https://www.googleapis.com/auth/service.management.readonly
* https://www.googleapis.com/auth/trace.append

Es ist jedoch m√∂glich, ihm mit einem Klick `cloud-platform` zu gew√§hren oder **benutzerdefinierte** Berechtigungen anzugeben.

<figure><img src="../../../../.gitbook/assets/image (327).png" alt=""><figcaption></figcaption></figure>

### Firewall

Es ist m√∂glich, den HTTP- und HTTPS-Verkehr zuzulassen.

<figure><img src="../../../../.gitbook/assets/image (326).png" alt=""><figcaption></figcaption></figure>

### Netzwerk

* **IP-Weiterleitung**: Es ist m√∂glich, die IP-Weiterleitung ab der Erstellung der Instanz zu **aktivieren**.
* **Hostname**: Es ist m√∂glich, der Instanz einen permanenten Hostnamen zu geben.
* **Interface**: Es ist m√∂glich, ein Netzwerkinterface hinzuzuf√ºgen.

### Zus√§tzliche Sicherheit

Diese Optionen werden die Sicherheit der VM **erh√∂hen** und sind empfehlenswert:

* **Sicheres Booten:** Sicheres Booten hilft dabei, Ihre VM-Instanzen vor Malware auf Boot- und Kernel-Ebene sowie Rootkits zu sch√ºtzen.
* **vTPM aktivieren:** Das Virtual Trusted Platform Module (vTPM) validiert die Vorab- und Bootintegrit√§t Ihrer Gast-VM und bietet Schl√ºsselerzeugung und -schutz.
* **Integrit√§ts√ºberwachung:** Die Integrit√§ts√ºberwachung erm√∂glicht es Ihnen, die Laufzeit-Bootintegrit√§t Ihrer gesch√ºtzten VM-Instanzen mithilfe von Stackdriver-Berichten zu √ºberwachen und zu √ºberpr√ºfen. Erfordert die Aktivierung von vTPM.

### VM-Zugriff

Der √ºbliche Weg, um den Zugriff auf die VM zu erm√∂glichen, besteht darin, bestimmten SSH-Public Keys den Zugriff auf die VM zu gestatten.\
Es ist jedoch auch m√∂glich, den Zugriff auf die VM √ºber den `os-config`-Dienst unter Verwendung von IAM zu aktivieren. Dar√ºber hinaus ist es m√∂glich, 2FA zu aktivieren, um auf die VM √ºber diesen Dienst zuzugreifen.\
Wenn dieser **Dienst** **aktiviert** ist, ist der Zugriff √ºber **SSH-Keys deaktiviert**.

<figure><img src="../../../../.gitbook/assets/image (328).png" alt=""><figcaption></figcaption></figure>

### Metadaten

Es ist m√∂glich, **Automatisierung** (Benutzerdaten in AWS) zu definieren, die **Shell-Befehle** sind, die jedes Mal ausgef√ºhrt werden, wenn die Maschine eingeschaltet oder neu gestartet wird.

Es ist auch m√∂glich, **zus√§tzliche Metadaten-Schl√ºssel-Wert-Werte** festzulegen, die √ºber den Metadaten-Endpunkt abgerufen werden k√∂nnen. Diese Informationen werden h√§ufig f√ºr Umgebungsvariablen und Start-/Stopp-Skripte verwendet. Dies kann mit der **`describe`-Methode** aus einem Befehl im Abschnitt zur Enumeration abgerufen werden, kann aber auch von innerhalb der Instanz √ºber den Metadaten-Endpunkt abgerufen werden.
```bash
# view project metadata
curl "http://metadata.google.internal/computeMetadata/v1/project/attributes/?recursive=true&alt=text" \
-H "Metadata-Flavor: Google"

# view instance metadata
curl "http://metadata.google.internal/computeMetadata/v1/instance/attributes/?recursive=true&alt=text" \
-H "Metadata-Flavor: Google"
```
Dar√ºber hinaus werden auch der **Authentifizierungstoken f√ºr das angeh√§ngte Dienstkonto** und **allgemeine Informationen** √ºber die Instanz, das Netzwerk und das Projekt √ºber den **Metadaten-Endpunkt** verf√ºgbar sein. Weitere Informationen finden Sie unter:

{% embed url="https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery/cloud-ssrf#6440" %}

### Verschl√ºsselung

Standardm√§√üig wird ein von Google verwalteter Verschl√ºsselungsschl√ºssel verwendet, aber ein kundenverwalteter Verschl√ºsselungsschl√ºssel (CMEK) kann konfiguriert werden. Sie k√∂nnen auch konfigurieren, was bei Widerruf des verwendeten CMEF geschehen soll: Nichts oder die VM herunterfahren.

<figure><img src="../../../../.gitbook/assets/image (329).png" alt=""><figcaption></figcaption></figure>

<details>

<summary><strong>Erfahren Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositorys einreichen.

</details>
