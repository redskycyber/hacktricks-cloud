# GCP - Hesap Makineleri

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya **HackTricks'i PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonu
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)'Ä± **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>

## Temel Bilgiler

Google Cloud Hesap Makineleri, Google'Ä±n bulut altyapÄ±sÄ±nda **Ã¶zelleÅŸtirilebilir sanal makinelerdir** ve geniÅŸ bir uygulama yelpazesinde Ã¶lÃ§eklenebilir ve talep Ã¼zerine hesaplama gÃ¼cÃ¼ sunar. KÃ¼resel daÄŸÄ±tÄ±m, kalÄ±cÄ± depolama, esnek iÅŸletim sistemi seÃ§enekleri ve gÃ¼Ã§lÃ¼ aÄŸ ve gÃ¼venlik entegrasyonlarÄ± gibi Ã¶zellikler sunarak, web sitelerini barÄ±ndÄ±rmak, veri iÅŸlemek ve bulutta uygulamalarÄ± verimli bir ÅŸekilde Ã§alÄ±ÅŸtÄ±rmak iÃ§in Ã§ok yÃ¶nlÃ¼ bir seÃ§enek sunar.

### Gizli VM

Gizli VM'ler, en son nesil AMD EPYC iÅŸlemciler tarafÄ±ndan sunulan **donanÄ±m tabanlÄ± gÃ¼venlik Ã¶zelliklerini** kullanÄ±r. Bu Ã¶zellikler, VM'nin iÅŸlenen ve depolanan verilerini ana iÅŸletim sistemi ve hipervizÃ¶rden bile korumasÄ±nÄ± saÄŸlar.

Gizli bir VM Ã§alÄ±ÅŸtÄ±rmak iÃ§in **makine tÃ¼rÃ¼**, aÄŸ **arayÃ¼zÃ¼**, **Ã¶nyÃ¼kleme diski gÃ¶rÃ¼ntÃ¼sÃ¼** gibi ÅŸeyleri **deÄŸiÅŸtirmeniz gerekebilir**.

### Disk ve Disk Åifreleme

KullanÄ±lacak diski **seÃ§mek** veya **yeni bir tane oluÅŸturmak** mÃ¼mkÃ¼ndÃ¼r. Yeni bir tane seÃ§erseniz:

* Diskin **boyutunu seÃ§ebilirsiniz**
* **Ä°ÅŸletim Sistemi**ni seÃ§ebilirsiniz
* Ã–rneÄŸin silindiÄŸinde diski **silinmesini isteyip istemediÄŸinizi** belirtebilirsiniz
* **Åifreleme**: **VarsayÄ±lan olarak** bir **Google yÃ¶netilen anahtar** kullanÄ±lacaktÄ±r, ancak aynÄ± zamanda **KMS'den bir anahtar seÃ§ebilir** veya **kullanÄ±lacak ham anahtarÄ± belirtebilirsiniz**.

### Konteyner DaÄŸÄ±tÄ±mÄ±

Sanal makine iÃ§ine bir **konteyner** daÄŸÄ±tmak mÃ¼mkÃ¼ndÃ¼r.\
KullanÄ±lacak **gÃ¶rÃ¼ntÃ¼yÃ¼** yapÄ±landÄ±rabilir, iÃ§inde Ã§alÄ±ÅŸtÄ±rÄ±lacak **komutu**, **argÃ¼manlarÄ±**, bir **birim** baÄŸlayabilir ve bu konteyner iÃ§in **Ã§eÅŸitli seÃ§enekler** yapÄ±landÄ±rabilirsiniz, Ã¶rneÄŸin **ayrÄ±calÄ±klÄ± olarak** Ã§alÄ±ÅŸtÄ±rma, stdin ve sahte TTY.

### Hizmet HesabÄ±

VarsayÄ±lan olarak, **Hesap Makinesi varsayÄ±lan hizmet hesabÄ±** kullanÄ±lacaktÄ±r. Bu SA'nÄ±n e-posta adresi ÅŸuna benzer: `<proj-num>-compute@developer.gserviceaccount.com`\
Bu hizmet hesabÄ±, projenin **tÃ¼mÃ¼ Ã¼zerinde EditÃ¶r rolÃ¼ne (yÃ¼ksek yetkiler) sahiptir**.

Ve **varsayÄ±lan eriÅŸim kapsamlarÄ±** aÅŸaÄŸÄ±daki gibidir:

* **https://www.googleapis.com/auth/devstorage.read\_only** -- Bucket'lara okuma eriÅŸimi :)
* https://www.googleapis.com/auth/logging.write
* https://www.googleapis.com/auth/monitoring.write
* https://www.googleapis.com/auth/servicecontrol
* https://www.googleapis.com/auth/service.management.readonly
* https://www.googleapis.com/auth/trace.append

Ancak, bunu **bir tÄ±klama ile `cloud-platform` olarak vermek** veya **Ã¶zel olanlarÄ± belirtmek** mÃ¼mkÃ¼ndÃ¼r.

<figure><img src="../../../../.gitbook/assets/image (138).png" alt=""><figcaption></figcaption></figure>

### GÃ¼venlik DuvarÄ±

HTTP ve HTTPS trafiÄŸine izin vermek mÃ¼mkÃ¼ndÃ¼r.

<figure><img src="../../../../.gitbook/assets/image (137).png" alt=""><figcaption></figcaption></figure>

### AÄŸ

* **IP YÃ¶nlendirme**: Ä°stemcinin oluÅŸturulmasÄ±ndan itibaren **IP yÃ¶nlendirmeyi etkinleÅŸtirmek** mÃ¼mkÃ¼ndÃ¼r.
* **Ana Makine AdÄ±**: Ä°steme kalÄ±cÄ± bir ana makine adÄ± verebilirsiniz.
* **ArayÃ¼z**: Bir aÄŸ arayÃ¼zÃ¼ eklemek mÃ¼mkÃ¼ndÃ¼r.

### Ek GÃ¼venlik

Bu seÃ§enekler, VM'nin gÃ¼venliÄŸini **artÄ±rÄ±r** ve Ã¶nerilir:

* **GÃ¼venli Ã¶nyÃ¼kleme:** GÃ¼venli Ã¶nyÃ¼kleme, VM Ã¶rneklerinizi Ã¶nyÃ¼kleme dÃ¼zeyi ve Ã§ekirdek dÃ¼zeyi kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±mlara ve kÃ¶k kitlere karÅŸÄ± korur.
* **vTPM'yi EtkinleÅŸtir:** Sanal GÃ¼venilir Platform ModÃ¼lÃ¼ (vTPM), konuk VM'nizin Ã¶nyÃ¼kleme Ã¶ncesi ve Ã¶nyÃ¼kleme bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ doÄŸrular ve anahtar oluÅŸturma ve koruma sunar.
* **BÃ¼tÃ¼nlÃ¼k denetimi:** BÃ¼tÃ¼nlÃ¼k izleme, Stackdriver raporlarÄ± kullanarak kalkanlÄ± VM Ã¶rneklerinizin Ã§alÄ±ÅŸma zamanÄ± Ã¶nyÃ¼kleme bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ izlemenizi ve doÄŸrulamanÄ±zÄ± saÄŸlar. vTPM'nin etkinleÅŸtirilmesi gereklidir.

### VM EriÅŸimi

VM'ye eriÅŸimi etkinleÅŸtirmenin yaygÄ±n yolu, belirli SSH genel anahtarlarÄ±nÄ±n VM'ye eriÅŸmesine **izin vermek**tir.\
Ancak, bu eriÅŸimi **IAM kullanarak `os-config` hizmetini kullanarak** etkinleÅŸtirmek de mÃ¼mkÃ¼ndÃ¼r. DahasÄ±, bu hizmeti kullanarak VM'ye eriÅŸmek iÃ§in 2FA'yÄ± etkinleÅŸtirmek de mÃ¼mkÃ¼ndÃ¼r.\
Bu **hizmet** etkinleÅŸtirildiÄŸinde, **SSH anahtarlarÄ±yla eriÅŸim devre dÄ±ÅŸÄ± bÄ±rakÄ±lÄ±r**.

<figure><img src="../../../../.gitbook/assets/image (139).png" alt=""><figcaption></figcaption></figure>

### Meta Veri

Her makine aÃ§Ä±ldÄ±ÄŸÄ±nda veya yeniden baÅŸlatÄ±ldÄ±ÄŸÄ±nda **yÃ¼rÃ¼tÃ¼lecek kabuk komutlarÄ±** olan **otomasyonu** (AWS'deki userdata) tanÄ±mlamak mÃ¼mkÃ¼ndÃ¼r.

AyrÄ±ca, metadata uÃ§ noktasÄ±ndan eriÅŸilebilecek **ekstra meta veri anahtar-deÄŸer deÄŸerleri** eklemek de mÃ¼mkÃ¼ndÃ¼r. Bu bilgi genellikle ortam deÄŸiÅŸkenleri ve baÅŸlatma/kapatma komutlarÄ± iÃ§in kullanÄ±lÄ±r. Bu, numaralandÄ±rma bÃ¶lÃ¼mÃ¼ndeki bir komutun **`describe` yÃ¶ntemi** kullanÄ±larak elde edilebilir, ancak ayrÄ±ca meta veri uÃ§ noktasÄ±na eriÅŸerek Ã¶rneÄŸin iÃ§eriden de alÄ±nabilir.
```bash
# view project metadata
curl "http://metadata.google.internal/computeMetadata/v1/project/attributes/?recursive=true&alt=text" \
-H "Metadata-Flavor: Google"

# view instance metadata
curl "http://metadata.google.internal/computeMetadata/v1/instance/attributes/?recursive=true&alt=text" \
-H "Metadata-Flavor: Google"
```
AyrÄ±ca, **baÄŸlÄ± hizmet hesabÄ± iÃ§in yetkilendirme belirteci** ve **Ã¶zet bilgiler** Ã¶rneÄŸin, Ã¶rneÄŸin, aÄŸ ve proje hakkÄ±nda, **meta veri uÃ§ noktasÄ±ndan** de alÄ±nabilir. Daha fazla bilgi iÃ§in ÅŸuraya bakÄ±n:

{% embed url="https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery/cloud-ssrf#6440" %}

### Åifreleme

VarsayÄ±lan olarak, Google tarafÄ±ndan yÃ¶netilen bir ÅŸifreleme anahtarÄ± kullanÄ±lÄ±r, ancak MÃ¼ÅŸteri tarafÄ±ndan yÃ¶netilen bir ÅŸifreleme anahtarÄ± (CMEK) yapÄ±landÄ±rÄ±labilir. AyrÄ±ca, kullanÄ±lan CMEF iptal edildiÄŸinde ne yapÄ±lacaÄŸÄ±nÄ± da yapÄ±landÄ±rabilirsiniz: HiÃ§bir ÅŸey yapma veya sanal makineyi kapatma.

<figure><img src="../../../../.gitbook/assets/image (140).png" alt=""><figcaption></figcaption></figure>

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahramana kadar AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya HackTricks'i **PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARI**](https://github.com/sponsors/carlospolop)'na gÃ¶z atÄ±n!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)'Ä± **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>
