# GCP - App Engine æšä¸¾

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹  AWS é»‘å®¢æŠ€æœ¯ï¼Œæˆä¸ºä¸“å®¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS çº¢é˜Ÿä¸“å®¶ï¼‰</strong></a><strong>ï¼</strong></summary>

æ”¯æŒ HackTricks çš„å…¶ä»–æ–¹å¼ï¼š

- å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨ HackTricks ä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½ PDF ç‰ˆæœ¬çš„ HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
- è·å–[**å®˜æ–¹ PEASS & HackTricks å•†å“**](https://peass.creator-spring.com)
- æ¢ç´¢[**PEASS å®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFT**](https://opensea.io/collection/the-peass-family)æ”¶è—å“
- **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** ä¸Šå…³æ³¨æˆ‘ä»¬**ã€‚
- é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>

## åŸºæœ¬ä¿¡æ¯ <a href="#reviewing-app-engine-configurations" id="reviewing-app-engine-configurations"></a>

Google Cloud Platformï¼ˆGCPï¼‰çš„ App Engine æ˜¯ä¸€ä¸ª**å¼ºå¤§çš„æ— æœåŠ¡å™¨å¹³å°ï¼Œä¸“ä¸ºå¤§è§„æ¨¡ Web åº”ç”¨ç¨‹åºçš„å¼€å‘å’Œæ‰˜ç®¡è€Œè®¾è®¡**ã€‚è¯¥å¹³å°çš„è®¾è®¡ä¾§é‡äºç®€åŒ–å¼€å‘æµç¨‹å¹¶å¢å¼ºåº”ç”¨ç¨‹åºçš„å¯ç®¡ç†æ€§ã€‚GCP çš„ App Engine çš„å…³é”®ç‰¹ç‚¹å’Œä¼˜åŠ¿åŒ…æ‹¬ï¼š

1. **æ— æœåŠ¡å™¨æ¶æ„**ï¼šApp Engine è‡ªåŠ¨å¤„ç†åŸºç¡€æ¶æ„ï¼ŒåŒ…æ‹¬æœåŠ¡å™¨ä¾›åº”ã€é…ç½®å’Œæ‰©å±•ã€‚è¿™ä½¿å¼€å‘äººå‘˜å¯ä»¥ä¸“æ³¨äºç¼–å†™ä»£ç ï¼Œè€Œä¸å¿…æ‹…å¿ƒåº•å±‚ç¡¬ä»¶ã€‚
2. **è‡ªåŠ¨æ‰©å±•**ï¼šApp Engine å¯æ ¹æ®æ¥æ”¶åˆ°çš„æµé‡é‡è‡ªåŠ¨æ‰©å±•åº”ç”¨ç¨‹åºã€‚å®ƒåœ¨å¤„ç†å¢åŠ çš„æµé‡æ—¶è¿›è¡Œæ‰©å±•ï¼Œå¹¶åœ¨æµé‡å‡å°‘æ—¶è¿›è¡Œç¼©å‡ï¼Œæœ‰åŠ©äºä¼˜åŒ–æˆæœ¬å’Œæ€§èƒ½ã€‚
3. **è¯­è¨€å’Œè¿è¡Œæ—¶æ”¯æŒ**ï¼šå®ƒæ”¯æŒæµè¡Œçš„ç¼–ç¨‹è¯­è¨€ï¼Œå¦‚ Javaã€Pythonã€Node.jsã€Goã€Rubyã€PHP å’Œ .NETã€‚æ‚¨å¯ä»¥åœ¨æ ‡å‡†ç¯å¢ƒæˆ–çµæ´»ç¯å¢ƒä¸­è¿è¡Œåº”ç”¨ç¨‹åºã€‚æ ‡å‡†ç¯å¢ƒæ›´ä¸ºå—é™ï¼Œä½†é’ˆå¯¹ç‰¹å®šè¯­è¨€è¿›è¡Œäº†é«˜åº¦ä¼˜åŒ–ï¼Œè€Œçµæ´»ç¯å¢ƒå…è®¸æ›´å¤šå®šåˆ¶ã€‚
4. **é›†æˆæœåŠ¡**ï¼šApp Engine ä¸è®¸å¤šå…¶ä»– GCP æœåŠ¡é›†æˆï¼Œå¦‚ Cloud SQLã€Cloud Storageã€Cloud Datastore ç­‰ã€‚è¿™ç§é›†æˆç®€åŒ–äº†åŸºäºäº‘çš„åº”ç”¨ç¨‹åºçš„æ¶æ„ã€‚
5. **ç‰ˆæœ¬æ§åˆ¶å’Œæµé‡åˆ†å‰²**ï¼šæ‚¨å¯ä»¥è½»æ¾éƒ¨ç½²åº”ç”¨ç¨‹åºçš„å¤šä¸ªç‰ˆæœ¬ï¼Œç„¶ååœ¨å®ƒä»¬ä¹‹é—´åˆ†å‰²æµé‡è¿›è¡Œ A/B æµ‹è¯•æˆ–é€æ­¥å‘å¸ƒã€‚
6. **åº”ç”¨ç¨‹åºæ´å¯Ÿ**ï¼šApp Engine æä¾›å†…ç½®æœåŠ¡ï¼Œå¦‚æ—¥å¿—è®°å½•ã€ç”¨æˆ·èº«ä»½éªŒè¯ä»¥åŠä¸€å¥—å¼€å‘äººå‘˜å·¥å…·ï¼Œç”¨äºç›‘è§†å’Œç®¡ç†åº”ç”¨ç¨‹åºã€‚
7. **å®‰å…¨æ€§**ï¼šå®ƒæä¾›å†…ç½®å®‰å…¨åŠŸèƒ½ï¼Œå¦‚åº”ç”¨ç¨‹åºç‰ˆæœ¬æ§åˆ¶ã€ç”¨äºå®‰å…¨è¿æ¥çš„ SSL/TLS è¯ä¹¦ä»¥åŠèº«ä»½å’Œè®¿é—®ç®¡ç†ã€‚

### é˜²ç«å¢™

å¯ä»¥ä¸ºè¿è¡Œåº”ç”¨ç¨‹åºçš„å®ä¾‹é…ç½®ä¸€ä¸ªç®€å•çš„**é˜²ç«å¢™**ï¼Œå…·æœ‰ä»¥ä¸‹é€‰é¡¹ï¼š

<figure><img src="../../../.gitbook/assets/image (246).png" alt=""><figcaption></figcaption></figure>

### SA

è¿™äº›åº”ç”¨ç¨‹åºä½¿ç”¨çš„é»˜è®¤æœåŠ¡å¸æˆ·æ˜¯**`<proj-name>@appspot.gserviceaccount.com`**ï¼Œè¯¥å¸æˆ·åœ¨é¡¹ç›®ä¸­å…·æœ‰**ç¼–è¾‘**è§’è‰²ï¼Œå¹¶ä¸” APP Engine å®ä¾‹ä¸­çš„ SAs **å…·æœ‰äº‘å¹³å°èŒƒå›´ï¼ˆç­‰ç­‰ï¼‰çš„æƒé™**ã€‚

### å­˜å‚¨

æºä»£ç å’Œå…ƒæ•°æ®**è‡ªåŠ¨å­˜å‚¨åœ¨å­˜å‚¨æ¡¶**ä¸­ï¼Œåç§°ç±»ä¼¼äº `<proj-id>.appspot.com` å’Œ `staging.<proj-id>.appspot.com` å’Œ `<country>.<proj-id>.appspot.com`

**åº”ç”¨ç¨‹åºçš„æ¯ä¸ªæ–‡ä»¶**éƒ½ä»¥**å†…å®¹çš„ sha1 ä½œä¸ºæ–‡ä»¶å**å­˜å‚¨ï¼š

<figure><img src="../../../.gitbook/assets/image (82).png" alt=""><figcaption></figcaption></figure>

åœ¨ `staging.<proj-id>.appspot.com` çš„ **`ae`** æ–‡ä»¶å¤¹ä¸­ï¼Œæ¯ä¸ªç‰ˆæœ¬éƒ½æœ‰ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«**æºä»£ç **æ–‡ä»¶å’Œæè¿°åº”ç”¨ç¨‹åºç»„ä»¶çš„ **`manifest.json`** æ–‡ä»¶ï¼š
```json
{"requirements.txt":{"sourceUrl":"https://storage.googleapis.com/staging.onboarding-host-98efbf97812843.appspot.com/a270eedcbe2672c841251022b7105d340129d108","sha1Sum":"a270eedc_be2672c8_41251022_b7105d34_0129d108"},"main_test.py":{"sourceUrl":"https://storage.googleapis.com/staging.onboarding-host-98efbf97812843.appspot.com/0ca32fd70c953af94d02d8a36679153881943f32","sha1Sum":"0ca32fd7_0c953af9_4d02d8a ...
```
{% endcode %}

### å®¹å™¨

Web åº”ç”¨æœ€ç»ˆå°†åœ¨å®¹å™¨å†…æ‰§è¡Œï¼Œä½¿ç”¨ Code Build æ„å»ºå®¹å™¨ã€‚

### URL å’ŒåŒºåŸŸ

**é»˜è®¤**çš„ç½‘é¡µå°†åœ¨ URL **`<project-uniq-name>.appspot.com`** ä¸­å…¬å¼€ï¼Œå°½ç®¡æ—§ç‰ˆæœ¬çš„ URL ä¼šç•¥æœ‰ä¸åŒï¼Œä¾‹å¦‚ **`https://20240117t001540-dot-<project-uniq-name>.uc.r.appspot.com`**ï¼ˆè¯·æ³¨æ„åˆå§‹æ—¶é—´æˆ³ï¼‰ã€‚

çœ‹èµ·æ¥ä¼¼ä¹æ¯ä¸ªåŒºåŸŸåªèƒ½éƒ¨ç½²ä¸€ä¸ªåº”ç”¨å¼•æ“ Web åº”ç”¨ï¼Œä½†å¯ä»¥åœ¨ **`app.yml`** ä¸­æŒ‡å®š **`service: <servicename>`** å¹¶åˆ›å»ºä¸€ä¸ªæ–°æœåŠ¡ï¼ˆä¸€ä¸ªæ–°çš„ Webï¼‰ã€‚è¿™ä¸ªæ–° Web çš„ URL æ ¼å¼å°†æ˜¯ **`<servicename>-dot-<project-uniq-name>.appspot.com`**ã€‚

### æšä¸¾

{% hint style="danger" %}
æ¯æ¬¡ä¸Šä¼ æ–°ä»£ç åˆ°åº”ç”¨ç¨‹åºæ—¶ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°ç‰ˆæœ¬ã€‚**æ‰€æœ‰ç‰ˆæœ¬éƒ½ä¼šè¢«å­˜å‚¨**ï¼Œå®ƒä»¬ç”šè‡³æœ‰ä¸€ä¸ª**ç”¨äºè®¿é—®å®ƒä»¬çš„ URL**ã€‚å› æ­¤ï¼Œä¿®æ”¹æ—§ç‰ˆæœ¬çš„ä»£ç å¯èƒ½æ˜¯ä¸€ç§**å¾ˆå¥½çš„æŒä¹…æ€§æŠ€æœ¯**ã€‚
{% endhint %}

ä¸ Cloud Functions ä¸€æ ·ï¼Œ**åº”ç”¨ç¨‹åºæœ‰å¯èƒ½ä¾èµ–åœ¨è¿è¡Œæ—¶é€šè¿‡ç¯å¢ƒå˜é‡è®¿é—®çš„ç§˜å¯†**ã€‚è¿™äº›å˜é‡å­˜å‚¨åœ¨ä¸€ä¸ª **`app.yaml`** æ–‡ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®ï¼š
```bash
# List the apps
gcloud app services list
gcloud app services describe <app-name>
# Access via browser to the specified app
gcloud app services browse <app-name>

# Get App versions
gcloud app versions list
# Get all the info of the app and version, included specific verion URL and the env
gcloud app versions describe -s <app-name> <version-id>

# Logs
gcloud app logs tail -s <app-name>

# Instances
## This is only valid if a flexible environment is used and not a standard one
gcloud app instances list
gcloud app instances describe -s <app-name> --version <version-id> <ID>
## Connect to the instance via ssh
gcloud app instances ssh --service <app-name> --version <version-id> <ID>

# Firewalls
gcloud app firewall-rules list
gcloud app firewall-rules describe <num_fw>

# Get domains
gcloud app domain-mappings list
gcloud app domain-mappings describe <name>

# SSl certificates
gcloud app ssl-certificates list
gcloud app ssl-certificates describe <name>
```
### ææƒ

{% content-ref url="../gcp-privilege-escalation/gcp-appengine-privesc.md" %}
[gcp-appengine-privesc.md](../gcp-privilege-escalation/gcp-appengine-privesc.md)
{% endcontent-ref %}

### æœªè®¤è¯æšä¸¾

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-app-engine-unauthenticated-enum.md" %}
[gcp-app-engine-unauthenticated-enum.md](../gcp-unaunthenticated-enum-and-access/gcp-app-engine-unauthenticated-enum.md)
{% endcontent-ref %}

### åæ¸—é€

{% content-ref url="../gcp-post-exploitation/gcp-app-engine-post-exploitation.md" %}
[gcp-app-engine-post-exploitation.md](../gcp-post-exploitation/gcp-app-engine-post-exploitation.md)
{% endcontent-ref %}

### æŒä¹…æ€§

{% content-ref url="../gcp-persistence/gcp-app-engine-persistence.md" %}
[gcp-app-engine-persistence.md](../gcp-persistence/gcp-app-engine-persistence.md)
{% endcontent-ref %}

<details>

<summary><strong>ä»é›¶å¼€å§‹å­¦ä¹ AWSé»‘å®¢æŠ€æœ¯</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

æ”¯æŒHackTricksçš„å…¶ä»–æ–¹å¼ï¼š

* å¦‚æœæ‚¨æƒ³çœ‹åˆ°æ‚¨çš„**å…¬å¸åœ¨HackTricksä¸­åšå¹¿å‘Š**æˆ–**ä¸‹è½½PDFæ ¼å¼çš„HackTricks**ï¼Œè¯·æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* è·å–[**å®˜æ–¹PEASS & HackTrickså‘¨è¾¹äº§å“**](https://peass.creator-spring.com)
* æ¢ç´¢[**PEASSå®¶æ—**](https://opensea.io/collection/the-peass-family)ï¼Œæˆ‘ä»¬çš„ç‹¬å®¶[**NFTs**](https://opensea.io/collection/the-peass-family)
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«æ‚¨çš„é»‘å®¢æŠ€å·§ã€‚

</details>
