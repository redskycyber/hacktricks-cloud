# GCP - Cloud Run Enum

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahramana kadar AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'Ä± desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya HackTricks'i **PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) keÅŸfedin, Ã¶zel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonunu
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**'Ä± takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR gÃ¶ndererek paylaÅŸÄ±n**.

</details>

## Cloud Run <a href="#reviewing-cloud-run-configurations" id="reviewing-cloud-run-configurations"></a>

Cloud Run, Google'Ä±n Ã¶lÃ§eklenebilir altyapÄ±sÄ± Ã¼zerinde doÄŸrudan **konteynerleri Ã§alÄ±ÅŸtÄ±rmanÄ±za** olanak tanÄ±yan bir sunucusuz yÃ¶netilen hesaplama platformudur.

Konteynerinizi Ã§alÄ±ÅŸtÄ±rabilir veya Go, Node.js, Python, Java, .NET Core veya Ruby kullanÄ±yorsanÄ±z, **sizin iÃ§in konteyneri oluÅŸturan** [kaynak tabanlÄ± daÄŸÄ±tÄ±m](https://cloud.google.com/run/docs/deploying-source-code) seÃ§eneÄŸini kullanabilirsiniz.

Google, Cloud Run'Ä± **Google Cloud'daki diÄŸer hizmetlerle iyi Ã§alÄ±ÅŸacak ÅŸekilde tasarlamÄ±ÅŸtÄ±r**, bÃ¶ylece tam Ã¶zellikli uygulamalar oluÅŸturabilirsiniz.

### Hizmetler ve iÅŸler <a href="#services-and-jobs" id="services-and-jobs"></a>

Cloud Run'da kodunuz ya bir _**hizmet**_ olarak sÃ¼rekli Ã§alÄ±ÅŸabilir ya da bir _**iÅŸ**_ olarak Ã§alÄ±ÅŸabilir. Hem hizmetler hem de iÅŸler aynÄ± ortamda Ã§alÄ±ÅŸÄ±r ve Google Cloud'daki diÄŸer hizmetlerle aynÄ± entegrasyonlarÄ± kullanabilir.

* **Cloud Run hizmetleri.** Web isteklerine veya olaylara yanÄ±t veren kodu Ã§alÄ±ÅŸtÄ±rmak iÃ§in kullanÄ±lÄ±r.
* **Cloud Run iÅŸleri.** Bir iÅŸi gerÃ§ekleÅŸtiren (bir iÅŸ) ve iÅŸ tamamlandÄ±ÄŸÄ±nda sona eren kodu Ã§alÄ±ÅŸtÄ±rmak iÃ§in kullanÄ±lÄ±r.

## Cloud Run Hizmeti

Google [Cloud Run](https://cloud.google.com/run), env deÄŸiÅŸkenlerini arayabileceÄŸiniz baÅŸka bir sunucusuz tekliftir. Cloud Run, varsayÄ±lan olarak konteyner iÃ§inde 8080 numaralÄ± baÄŸlantÄ± noktasÄ±nda Ã§alÄ±ÅŸan kÃ¼Ã§Ã¼k bir web sunucusu oluÅŸturur ve HTTP GET isteÄŸi bekler. Ä°stek alÄ±ndÄ±ÄŸÄ±nda, bir iÅŸ yÃ¼rÃ¼tÃ¼lÃ¼r ve iÅŸ gÃ¼nlÃ¼ÄŸÃ¼ bir HTTP yanÄ±tÄ± aracÄ±lÄ±ÄŸÄ±yla Ã§Ä±ktÄ±lanÄ±r.

### Ä°lgili ayrÄ±ntÄ±lar

* VarsayÄ±lan olarak, web sunucusuna **eriÅŸim** **genel**dir, ancak **sÄ±nÄ±rlÄ± iÃ§ trafiÄŸe** (VPC...) de **sÄ±nÄ±rlanabilir**.\
AyrÄ±ca, web sunucusuna ulaÅŸmak iÃ§in **kimlik doÄŸrulamasÄ±**, **tÃ¼mÃ¼ne izin verme** veya **IAM aracÄ±lÄ±ÄŸÄ±yla kimlik doÄŸrulama gerektirme** ÅŸeklinde olabilir.
* VarsayÄ±lan olarak, **ÅŸifreleme** bir **Google tarafÄ±ndan yÃ¶netilen anahtar** kullanÄ±r, ancak **KMS** tarafÄ±ndan bir **CMEK** (MÃ¼ÅŸteri YÃ¶netimli Åifreleme AnahtarÄ±) de **seÃ§ilebilir**.
* VarsayÄ±lan olarak, kullanÄ±lan **hizmet hesabÄ±** proje Ã¼zerinde **EditÃ¶r** eriÅŸimine sahip olan **Compute Engine varsayÄ±lan hesabÄ±dÄ±r** ve **`cloud-platform`** kapsamÄ±na sahiptir.
* YÃ¼rÃ¼tme iÃ§in **aÃ§Ä±k metin ortam deÄŸiÅŸkenleri** tanÄ±mlanabilir ve hatta **bulut sÄ±rlarÄ±nÄ± baÄŸlamak** veya **bulut sÄ±rlarÄ±nÄ± ortam deÄŸiÅŸkenlerine eklemek** mÃ¼mkÃ¼ndÃ¼r.
* AyrÄ±ca, **Cloud SQL ile baÄŸlantÄ±lar eklemek** ve **bir dosya sistemi baÄŸlamak** mÃ¼mkÃ¼ndÃ¼r.
* DaÄŸÄ±tÄ±lan hizmetlerin **URL'leri**, **`https://<svc-name>-<random>.a.run.app`** ÅŸeklinde benzerdir.
* Bir Run Hizmeti, **1'den fazla sÃ¼rÃ¼m veya revizyon** iÃ§erebilir ve Ã§eÅŸitli revizyonlar arasÄ±nda **trafiÄŸi bÃ¶lebilir**.

### Enumerasyon
```bash
# List services
gcloud run services list
gcloud run services list --platform=managed
gcloud run services list --platform=gke

# Get info of a service
gcloud run services describe --region <region> <svc-name>

# Get info of all the services together
gcloud run services list --format=yaml
gcloud run services list --platform=managed --format=json
gcloud run services list --platform=gke --format=json

# Get policy
gcloud run services get-iam-policy --region <region> <svc-name>

# Get revisions
gcloud run revisions list --region <region>
gcloud run revisions describe --region <region> <revision>

# Get domains
gcloud run domain-mappings list
gcloud run domain-mappings describe <name>

# Attempt to trigger a job unauthenticated
curl <url>

# Attempt to trigger a job with your current gcloud authorization
curl -H "Authorization: Bearer $(gcloud auth print-identity-token)" <url>
```
## Cloud Run Ä°ÅŸleri

Cloud Run iÅŸleri, **tamamlanma sÃ¼resi olan ve istekleri karÅŸÄ±lamayan konteynerler iÃ§in daha uygun** olabilir. Ä°ÅŸler, istekleri karÅŸÄ±lamak veya bir baÄŸlantÄ± noktasÄ±nda dinlemek gibi bir yeteneÄŸe sahip deÄŸildir. Bu, Cloud Run hizmetlerinin aksine, iÅŸlerin bir web sunucusu iÃ§ermemesi gerektiÄŸi anlamÄ±na gelir. Bunun yerine, iÅŸ konteynerleri tamamlandÄ±ÄŸÄ±nda sonlanmalÄ±dÄ±r.

### SÄ±ralama
```bash
gcloud beta run jobs list
gcloud beta run jobs describe --region <region> <job-name>
gcloud beta run jobs get-iam-policy --region <region> <job-name>
```
## AyrÄ±calÄ±k YÃ¼kseltme

AÅŸaÄŸÄ±daki sayfada, **ayrÄ±calÄ±klarÄ± yÃ¼kseltmek iÃ§in bulut Ã§alÄ±ÅŸtÄ±rma izinlerinin nasÄ±l kÃ¶tÃ¼ye kullanÄ±labileceÄŸini** kontrol edebilirsiniz:

{% content-ref url="../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md" %}
[gcp-run-privesc.md](../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md)
{% endcontent-ref %}

## Kimlik DoÄŸrulamasÄ±z EriÅŸim

{% content-ref url="../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md" %}
[gcp-cloud-run-unauthenticated-enum.md](../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md)
{% endcontent-ref %}

## SaldÄ±rÄ± SonrasÄ±

{% content-ref url="../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md" %}
[gcp-cloud-run-post-exploitation.md](../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md)
{% endcontent-ref %}

## KalÄ±cÄ±lÄ±k

{% content-ref url="../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md" %}
[gcp-cloud-run-persistence.md](../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md)
{% endcontent-ref %}

## Referanslar

* [https://cloud.google.com/run/docs/overview/what-is-cloud-run](https://cloud.google.com/run/docs/overview/what-is-cloud-run)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sÄ±fÄ±rdan kahraman olmak iÃ§in AWS hackleme Ã¶ÄŸrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diÄŸer yollarÄ±:

* Åirketinizi HackTricks'te **reklamÄ±nÄ±zÄ± gÃ¶rmek** veya HackTricks'i **PDF olarak indirmek** iÃ§in [**ABONELÄ°K PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks Ã¼rÃ¼nlerini**](https://peass.creator-spring.com) edinin
* Ã–zel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluÅŸan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keÅŸfedin
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katÄ±lÄ±n** veya bizi **Twitter** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**'da** takip edin.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **PR gÃ¶ndererek** paylaÅŸÄ±n.

</details>
