# GCP - Cloud Run Enum

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakerskimi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Cloud Run <a href="#reviewing-cloud-run-configurations" id="reviewing-cloud-run-configurations"></a>

Cloud Run to zarzÄ…dzana platforma obliczeniowa bezserwerowa, ktÃ³ra pozwala **uruchamiaÄ‡ kontenery** bezpoÅ›rednio na skalowalnej infrastrukturze Google.

MoÅ¼esz uruchamiaÄ‡ swÃ³j kontener lub JeÅ›li korzystasz z Go, Node.js, Python, Java, .NET Core lub Ruby, moÅ¼esz skorzystaÄ‡ z opcji [wdroÅ¼enia opartego na ÅºrÃ³dle](https://cloud.google.com/run/docs/deploying-source-code), ktÃ³ra **buduje kontener za Ciebie.**

Google zbudowaÅ‚ Cloud Run, aby **dobrze wspÃ³Å‚pracowaÅ‚ z innymi usÅ‚ugami w Google Cloud**, dziÄ™ki czemu moÅ¼esz tworzyÄ‡ peÅ‚nowymiarowe aplikacje.

### UsÅ‚ugi i zadania <a href="#services-and-jobs" id="services-and-jobs"></a>

Na Cloud Run, TwÃ³j kod moÅ¼e dziaÅ‚aÄ‡ ciÄ…gle jako _**usÅ‚uga**_ lub jako _**zadanie**_. ZarÃ³wno usÅ‚ugi, jak i zadania dziaÅ‚ajÄ… w tym samym Å›rodowisku i mogÄ… korzystaÄ‡ z tych samych integracji z innymi usÅ‚ugami w Google Cloud.

* **UsÅ‚ugi Cloud Run.** SÅ‚uÅ¼Ä… do uruchamiania kodu reagujÄ…cego na Å¼Ä…dania sieciowe lub zdarzenia.
* **Zadania Cloud Run.** SÅ‚uÅ¼Ä… do uruchamiania kodu wykonujÄ…cego pracÄ™ (zadanie) i koÅ„czÄ… siÄ™ po zakoÅ„czeniu pracy.

## UsÅ‚uga Cloud Run

Google [Cloud Run](https://cloud.google.com/run) to kolejna oferta bezserwerowa, gdzie moÅ¼na szukaÄ‡ zmiennych Å›rodowiskowych. Cloud Run tworzy maÅ‚y serwer WWW, domyÅ›lnie dziaÅ‚ajÄ…cy na porcie 8080 wewnÄ…trz kontenera, ktÃ³ry czeka na Å¼Ä…danie HTTP GET. Po otrzymaniu Å¼Ä…dania, uruchamiane jest zadanie, a dziennik zadania jest wyprowadzany za pomocÄ… odpowiedzi HTTP.

### Istotne szczegÃ³Å‚y

* DomyÅ›lnie **dostÄ™p** do serwera WWW jest **publiczny**, ale moÅ¼na go rÃ³wnieÅ¼ **ograniczyÄ‡ do ruchu wewnÄ™trznego** (VPC...)\
Ponadto **uwierzytelnienie** w celu skontaktowania siÄ™ z serwerem WWW moÅ¼e byÄ‡ **zezwala na wszystkich** lub **wymagaÄ‡ uwierzytelnienia za pomocÄ… IAM**.
* DomyÅ›lnie **szyfrowanie** korzysta z **zarzÄ…dzanego przez Google klucza**, ale moÅ¼na rÃ³wnieÅ¼ wybraÄ‡ **CMEK** (Klucz Szyfrowania ZarzÄ…dzany przez Klienta) z **KMS**.
* DomyÅ›lnie uÅ¼ywane jest **konto usÅ‚ugi** to **domyÅ›lne konto Compute Engine**, ktÃ³re ma dostÄ™p **Edytora** do projektu i ma zakres `cloud-platform`.
* MoÅ¼na zdefiniowaÄ‡ **zmienne Å›rodowiskowe w postaci tekstu jawnego** dla wykonania, a nawet **zamontowaÄ‡ tajne klucze chmury** lub **dodaÄ‡ tajne klucze chmury do zmiennych Å›rodowiskowych.**
* MoÅ¼liwe jest rÃ³wnieÅ¼ **dodanie poÅ‚Ä…czeÅ„ z Cloud SQL** i **zamontowanie systemu plikÃ³w.**
* **Adresy URL** wdroÅ¼onych usÅ‚ug sÄ… podobne do **`https://<nazwa-usÅ‚ugi>-<losowy>.a.run.app`**
* UsÅ‚uga Run moÅ¼e mieÄ‡ **wiÄ™cej niÅ¼ 1 wersjÄ™ lub rewizjÄ™**, i **rozdzielaÄ‡ ruch** miÄ™dzy kilkoma rewizjami.

### Wyliczenie
```bash
# List services
gcloud run services list
gcloud run services list --platform=managed
gcloud run services list --platform=gke

# Get info of a service
gcloud run services describe --region <region> <svc-name>

# Get info of all the services together
gcloud run services list --format=yaml
gcloud run services list --platform=managed --format=json
gcloud run services list --platform=gke --format=json

# Get policy
gcloud run services get-iam-policy --region <region> <svc-name>

# Get revisions
gcloud run revisions list --region <region>
gcloud run revisions describe --region <region> <revision>

# Get domains
gcloud run domain-mappings list
gcloud run domain-mappings describe <name>

# Attempt to trigger a job unauthenticated
curl <url>

# Attempt to trigger a job with your current gcloud authorization
curl -H "Authorization: Bearer $(gcloud auth print-identity-token)" <url>
```
## Zadania Cloud Run

Zadania Cloud Run sÄ… lepszym rozwiÄ…zaniem dla **kontenerÃ³w, ktÃ³re dziaÅ‚ajÄ… do zakoÅ„czenia i nie obsÅ‚ugujÄ… Å¼Ä…daÅ„**. Zadania nie majÄ… moÅ¼liwoÅ›ci obsÅ‚ugi Å¼Ä…daÅ„ ani nasÅ‚uchiwania na porcie. Oznacza to, Å¼e w przeciwieÅ„stwie do usÅ‚ug Cloud Run, zadania nie powinny zawieraÄ‡ serwera sieciowego. Zamiast tego, kontenery z zadaniami powinny zakoÅ„czyÄ‡ dziaÅ‚anie po zakoÅ„czeniu zadania.

### Wyliczanie
```bash
gcloud beta run jobs list
gcloud beta run jobs describe --region <region> <job-name>
gcloud beta run jobs get-iam-policy --region <region> <job-name>
```
## Eskalacja uprawnieÅ„

Na nastÄ™pnej stronie moÅ¼esz sprawdziÄ‡, jak **naduÅ¼yÄ‡ uprawnienia chmury Run do eskalacji uprawnieÅ„**:

{% content-ref url="../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md" %}
[gcp-run-privesc.md](../../gcp-security/gcp-privilege-escalation/gcp-run-privesc.md)
{% endcontent-ref %}

## Nieuwierzytelniony dostÄ™p

{% content-ref url="../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md" %}
[gcp-cloud-run-unauthenticated-enum.md](../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md)
{% endcontent-ref %}

## Po wykorzystaniu

{% content-ref url="../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md" %}
[gcp-cloud-run-post-exploitation.md](../../gcp-security/gcp-post-exploitation/gcp-cloud-run-post-exploitation.md)
{% endcontent-ref %}

## TrwaÅ‚oÅ›Ä‡

{% content-ref url="../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md" %}
[gcp-cloud-run-persistence.md](../../gcp-security/gcp-persistence/gcp-cloud-run-persistence.md)
{% endcontent-ref %}

## OdnoÅ›niki

* [https://cloud.google.com/run/docs/overview/what-is-cloud-run](https://cloud.google.com/run/docs/overview/what-is-cloud-run)

<details>

<summary><strong>Naucz siÄ™ hakowaÄ‡ AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* JeÅ›li chcesz zobaczyÄ‡ swojÄ… **firmÄ™ reklamowanÄ… w HackTricks** lub **pobraÄ‡ HackTricks w formacie PDF**, sprawdÅº [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* ZdobÄ…dÅº [**oficjalne gadÅ¼ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**RodzinÄ™ PEASS**](https://opensea.io/collection/the-peass-family), naszÄ… kolekcjÄ™ ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ swoimi sztuczkami hakowania, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
